(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e72a68ac"],{"05c8":function(e,t,a){},"0a6b":function(e,t,a){"use strict";a("8c51")},"1d92":function(e,t,a){"use strict";a("05c8")},"1e8f":function(e,t,a){},7205:function(e,t,a){"use strict";a("e838")},"8b4b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrap-offer"},[a("div",{staticClass:"wrap-offer__table"},[a("base-table",{staticClass:"offer-table",attrs:{data:e.data,showPagination:!0,isLoading:e.isLoading,table:e.params,paginationInfo:"chương trình",emptyText:"Không có dữ liệu chương trình ưu đãi"},on:{sizeChange:e.handleSizeChange,currentChange:e.handleCurrentChange,rowClick:e.handleRowClick}},[a("template",{slot:"header"},[a("filter-offer",{on:{search:e.handleSearch,create:e.handleOpenPopupCreate}})],1),a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"#",width:"70",align:"center"}}),a("el-table-column",{attrs:{label:"Mã chương trình",width:"200",prop:"programCode"}}),a("el-table-column",{attrs:{label:"Tên chương trình",prop:"programName"}}),a("el-table-column",{attrs:{label:"Mô tả",prop:"description"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.description))])]}}])}),a("el-table-column",{attrs:{"class-name":"column-action",width:"30",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.getRoleOffer?a("div",{staticClass:"wrap-icon",on:{click:function(a){return e.handleEdit(t.row)}}},[a("base-icon",{staticClass:"icon",staticStyle:{"font-size":"16px"},attrs:{icon:"edit-permission"}})],1):e._e()]}}])}),a("el-table-column",{attrs:{"class-name":"column-action",width:"35",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.getRoleOffer?a("div",{staticClass:"wrap-icon",on:{click:function(a){return e.handleOpenConfirm(t.row)}}},[a("base-icon",{staticClass:"icon",staticStyle:{"font-size":"16px"},attrs:{icon:"icon-thung-rac"}})],1):e._e()]}}])}),a("el-table-column",{attrs:{width:"10"}})],2)],1),a("popup-offer",{attrs:{detail:e.detailRow,type:e.type},on:{create:e.handleCreate,update:e.handleUpdate,delete:e.handleOpenConfirm}}),a("popup-confirm",{on:{confirm:e.handleConfirm}})],1)},i=[],s=a("f3f3"),r=a("c964"),o=a("276c"),c=a("e954"),l=a("920b"),p=a("92a6"),h=(a("96cf"),a("ac1f"),a("841c"),a("9ab4")),u=a("08ba"),d=a("1b40"),f=a("9f48"),m=a("c56f"),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"audit-action be-flex jc-space-between"},[a("div",{staticClass:"aciton-left flex"},[a("span",{staticClass:"search flex"},[a("base-icon",{staticClass:"icon-search",attrs:{icon:"search"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"searchBar",attrs:{type:"text",placeholder:"Tìm kiếm..."},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}})],1)]),e.checkPemission("offer",["add-offer"])?a("div",{staticClass:"action-right flex actions"},[a("el-button",{staticClass:"be-btn-danger btn-audit",attrs:{size:"medium"},on:{click:e.handleCreate}},[e._v("Thêm mới ")])],1):e._e()])},g=[],v=a("2ef0"),C=function(e){Object(l["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.search="",e.searchText=Object(v["debounce"])((function(t){e.$emit("search",Object(v["trim"])(t))}),500),e}return Object(c["a"])(a,[{key:"handleSearch",value:function(e){this.searchText(e)}},{key:"handleCreate",value:function(){this.$emit("create")}}]),a}(d["d"]);Object(h["a"])([Object(d["e"])("search")],C.prototype,"handleSearch",null),C=Object(h["a"])([d["a"]],C);var O=C,y=O,k=(a("0a6b"),a("2877")),j=Object(k["a"])(y,b,g,!1,null,"4ff85690",null),x=j.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-popup",{staticClass:"popup-offer",attrs:{name:"popup-offer",top:"8vh",hiddenFooter:!0,width:"380px",open:e.handleOpen}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._v(e._s("create"===e.type?"Thêm chương trình ưu đãi":"Sửa chương trình ưu đãi"))]),a("div",{staticClass:"content"},[a("el-form",{staticClass:"base-form",attrs:{model:e.data,"label-position":"top"}},[a("el-form-item",{staticClass:"base-form__item required",attrs:{label:"Mã chương trình"}},[a("el-input",{staticClass:"input-contact",attrs:{type:"text",placeholder:"Nhập mã"},on:{input:function(t){return e.handleChangeInput("code")}},model:{value:e.data.programCode,callback:function(t){e.$set(e.data,"programCode",t)},expression:"data.programCode"}}),e.errorCode?a("small",{staticClass:"small"},[e._v("Mã chương trình không được để trống")]):e._e()],1),a("el-form-item",{staticClass:"base-form__item required",attrs:{label:"Tên chương trình"}},[a("el-input",{attrs:{type:"text",placeholder:"Nhập tên"},on:{input:function(t){return e.handleChangeInput("name")}},model:{value:e.data.programName,callback:function(t){e.$set(e.data,"programName",t)},expression:"data.programName"}}),e.errorName?a("small",{staticClass:"small"},[e._v("Tên chương trình không được để trống")]):e._e()],1),a("el-form-item",{attrs:{prop:"description",label:"Mô tả"}},[a("el-input",{attrs:{type:"textarea",rows:5,placeholder:"Nhập mô tả"},model:{value:e.data.description,callback:function(t){e.$set(e.data,"description",t)},expression:"data.description"}})],1)],1)],1),a("template",{slot:"footer"},[a("div",{staticClass:"bottom be-flex",class:"create"===e.type?"jc-flex-end":"jc-space-between"},["edit"===e.type?a("el-button",{staticStyle:{height:"36px"},attrs:{size:"medium"},on:{click:e.handleDelete}},[e._v("Xóa")]):e._e(),a("div",{staticClass:"be-flex"},[a("el-button",{staticClass:"is-none-border",staticStyle:{height:"36px",background:"transparent"},on:{click:e.handleCancel}},[e._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",staticStyle:{height:"36px"},on:{click:e.handleSave}},[e._v("Lưu")])],1)],1)])],2)},_=[],N=function(e){Object(l["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.data={},e.errorName=!1,e.errorCode=!1,e.isExistContact=!1,e.optionType=[],e}return Object(c["a"])(a,[{key:"handleOpen",value:function(){this.errorName=!1,this.errorCode=!1,"edit"===this.type?this.data=Object(s["a"])({},this.detail):this.data={}}},{key:"handleChangeInput",value:function(e){console.log(e),"name"===e?this.errorName=!1:this.errorCode=!1,this.$forceUpdate()}},{key:"handleCancel",value:function(){this.setOpenPopup({popupName:"popup-offer",isOpen:!1})}},{key:"handleSave",value:function(){""===Object(v["trim"])(this.data.programName)&&(this.errorName=!0),""===Object(v["trim"])(this.data.programCode)&&(this.errorCode=!0),this.errorName||this.errorCode||("create"===this.type?this.$emit("create",this.data):this.$emit("update",this.data))}},{key:"handleDelete",value:function(){this.$emit("delete",this.data)}}]),a}(Object(d["b"])(f["a"]));Object(h["a"])([Object(d["c"])({required:!0,type:Object,default:function(){return{}}})],N.prototype,"detail",void 0),Object(h["a"])([Object(d["c"])({required:!1,type:String,default:"create"})],N.prototype,"type",void 0),N=Object(h["a"])([d["a"]],N);var S=N,$=S,P=(a("f0b4"),Object(k["a"])($,w,_,!1,null,"9184068c",null)),R=P.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-popup",{staticClass:"flex",attrs:{name:"popup-confirm-offer",width:"420px",open:e.handleOpen,hiddenFooter:!0}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._v("Xóa chương trình ưu đãi")]),a("div",{staticClass:"body-content"},[a("span",[e._v(" Bạn chắc chắn muốn xóa chương trình ưu đãi này ? ")])]),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex jc-flex-end"},[a("div",{},[a("el-button",{staticClass:"be-button-unset",staticStyle:{padding:"8px 10px"},attrs:{size:"mini"},on:{click:e.handleCancel}},[e._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:e.handleConfirm}},[e._v("Xác nhận")])],1)])])])],2)},z=[],E=function(e){Object(l["a"])(a,e);var t=Object(p["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return Object(c["a"])(a,[{key:"handleCancel",value:function(){this.setOpenPopup({popupName:"popup-confirm-offer",isOpen:!1})}},{key:"handleConfirm",value:function(){this.handleCancel(),this.$emit("confirm")}},{key:"handleOpen",value:function(){console.log("open")}},{key:"handleClose",value:function(){console.log("close")}}]),a}(Object(d["b"])(f["a"],m["a"]));E=Object(h["a"])([Object(d["a"])({components:{}})],E);var M=E,L=M,I=(a("7205"),Object(k["a"])(L,T,z,!1,null,"609d6ec4",null)),X=I.exports,q=function(e){Object(l["a"])(a,e);var t=Object(p["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.params={search:"",page:1,limit:20,total:0},e.isConflickClick=!1,e.isLoading=!1,e.data=[],e.detailRow={},e.type="create",e}return Object(c["a"])(a,[{key:"created",value:function(){this.apiOffer=Object(u["a"])("offer",{districtId:this.districtId}),this.init()}},{key:"getRoleOffer",get:function(){return this.checkPemission("offer",["add-offer"])}},{key:"indexMethod",value:function(e){return(this.params.page-1)*this.params.limit+e+1}},{key:"handleSizeChange",value:function(e){this.params.page=1,this.params.limit=e,this.init()}},{key:"handleCurrentChange",value:function(e){this.params.page=e,this.init()}},{key:"handleRowClick",value:function(e){if(this.getRoleOffer){if(this.isConflickClick)return void(this.isConflickClick=!1);this.handleEdit(e.row),this.isConflickClick=!1}}},{key:"handleSearch",value:function(e){this.params.page=1,this.params.search=e,this.init()}},{key:"handleOpenPopupCreate",value:function(){this.type="create",this.setOpenPopup({popupName:"popup-offer",isOpen:!0})}},{key:"handleCreate",value:function(e){var t,a=this;null===(t=this.apiOffer)||void 0===t||t.createOffer(e).then((function(){a.$message.success("Tạo chương trình ưu đãi thành công"),a.setOpenPopup({popupName:"popup-offer",isOpen:!1}),a.init()})).catch((function(e){500===e.errorCode&&"Mã chương trình đã tồn tại"===e.message&&a.$message.error(e.message)}))}},{key:"handleUpdate",value:function(e){var t,a=this;null===(t=this.apiOffer)||void 0===t||t.updateOffer(e).then((function(){a.$message.success("Sửa chương trình ưu đãi thành công"),a.setOpenPopup({popupName:"popup-offer",isOpen:!1}),a.init()})).catch((function(e){500===e.errorCode&&"Mã chương trình đã tồn tại"===e.message&&a.$message.error(e.message)}))}},{key:"handleDelete",value:function(e){var t,a=this;null===(t=this.apiOffer)||void 0===t||t.deleteOffer(e).then((function(){a.$message.success("Xóa chương trình ưu đãi thành công"),a.init()})).catch((function(){a.$message.error("Xóa chương trình ưu đãi thất bại")}))}},{key:"handleOpenConfirm",value:function(e){this.isConflickClick=!0,this.detailRow=e,this.setOpenPopup({popupName:"popup-confirm-offer",isOpen:!0})}},{key:"handleConfirm",value:function(){this.handleDelete(this.detailRow.id),this.setOpenPopup({popupName:"popup-offer",isOpen:!1})}},{key:"init",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.isLoading=!0,a=Object(s["a"])(Object(s["a"])({},this.params),{},{search:this.params.search||null,total:null}),e.next=5,null===(t=this.apiOffer)||void 0===t?void 0:t.getOffer(a);case 5:n=e.sent,this.data=n.content||[],this.params.total=n.totalElements,this.isLoading=!1,e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),this.isLoading=!1,console.log(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleEdit",value:function(e){this.isConflickClick=!0,this.detailRow=e,this.type="edit",this.setOpenPopup({popupName:"popup-offer",isOpen:!0})}}]),a}(Object(d["b"])(f["a"],m["a"]));q=Object(h["a"])([Object(d["a"])({components:{FilterOffer:x,PopupOffer:R,PopupConfirm:X}})],q);var D=q,F=D,U=(a("1d92"),Object(k["a"])(F,n,i,!1,null,"7bbdc8a5",null));t["default"]=U.exports},"8c51":function(e,t,a){},e838:function(e,t,a){},f0b4:function(e,t,a){"use strict";a("1e8f")}}]);
//# sourceMappingURL=chunk-e72a68ac.40539627.js.map