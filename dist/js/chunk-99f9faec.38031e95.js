(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-99f9faec"],{"098d":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contract-page"},[a("div",{staticClass:"audit-table"},[a("base-table",{staticClass:"table-contract",attrs:{data:t.data,"is-loading":t.isLoading,table:t.query,paginationInfo:"hợp đồng",emptyText:"Không có dữ liệu hợp đồng"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,rowClick:t.handleRowClick}},[a("template",{slot:"header"},[a("div",{staticClass:"audit-action be-flex jc-space-between"},[a("div",{staticClass:"aciton-left flex"},[a("search-bar",{attrs:{search:t.query.search},on:{search:t.handleSearch}}),a("button",{staticClass:"filter sortText be-button-unset",staticStyle:{"margin-right":"20px","margin-left":"20px"},attrs:{slot:"reference"},on:{click:t.handleClickFillter},slot:"reference"},[a("base-icon",{staticClass:"ABCA",attrs:{icon:"filter"}}),t._v(" Bộ lọc ")],1),a("el-dropdown",{staticClass:"import-sort",attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("el-button",{staticClass:"be-button-unset custom-button"},[a("base-icon",{staticClass:"icon",attrs:{icon:"sort"}}),t._v(" Sắp xếp ")],1),a("el-dropdown-menu",{staticClass:"sort-menu-popper",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.option,(function(e){return a("el-dropdown-item",{key:e.id,class:e.active?"active":null,attrs:{command:e,divided:e.divided}},[a("span",{staticClass:"be-flex"},[a("span",{staticClass:"be-flex-item"},[t._v(" "+t._s(e.name)+" ")])])])})),1)],1)],1),a("div",{staticClass:"action-right flex actions"},[a("el-button",{staticClass:"custom-button",attrs:{loading:t.isExcelLoading},on:{click:t.handleExport}},[a("span",{staticClass:"be-inline-flex align-center"},[a("base-icon",{staticClass:"icon",attrs:{icon:"excel-fullcolor"}}),t._v(" Xuất Excel ")],1)])],1)])]),a("el-table-column",{attrs:{type:"index",index:t.indexMethod,label:"#",width:"61",align:"center"}}),a("el-table-column",{attrs:{label:"SỐ HSYCBH",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.applyFormNo))])]}}])}),a("el-table-column",{attrs:{prop:"contractNo",label:"SỐ HĐBH",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"be-flex"},[a("p",[t._v(t._s(e.row.contractNo))])])]}}])}),a("el-table-column",{attrs:{label:"CHI NHÁNH",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.branchName))])]}}])}),a("el-table-column",{attrs:{label:"ĐƠN VỊ KINH DOANH",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.transactionOfficeName))])]}}])}),a("el-table-column",{staticClass:"checkLength",attrs:{label:"MÃ NVTV",width:"110",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"cell-two-line"},[a("p",{staticClass:"checkLength"},[t._v(t._s(e.row.salesMemberNo))])])]}}])}),a("el-table-column",{staticClass:"checkLength",attrs:{label:"NV TƯ VẤN",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"cell-two-line"},[a("p",{staticClass:"checkLength"},[t._v(t._s(e.row.salesFullName))])])]}}])}),a("el-table-column",{key:105,staticClass:"checkLength",attrs:{label:"Mã NV đứng code",prop:"consultantMemberNo",width:"155",align:"left"}}),a("el-table-column",{key:135,staticClass:"checkLength",attrs:{label:"NV đứng code",prop:"consultantName",width:"210"}}),a("el-table-column",{key:205,staticClass:"checkLength",attrs:{label:"Mã code",prop:"consultantNo",width:"110",align:"center"}}),a("el-table-column",{attrs:{label:"SỐ CIF",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"cell-two-line"},[a("p",{staticClass:"checkLength"},[t._v(t._s(e.row.customerCifCode))])])]}}])}),a("el-table-column",{attrs:{label:"TÊN BMBH",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"cell-two-line"},[a("p",{staticClass:"checkLength uppercase"},[t._v(t._s(e.row.customerFullName))])])]}}])}),a("el-table-column",{attrs:{label:"MÃ SẢN PHẨM",width:"120",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"cell-two-line"},[a("p",{staticClass:"checkLength"},[t._v(t._s(e.row.productCode))])])]}}])}),a("el-table-column",{attrs:{label:"SẢN PHẨM",width:"265"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"cell-two-line"},[a("p",{staticClass:"checkLength"},[t._v(t._s(e.row.productName))])])]}}])}),a("el-table-column",{attrs:{label:"PHÍ NĂM (APE)",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.apeAmount))+" ")]}}])}),a("el-table-column",{attrs:{label:"TRẠNG THÁI",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["4"===e.row.contractStatus?a("span",{staticClass:"lapse statuss",attrs:{align:"center"}},[t._v("Mất hiệu lực")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"ĐỊA CHỈ BMBH",width:"374"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{staticClass:"checkLength"},[t._v(t._s(e.row.customerAddress))])]}}])}),a("el-table-column",{attrs:{prop:"customerMobilePhone",label:"SĐT BMBH",width:"120"}}),a("el-table-column",{staticClass:"checkLength",attrs:{label:"NGƯỜI ĐƯỢC BH",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.beneficiaryName))])]}}])}),a("el-table-column",{attrs:{prop:"paymentPeriod",label:"ĐỊNH KỲ",width:"90",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("parsePaymentPeriod")(e.row.paymentPeriod)))]}}])}),a("el-table-column",{attrs:{label:"NGÀY HIỆU LỰC",align:"center",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDateTime")(e.row.issueDate))+" ")]}}])}),a("el-table-column",{attrs:{label:"NGÀY MẤT HIỆU LỰC",align:"center",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDateTime")(e.row.expireDate))+" ")]}}])})],2)],1),a("audit-popup-filter",{on:{apply:t.handleFilter}}),a("detail-contract",{attrs:{detail:t.contractInfor}}),a("audit-popup-filter",{attrs:{type:t.$route.name},on:{apply:t.handleFilter}})],1)},i=[],s=a("f3f3"),l=a("276c"),c=a("e954"),r=a("920b"),o=a("92a6"),u=(a("ac1f"),a("841c"),a("b0c0"),a("9ab4")),d=a("1b40"),h=a("08ba"),p=a("4a7b8"),f=a("4a47e"),b=a("9f48"),y=a("4bb5"),g=a("2f46"),v=a("2ef0"),m=a("567c"),C=a("2b17"),_=Object(y["a"])("beAudit"),w=function(t){Object(r["a"])(a,t);var e=Object(o["a"])(a);function a(){var t;return Object(l["a"])(this,a),t=e.apply(this,arguments),t.loading=!1,t.data=[],t.valueSearch="",t.query={page:1,search:"",limit:20,total:0,contractStatus:4,searchType:"CONTRACT",orderByClause:""},t.contractInfor={},t.isLoading=!1,t.option=[{id:1,name:"Đơn vị kinh doanh",divided:!1},{id:6,name:"Tổng phí",divided:!0},{id:2,name:"Ngày phát hành",divided:!0},{id:3,name:"Ngày đóng phí",divided:!1},{id:4,name:"Ngày hết hạn",divided:!1},{id:5,name:"Mã sản phẩm",divided:!0}],t}return Object(c["a"])(a,[{key:"handleSearch",value:function(t){this.resetQuery(),this.query.search=t,this.init()}},{key:"init",value:function(){var t=this;this.isLoading=!0;var e=Object(s["a"])(Object(s["a"])({},this.query),{},{contractStatus:4,total:null,orderByClause:this.query.orderByClause?this.query.orderByClause:null});this.api.getData(e).then((function(e){t.data=e.data,t.isLoading=!1})).catch((function(){t.isLoading=!1})),this.api.getContractCount(e).then((function(e){t.query.total=e.data}))}},{key:"resetQuery",value:function(){this.query.page=1,this.query.limit=20}},{key:"handleSizeChange",value:function(t){this.query.limit=t,this.init()}},{key:"handleCurrentChange",value:function(t){this.query.page=t,this.init()}},{key:"handleRowClick",value:function(t){this.contractInfor=t.row,this.setOpenPopup({popupName:"contractDetail",isOpen:!0})}},{key:"handleFilter",value:function(t){var e=this;this.query=Object(s["a"])(Object(s["a"])(Object(s["a"])({},this.query),t),{},{contractStatus:4}),this.query.page=1,this.api.getData(this.query).then((function(t){e.data=t.data,e.isLoading=!1})).catch((function(){e.isLoading=!1})),this.api.getContractCount(this.query).then((function(t){e.query.total=t.data}))}},{key:"handleClickFillter",value:function(){this.setOpenPopup({popupName:"audit-filter",isOpen:!0})}},{key:"handleCommand",value:function(t){Object(v["forEach"])(this.option,(function(e){t.id===e.id?e.active=!0:e.active=!1})),this.query.orderByClause=t.id,this.init()}},{key:"indexMethod",value:function(t){return(this.query.page-1)*this.query.limit+t+1}},{key:"setParamsForUser",value:function(){var t,e,a,n;this.getDisableArea&&(this.query.areaIdArray="".concat(null===(t=this.user)||void 0===t?void 0:t.areaId),this.query.branchIdArray="".concat(null===(e=this.user)||void 0===e?void 0:e.branchId));this.getDisableTransaction&&(this.query.transOfficeIdArray="".concat(null===(a=this.user)||void 0===a?void 0:a.transactionOfficeId));this.getDisableSaleMember&&(this.query.salesMemberIdArray="".concat(null===(n=this.user)||void 0===n?void 0:n.id))}},{key:"created",value:function(){var t,e;this.api=Object(h["a"])("contract",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id});var a=this.getFilter(this.$route.name);a&&(this.query=Object(v["assign"])(this.query,a.filters)),this.init()}},{key:"handleExport",value:function(){var t="hop_dong_mat_hieu_luc";this.query.contractStatus="4",this.query.searchType="CONTRACT";var e="contractExpire";this.handleExportExcel(e,this.query,t)}}]),a}(Object(d["b"])(b["a"],g["a"],C["a"]));Object(u["a"])([_.Getter("getFilter")],w.prototype,"getFilter",void 0),w=Object(u["a"])([Object(d["a"])({components:{DetailContract:p["a"],AuditPopupFilter:f["a"],SearchBar:m["a"]}})],w);var k=w,x=k,N=(a("8c56"),a("2877")),S=Object(N["a"])(x,n,i,!1,null,"1ad85356",null);e["default"]=S.exports},"2f46":function(t,e,a){"use strict";var n=a("c964"),i=a("276c"),s=a("e954"),l=a("920b"),c=a("92a6"),r=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("99af"),a("9ab4")),o=a("08ba"),u=a("1b40"),d=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(i["a"])(this,a),t=e.apply(this,arguments),t.isExcelLoading=!1,t}return Object(s["a"])(a,[{key:"handleExportExcel",value:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,a,n){var i,s,l,c,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(a.total<1)){t.next=4;break}this.$message.error("Không tìm thấy dữ liệu xuất file"),t.next=28;break;case 4:if(!(a.total>=5e4)){t.next=8;break}this.$message.error("Số lượng bản ghi vượt quá 50000, vui lòng sử dụng bộ lọc"),t.next=28;break;case 8:return this.isExcelLoading=!0,t.prev=9,t.next=12,this.export.exportContract(e,a);case 12:i=t.sent,s=window.URL.createObjectURL(new Blob([i.data],{type:"application/octet-stream"})),l=document.createElement("a"),l.href=s,c=new Date,r="".concat(c.getFullYear()).concat(c.getMonth()+1).concat(c.getDate(),"_").concat(c.getHours()).concat(c.getMinutes()).concat(c.getMilliseconds()),l.setAttribute("download","Danh_sach_".concat(n,"_").concat(r,".xlsx")),document.body.appendChild(l),l.click(),this.isExcelLoading=!1,t.next=28;break;case 24:t.prev=24,t.t0=t["catch"](9),500===t.t0.response.status&&this.$message.error("Không tìm thấy dữ liệu xuất file"),this.isExcelLoading=!1;case 28:case"end":return t.stop()}}),t,this,[[9,24]])})));function e(e,a,n){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.export=Object(o["a"])("export",{districtId:this.districtId})}}]),a}(u["d"]);d=Object(r["a"])([u["a"]],d),e["a"]=d},8757:function(t,e,a){},"8c56":function(t,e,a){"use strict";a("8757")}}]);
//# sourceMappingURL=chunk-99f9faec.38031e95.js.map