(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dac3d5ec"],{"14b4":function(e,t,a){"use strict";a("d0d6")},1522:function(e,t,a){},"181e":function(e,t,a){"use strict";a("1522")},"20d2":function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return i}));var s=["image/png","image/jpeg","video/mp4","video/MP4V-ES","video/quicktime","video/x-flv","video/x-msvideo","video/x-ms-wmv"],i=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.presentationml.presentation"]},3549:function(e,t,a){},"35f8":function(e,t,a){"use strict";a("4230")},4230:function(e,t,a){},"48c2":function(e,t,a){},"567c":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"search flex"},[a("base-icon",{staticClass:"icon-search",attrs:{icon:"search"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.valueSearch,expression:"valueSearch"}],staticClass:"searchBar",attrs:{type:"text",placeholder:"Tìm kiếm..."},domProps:{value:e.valueSearch},on:{input:function(t){t.target.composing||(e.valueSearch=t.target.value)}}})],1)},i=[],n=a("f3f3"),o=a("276c"),l=a("e954"),c=a("920b"),r=a("92a6"),u=(a("ac1f"),a("841c"),a("b0c0"),a("9ab4")),d=a("2ef0"),p=a("1b40"),h=a("4bb5"),m=Object(h["a"])("beAudit"),f=function(e){Object(c["a"])(a,e);var t=Object(r["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.valueSearch=e.search,e.searchText=Object(d["debounce"])((function(t){e.$emit("search",Object(d["trim"])(t))}),500),e}return Object(l["a"])(a,[{key:"handleSearch",value:function(e){var t;if(e!==this.search&&this.searchText(e),null!==(t=this.$route)&&void 0!==t&&t.name){var a=this.getFilter(this.$route.name);a?this.setReportFilter({contract:this.$route.name,filters:Object(n["a"])(Object(n["a"])({},a.filters),{},{search:Object(d["trim"])(e)})}):this.setReportFilter({contract:this.$route.name,filters:{search:Object(d["trim"])(e)}})}}},{key:"checkRoute",value:function(e){this.init(e)}},{key:"init",value:function(e){var t=this.getFilter(e.name);t&&t.filters?this.valueSearch=t.filters.search:this.valueSearch=""}}]),a}(p["d"]);Object(u["a"])([m.Getter("getFilter")],f.prototype,"getFilter",void 0),Object(u["a"])([m.Action("setReportFilter")],f.prototype,"setReportFilter",void 0),Object(u["a"])([Object(p["c"])({default:"",required:!1})],f.prototype,"search",void 0),Object(u["a"])([Object(p["e"])("valueSearch",{immediate:!1})],f.prototype,"handleSearch",null),Object(u["a"])([Object(p["e"])("$route")],f.prototype,"checkRoute",null),f=Object(u["a"])([Object(p["a"])({components:{}})],f);var v=f,b=v,C=(a("61d3"),a("2877")),g=Object(C["a"])(b,s,i,!1,null,"f42d5708",null);t["a"]=g.exports},"61d3":function(e,t,a){"use strict";a("48c2")},7461:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-popup",{staticClass:"addUploadFile",attrs:{name:"add-upload-file",open:e.handleOpen,close:e.handleClose,hiddenFooter:!0,width:"520px",top:"5vh"}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._v("Thêm file tài liệu")]),a("el-upload",{staticClass:"upload body-Upload",attrs:{drag:"",":file-list":e.fileList,"on-change":e.handleChangeFile,"auto-upload":!1,"show-file-list":!1,action:"",multiple:""}},[a("div",{staticClass:"el-upload__text"},[e._v("Kéo thả file hoặc"),a("em",[e._v(" Chọn từ máy tính")])])]),e.fileList.length?a("div",{staticClass:"list-file"},e._l(e.fileList,(function(t){return a("div",{key:t.uid,staticClass:"flex jc-space-between file-item"},[a("div",{staticClass:"left"},[a("p",[e._v(e._s(t.name))])]),a("div",{staticClass:"right",on:{click:function(a){return e.handleDeleteFile(t.uid)}}},[a("base-icon",{staticClass:"icon-action cursor",attrs:{icon:"delete"}})],1)])})),0):e._e(),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex"},[a("div",{staticClass:"bt-center"},[a("el-button",{staticClass:"group-button-cencel",on:{click:e.handleClose}},[e._v("Hủy")]),e.fileList.length?a("el-button",{staticClass:"be-btn-danger group-button-save",on:{click:e.handleAddFile}},[e._v("Thêm")]):e._e()],1)])])])],2)},i=[],n=a("d0ff"),o=a("c964"),l=a("276c"),c=a("e954"),r=a("920b"),u=a("92a6"),d=(a("b0c0"),a("96cf"),a("9ab4")),p=a("9f48"),h=a("1b40"),m=a("4bb5"),f=a("08ba"),v=a("2ef0"),b=Object(m["a"])("beUser"),C=function(e){Object(r["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.fileList=[],e.dataInput={attachFiles:[]},e}return Object(c["a"])(a,[{key:"handleChangeFile",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var a,s,i,n,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=new FormData,"ready"!==t.status){e.next=16;break}return t.type=t.raw.type,this.fileList.push(t),a.append("files",t.raw),t.percentage=1,s=function(e){var a=e.loaded/e.total*100;t.percentage=a},i={},i.data=a,i.progress=s,n=t.uid,e.next=13,this.apiUpload.uploadFile(i);case 13:o=e.sent,l=Object(v["findIndex"])(this.fileList,(function(e){return e.uid===n})),this.fileList[l].url=o.success[0].url;case 16:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleDeleteFile",value:function(e){this.fileList=Object(v["filter"])(this.fileList,(function(t){return t.uid!==e}))}},{key:"handleAddFile",value:function(){var e,t,a=this;(this.fileList.length&&(this.dataInput.attachFiles=Object(n["a"])(this.fileList)),this.idUpload&&"customer"==this.$route.name||"customerNewsfeed"==this.$route.name)?null===(e=this.api)||void 0===e||e.uploadFile(this.idUpload,this.dataInput).then((function(e){a.$message.success("Upload file thành công"),a.fileList=[],a.$emit("load"),a.handleClose()})).catch((function(e){console.log(e)})):null===(t=this.api)||void 0===t||t.uploadFileDeal(this.idUploadDeal,this.dataInput).then((function(e){a.$message.success("Upload file thành công"),a.fileList=[],a.$emit("load"),a.handleClose()})).catch((function(e){console.log(e)}))}},{key:"handleOpen",value:function(){console.log("test id bên khách hàng",this.idUpload),console.log("test id dell",this.idUploadDeal),console.log("route",this.$route)}},{key:"handleClose",value:function(){this.fileList=[],this.setOpenPopup({popupName:"add-upload-file",isOpen:!1})}},{key:"created",value:function(){var e,t,a,s;this.apiUpload=Object(f["a"])("upload",{districtId:null===(e=this.user)||void 0===e||null===(t=e.districts)||void 0===t?void 0:t[0].id}),this.api=Object(f["a"])("category",{districtId:null===(a=this.user)||void 0===a||null===(s=a.districts)||void 0===s?void 0:s[0].id})}}]),a}(Object(h["b"])(p["a"]));Object(d["a"])([b.State("user")],C.prototype,"user",void 0),Object(d["a"])([Object(h["c"])()],C.prototype,"idUpload",void 0),Object(d["a"])([Object(h["c"])()],C.prototype,"idUploadDeal",void 0),C=Object(d["a"])([Object(h["a"])({components:{}})],C);var g=C,y=g,O=(a("181e"),a("2877")),k=Object(O["a"])(y,s,i,!1,null,null,null);t["a"]=k.exports},"780a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"customer-page"},[a("div",{staticClass:"audit-table"},[a("base-table",{staticClass:"table-contract custom-table",attrs:{paginationInfo:"khách hàng",data:e.data,"is-loading":e.isLoading,table:e.query,showPagination:!0,emptyText:"Không có dữ liệu khách hàng"},on:{sizeChange:e.handleSizeChange,currentChange:e.handleCurrentChange,rowClick:e.handleRowClick,filterChange:e.handleFiltersChange,selectionChange:e.handleSelection},scopedSlots:e._u([{key:"header",fn:function(t){var s=t.filters,i=t.events;return a("div",{staticClass:"be-flex align-center header"},[a("div",{staticClass:"audit-action be-flex jc-space-between w-100"},[a("div",{staticClass:"aciton-left flex"},[a("customer-filter",{attrs:{filters:s},on:{change:i}})],1),a("div",{staticClass:"action-right flex actions"},[a("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:e.listSelect.length>0,expression:"listSelect.length > 0"}],staticClass:"dro-customer",attrs:{"split-button":"",placement:"bottom-end"},on:{command:e.handleCommand}},[e._v(" Thao tác "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"delete"}},[e._v("Xóa khách hàng")]),a("el-dropdown-item",{attrs:{command:"UpdateNv"}},[e._v("Gán NV phụ trách")])],1)],1),a("el-dropdown",{staticClass:"dropdown-create",attrs:{"split-button":"",placement:"bottom-end"},on:{click:e.handleCreateCustomer}},[e._v(" Thêm mới "),a("el-dropdown-menu",{staticClass:"sort-menu-popper poper-customer",attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"","auto-upload":!1,accept:e._f("joinArray")(e.fileExcelAccept),"show-file-list":!1,"on-change":e.handleUpload}},[a("el-dropdown-item",{staticClass:"drop-template",staticStyle:{width:"106%","text-align":"left"}},[a("span",[e._v("Thêm mới từ Excel")])])],1),a("el-dropdown-item",[e._v("Tải file mẫu")])],1)],1),a("el-button",{staticClass:"custom-button",on:{click:e.getCustomerCategory}},[a("span",{staticClass:"be-inline-flex align-center"},[a("base-icon",{staticClass:"icon",attrs:{icon:"excel-fullcolor"}}),e._v(" Xuất Excel ")],1)])],1)])])}}])},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"#",width:"61",align:"center"}}),a("el-table-column",{staticClass:"fix_style-checkbox",attrs:{type:"selection",align:"center"}}),a("el-table-column",{attrs:{label:"Mã cif",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"cell-two-line"},[a("p",[e._v(e._s(t.row.customerCifCode))])])]}}])}),a("el-table-column",{attrs:{label:"họ tên","min-width":"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"row-user"},[a("span",[t.row.avatar?a("base-avatar",{staticClass:"avatar__change",attrs:{size:"small",url:t.row.avatar}}):a("base-icon",{staticClass:"avatar__imployee--defalt",attrs:{icon:"icon-avatar-default"}})],1),a("div",{domProps:{innerHTML:e._s(e.checkName(t.row))}})])]}}])}),a("el-table-column",{attrs:{width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"bottom","popper-class":"popper-action-customer"},nativeOn:{click:function(t){return e.handleConflictClick.apply(null,arguments)}}},[a("div",{staticClass:"be-flex-column content poper-text"},[a("div",{staticClass:"content-item cursor",staticStyle:{"line-height":"36px"}},[a("span",{on:{click:function(a){return e.handleEdit(t.row.id)}}},[e._v("Sửa thông tin")])]),a("div",{staticClass:"content-item cursor",staticStyle:{"line-height":"36px","border-bottom":"1px solid #dbdbdb"},on:{click:function(a){return e.Addcharge({status:"assign",id:t.row.id,data:t.row})}}},[a("span",[e._v("Gán phụ trách")])]),a("div",{staticClass:"content-item cursor",staticStyle:{"line-height":"36px"},on:{click:function(a){return e.handleOpenPopupNote(t.row)}}},[a("span",[e._v("Ghi chú")])]),a("div",{staticClass:"content-item cursor",staticStyle:{"line-height":"36px"},on:{click:function(a){return e.handleClickOpenAction(t.row.id,t.row,"fill")}}},[a("span",[e._v("Tạo lịch hẹn")])]),a("div",{staticClass:"content-item cursor",staticStyle:{"line-height":"36px"},on:{click:function(a){return e.handleOpenPopupUpload(t.row.id)}}},[a("span",[e._v("Upload tài liệu")])]),a("div",{staticClass:"content-item cursor",staticStyle:{"line-height":"36px"},on:{click:function(a){return e.Addcharge({status:"add",id:"",data:t.row})}}},[a("span",[e._v("Tạo cơ hội bán hàng")])]),a("div",{staticClass:"content-item cursor",staticStyle:{"line-height":"36px","border-top":"1px solid #dbdbdb"}},[a("span",{on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("Xóa khách hàng")])])]),a("div",{staticClass:"reference action-more",attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"el-icon-more"})])])]}}])}),a("el-table-column",{attrs:{label:"nguồn","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getRelationShip(t.row.customerChannel))+" ")]}}])}),a("el-table-column",{attrs:{prop:"leadScore",label:"điểm",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"Trạng thái",width:"180",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{attrs:{align:"left"},domProps:{innerHTML:e._s(e.checkStatus(t.row))}})]}}])}),a("el-table-column",{attrs:{label:"nv phụ trách","min-width":"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.salesFullName?a("div",{staticClass:"row-user"},[t.row.salesAvatar&&"2"!==t.row.assignStatus?a("el-avatar",{attrs:{size:"medium",src:t.row.salesAvatar}}):a("base-icon",{staticClass:"avatar__imployee--defalt",attrs:{icon:"icon-avatar-default"}}),a("div",{staticClass:"cell-two-line"},[a("p",[e._v(e._s(t.row.salesFullName))]),a("span",[e._v(e._s(t.row.salesMemberNo))])])],1):a("div",{staticClass:"row-user"},[a("div",{staticClass:"cell-two-line"},[a("p",[e._v(e._s(t.row.salesFullName))]),a("span",[e._v(e._s(t.row.salesMemberNo))])])])]}}])})],1)],1),a("create-customer",{attrs:{dataProp:e.dataPopup},on:{reset:e.resetCreateCustomer,delete:e.handleDelete}}),a("appoint-customer",{attrs:{idCustomer:this.idCustomer,dataRow:this.dataRow,checkFillCustomer:this.checkFillCustomer,checkType:this.type}}),a("popup-confirm-deal",{attrs:{dataProp:e.dataPopup},on:{confirm:e.handleConfirm}}),a("PopupDeleteGroup",{attrs:{customerFullName:e.customerFullName,customerCifCode:e.customerCifCode,listId:e.listId},on:{load:e.loadData}}),a("create-deal",{attrs:{dataProp:e.dataPopup,dataCustomer:e.dataCustomer}}),a("popup-note",{attrs:{type:e.type},on:{update:e.handleCreateNote}}),a("popup-add-upload-file",{attrs:{idUpload:e.idUpload}}),a("popup-assgin",{attrs:{listId:e.Datas},on:{confirm:e.handleReaload}})],1)},i=[],n=a("c964"),o=a("f3f3"),l=a("276c"),c=a("e954"),r=a("920b"),u=a("92a6"),d=(a("96cf"),a("b0c0"),a("d81d"),a("d3b7"),a("25f0"),a("9ab4")),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-popup",{staticClass:"flex",attrs:{name:"popup-assgin",width:"420px",open:e.handleOpen,close:e.handleClose,hiddenFooter:!0}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._v("Gán nhân viên phụ trách")]),a("div",{staticClass:"body-content"},[a("el-form",{staticClass:"form-validate-custom"},[a("el-form-item",{attrs:{label:"Nhân viên phụ trách"}},[a("el-select",{staticClass:"filter-select",attrs:{size:"large",filterable:"",remote:"",placeholder:"Chọn cán bộ nhân viên","remote-method":e.remoteMethod,clearable:""},model:{value:e.salesMemberId,callback:function(t){e.salesMemberId=t},expression:"salesMemberId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}]},e._l(e.members,(function(e){return a("el-option",{key:e.id,attrs:{label:e.memberNo+" - "+e.fullName,value:e.id}})})),1)])],1)],1)],1),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex jc-flex-end"},[a("div",{},[a("el-button",{staticClass:"be-button-unset",attrs:{size:"mini"},on:{click:e.handleCancel}},[e._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:e.handleConfirm}},[e._v("Xác nhận")])],1)])])])],2)},h=[],m=a("d0ff"),f=(a("99af"),a("ac1f"),a("841c"),a("3ca3"),a("ddb0"),a("1b40")),v=a("9f48"),b=a("c56f"),C=a("08ba"),g=function(e){Object(r["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.members=[],e.query={members:{i:0,ps:20,limit:"",page:1,search:"",statusAccount:0,groupCode:"INSURANCE",sort:1}},e.salesMemberId="",e.customerCifCodes="",e.customerIds="",e}return Object(c["a"])(a,[{key:"loadMore",value:function(){var e=this;this.query.members.i+=this.query.members.ps,this.apiEmpoly.getEmployeeList(this.query.members).then((function(t){e.members=[].concat(Object(m["a"])(e.members),Object(m["a"])(t.data))}))}},{key:"remoteMethod",value:function(e){var t=this;this.query.members.i=0,this.query.members.search=e,this.apiEmpoly.getEmployeeList(this.query.members).then((function(e){t.members=e.data}))}},{key:"handleSearch",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=t,e.next="members"===e.t0?3:6;break;case 3:return e.next=5,this.apiEmpoly.getEmployeeList(this.query.members).then((function(e){var t,s,i;a.members=e.data,console.log(null===(t=a.dataProp)||void 0===t?void 0:t.data.salesMemberId);var n,o,l,c,r,u=a.members.some((function(e){var t;return e.id==(null===(t=a.dataProp)||void 0===t?void 0:t.data.salesMemberId)}));(a.salesMemberId=null!==(s=a.dataProp)&&void 0!==s&&s.data.salesMemberId?null===(i=a.dataProp)||void 0===i?void 0:i.data.salesMemberId:"",!u&&a.salesMemberId)&&a.members.push({id:null===(n=a.dataProp)||void 0===n?void 0:n.data.salesMemberId,fullName:null!==(o=a.dataProp)&&void 0!==o&&o.data.salesFullName?null===(l=a.dataProp)||void 0===l?void 0:l.data.salesFullName:"",memberNo:null!==(c=a.dataProp)&&void 0!==c&&c.data.salesMemberNo?null===(r=a.dataProp)||void 0===r?void 0:r.data.salesMemberNo:""})}));case 5:return e.abrupt("break",9);case 6:return e.next=8,Promise.all([this.apiEmpoly.getEmployeeList(this.query.members).then((function(e){a.members=e.data}))]);case 8:return e.abrupt("break",9);case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleCancel",value:function(){this.setOpenPopup({popupName:"popup-assgin",isOpen:!1})}},{key:"handleConfirm",value:function(){var e=this,t=this.dataProp.map((function(e){return e.id})),a=this.dataProp.map((function(e){return e.customerIdNumber})),s={customerIdNumbers:a,customerIds:t,salesMemberId:this.salesMemberId};this.apiDeal.updatePersonChangeSale(s).then((function(t){e.$emit("confirm",s),e.setOpenPopup({popupName:"popup-assgin",isOpen:!1})}))}},{key:"handleOpen",value:function(){this.dataProp=this.listId,this.handleSearch("members")}},{key:"handleClose",value:function(){this.query.members.search="",this.members=[],this.salesMemberId="",this.$emit("close")}},{key:"created",value:function(){this.apiEmpoly=Object(C["a"])("employee",{districtId:this.districtId}),this.apiDeal=Object(C["a"])("deal",{districtId:this.districtId})}}]),a}(Object(f["b"])(v["a"],b["a"]));Object(d["a"])([Object(f["c"])()],g.prototype,"listId",void 0),g=Object(d["a"])([Object(f["a"])({components:{}})],g);var y=g,O=y,k=(a("8833"),a("2877")),w=Object(k["a"])(O,p,h,!1,null,"87d6d8ce",null),j=w.exports,_=a("567c"),x=a("895c"),N=a("2b17"),I=a("d67a"),P=a("4bb5"),S=a("2ef0"),F=a("9f13"),$=a("c822"),M=a("be17"),U=a("0506"),D=a("1572"),L=a("222c"),E=a("7461"),R=a("20d2"),q=Object(P["a"])("beCustomer"),T=function(e){Object(r["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.isConflickClick=!1,e.isLoading=!1,e.data=[],e.query={page:1,limit:20,total:0},e.fileExcelAccept=R["a"],e.pushData=[],e.Datas=[],e.customerFullName="",e.imageUrl="",e.isUpload=!1,e.customerCifCode="",e.dataRow={},e.dataPopup={title:"",code:"",id:"",data:{}},e.dataCustomer={id:"",customerFullName:"",customerCifCode:""},e.filters={},e.type="add",e.customerId=0,e.listTest=[],e.checkShow=!1,e.listSelect=[],e.listId=[],e.debounceFilter=Object(S["debounce"])((function(){e.init()}),600),e.idCustomer="",e.checkFillCustomer="",e.idUpload="",e}return Object(c["a"])(a,[{key:"handleUpload",value:function(e){var t=this,a=this.$message({message:"Đang tải file lên",type:"success",duration:0});this.$message.close();var s=new FormData;"ready"===e.status&&(s.append("file",e.raw),s.append("name",e.name),this.apiCustomer.importExcelCustomer(s).then((function(){a.close(),t.$message.success("Tải lên thành công"),t.init()})).catch((function(e){a.close(),429===e.errorCode?t.$message.error("Không upload được file khi hệ thống đang cập nhật dữ liệu. Vui lòng thử lại sau ít phút"):t.$message.error(e.message)})))}},{key:"loadData",value:function(){this.init()}},{key:"indexMethod",value:function(e){return(this.query.page-1)*this.query.limit+e+1}},{key:"handleSelection",value:function(e){this.pushData=e,this.listSelect=e.map((function(e){return e.customerIdNumber})),this.checkShow=this.listSelect.length>0}},{key:"handleCommand",value:function(e){"delete"===e&&(this.listId=this.listSelect,this.setOpenPopup({popupName:"delete-group",isOpen:!0})),"UpdateNv"==e&&(this.Datas=this.pushData,this.setOpenPopup({popupName:"popup-assgin",isOpen:!0}))}},{key:"init",value:function(){var e=this;this.isLoading=!0;var t=Object(o["a"])(Object(o["a"])(Object(o["a"])({},this.query),this.filters),{},{total:null});this.apiCustomer.getDataCustomer("customers",t).then((function(t){e.data=t.content,e.query.total=t.totalElements,e.isLoading=!1})).catch((function(){e.isLoading=!1}))}},{key:"resetCreateCustomer",value:function(){this.init()}},{key:"handleReaload",value:function(){this.init()}},{key:"handleFiltersChange",value:function(e){this.query.page=1,this.query.limit=20,this.filters=Object(o["a"])(Object(o["a"])({},this.filters),e),this.debounceFilter()}},{key:"handleConfirm",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("delete"!=this.dataPopup.code){e.next=6;break}if(!this.dataPopup.id||0==this.dataPopup.id){e.next=4;break}return e.next=4,this.apiCustomer.deleteDealOrCusById("sales-deals",Object(S["trim"])(this.dataPopup.id.toString())).then((function(){a.$message.success("Xóa thành công"),a.setOpenPopup({popupName:"popup-confirm-deal",isOpen:!1}),a.init()})).catch((function(e){return a.$message.error(e.message)}));case 4:e.next=8;break;case 6:return e.next=8,this.apiCustomer.updatePersonChangeSale(t).then((function(){a.$message.success("Gán thành công"),a.setOpenPopup({popupName:"popup-confirm-deal",isOpen:!1}),a.init()})).catch((function(e){return a.$message.error(e.message)}));case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"Addcharge",value:function(e){var t=e.status,a=e.id;this.dataPopup.code=t,this.dataPopup.id=a,"assign"!=t&&"delete"!=t||(this.dataPopup.title="assign"==t?"Gán Nhân viên phụ trách":"Xác nhận xóa",this.dataPopup.data=null===e||void 0===e?void 0:e.data,this.setOpenPopup({popupName:"popup-confirm-deal",isOpen:!0})),"add"!=t&&"edit"!=t||(this.dataPopup.title="add"==t?"Thêm mới cơ hội bán hàng":"Sửa thông tin cơ hội bán hàng",this.dataCustomer.id=e.data.id,this.dataCustomer.customerFullName=e.data.customerFullName,this.dataCustomer.customerCifCode=e.data.customerCifCode,this.setOpenPopup({popupName:"create-deal",isOpen:!0}))}},{key:"handleEdit",value:function(e){this.dataPopup.code="edit",this.dataPopup.id=e,this.dataPopup.title="Chỉnh sửa khách hàng tiềm năng",this.setOpenPopup({popupName:"create-customer",isOpen:!0})}},{key:"handleDelete",value:function(e){this.customerFullName=e.customerFullName,this.customerCifCode=e.customerIdNumber,this.setOpenPopup({popupName:"delete-group",isOpen:!0})}},{key:"resetQuery",value:function(){this.query.page=1,this.query.limit=20}},{key:"handleSizeChange",value:function(e){this.query.limit=e,this.init()}},{key:"handleCurrentChange",value:function(e){this.query.page=e,this.init()}},{key:"checkName",value:function(e){var t="";return t="1"==e.customerType?e.customerFirstName+" "+e.customerLastName:e.customerFullName,t+"</span>"}},{key:"checkStatus",value:function(e){var t="";return"1"==e.customerStateId?t="Tiềm năng":"2"==e.customerStateId?t="Đang làm việc":"3"==e.customerStateId?t="Đã ký hợp đồng":"4"==e.customerStateId?t="Đã kết thúc":"5"==e.customerStateId?t="Spam":"6"==e.customerStateId&&(t="Dupilcated"),t+"</span>"}},{key:"getRelationShip",value:function(e){return F["CUSTOMER_CHANEL"][e]}},{key:"handleConflictClick",value:function(){this.isConflickClick=!0}},{key:"handleCreateCustomer",value:function(){this.dataPopup.code="add",this.setOpenPopup({popupName:"create-customer",isOpen:!0})}},{key:"handleClickOpenAction",value:function(e,t,a){this.idCustomer=e,this.dataRow=t,this.checkFillCustomer=a,this.setOpenPopup({popupName:"appoint-customer",isOpen:!0})}},{key:"handleRowClick",value:function(e){this.isConflickClick?this.isConflickClick=!1:this.$router.push({name:"customerNewsfeed",params:{type:this.$route.params.type,view:"bang-tin",id:e.row.id}})}},{key:"handleOpenPopupUpload",value:function(e){this.idUpload=e,this.setOpenPopup({popupName:"add-upload-file",isOpen:!0})}},{key:"handleCreateNote",value:function(e){var t=this,a="CUSTOMER";this.apiCustomer.createNote(a,{description:e.content,customerId:this.customerId}).then((function(){t.$message.success("Tạo ghi chú thành công"),t.init()}))}},{key:"handleOpenPopupNote",value:function(e){this.customerId=e.id,this.setOpenPopup({popupName:"popup-note",isOpen:!0})}},{key:"created",value:function(){var e,t;this.apiCustomer=Object(C["a"])("deal",{districtId:null===(e=this.user)||void 0===e||null===(t=e.districts)||void 0===t?void 0:t[0].id}),this.init()}}]),a}(Object(f["b"])(v["a"],N["a"]));Object(d["a"])([q.Action("setDetailIdCustomer")],T.prototype,"setDetailIdCustomer",void 0),T=Object(d["a"])([Object(f["a"])({components:{SearchBar:_["a"],CreateCustomer:x["a"],AppointCustomer:I["a"],CustomerFilter:U["a"],PopupConfirmDeal:D["a"],PopupDeleteGroup:$["a"],CreateDeal:M["a"],PopupNote:L["a"],PopupAddUploadFile:E["a"],PopupAssgin:j}})],T);var A=T,G=A,X=(a("35f8"),Object(k["a"])(G,s,i,!1,null,"63c689ca",null));t["default"]=X.exports},8833:function(e,t,a){"use strict";a("3549")},c822:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-popup",{staticClass:"deleteGroup",attrs:{name:"delete-group",hiddenFooter:!0,width:"400px",closeClickModal:!1,"max-height:75vh":"",open:e.handleOpen,close:e.handleClose,top:"30vh"}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._v("Xóa khách hàng")]),a("div",{staticClass:"body-content"},[0==this.listId.length?a("div",[a("a",[e._v("Bạn có muốn xóa khách hàng '")]),e._v(e._s(this.customerFullName)+"' không?")]):a("div",[a("a",[e._v("Bạn có muốn xóa")]),e._v(" "+e._s(this.listId.length)+" khách hàng đã chọn không?")])]),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex"},[a("div",{staticClass:"bt-center"},[a("el-button",{staticClass:"group-button-cencel",on:{click:e.handleClose}},[e._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger group-button-save",on:{click:e.handleSave}},[e._v("Xác nhận")])],1)])])])],2)},i=[],n=a("276c"),o=a("e954"),l=a("920b"),c=a("92a6"),r=a("9ab4"),u=a("1b40"),d=a("4bb5"),p=a("9f48"),h=a("08ba"),m=Object(d["a"])("beUser"),f=function(e){Object(l["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;return Object(n["a"])(this,a),e=t.apply(this,arguments),e.dataInput={customerIdNumbers:[]},e}return Object(o["a"])(a,[{key:"handleClose",value:function(){this.customerFullName="",this.dataInput.customerIdNumbers=[],this.setOpenPopup({popupName:"delete-group",isOpen:!1})}},{key:"handleOpen",value:function(){console.log("name",this.customerFullName),console.log("code",this.customerCifCode),console.log("list2",this.listId),0==this.listId.length?(console.log("k vao"),this.dataInput.customerIdNumbers.push(this.customerCifCode)):this.dataInput.customerIdNumbers=this.listId,console.log("input",this.dataInput)}},{key:"handleSave",value:function(){var e,t=this;null===(e=this.api)||void 0===e||e.deleteCustomer(this.dataInput).then((function(){t.$message.success("Xóa khách hàng thành công"),t.$emit("load"),t.handleClose()})).catch((function(e){t.$message.error(e.message)}))}},{key:"created",value:function(){var e,t;this.api=Object(h["a"])("category",{districtId:null===(e=this.user)||void 0===e||null===(t=e.districts)||void 0===t?void 0:t[0].id})}}]),a}(Object(u["b"])(p["a"]));Object(r["a"])([m.State("user")],f.prototype,"user",void 0),Object(r["a"])([Object(u["c"])()],f.prototype,"customerFullName",void 0),Object(r["a"])([Object(u["c"])()],f.prototype,"customerCifCode",void 0),Object(r["a"])([Object(u["c"])()],f.prototype,"listId",void 0),f=Object(r["a"])([Object(u["a"])({components:{}})],f);var v=f,b=v,C=(a("14b4"),a("2877")),g=Object(C["a"])(b,s,i,!1,null,null,null);t["a"]=g.exports},d0d6:function(e,t,a){}}]);
//# sourceMappingURL=chunk-dac3d5ec.dfada7bc.js.map