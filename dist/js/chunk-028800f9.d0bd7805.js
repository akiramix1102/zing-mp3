(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-028800f9"],{"03a0":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"flex",attrs:{name:"popupDeleteContract",width:"420px",open:t.handleOpen,hiddenFooter:!0}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.data&&t.data.title?t.data.title:""))]),a("div",{staticClass:"body-content"},[t._v(" Bạn có chắc chắn muốn xóa thu phí "),a("br"),a("b",[t._v(t._s(t.data&&t.data.message?t.data.message:""))]),t._v("? ")]),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex jc-flex-end"},[a("div",{},[a("el-button",{staticClass:"be-button-unset",attrs:{size:"mini"},on:{click:t.handleCancel}},[t._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:t.handleConfirm}},[t._v("Xác nhận")])],1)])])])],2)},i=[],c=a("276c"),s=a("e954"),o=a("920b"),r=a("92a6"),l=a("9ab4"),u=a("1b40"),d=a("9f48"),p=a("c56f"),h=function(t){Object(o["a"])(a,t);var e=Object(r["a"])(a);function a(){return Object(c["a"])(this,a),e.apply(this,arguments)}return Object(s["a"])(a,[{key:"handleCancel",value:function(){this.setOpenPopup({popupName:"popupDeleteContract",isOpen:!1})}},{key:"handleConfirm",value:function(){this.$emit("delete"),this.setOpenPopup({popupName:"popupDeleteContract",isOpen:!1})}},{key:"handleOpen",value:function(){console.log("open")}},{key:"handleClose",value:function(){console.log("close")}}]),a}(Object(u["b"])(d["a"],p["a"]));Object(l["a"])([Object(u["c"])()],h.prototype,"data",void 0),h=Object(l["a"])([Object(u["a"])({components:{}})],h);var b=h,f=b,v=(a("2267"),a("2877")),m=Object(v["a"])(f,n,i,!1,null,"1eea04f4",null);e["a"]=m.exports},2267:function(t,e,a){"use strict";a("a7ba")},"2f46":function(t,e,a){"use strict";var n=a("c964"),i=a("276c"),c=a("e954"),s=a("920b"),o=a("92a6"),r=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("99af"),a("9ab4")),l=a("08ba"),u=a("1b40"),d=function(t){Object(s["a"])(a,t);var e=Object(o["a"])(a);function a(){var t;return Object(i["a"])(this,a),t=e.apply(this,arguments),t.isExcelLoading=!1,t}return Object(c["a"])(a,[{key:"handleExportExcel",value:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,a,n){var i,c,s,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(a.total<1)){t.next=4;break}this.$message.error("Không tìm thấy dữ liệu xuất file"),t.next=28;break;case 4:if(!(a.total>=5e4)){t.next=8;break}this.$message.error("Số lượng bản ghi vượt quá 50000, vui lòng sử dụng bộ lọc"),t.next=28;break;case 8:return this.isExcelLoading=!0,t.prev=9,t.next=12,this.export.exportContract(e,a);case 12:i=t.sent,c=window.URL.createObjectURL(new Blob([i.data],{type:"application/octet-stream"})),s=document.createElement("a"),s.href=c,o=new Date,r="".concat(o.getFullYear()).concat(o.getMonth()+1).concat(o.getDate(),"_").concat(o.getHours()).concat(o.getMinutes()).concat(o.getMilliseconds()),s.setAttribute("download","Danh_sach_".concat(n,"_").concat(r,".xlsx")),document.body.appendChild(s),s.click(),this.isExcelLoading=!1,t.next=28;break;case 24:t.prev=24,t.t0=t["catch"](9),500===t.t0.response.status&&this.$message.error("Không tìm thấy dữ liệu xuất file"),this.isExcelLoading=!1;case 28:case"end":return t.stop()}}),t,this,[[9,24]])})));function e(e,a,n){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.export=Object(l["a"])("export",{districtId:this.districtId})}}]),a}(u["d"]);d=Object(r["a"])([u["a"]],d),e["a"]=d},"4cc5":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrap-payment"},[a("div",{staticClass:"table-payment"},[a("base-table",{staticClass:"custom-table table-oppotunity-sale",attrs:{data:t.data,"is-loading":t.isLoading,table:t.query,showPagination:!0,paginationInfo:"cơ hội"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,rowClick:t.handleRowClick}},[a("template",{slot:"header"},[a("div",{staticClass:"pament-action be-flex jc-space-between"},[a("div",{staticClass:"aciton-left flex"},[a("search-bar",{attrs:{search:t.query.search},on:{search:t.handleSearch}}),a("button",{staticClass:"filter1 sortText be-button-unset",staticStyle:{"margin-right":"20px","margin-left":"20px"},attrs:{slot:"reference"},on:{click:t.handleClickFillter},slot:"reference"},[a("base-icon",{attrs:{icon:"filter"}}),t._v(" Bộ lọc ")],1),a("el-dropdown",{staticClass:"import-sort",attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("el-button",{staticClass:"be-button-unset custom-button"},[a("base-icon",{staticClass:"icon",attrs:{icon:"sort"}}),t._v(" Sắp xếp ")],1),a("el-dropdown-menu",{staticClass:"sort-menu-popper",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.option,(function(e){return a("el-dropdown-item",{key:e.id,class:e.active?"active":null,attrs:{command:e,divided:e.divided}},[a("span",{staticClass:"be-flex"},[a("span",{staticClass:"be-flex-item"},[t._v(" "+t._s(e.name)+" ")])])])})),1)],1)],1),a("div",{staticClass:"action-right flex actions"},[a("div",{staticClass:"actions"},[a("el-button",{staticClass:"be-btn-danger btn-add",on:{click:t.handleCreateCost}},[t._v(" Thêm mới ")])],1)])])]),a("el-table-column",{attrs:{label:"#",type:"index",align:"center"}}),a("el-table-column",{attrs:{label:"SỐ HSYCBH",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.applyFormNo))])]}}])}),a("el-table-column",{attrs:{prop:"contractNo",label:"SỐ HĐ",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.contractNo))])]}}])}),a("el-table-column",{attrs:{label:"SẢN PHẨM",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"cell-two-line"},[a("p",{staticClass:"checkLength"},[t._v(t._s(e.row.productName))])]),a("div",{staticClass:"cell-two-line"},[a("p",{staticClass:"checkLength style-product-code"},[t._v(t._s(e.row.productCode))])])]}}])}),a("el-table-column",{attrs:{label:"TRẠNG THÁI",width:"110",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{align:"left"},domProps:{innerHTML:t._s(t.checkStatus(e.row))}})]}}])}),a("el-table-column",{attrs:{label:"NGÀY PS",align:"center",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDateTime")(e.row.lastPayDate))+" ")]}}])}),a("el-table-column",{attrs:{label:"TỔNG PHÍ",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.totalAmount))+" ")]}}])})],2),a("audit-popup-filter",{attrs:{type:t.$route.name},on:{apply:t.handleFilter}}),a("create-cost",{attrs:{dataProp:t.dataEdit},on:{payment:t.init,reload:t.init,apply:t.init}}),a("detail-contract",{attrs:{dataEdit:t.dataEdit,detail:t.contractInfor,dataPopupconfirm:t.dataPopupconfirm},on:{reset:t.resetSelectContract,openDestroy:t.handleClickOpenAction}}),a("action-contract",{attrs:{status:t.isCheckClick,action:t.contractAction,select:t.dataSelect},on:{reset:t.resetSelectContract}})],1)])},i=[],c=a("f3f3"),s=a("276c"),o=a("e954"),r=a("920b"),l=a("92a6"),u=(a("b0c0"),a("ac1f"),a("841c"),a("9ab4")),d=a("1b40"),p=a("4bb5"),h=a("08ba"),b=a("2ef0"),f=a("9f48"),v=a("567c"),m=a("2f46"),y=a("2b17"),C=a("4a47e"),g=a("4f98"),k=a("4a7b8"),O=a("f719"),w=a("03a0"),_=Object(p["a"])("beAudit"),x=Object(p["a"])("beCustomer"),j=function(t){Object(r["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.data=[],t.isLoading=!0,t.isConflickClick=!1,t.query={page:1,search:"",limit:20,total:0,contractStatus:"",searchType:"CONTRACT",customerId:""},t.dataEdit={title:"",code:"",type:"",bankContractNo:""},t.contractInfor={},t.option=[{id:1,name:"Đơn vị kinh doanh",divided:!1},{id:6,name:"Tổng phí",divided:!0},{id:2,name:"Ngày phát hành",divided:!0},{id:3,name:"Ngày đóng phí",divided:!1},{id:4,name:"Ngày hết hạn",divided:!1},{id:5,name:"Mã sản phẩm",divided:!0}],t.responses=[],t}return Object(o["a"])(a,[{key:"handleCommand",value:function(t){Object(b["forEach"])(this.option,(function(e){t.id===e.id?e.active=!0:e.active=!1})),this.query.orderByClause=t.id,this.init()}},{key:"checkTypeContract",value:function(t){switch(t){case"new":this.query.contractStatus=1;break;case"cancel":this.query.contractStatus=2;break;case"renew":this.query.contractStatus=3;break;default:this.query.contractStatus=null;break}}},{key:"init",value:function(){var t,e=this;this.isLoading=!0,this.checkTypeContract(null===(t=this.$route)||void 0===t?void 0:t.name);var a=Object(c["a"])(Object(c["a"])({},this.query),{},{total:null,orderByClause:this.query.orderByClause?this.query.orderByClause:null});this.api.getData(a).then((function(t){e.data=t.data,e.isLoading=!1})).catch((function(){e.isLoading=!1})),this.api.getContractCount(a).then((function(t){e.query.total=t.data}))}},{key:"handleFilter",value:function(t){var e=this,a=this.$route.name;a&&(this.query=Object(c["a"])(Object(c["a"])(Object(c["a"])({},this.query),t),{},{contractStatus:this.checkDataRoute(a)}),this.query.page=1,this.api.getData(this.query).then((function(t){e.data=t.data,e.isLoading=!1})).catch((function(){e.isLoading=!1})),this.api.getContractCount(this.query).then((function(t){e.query.total=t.data})))}},{key:"checkDataRoute",value:function(t){return"new"===t?1:"cancel"===t?2:"renew"===t?3:"lapse"===t?4:"contract"===t?"":"pending"===t?3:"refuse"===t?4:void 0}},{key:"handleSearch",value:function(t){this.query.search=t,this.resetQuery(),this.init()}},{key:"resetQuery",value:function(){this.query.page=1,this.query.limit=20}},{key:"handleCurrentChange",value:function(t){this.query.page=t,this.init()}},{key:"handleSizeChange",value:function(t){this.query.limit=t,this.init()}},{key:"checkStatus",value:function(t){var e="",a="";if("1"===t.contractStatus)switch(t.expireStatus){case"1":e="Mới",a="effective";break;case"2":e="Hủy",a="cancel";break;default:e="Mới",a="effective";break}else"2"===t.contractStatus?(e="Hủy",a="cancel"):"3"===t.contractStatus?(e="Tái tục",a="effective"):"4"===t.contractStatus&&(e="Mất hiệu lực",a="lapse");return'<span class="'+a+' statuss">'+e+"</span>"}},{key:"handleClickFillter",value:function(){this.setOpenPopup({popupName:"audit-filter",isOpen:!0})}},{key:"handleCreateCost",value:function(){this.dataEdit.type="khach-hang",this.dataEdit.title="Thêm mới thu phí",this.dataEdit.code="",this.setOpenPopup({popupName:"create-cost",isOpen:!0})}},{key:"created",value:function(){var t,e;this.api=Object(h["a"])("contract",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.query.customerId=this.detailCustomer.id,this.init()}},{key:"handleRowClick",value:function(t){this.isConflickClick?this.isConflickClick=!1:(this.contractInfor=t.row,this.setOpenPopup({popupName:"contractDetail",isOpen:!0}))}}]),a}(Object(d["b"])(f["a"],m["a"],y["a"]));Object(u["a"])([_.Getter("getFilter")],j.prototype,"getFilter",void 0),Object(u["a"])([x.State("detailCustomer")],j.prototype,"detailCustomer",void 0),j=Object(u["a"])([Object(d["a"])({components:{PopupMixin:f["a"],SearchBar:v["a"],AuditPopupFilter:C["a"],CreateCost:g["a"],DetailContract:k["a"],ActionContract:O["a"],DeleteContract:w["a"]}})],j);var S=j,q=S,N=(a("953b5"),a("2877")),E=Object(N["a"])(q,n,i,!1,null,"e6c84bea",null);e["default"]=E.exports},"7c53":function(t,e,a){},"953b5":function(t,e,a){"use strict";a("7c53")},a7ba:function(t,e,a){}}]);
//# sourceMappingURL=chunk-028800f9.d0bd7805.js.map