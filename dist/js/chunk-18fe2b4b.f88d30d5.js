(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18fe2b4b"],{"0a19":function(t,e,a){},"0a73":function(t,e,a){"use strict";a("b41e")},"0ccb":function(t,e,a){var s=a("50c4"),r=a("1148"),i=a("1d80"),n=Math.ceil,o=function(t){return function(e,a,o){var c,l,u=String(i(e)),d=u.length,m=void 0===o?" ":String(o),p=s(a);return p<=d||""==m?u:(c=p-d,l=r.call(m,n(c/m.length)),l.length>c&&(l=l.slice(0,c)),t?u+l:l+u)}};t.exports={start:o(!1),end:o(!0)}},"19f1":function(t,e,a){},"48c2":function(t,e,a){},"4a22":function(t,e,a){},"4a7b8":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"popup-contract",attrs:{name:"contractDetail",open:t.handleOpen,close:t.handleClose,width:"1000px"}},[a("div",{staticClass:"be-flex",attrs:{slot:"title"},slot:"title"},[a("p",[t._v("Chi tiết Hợp đồng")]),a("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:t.showAction,expression:"showAction"}],staticClass:"actionn",attrs:{size:"medium",trigger:"click"},on:{command:t.handleClickActionDetail}},[a("span",{staticClass:"subIcon",staticStyle:{"margin-left":"790px"}},[a("base-icon",{staticClass:"icon2",attrs:{icon:"action2"}})],1),a("el-dropdown-menu",{staticClass:"actionDetail actionT dropdown-detail-contract",attrs:{slot:"dropdown"},slot:"dropdown"},["1"!==t.contract.auditStatus&&"8"!==t.contract.auditStatus||!t.checkSaleMember?t._e():a("el-dropdown-item",{attrs:{command:"edit"}},[a("div",[t._v("Chỉnh sửa HĐ")])]),t.disableCancelContract?a("el-dropdown-item",{attrs:{command:"destroy"}},[a("div",[t._v("Hủy HĐ")])]):t._e(),t.disableChangeConsultant?a("el-dropdown-item",{attrs:{command:"change-staff-code"}},[a("div",[t._v("Yêu cầu đổi NV đứng code")])]):t._e(),t.disable?t._e():a("el-dropdown-item",{staticStyle:{"border-top":"1px solid #dbdbdb"},attrs:{command:"issue"}},[a("div",[t._v("Cập nhật ngày phát hành HĐ")])]),t.disable?t._e():a("el-dropdown-item",{attrs:{command:"date"}},[t._v("Cập nhật ngày bàn giao HĐ")]),a("el-dropdown-item",{attrs:{command:"history"}},[a("div",[t._v("Lịch sử chỉnh sửa")])])],1)],1),a("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:t.showActionAudit,expression:"showActionAudit"}],staticClass:"actionn",attrs:{size:"medium",trigger:"click"},on:{command:t.handleClickActionDetail}},[a("span",{staticClass:"subIcon",staticStyle:{"margin-left":"790px"}},[a("base-icon",{staticClass:"icon2",attrs:{icon:"action2"}})],1),a("el-dropdown-menu",{staticClass:"actionDetail actionT dropdown-detail-contract",attrs:{slot:"dropdown"},slot:"dropdown"},[t.disableChangeConsultant?a("el-dropdown-item",{attrs:{command:"change-staff-code"}},[a("div",[t._v("Yêu cầu đổi NV đứng code")])]):t._e(),a("el-dropdown-item",{attrs:{command:"history"}},[a("div",[t._v("Lịch sử chỉnh sửa")])])],1)],1)],1),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[a("div",{staticClass:"title"},[t._v("Thông tin chung "),a("i",{staticClass:"el-icon-caret-bottom"})]),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Số hợp đồng ")]),null!=t.contract.contractNo?a("p",{staticClass:"info"},[t._v(t._s(t.contract.contractNo))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Ngày PH ")]),null!=t.contract.issueDate?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatDateTime")(t.contract.issueDate)))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Số HSYCBH ")]),null!=t.contract.applyFormNo?a("p",{staticClass:"info"},[t._v(t._s(t.contract.applyFormNo))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Ngày nhận HS ")]),null!=t.contract.receiveFormDate?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatDateTime")(t.contract.receiveFormDate)))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Phân loại KH")]),null!=t.contract.customerType?a("p",{staticClass:"info"},[t._v(t._s(t.getRelationShip(t.contract.customerType)))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Ngày bàn giao HĐ ")]),null!=t.contract.handOverDate?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatDateTime")(t.contract.handOverDate)))]):a("p",{staticClass:"info"})])],1)],1)]),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[a("div",{staticClass:"title"},[t._v("Thông tin khách hàng "),a("i",{staticClass:"el-icon-caret-bottom"})]),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Số CIF ")]),null!=t.contract.customerCifCode?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.customerCifCode))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Tên Khách hàng ")]),null!=t.contract.customerFullName?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.customerFullName))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("CMND ")]),null!=t.contract.customerIdNumber?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.customerIdNumber))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Địa chỉ ")]),null!=t.contract.customerAddress?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.customerAddress))]):a("p",{staticClass:"info"})])],1)],1)]),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[a("div",{staticClass:"title"},[t._v("Thông tin bên mua bảo hiểm "),a("i",{staticClass:"el-icon-caret-bottom"})]),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" "+t._s(t.contract.bmbhCifCode?"Số CIF":"CMND")+" ")]),t.contract.bmbhCifCode?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.bmbhCifCode))]):a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.bmbhIdNumber?t.contract.bmbhIdNumber:""))])]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Tên Bên mua bảo hiểm ")]),null!=t.contract.bmbhFullName?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.bmbhFullName))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"be-flex row"},[a("el-col",{staticClass:"be-flex-item",attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(t._s(t.contract.bmbhCifCode?"CMND":"")+" ")]),t.contract.bmbhIdNumber&&t.contract.bmbhCifCode?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.bmbhIdNumber))]):a("p",{staticClass:"info"})]),a("el-col",{staticClass:"be-flex-item",attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Địa chỉ ")]),null!=t.contract.bmbhAddress?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.bmbhAddress))]):a("p",{staticClass:"info"})])],1)],1)]),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[a("div",{staticClass:"title"},[t._v("Thông tin ngân hàng "),a("i",{staticClass:"el-icon-caret-bottom"})]),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Nhân viên đứng code ")]),a("div",{staticClass:"be-flex"},[t.contract.consultantNo&&null!=t.contract.consultantName?a("p",{staticClass:"info"},[t._v(t._s(t.contract.consultantNo+" - "+t.contract.consultantName))]):a("p",{staticClass:"info"})])]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Đơn vị kinh doanh ")]),t.contract.transactionOfficeCode&&null!=t.contract.transactionOfficeName?a("p",{staticClass:"info"},[t._v(" "+t._s(t.contract.transactionOfficeCode+" - "+t.contract.transactionOfficeName)+" ")]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Nhân viên tư vấn")]),a("div",{staticClass:"be-flex"},[t.contract.salesMemberNo&&null!=t.contract.salesFullName?a("p",{staticClass:"info"},[t._v(t._s(t.contract.salesMemberNo+" - "+t.contract.salesFullName))]):a("p",{staticClass:"info"})])]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Chi nhánh ")]),t.contract.branchCode&&null!=t.contract.branchName?a("p",{staticClass:"info"},[t._v(t._s(t.contract.branchCode+" - "+t.contract.branchName))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Nhân viên giới thiệu")]),a("div",{staticClass:"be-flex"},[t.contract.refMemberNo&&null!=t.contract.refFullName?a("p",{staticClass:"info"},[t._v(t._s(t.contract.refMemberNo+" - "+t.contract.refFullName))]):a("p",{staticClass:"info"})])]),a("el-col",{attrs:{span:12}})],1)],1)]),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[a("div",{staticClass:"title"},[t._v("Thông tin phí phát sinh "),a("i",{staticClass:"el-icon-caret-bottom"})]),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Phí CB (TP) ")]),null!=t.contract.basicAmount?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatNumber")(t.contract.basicAmount)))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Ngày phí phát sinh ")]),null!=t.contract.lastPayDate?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatDateTime")(t.contract.lastPayDate)))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Phí đóng thêm (EP)")]),null!=t.contract.extraAmount?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatNumber")(t.contract.extraAmount)))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Ngày hết hạn HĐ ")]),null!=t.contract.expireDate?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatDateTime")(t.contract.expireDate)))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Tổng phí ")]),null!=t.contract.totalAmount?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatNumber")(t.contract.totalAmount)))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Định kỳ đóng phí ")]),null!=t.contract.paymentPeriod?a("p",{staticClass:"info"},[t._v(t._s(t.getPaymentPeriod()))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Mệnh giá ")]),null!=t.contract.faceValueAmount?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatNumber")(t.contract.faceValueAmount)))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Thời hạn HĐ ")]),null!=t.contract.numOfContractYear?a("p",{staticClass:"info"},[t._v(t._s(t.contract.numOfContractYear))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}}),a("el-col",{staticStyle:{float:"right"},attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Thời hạn đóng phí ")]),null!=t.contract.numOfFeeYear?a("p",{staticClass:"info"},[t._v(t._s(t.contract.numOfFeeYear))]):a("p",{staticClass:"info"})])],1)],1)]),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[a("div",{staticClass:"title"},[t._v("Thông tin sản phẩm "),a("i",{staticClass:"el-icon-caret-bottom"})]),t.contract&&t.contract.subContracts?a("base-table",{staticStyle:{"margin-top":"12px"},attrs:{data:t.contract.subContracts,showPagination:!1,table:t.query}},[a("el-table-column",{attrs:{type:"index",index:t.indexMethod,label:"STT",width:"60"}}),a("el-table-column",{attrs:{label:"MÃ SẢN PHẨM",align:"center",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.productCode)+" ")]}}],null,!1,1819707643)}),a("el-table-column",{attrs:{label:"TÊN SẢN PHẨM","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.product?e.row.product:e.row.productName)+" ")]}}],null,!1,2190619316)}),a("el-table-column",{staticClass:"cost",attrs:{label:"TỔNG PHÍ",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.totalAmount))+" ")]}}],null,!1,1508014122)})],1):t._e()],1)]),a("edit-history",{attrs:{contract:t.contract}}),a("change-staff-code",{attrs:{bankContractNo:t.contract.bankContractNo},on:{reset:t.handleChangeStaff}})],1)},r=[],i=a("c964"),n=a("276c"),o=a("e954"),c=a("920b"),l=a("92a6"),u=(a("96cf"),a("b0c0"),a("7db0"),a("9ab4")),d=a("08ba"),m=a("1b40"),p=a("4bb5"),h=a("f719"),f=a("9f48"),b=a("9f13"),v=a("7836"),C=a("4f98"),y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"history-popup",attrs:{name:"edit-history",width:"1200px",open:t.handleOpen,close:t.handleClose}},[a("template",{slot:"title"},[t._v("Lịch sử chỉnh sửa")]),a("el-row",{staticClass:"be-flex history-row"},[t.dataLog.length>0?a("el-col",{staticClass:"history-col-left"},t._l(t.dataLog,(function(e,s){return a("div",{key:s,class:t.logActive==s?"cursor log-item is-active":"cursor log-item",on:{click:function(e){return t.handleClickLog(s)}}},[a("h4",{staticClass:"log-item__time"},[t._v(t._s(t._f("formatDateFullTime")(e.logDate)))]),a("div",{staticClass:"flex log-item__user"},[a("span",{staticClass:"small log-item__user__name"},[t._v(t._s(e.logMemberNo)+t._s(e.logMemberNo&&e.logName?" - ":"")+t._s(e.logName))])])])})),0):a("el-col",{staticClass:"history-col-left"},[a("empty-block",{attrs:{emptyText:"Không có chỉnh sửa nào"}})],1),a("el-col",{staticClass:"history-col-right"},[Object.keys(t.dataDetail).length>0?a("detail-contract-history",{attrs:{contract:t.dataDetail}}):a("empty-block",{attrs:{emptyText:"Không có chỉnh sửa nào"}})],1)],1)],2)},g=[],I=a("f3f3"),O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"history-detail"},[a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[t._m(0),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Số hợp đồng ")]),null!=t.contract.contractNo?a("p",{staticClass:"info"},[t._v(t._s(t.contract.contractNo))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Ngày PH ")]),null!=t.contract.issueDate?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatDateTime")(t.contract.issueDate)))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Số HSYCBH ")]),null!=t.contract.applyFormNo?a("p",{staticClass:"info"},[t._v(t._s(t.contract.applyFormNo))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Ngày nhận HS ")]),null!=t.contract.receiveFormDate?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatDateTime")(t.contract.receiveFormDate)))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Phân loại KH")]),null!=t.contract.customerType?a("p",{staticClass:"info"},[t._v(t._s(t.getRelationShip(t.contract.customerType)))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Ngày bàn giao HĐ ")]),null!=t.contract.handOverDate?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatDateTime")(t.contract.handOverDate)))]):a("p",{staticClass:"info"})])],1)],1)]),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[t._m(1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Số CIF ")]),null!=t.contract.customerCifCode?a("p",{staticClass:"info"},[t._v(t._s(t.contract.customerCifCode))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Tên Khách hàng ")]),null!=t.contract.customerFullName?a("p",{staticClass:"info"},[t._v(t._s(t.contract.customerFullName))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("CMND ")]),null!=t.contract.customerIdNumber?a("p",{staticClass:"info"},[t._v(t._s(t.contract.customerIdNumber))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Địa chỉ ")]),null!=t.contract.customerAddress?a("p",{staticClass:"info"},[t._v(t._s(t.contract.customerAddress))]):a("p",{staticClass:"info"})])],1)],1)]),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[t._m(2),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" "+t._s(t.contract.bmbhCifCode?"Số CIF":"CMND")+" ")]),t.contract.bmbhCifCode?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.bmbhCifCode))]):a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.bmbhIdNumber?t.contract.bmbhIdNumber:""))])]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Tên Bên mua bảo hiểm ")]),null!=t.contract.bmbhFullName?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.bmbhFullName))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"be-flex row"},[a("el-col",{staticClass:"be-flex-item",attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(t._s(t.contract.bmbhCifCode?"CMND":"")+" ")]),t.contract.bmbhIdNumber&&t.contract.bmbhCifCode?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.bmbhIdNumber))]):a("p",{staticClass:"info"})]),a("el-col",{staticClass:"be-flex-item",attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Địa chỉ ")]),null!=t.contract.bmbhAddress?a("p",{staticClass:"info uppercase"},[t._v(t._s(t.contract.bmbhAddress))]):a("p",{staticClass:"info"})])],1)],1)]),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[t._m(3),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Nhân viên đứng code ")]),a("div",{staticClass:"be-flex"},[t.contract.consultantNo&&null!=t.contract.consultantName?a("p",{staticClass:"info"},[t._v(t._s(t.contract.consultantNo+" - "+t.contract.consultantName))]):a("p",{staticClass:"info"})])]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Đơn vị kinh doanh ")]),t.contract.transactionOfficeCode&&null!=t.contract.transactionOfficeName?a("p",{staticClass:"info"},[t._v(" "+t._s(t.contract.transactionOfficeCode+" - "+t.contract.transactionOfficeName)+" ")]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Nhân viên tư vấn")]),a("div",{staticClass:"be-flex"},[t.contract.salesMemberNo&&null!=t.contract.salesFullName?a("p",{staticClass:"info"},[t._v(t._s(t.contract.salesMemberNo+" - "+t.contract.salesFullName))]):a("p",{staticClass:"info"})])]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Chi nhánh ")]),t.contract.branchCode&&null!=t.contract.branchName?a("p",{staticClass:"info"},[t._v(t._s(t.contract.branchCode+" - "+t.contract.branchName))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Nhân viên giới thiệu")]),a("div",{staticClass:"be-flex"},[t.contract.refMemberNo&&null!=t.contract.refFullName?a("p",{staticClass:"info"},[t._v(t._s(t.contract.refMemberNo+" - "+t.contract.refFullName))]):a("p",{staticClass:"info"})])]),a("el-col",{attrs:{span:12}})],1)],1)]),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[t._m(4),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Phí CB (TP) ")]),null!=t.contract.basicAmount?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatNumber")(t.contract.basicAmount)))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Ngày phí phát sinh ")]),null!=t.contract.lastPayDate?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatDateTime")(t.contract.lastPayDate)))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Phí đóng thêm (EP)")]),null!=t.contract.extraAmount?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatNumber")(t.contract.extraAmount)))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Ngày hết hạn HĐ ")]),null!=t.contract.expireDate?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatDateTime")(t.contract.expireDate)))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Tổng phí ")]),null!=t.contract.totalAmount?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatNumber")(t.contract.totalAmount)))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Định kỳ đóng phí ")]),null!=t.contract.paymentPeriod?a("p",{staticClass:"info"},[t._v(t._s(t.contract.paymentPeriod))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Mệnh giá ")]),null!=t.contract.faceValueAmount?a("p",{staticClass:"info"},[t._v(t._s(t._f("formatNumber")(t.contract.faceValueAmount)))]):a("p",{staticClass:"info"})]),a("el-col",{attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v("Thời hạn HĐ ")]),null!=t.contract.numOfContractYear?a("p",{staticClass:"info"},[t._v(t._s(t.contract.numOfContractYear))]):a("p",{staticClass:"info"})])],1),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:12}}),a("el-col",{staticStyle:{float:"right"},attrs:{span:12}},[a("label",{staticClass:"title2"},[t._v(" Thời hạn đóng phí ")]),null!=t.contract.numOfFeeYear?a("p",{staticClass:"info"},[t._v(t._s(t.contract.numOfFeeYear))]):a("p",{staticClass:"info"})])],1)],1)]),a("div",{staticClass:"content1"},[a("div",{staticClass:"general1"},[t._m(5),t.contract&&t.contract.subContracts?a("base-table",{staticStyle:{"margin-top":"12px"},attrs:{data:t.contract.subContracts,showPagination:!1,table:t.query}},[a("el-table-column",{attrs:{type:"index",index:t.indexMethod,label:"STT",width:"60"}}),a("el-table-column",{attrs:{label:"MÃ SẢN PHẨM",align:"center",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.productCode)+" ")]}}],null,!1,1819707643)}),a("el-table-column",{attrs:{label:"TÊN SẢN PHẨM",width:"550"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.product?e.row.product:e.row.productName)+" ")]}}],null,!1,2190619316)}),a("el-table-column",{staticClass:"cost",attrs:{label:"TỔNG PHÍ",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.totalAmount))+" ")]}}],null,!1,1508014122)})],1):t._e()],1)])])},N=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[t._v("Thông tin chung "),a("i",{staticClass:"el-icon-caret-bottom"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[t._v("Thông tin khách hàng "),a("i",{staticClass:"el-icon-caret-bottom"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[t._v("Thông tin bên mua bảo hiểm "),a("i",{staticClass:"el-icon-caret-bottom"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[t._v("Thông tin ngân hàng "),a("i",{staticClass:"el-icon-caret-bottom"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[t._v("Thông tin phí phát sinh "),a("i",{staticClass:"el-icon-caret-bottom"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[t._v("Thông tin sản phẩm "),a("i",{staticClass:"el-icon-caret-bottom"})])}],_=Object(p["a"])("beUser"),k=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(n["a"])(this,a),t=e.apply(this,arguments),t.query={page:1,limit:20},t.contractAction={},t.params={},t}return Object(o["a"])(a,[{key:"handleClose",value:function(){console.log("close test popup")}},{key:"indexMethod",value:function(t){return(this.query.page-1)*this.query.limit+t+1}},{key:"getRelationShip",value:function(t){return b["RELATIONSHIP_VALUE_TO_TYPE"][t]}}]),a}(Object(m["b"])(f["a"]));Object(u["a"])([_.State("user")],k.prototype,"user",void 0),Object(u["a"])([Object(m["c"])({required:!1,type:Object,default:{}})],k.prototype,"contract",void 0),Object(u["a"])([Object(m["c"])()],k.prototype,"dataPopupconfirm",void 0),k=Object(u["a"])([Object(m["a"])({components:{PopupConfirm:v["a"],ActionContract:h["a"],CreateCost:C["a"]}})],k);var M=k,j=M,P=(a("9fc4"),a("2877")),D=Object(P["a"])(j,O,N,!1,null,"9c5728ce",null),x=D.exports,w=a("0554"),F=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(n["a"])(this,a),t=e.apply(this,arguments),t.logActive=0,t.param={page:1,limit:100},t.dataLog=[],t.dataDetail={},t}return Object(o["a"])(a,[{key:"handleClickLog",value:function(t){var e=this;this.logActive=t,this.apiContract.getPaymentLogDetail(this.dataLog[this.logActive].logNumber,{contractNo:this.contract.contractNo,applyFormNo:this.contract.applyFormNo}).then((function(t){return e.dataDetail=t.data}))}},{key:"handleBackToDetail",value:function(){this.toggleDetailHistory(!1),this.setOpenPopup({popupName:"edit-history",isOpen:!1})}},{key:"toggleDetailHistory",value:function(t){this.setOpenPopup({popupName:"contractDetailHistory",isOpen:t})}},{key:"handleOpen",value:function(){this.init()}},{key:"init",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.apiContract.getListPaymentLog(Object(I["a"])(Object(I["a"])({},this.param),{},{contractNo:this.contract.contractNo,applyFormNo:this.contract.applyFormNo})).then((function(t){return a.dataLog=t.data.content})).catch((function(t){return a.$message.error(t.message)}));case 2:null!==(e=this.dataLog[this.logActive])&&void 0!==e&&e.logNumber&&this.apiContract.getPaymentLogDetail(this.dataLog[this.logActive].logNumber,{contractNo:this.contract.contractNo,applyFormNo:this.contract.applyFormNo}).then((function(t){return a.dataDetail=t.data}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleClose",value:function(){this.dataDetail={},this.dataLog=[],this.logActive=0}},{key:"created",value:function(){this.apiContract=Object(d["a"])("contract",{districtId:this.districtId})}}]),a}(f["a"]);Object(u["a"])([Object(m["c"])({required:!1,type:Object,default:{}})],F.prototype,"contract",void 0),F=Object(u["a"])([Object(m["a"])({components:{DetailContractHistory:x,EmptyBlock:w["a"]}})],F);var T=F,A=T,S=Object(P["a"])(A,y,g,!1,null,null,null),q=S.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"flex popup-staff-code",attrs:{name:"change-staff-code",width:"464px",open:t.handleOpen,close:t.handleClose,hiddenFooter:!0}},[a("template",{slot:"title"},[t._v("Yêu cầu thay đổi NV đứng code")]),a("el-form",{staticClass:"form-validate-custom"},[a("el-form-item",{attrs:{label:"Lí do"}},[a("el-select",{attrs:{placeholder:"Chọn lý do"},model:{value:t.formData.code,callback:function(e){t.$set(t.formData,"code",e)},expression:"formData.code"}},t._l(t.listReason,(function(e){return a("el-option",{key:e.id,attrs:{label:t.getConsultType(e.key),value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"Mô tả"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"Nhập nội dung"},model:{value:t.formData.reason,callback:function(e){t.$set(t.formData,"reason",e)},expression:"formData.reason"}})],1),a("el-form-item",{attrs:{label:"Tài liệu đính kèm"}},[a("el-upload",{ref:"upload",class:t.fileList.length>0?"upload uploaded hiddendUpload":"upload uploaded",attrs:{drag:"",":file-list":t.fileList,"on-change":t.handleChangeFile,"auto-upload":!1,action:"",multiple:!1,accept:".xls, .xlsx, .doc, .pdf, .jpg, .jpeg, .png, .zip, .docx","show-file-list":!1}},[a("div",{staticClass:"el-upload__text"},[t._v("Kéo thả file hoặc"),a("em",[t._v(" Chọn từ máy tính")])])]),t.fileList.length?a("div",{staticClass:"list-file file-attach"},t._l(t.fileList,(function(e){return a("div",{key:e.uid,staticClass:"flex jc-space-between file-item"},[a("div",{staticClass:"left flex"},[t.iconFileType?a("base-icon",{staticClass:"icon",attrs:{icon:t.iconFileType}}):a("el-avatar",{attrs:{shape:"square",size:24,src:t.formData.attachmentUrl}}),a("p",[t._v(t._s(e.name))])],1),a("div",{staticClass:"right",on:{click:t.handleRemove}},[a("base-icon",{staticClass:"icon-action cursor",attrs:{icon:"delete"}})],1)])})),0):t._e()],1)],1),a("template",{slot:"footer"},[a("div",{staticClass:"bottom text-right"},[a("el-button",{staticClass:"be-button-unset",on:{click:function(e){return t.handleSubmit("reset")}}},[t._v("Huỷ")]),a("el-button",{staticClass:"be-btn-danger",on:{click:t.handleSubmit}},[t._v("Lưu ")])],1)])],2)},L=[],R=(a("caad"),a("2532"),function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(n["a"])(this,a),t=e.apply(this,arguments),t.fileList=[],t.formData={code:"",attachmentUrl:"",reason:"",status:1},t.listReason=[],t.listStatus=[],t.fileType="",t}return Object(o["a"])(a,[{key:"iconFileType",get:function(){var t="";return this.fileType.includes(".doc")&&(t="word"),this.fileType.includes(".pdf")&&(t="pdf"),this.fileType.includes(".xls")&&(t="excel-fullcolor"),this.fileType.includes(".zip")&&(t="zip"),t}},{key:"getConsultType",value:function(t){return t.includes("resign")?"NV nghỉ việc":"NV điều chuyển"}},{key:"handleRemove",value:function(){var t;null===(t=this.$refs.upload)||void 0===t||t.clearFiles(),this.fileList=[],this.formData.attachmentUrl=""}},{key:"handleChangeFile",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,s,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=new FormData,"ready"!==e.status){t.next=16;break}return e.type=e.raw.type,this.fileType=e.name,a.append("files",e.raw),e.percentage=1,s=function(t){var a=t.loaded/t.total*100;e.percentage=a},r={},r.data=a,r.progress=s,t.next=12,this.apiUpload.uploadFile(r);case 12:i=t.sent,this.fileList[0]={name:i.success[0].name,url:i.success[0].url},this.formData.attachmentUrl=i.success[0].url,this.$forceUpdate();case 16:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"handleReset",value:function(){var t;null===(t=this.$refs.upload)||void 0===t||t.clearFiles(),this.fileList=[],this.formData={code:"",attachmentUrl:"",reason:"",status:1}}},{key:"handleSubmit",value:function(t){var e=this;"reset"==t?(this.handleReset(),this.setOpenPopup({popupName:"change-staff-code",isOpen:!1})):this.apiContract.changeConsultant(this.bankContractNo,this.formData).then((function(){e.$emit("reset"),e.$message.success("Cập nhập thành công"),e.setOpenPopup({popupName:"change-staff-code",isOpen:!1})})).catch((function(t){return e.$message.error(t.mesage)}))}},{key:"handleOpen",value:function(){this.init()}},{key:"handleClose",value:function(){this.handleReset()}},{key:"init",value:function(){var t=this;this.apiParam.getChangeConsultantCode().then((function(e){t.listReason=e,t.listReason.length>0&&(t.formData.code=t.listReason[0].value)}))}},{key:"created",value:function(){this.apiUpload=Object(d["a"])("upload",{districtId:this.districtId}),this.apiContract=Object(d["a"])("contract",{districtId:this.districtId}),this.apiParam=Object(d["a"])("param",{districtId:this.districtId})}}]),a}(f["a"]));Object(u["a"])([Object(m["c"])({})],R.prototype,"bankContractNo",void 0),R=Object(u["a"])([m["a"]],R);var E=R,B=E,Y=(a("d9b0"),Object(P["a"])(B,$,L,!1,null,"6bfa3839",null)),H=Y.exports,U=a("1f2a"),V=Object(p["a"])("beUser"),K=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(n["a"])(this,a),t=e.apply(this,arguments),t.query={page:1,limit:20},t.isOpen=!1,t.showAction=!0,t.contract={},t.contractAction={},t.params={},t}return Object(o["a"])(a,[{key:"disableCancelContract",get:function(){var t=new Date,e=!1;if(this.contract.allowCancelDate){var a=new Date(this.contract.allowCancelDate);e=a>t}else e=!0;var s="contract"===this.$route.name||"audit"===this.$route.name||"cancel"!==this.$route.name;return!(!s||"2"===this.contract.contractStatus||!e)}},{key:"disable",get:function(){return"audit"===this.$route.name&&"1"===this.contract.auditStatus}},{key:"disableEditContract",get:function(){return"1"===this.contract.auditStatus||"8"===this.contract.auditStatus}},{key:"disableChangeConsultant",get:function(){return"audit"!=this.$route.name&&1!=this.contract.auditStatus&&2!=this.contract.auditStatus&&1!=this.contract.changeConsultantStatus}},{key:"showActionAudit",get:function(){return"cho-duyet"==this.$route.name||"da-khop"==this.$route.name||"yeu-cau-hieu-chinh"==this.$route.name||"da-duyet"==this.$route.name}},{key:"handleChangeStaff",value:function(){this.$emit("reset"),this.setOpenPopup({popupName:"contractDetail",isOpen:!1})}},{key:"checkBetweenDay",value:function(t){var e=864e5,a=new Date(t).getTime()+e;return(new Date).getTime()>=new Date(t).getTime()&&(new Date).getTime()<=a}},{key:"checkSaleMember",get:function(){console.log("a");var t=1===this.role.userRole.length&&this.role.userRole.find((function(t){return"TRANSACTION_OFFICE_MEMBER"===t}));return console.log("isOfficeMember",t),console.log(" this.contract.createdBy === this.user.id",this.contract.createdBy===this.user.id),console.log(" this.contract.salesMemberId !== this.user.memberId",this.contract.salesMemberId!==this.user.memberId),console.log("!this.checkBetweenDay",!this.checkBetweenDay(this.contract.createdAt)),!(t&&this.contract.createdBy===this.user.id&&this.contract.salesMemberId!==this.user.memberId&&!this.checkBetweenDay(this.contract.createdAt))}},{key:"handleOpen",value:function(){var t,e=this;this.isOpen=!0,"pending"===this.$route.name?(this.params.searchType="APPLY_FORM",this.params.contractStatus="3",this.showAction=!1):"refuse"===this.$route.name?(this.params.searchType="APPLY_FORM",this.params.contractStatus="4",this.showAction=!1):"lapse"===this.$route.name?(this.params.searchType="CONTRACT",this.params.contractStatus="4",this.showAction=!1):"new"===this.$route.name?(this.params.searchType="CONTRACT",this.params.contractStatus="1"):"cancel"===this.$route.name&&(this.params.searchType="CONTRACT",this.params.contractStatus="2"),"dang-doi-soat"!=this.$route.name&&"cho-duyet"!=this.$route.name&&"da-duyet"!=this.$route.name&&"yeu-cau-hieu-chinh"!=this.$route.name&&"da-khop"!=this.$route.name||(this.showAction=!1),this.apiContract.getDataDetail(null===(t=this.detail)||void 0===t?void 0:t.bankContractNo,this.params).then((function(t){e.contract=t})).catch((function(t){return console.log(t)}))}},{key:"resetSelectContract",value:function(){var t,e=this;this.apiContract.getDataDetail(null===(t=this.detail)||void 0===t?void 0:t.bankContractNo,this.params).then((function(t){e.contract=t})).catch((function(t){return console.log(t)})),this.$emit("reset")}},{key:"handleClose",value:function(){this.isOpen=!1,this.contract={}}},{key:"indexMethod",value:function(t){return(this.query.page-1)*this.query.limit+t+1}},{key:"handleConfirm",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=this.dataPopupconfirm.ids,t.next=3,null===(e=this.apiContract)||void 0===e?void 0:e.deleteContract({ids:a}).then((function(){s.$message({type:"success",message:"Hủy thành công"}),s.setOpenPopup({popupName:"popup-confirm",isOpen:!1}),s.$emit("reset")})).catch((function(){return s.$message({type:"warning",message:"Hủy thất bại"})}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleClickActionDetail",value:function(t){"date"===t&&this.$emit("updateDate",this.contract),"issue"===t&&this.$emit("updateIssue",this.contract),"destroy"==t&&this.$emit("openDestroy",{status:"destroy-detail",row:this.contract}),"edit"==t&&(this.dataEdit.code=t,this.dataEdit.bankContractNo=this.detail.bankContractNo,this.setOpenPopup({popupName:"create-cost",isOpen:!0})),"history"==t&&this.setOpenPopup({popupName:"edit-history",isOpen:!0}),"change-staff-code"==t&&this.setOpenPopup({popupName:"change-staff-code",isOpen:!0})}},{key:"getRelationShip",value:function(t){return b["RELATIONSHIP_VALUE_TO_TYPE"][t]}},{key:"getPaymentPeriod",value:function(){var t="";return 1==this.contract.paymentPeriod&&(t="Năm"),2==this.contract.paymentPeriod&&(t="Nửa năm"),4==this.contract.paymentPeriod&&(t="Quý"),12==this.contract.paymentPeriod&&(t="Tháng"),0==this.contract.paymentPeriod&&(t="1 lần"),t}},{key:"created",value:function(){var t,e,a=this;this.apiContract=Object(d["a"])("contract",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),U["a"].$on("reloadDetail",(function(){a.isOpen&&a.resetSelectContract()}))}},{key:"destroyed",value:function(){U["a"].$off("reloadDetail")}}]),a}(Object(m["b"])(f["a"]));Object(u["a"])([V.State("user")],K.prototype,"user",void 0),Object(u["a"])([V.State("role")],K.prototype,"role",void 0),Object(u["a"])([Object(m["c"])({required:!1,type:Object,default:{}})],K.prototype,"detail",void 0),Object(u["a"])([Object(m["c"])({required:!1,type:Object,default:function(){return{}}})],K.prototype,"dataEdit",void 0),Object(u["a"])([Object(m["c"])()],K.prototype,"dataPopupconfirm",void 0),K=Object(u["a"])([Object(m["a"])({components:{PopupConfirm:v["a"],ActionContract:h["a"],CreateCost:C["a"],EditHistory:q,ChangeStaffCode:H}})],K);var z=K,W=z,G=(a("9d58"),Object(P["a"])(W,s,r,!1,null,"11197278",null));e["a"]=G.exports},"4d90":function(t,e,a){"use strict";var s=a("23e7"),r=a("0ccb").start,i=a("9a0c");s({target:"String",proto:!0,forced:i},{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},"4f79":function(t,e,a){"use strict";a("de10")},"4f98":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"create-cost",attrs:{id:"create-cost",name:"create-cost",width:"1000px",open:t.handleOpen,hiddenFooter:!0,close:t.handleClose,closeClickModal:!1}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.dataProp.title))]),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"dataInput",staticClass:"form_customer",attrs:{model:t.dataInput,rules:t.rules}},[a("div",{staticClass:"body-content"},[a("div",{staticClass:"box-content box-content-1"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("span",{staticClass:"title-box"},[t._v(" Thông tin chung "),a("i",{staticClass:"el-icon-caret-bottom"})]),a("div",{staticClass:"content"},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"box-left"},[a("span",{staticClass:"title"},[t._v("Loại phí "),a("span",{staticClass:"required"},[t._v("*")])]),a("div",{staticClass:"check-box"},[a("el-form-item",{attrs:{prop:"feeType"}},t._l(t.typeApplyFee,(function(e){return a("el-radio",{key:e.id,staticClass:"radio-control",attrs:{label:e.value},model:{value:t.dataInput.feeType,callback:function(e){t.$set(t.dataInput,"feeType",e)},expression:"dataInput.feeType"}},[t._v(" "+t._s(e.code)+" ")])})),1)],1),a("div",{staticClass:"big-box-time"},[a("div",{staticStyle:{width:"53%"}},[a("span",{staticClass:"title"},[t._v("Ngày phí phát sinh "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"payFeeDate"}},[a("div",{staticClass:"box-time"},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",format:"dd/MM/yyyy","picker-options":t.pickerOptions,placeholder:"DD/MM/YYYY"},model:{value:t.dataInput.payFeeDate,callback:function(e){t.$set(t.dataInput,"payFeeDate",e)},expression:"dataInput.payFeeDate"}}),t.errorPayFeeDate?a("div",{staticClass:"errorHSYCB"},[t._v(" Không nhập được phí phát sinh chậm "),a("br"),t._v(" quá 1 ngày ")]):t._e()],1)])],1),a("div",[a("span",{staticClass:"title"},[t._v("Ngày phát hành")]),a("el-form-item",{attrs:{prop:"issueDate"}},[a("div",{staticClass:"box-time"},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",format:"dd/MM/yyyy","picker-options":t.pickerOptions,placeholder:"DD/MM/YYYY"},model:{value:t.dataInput.issueDate,callback:function(e){t.$set(t.dataInput,"issueDate",e)},expression:"dataInput.issueDate"}})],1)])],1)]),a("span",{staticClass:"title"},[t._v("Chương trình ưu đãi")]),a("div",{staticClass:"input-ctud"},[a("el-form-item",[a("el-select",{staticClass:"select",attrs:{remote:"","remote-method":t.remoteOffer,filterable:"","default-first-option":"",clearable:"",placeholder:"Chọn chương trình ưu đãi"},model:{value:t.dataInput.offerProgramId,callback:function(e){t.$set(t.dataInput,"offerProgramId",e)},expression:"dataInput.offerProgramId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreOffer,expression:"loadMoreOffer"}],attrs:{"infinite-scroll-delay":"500"}},t._l(t.optionsOffer,(function(e){return a("el-option",{key:e.id,attrs:{label:t.getNameOffer(e.programCode,e.programName),value:e.id}})})),1)])],1)],1)])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"box-right"},[a("span",{staticClass:"title"},[t._v("Nguồn hợp đồng "),a("span",{staticClass:"required"},[t._v("*")])]),a("div",{staticClass:"checkbox-contact"},[a("el-form-item",{attrs:{prop:"customerChannel"}},t._l(t.typeProgramSource,(function(e){return a("el-radio",{key:e.id,staticClass:"radio-control",attrs:{label:e.value},model:{value:t.dataInput.customerChannel,callback:function(e){t.$set(t.dataInput,"customerChannel",e)},expression:"dataInput.customerChannel"}},[t._v(" "+t._s(t.getNameCustomerChannel(e.code))+" ")])})),1)],1),a("span",{staticClass:"title"},[t._v("Ghi chú")]),a("el-input",{staticClass:"custom-text-area input-auto-complete",attrs:{type:"textarea",rows:"3",placeholder:"Nhập ghi chú..."},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1)])],1),a("hr"),a("div",{staticClass:"botton"},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"box-left"},[a("span",{staticClass:"title"},[t._v("Số HSYCBH "),t.rules.applyFormNo[0].required?a("span",{staticClass:"required"},[t._v("*")]):t._e()]),a("el-form-item",{attrs:{prop:"applyFormNo"}},[a("el-input",{model:{value:t.dataInput.applyFormNo,callback:function(e){t.$set(t.dataInput,"applyFormNo",e)},expression:"dataInput.applyFormNo"}}),t.validateError?a("div",{staticClass:"errorHSYCB"},[t._v("Số HSYCBH không hợp lệ")]):t._e()],1),a("span",{staticClass:"title"},[t._v("Số HĐ "),t.rules.contractNo[0].required?a("span",{staticClass:"required"},[t._v("*")]):t._e()]),a("el-form-item",{attrs:{prop:"contractNo"}},[a("el-input",{model:{value:t.dataInput.contractNo,callback:function(e){t.$set(t.dataInput,"contractNo",e)},expression:"dataInput.contractNo"}})],1)],1)]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"box-right"},[a("div",{staticClass:"fee-payment-time"},[a("div",[a("span",{staticClass:"title"},[t._v("Thời hạn đóng phí "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"numOfFeeYear"}},[a("el-input",{attrs:{type:"text"},model:{value:t.dataInput.numOfFeeYear,callback:function(e){t.$set(t.dataInput,"numOfFeeYear",e)},expression:"dataInput.numOfFeeYear"}})],1)],1),a("div",[a("span",{staticClass:"title"},[t._v("Thời hạn HĐ "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"numOfContractYear"}},[a("el-input",{model:{value:t.dataInput.numOfContractYear,callback:function(e){t.$set(t.dataInput,"numOfContractYear",e)},expression:"dataInput.numOfContractYear"}})],1)],1)]),a("div",{staticClass:"payment-period"},[a("div",[a("span",{staticClass:"title"},[t._v("Năm phí hiện tại "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"currentFeeYear"}},[a("el-input",{model:{value:t.dataInput.currentFeeYear,callback:function(e){t.$set(t.dataInput,"currentFeeYear",e)},expression:"dataInput.currentFeeYear"}}),t.errorCurrentFeeYear?a("div",{staticClass:"errorHSYCB"},[t._v("Năm phí hiện tại không hợp lệ")]):t._e()],1)],1),a("div",[a("span",{staticClass:"title"},[t._v("Định kỳ đóng phí "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"paymentPeriod"}},[a("el-select",{attrs:{placeholder:""},model:{value:t.dataInput.paymentPeriod,callback:function(e){t.$set(t.dataInput,"paymentPeriod",e)},expression:"dataInput.paymentPeriod"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1)])])])],1)])],1)],1),a("div",{staticClass:"box-content box-content-2 box-content-2-plus"},[a("el-row",[a("span",{staticClass:"title-box"},[t._v(" Thông tin khách hàng "),a("i",{staticClass:"el-icon-caret-bottom"})]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"box-left"},[a("span",{staticClass:"title"},[t._v("Phân loại KH "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"customerType"}},[a("el-select",{attrs:{placeholder:"Chọn phân loại KH",clearable:""},model:{value:t.dataInput.customerType,callback:function(e){t.$set(t.dataInput,"customerType",e)},expression:"dataInput.customerType"}},t._l(t.optionsRelationship,(function(e){return a("el-option",{key:e.id,attrs:{label:t.getRelationship(e.code),value:e.value}})})),1)],1),t.openLoanCode?a("span",{staticClass:"title"},[t._v("Mã khoản vay "),a("span",{staticClass:"required"},[t._v("*")])]):t._e(),t.openLoanCode?a("el-form-item",{attrs:{prop:"loanCode"}},[a("el-input",{attrs:{placeholder:"Nhập mã khoản vay"},model:{value:t.dataInput.loanCode,callback:function(e){t.$set(t.dataInput,"loanCode",e)},expression:"dataInput.loanCode"}})],1):t._e()],1)]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"box-right"},[a("span",{staticClass:"title"},[t._v("Chọn khách hàng "),t.rules.customerId[0].required?a("span",{staticClass:"required"},[t._v("*")]):t._e()]),a("el-form-item",{attrs:{prop:"customerId"}},[a("el-select",{staticClass:"select",attrs:{remote:"","remote-method":t.remoteCustomer,filterable:"",clearable:"",disabled:"customerPayment"==this.$route.name,placeholder:"Chọn tên khách hàng","popper-class":"uploader-select select-extend-item-audit"},model:{value:t.dataInput.customerId,callback:function(e){t.$set(t.dataInput,"customerId",e)},expression:"dataInput.customerId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreCustomer,expression:"loadMoreCustomer"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},[t._l(t.arrayCustomer,(function(e){return a("el-option",{key:e.id,attrs:{label:t.getNameCustomer(e.customerCifCode,e.customerFullName),value:e.id}},[[a("div",{staticClass:"box-customer",class:e.address?null:"box-customer-plus"},[e.customerCifCode?a("span",[t._v(t._s(e.customerCifCode)+" - "+t._s(e.customerFullName))]):a("span",[t._v(t._s(e.customerFullName))]),e.address?a("span",{staticClass:"box-address"},[t._v(t._s(e.address))]):t._e(),a("span",{staticClass:"icon-edit",on:{click:function(a){return t.handleEditCustomer(e.id,a)}}},[a("base-icon",{staticClass:"icon-edit-customer",attrs:{icon:"icon-edit-customer"}})],1)])]],2)})),a("div",{staticClass:"option-extend"},[a("a",{on:{click:function(e){return t.handleAddCustomer("customer")}}},[a("base-icon",{staticClass:"style_avatar",attrs:{icon:"add-user"}}),t._v(" Thêm khách hàng mới ")],1)]),t.arrayCustomer.length<=0?a("el-option",{attrs:{value:"",label:""}},[t._v("Không tìm thấy dữ liệu")]):t._e()],2)]),t.errorCustomer?a("div",{staticClass:"errorHSYCB"},[t._v(" Khách hàng bạn chọn có CIF. Bạn cần chọn đúng Phân loại KH khớp với "),a("br"),t._v(" CIF ")]):t._e()],1),a("span",{staticClass:"title"},[t._v("Bên mua bảo hiểm "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"bmbhId"}},[t.nameBmbh?t._e():a("el-select",{staticClass:"select",attrs:{remote:"","remote-method":t.remoteBmbh,filterable:"",clearable:"",placeholder:"Chọn bên mua bảo hiểm","popper-class":"uploader-select select-extend-item-audit"},model:{value:t.dataInput.bmbhId,callback:function(e){t.$set(t.dataInput,"bmbhId",e)},expression:"dataInput.bmbhId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreBmbh,expression:"loadMoreBmbh"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},[t._l(t.arrayBmbh,(function(e,s){return a("el-option",{key:s,attrs:{label:t.getNameBmbh(e.customerCifCode,e.customerFullName),value:e.id}},[[a("div",{staticClass:"box-customer",class:e.address?null:"box-customer-plus"},[e.customerCifCode?a("span",[t._v(t._s(e.customerCifCode)+" - "+t._s(e.customerFullName))]):a("span",[t._v(t._s(e.customerFullName))]),e.address?a("span",{staticClass:"box-address"},[t._v(t._s(e.address))]):t._e(),a("span",{staticClass:"icon-edit",on:{click:function(a){return t.handleEditBmbh(e.id,a)}}},[a("base-icon",{staticClass:"icon-edit-customer",attrs:{icon:"icon-edit-customer"}})],1)])]],2)})),a("div",{staticClass:"option-extend"},[a("a",{on:{click:function(e){return t.handleAddCustomer("bmbh")}}},[a("base-icon",{staticClass:"style_avatar",attrs:{icon:"add-user"}}),t._v(" Thêm bên mua bảo hiểm ")],1)]),t.arrayBmbh.length<=0?a("el-option",{attrs:{value:"",label:""}},[t._v("Không tìm thấy dữ liệu")]):t._e()],2)]),t.nameBmbh?a("el-input",{on:{focus:function(e){return t.handleFocusNameBmbh()}},model:{value:t.nameBmbh,callback:function(e){t.nameBmbh=e},expression:"nameBmbh"}}):t._e()],1)],1)])],1)],1),a("div",{staticClass:"box-content box-content-3"},[a("el-row",[a("span",{staticClass:"title-box"},[t._v(" Thông tin ngân hàng "),a("i",{staticClass:"el-icon-caret-bottom"})]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"box-left"},[a("span",{staticClass:"title"},[t._v("Đơn vị kinh doanh "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"transactionOfficeId"}},[a("el-select",{staticClass:"select",attrs:{remote:"","remote-method":t.remoteTransactionOffice,filterable:"",placeholder:"Chọn đơn vị kinh doanh"},on:{change:t.changeTransactionOfficeId},model:{value:t.dataInput.transactionOfficeId,callback:function(e){t.$set(t.dataInput,"transactionOfficeId",e)},expression:"dataInput.transactionOfficeId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreTransactionOffice,expression:"loadMoreTransactionOffice"}],attrs:{"infinite-scroll-delay":"500"}},t._l(t.saleMembersListTransactionOffice,(function(t){return a("el-option",{key:t.id,attrs:{label:t.locationCode+" - "+t.name,value:t.id}})})),1)])],1),a("span",{staticClass:"title"},[t._v("NV đứng code "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"consultantMemberId"}},[a("el-select",{staticClass:"select",attrs:{remote:"","remote-method":t.remoteConsultantMember,filterable:"","default-first-option":"",clearable:"",placeholder:"Chọn NV đứng code"},on:{change:t.fillCode},model:{value:t.dataInput.consultantMemberId,callback:function(e){t.$set(t.dataInput,"consultantMemberId",e)},expression:"dataInput.consultantMemberId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreConsultantMember,expression:"loadMoreConsultantMember"}],attrs:{"infinite-scroll-delay":"500"}},t._l(t.saleMembersListConsultantMember,(function(t){return a("el-option",{key:t.id,attrs:{label:t.memberNo+" - "+t.fullName,value:t.id}})})),1)])],1),a("span",{staticClass:"title"},[t._v("Mã code "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"certCode"}},[a("el-input",{attrs:{disabled:""},model:{value:t.dataInput.certCode,callback:function(e){t.$set(t.dataInput,"certCode",e)},expression:"dataInput.certCode"}})],1)],1)]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"box-right"},[a("span",{staticClass:"title"},[t._v("NV tư vấn "),a("span",{staticClass:"required"},[t._v("*")])]),a("el-form-item",{attrs:{prop:"salesMemberId"}},[a("el-select",{staticClass:"select",attrs:{remote:"","remote-method":t.remoteSaleMembers,filterable:"","default-first-option":"",clearable:"",placeholder:"Chọn NV tư vấn"},model:{value:t.dataInput.salesMemberId,callback:function(e){t.$set(t.dataInput,"salesMemberId",e)},expression:"dataInput.salesMemberId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreSaleMember,expression:"loadMoreSaleMember"}],attrs:{"infinite-scroll-delay":"500"}},t._l(t.saleMembersList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.memberNo+" - "+t.fullName,value:t.id}})})),1)])],1),a("span",{staticClass:"title"},[t._v("NV giới thiệu")]),a("el-form-item",{attrs:{prop:"refMemberId"}},[a("el-select",{staticClass:"select",attrs:{remote:"","remote-method":t.remoteRefMember,filterable:"","default-first-option":"",clearable:"",placeholder:"Chọn NV giới thiệu"},model:{value:t.refMemberId,callback:function(e){t.refMemberId=e},expression:"refMemberId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadRefMember,expression:"loadRefMember"}],attrs:{"infinite-scroll-delay":"500"}},t._l(t.saleMembersListRefMember,(function(t){return a("el-option",{key:t.id,attrs:{label:t.memberNo+" - "+t.fullName,value:t.id}})})),1)])],1)],1)])],1)],1),a("div",{staticClass:"box-content box-content-4"},[a("el-row",[a("span",{staticClass:"title-box"},[t._v(" Thông tin sản phẩm "),a("i",{staticClass:"el-icon-caret-bottom"})]),a("div",{staticClass:"salary-table salary-table--dvkd"},[a("el-form",{ref:"formRule",attrs:{model:t.formEmulationRule,rules:t.formEmulationRule.rules}},[a("base-tree-table",{attrs:{data:t.formEmulationRule.dataTable,table:t.table,showPagination:!1,showSummary:!0,summaryMethod:t.summaryMethod,sumText:"Tổng"},on:{sizeChange:t.handleSizeChange}},[a("el-table-column",{attrs:{type:"index",width:"40",align:"center",label:"#"}}),a("el-table-column",{attrs:{label:"SẢN PHẨM",prop:"productId",width:"300",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{staticClass:"form-item",attrs:{prop:"dataTable."+e.$index+".productId",rules:t.formEmulationRule.rules.productId}},[a("el-select",{staticClass:"select input-product-code",attrs:{remote:"",disabled:"9"===e.row.auditStatus,"remote-method":t.remoteProduct,filterable:"","default-first-option":"",clearable:"",placeholder:"","popper-class":"popper-select-product"},on:{focus:t.handleProduct,change:function(a){return t.addProduct(e.$index,a)}},model:{value:e.row.productId,callback:function(a){t.$set(e.row,"productId",a)},expression:"scope.row.productId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreProduct,expression:"loadMoreProduct"}],staticClass:"list-product",attrs:{"infinite-scroll-delay":"500"}},t._l(t.arrayProduct,(function(t){return a("el-option",{key:t.id,attrs:{label:t.productCode+" - "+t.productName,value:t.id}})})),1)])],1)]}}])}),a("el-table-column",{attrs:{label:"PHÍ CB (TP)",prop:"basicAmount",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{staticClass:"form-item",attrs:{prop:"dataTable."+e.$index+".basicAmount",rules:t.formEmulationRule.rules.basicAmount}},[a("el-input",{staticClass:"input-fee",attrs:{disabled:"9"===e.row.auditStatus},nativeOn:{keyup:function(a){return t.numberFormat(a,e.$index,"basicAmount")}},model:{value:e.row.basicAmount,callback:function(a){t.$set(e.row,"basicAmount",a)},expression:"scope.row.basicAmount"}})],1)]}}])}),a("el-table-column",{attrs:{label:"Phí thêm (EP)",prop:"extraAmount",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{staticClass:"form-item",attrs:{prop:"extraAmount"}},[a("el-input",{staticClass:"input-extraFee",attrs:{disabled:t.disabledExtraAmount(e)},nativeOn:{keyup:function(a){return t.numberFormat(a,e.$index,"extraAmount")}},model:{value:e.row.extraAmount,callback:function(a){t.$set(e.row,"extraAmount",a)},expression:"scope.row.extraAmount"}})],1)]}}])}),a("el-table-column",{attrs:{label:"Tổng Phí",prop:"totalAmount",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{staticClass:"form-item"},[a("el-input",{staticClass:"input-totalFee",attrs:{value:t.getTotal(e.row.basicAmount,e.row.extraAmount),disabled:!0}})],1)]}}])}),a("el-table-column",{attrs:{label:"FYP",prop:"totalAmount",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form-item",{staticClass:"form-item"},[a("el-input",{staticClass:"input-totalFee",attrs:{value:t.getFYP(e.row.basicAmount,e.row.extraAmount),disabled:!0}})],1)]}}])}),a("el-table-column",{attrs:{label:"",width:"47",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"action"},[e.$index>0&&"9"!==e.row.auditStatus?a("base-icon",{staticClass:"subIcon",staticStyle:{"font-size":"16px",color:"#6b6b6b"},attrs:{slot:"reference",icon:"remove"},nativeOn:{click:function(a){return t.handleDeleteRule(e.row,"more")}},slot:"reference"}):t._e()],1)]}}])})],1)],1),a("div",{staticClass:"add-product",on:{click:t.handleAddRule}},[a("div",{staticClass:"plus"},[a("i",{staticClass:"el-icon-plus"})]),a("div",[a("span",[t._v("Thêm sản phẩm")])])])],1)])],1)])]),a("div",{staticClass:"text-right footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-close",on:{click:t.handleClose}},[t._v("Huỷ")]),a("el-button",{staticClass:"btn-add",attrs:{loading:t.loadBtn,disabled:t.btnAdd},on:{click:t.handleCreate}},[t._v("Lưu")])],1),a("add-customer",{attrs:{dataProp:t.dataPropCustomer,checkCustomerType:this.checkCustomerType},on:{saveSuccess:t.saveCustomer}}),a("add-bmbh",{attrs:{dataProp:t.dataPropBmbh,checkCustomerType:this.checkCustomerType},on:{saveSuccess:t.saveBmbh}})],1)},r=[],i=a("c964"),n=a("d0ff"),o=a("f3f3"),c=a("276c"),l=a("e954"),u=a("920b"),d=a("92a6"),m=(a("96cf"),a("a4d3"),a("e01a"),a("4d90"),a("a15b"),a("ac1f"),a("1276"),a("b0c0"),a("fb6a"),a("a9e3"),a("99af"),a("5319"),a("d3b7"),a("3ca3"),a("ddb0"),a("4ec9"),a("d81d"),a("a434"),a("841c"),a("9ab4")),p=a("1b40"),h=a("9f48"),f=a("08ba"),b=a("c56f"),v=a("2ef0"),C=a("4bb5"),y=a("9f13"),g=a("fa00"),I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"addCustomer",attrs:{name:"addbmbh-popup",closeClickModal:!1,width:"504px","max-height:75vh":"",top:"5vh",open:t.handleOpen,close:t.handleClose}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s("edit"==t.dataProp.code?t.dataProp.title:"Thêm bên mua bảo hiểm mới"))]),a("el-form",{ref:"dataInput",staticClass:"form_customer",attrs:{model:t.dataInput,rules:t.rules}},[(this.checkCustomerType,a("el-form-item",{staticClass:"itemlabel",attrs:{label:"Số CIF Bảo hiểm ",prop:"customerCifCode"}},[a("el-input",{attrs:{placeholder:"Nhập số CIF bảo hiểm"},model:{value:t.dataInput.customerCifCode,callback:function(e){t.$set(t.dataInput,"customerCifCode","string"===typeof e?e.trim():e)},expression:"dataInput.customerCifCode"}})],1)),a("el-form-item",{staticClass:"form_customer-top",attrs:{label:"Họ và tên",prop:"customerFullName"}},[a("el-input",{attrs:{placeholder:"Nhập họ và tên"},model:{value:t.dataInput.customerFullName,callback:function(e){t.$set(t.dataInput,"customerFullName",e)},expression:"dataInput.customerFullName"}}),0==this.fullNameLength?a("small",{staticClass:"error"},[t._v("Tên bảo hiểm không được để trống")]):t._e()],1),a("el-form-item",{staticClass:"form_customer-top",attrs:{label:"CMND",prop:"customerIdNumber"}},[a("el-input",{attrs:{placeholder:"Nhập số CMND",type:"number",maxlength:"12","show-word-limit":""},model:{value:t.dataInput.customerIdNumber,callback:function(e){t.$set(t.dataInput,"customerIdNumber","string"===typeof e?e.trim():e)},expression:"dataInput.customerIdNumber"}}),t.listError.customerIdNumber&&this.idNumberLength>0?a("small",{staticClass:"error"},[t._v("Số CMND 9 hoặc 12 số")]):t._e()],1),a("el-form-item",{staticClass:"form_customer-top",attrs:{label:"Số điện thoại",prop:"customerMobilePhone"}},[a("el-input",{attrs:{placeholder:"Nhập số điện thoại",type:"number"},model:{value:t.dataInput.customerMobilePhone,callback:function(e){t.$set(t.dataInput,"customerMobilePhone","string"===typeof e?e.trim():e)},expression:"dataInput.customerMobilePhone"}})],1),a("el-form-item",{staticClass:"form_customer-top",attrs:{label:"Địa chỉ"}},[a("el-input",{attrs:{placeholder:"Nhập địa chỉ"},model:{value:t.dataInput.address,callback:function(e){t.$set(t.dataInput,"address",e)},expression:"dataInput.address"}})],1),a("el-form-item",{staticClass:"form_customer-top",attrs:{label:"Email"}},[a("el-input",{attrs:{placeholder:"Nhập email"},model:{value:t.dataInput.customerEmail,callback:function(e){t.$set(t.dataInput,"customerEmail",e)},expression:"dataInput.customerEmail"}})],1),a("div",{staticClass:"btn-handling-customer bottom"},[a("div",{staticClass:"bt-center"},[a("el-button",{staticClass:"be-button-unset",attrs:{size:"mini"},on:{click:t.handleClose}},[t._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:t.handleSave}},[t._v("Lưu")])],1)])],1)],1)},O=[],N=(a("498a"),a("1f2a")),_=Object(C["a"])("beUser"),k=function(t){Object(u["a"])(a,t);var e=Object(d["a"])(a);function a(){var t;return Object(c["a"])(this,a),t=e.apply(this,arguments),t.idNumberLength=0,t.fullNameLength=0,t.listError={customerIdNumber:!1,customerFullName:!1},t.rules={customerCifCode:[{min:8,max:8,message:"CIF phải có 8 ký tự",trigger:"change"}],customerFullName:[{required:!0,message:0==t.fullNameLength?"Tên bảo hiểm không được để trống":"",trigger:"blur"}],customerIdNumber:[{required:!0,message:0==t.idNumberLength?"Số CMND không được để trống":"",trigger:"change"}]},t.dataInput={customerCifCode:"",customerFullName:"",customerIdNumber:"",customerMobilePhone:"",customerEmail:"",address:""},t}return Object(l["a"])(a,[{key:"searchText",value:function(t){t&&9==t.length||t&&12==t.length?this.listError.customerIdNumber=!1:this.listError.customerIdNumber=!0,this.idNumberLength=t.length}},{key:"changeName",value:function(t){var e=Object(v["trim"])(t);this.fullNameLength=e.length,0==e.length?this.listError.customerFullName=!0:this.listError.customerFullName=!1}},{key:"changeValueIdNumber",value:function(t){console.log("query",t)}},{key:"handleOpen",value:function(){"edit"==this.dataProp.code&&this.handleEditCustomer(),this.fullNameLength=1,this.$refs.dataInput.clearValidate(),console.log(this.$route.name)}},{key:"handleEditCustomer",value:function(){var t=this;this.api.detailCustomer(this.dataProp.id).then((function(e){e.customerCifCode&&(t.dataInput.customerCifCode=e.customerCifCode),t.dataInput.customerFullName=e.customerFullName,t.dataInput.customerIdNumber=e.customerIdNumber,t.dataInput.customerMobilePhone=e.customerMobilePhone,t.dataInput.customerEmail=e.customerEmail,t.dataInput.address=e.address}))}},{key:"handleClose",value:function(){this.$refs.dataInput.clearValidate(),this.dataInput.customerCifCode="",this.dataInput.customerFullName="",this.dataInput.customerIdNumber="",this.dataInput.customerMobilePhone="",this.dataInput.customerEmail="",this.dataInput.address="",this.setOpenPopup({popupName:"addbmbh-popup",isOpen:!1})}},{key:"handleSave",value:function(){var t=this,e=this.$refs.dataInput;e.validate((function(e){if(!e)return console.log("error validate data!"),!1;if(9==t.idNumberLength&&t.fullNameLength>0||12==t.idNumberLength&&t.fullNameLength>0){var a,s,r=Object(o["a"])(Object(o["a"])({},t.dataInput),{},{customerFullName:t.dataInput.customerFullName.trim()});if("edit"==t.dataProp.code)null===(a=t.api)||void 0===a||a.updateCustomer(t.dataProp.id,r).then((function(e){t.$message.success("Chỉnh sửa bên mua bảo hiểm thành công");var a={customerCifCode:t.dataInput.customerCifCode,customerFullName:t.dataInput.customerFullName,id:t.dataProp.id};N["a"].$emit("pushIdBmbh",a),t.handleClose()})).catch((function(e){t.$message.error(e.message)}));if("add"==t.dataProp.code)null===(s=t.api)||void 0===s||s.AddCustomer(r).then((function(e){t.$message.success("Thêm bên mua bảo hiểm thành công"),t.$emit("saveSuccess",e.data),t.handleClose()})).catch((function(e){t.$message.error(e.message)}))}}))}},{key:"created",value:function(){var t,e,a,s;this.apiContract=Object(f["a"])("contract",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.api=Object(f["a"])("category",{districtId:null===(a=this.user)||void 0===a||null===(s=a.districts)||void 0===s?void 0:s[0].id})}}]),a}(Object(p["b"])(h["a"]));Object(m["a"])([_.State("user")],k.prototype,"user",void 0),Object(m["a"])([Object(p["c"])()],k.prototype,"checkCustomerType",void 0),Object(m["a"])([Object(p["c"])()],k.prototype,"dataProp",void 0),Object(m["a"])([Object(p["e"])("dataInput.customerIdNumber",{immediate:!1})],k.prototype,"searchText",null),Object(m["a"])([Object(p["e"])("dataInput.customerFullName",{immediate:!1})],k.prototype,"changeName",null),k=Object(m["a"])([Object(p["a"])({components:{}})],k);var M=k,j=M,P=(a("0a73"),a("2877")),D=Object(P["a"])(j,I,O,!1,null,"725993a9",null),x=D.exports,w=Object(C["a"])("beUser"),F=function(t){Object(u["a"])(a,t);var e=Object(d["a"])(a);function a(){var t;return Object(c["a"])(this,a),t=e.apply(this,arguments),t.locationRes=void 0,t.loadBtn=!1,t.totalBasicAmount=0,t.totalBasicExtraAmount=0,t.arrayCustomer=[],t.arrayBmbh=[],t.arrayProduct=[],t.description="",t.salesMember="",t.refMemberId="",t.btnAdd=!1,t.table={total:100,page:1,limit:20},t.options=[{value:"1",label:"Năm"},{value:"2",label:"Nửa năm"},{value:"4",label:"Quý"},{value:"12",label:"Tháng"},{value:"0",label:"1 lần"}],t.isLoading=!1,t.contractDetail={},t.typeProgramSource=[],t.typeApplyFee=[],t.optionsRelationship=[],t.optionsOffer=[],t.index=0,t.querySaleMember={i:0,ps:20,search:""},t.queryConsulantMember={i:0,ps:20,search:""},t.queryOffer={page:1,limit:20,search:""},t.queryRefMember={i:0,ps:20,search:""},t.queryLocation={i:0,ps:20,search:"",type:3},t.queryCustomer={limit:20,page:1,search:""},t.queryBmbh={limit:20,page:1,search:""},t.saleMembersList=[],t.saleMembersListConsultantMember=[],t.saleMembersListRefMember=[],t.saleMembersListTransactionOffice=[],t.saleMembersListCustomer=[],t.validateContractNo=!0,t.validateError=!1,t.errorCurrentFeeYear=!1,t.errorPayFeeDate=!1,t.openLoanCode=!1,t.dataPropCustomer={title:"",id:"",code:""},t.dataPropBmbh={title:"",id:"",code:""},t.nameBmbh="",t.errorCustomer=!1,t.arrayCategory=[],t.errorCategory=!1,t.messErrorCategory="",t.checkCustomerType=!1,t.queryDrop={querySaleMember:{i:0,ps:20,search:"",statusAccount:0,groupCode:"INSURANCE",sort:1}},t.queryDropCustomer={queryCustomer:{limit:20,ps:20,page:1,search:""}},t.queryDropBmbh={queryBmbh:{limit:20,ps:20,page:1,search:""}},t.queryDropProduct={queryProduct:{page:1,limit:20,search:""}},t.pickerOptions={disabledDate:function(t){return t.getTime()>Date.now()}},t.indexArrayCustomer="",t.indexArrayBmbh="",t.dataInput={feeType:"",customerChannel:"",currentFeeYear:"",payFeeDate:new Date,issueDate:new Date,applyFormNo:"",loanCode:"",contractNo:"",numOfFeeYear:"",numOfContractYear:"",paymentPeriod:"",customerType:"",customerId:null,bmbhId:"",transactionOfficeId:"",consultantMemberId:"",salesMemberId:"",code:"",certCode:"",offerProgramId:""},t.rules={currentFeeYear:[{required:!0,message:"Năm phí hiện tại không được để trống",trigger:"blur"}],payFeeDate:[{required:!0,message:"Ngày phí phát sinh không được để trống",trigger:"blur"}],applyFormNo:[{required:!0,message:"Số HSYCBH không được để trống",trigger:"change"},{min:10,max:10,message:"Mã HSYCBH phải có 10 ký tự",trigger:"change"}],loanCode:[{required:!0,message:"Mã khoản vay không được để trống",trigger:"change"}],contractNo:[{required:!0,message:"Số HĐ không được để trống",trigger:"change"},{min:9,max:9,message:"Số HĐ phải có 9 ký tự",trigger:"change"}],numOfFeeYear:[{required:!0,message:"Thời hạn đóng phí không được để trống",trigger:"blur"}],numOfContractYear:[{required:!0,message:"Thời hạn HĐ không được để trống",trigger:"blur"}],paymentPeriod:[{required:!0,message:"Định kỳ đóng phí không được để trống",trigger:"blur"}],customerType:[{required:!0,message:"Phân loại KH không được để trống",trigger:"blur"}],customerId:[{required:!0,message:"Khách hàng không được để trống",trigger:"blur",type:"number"}],bmbhId:[{required:!0,message:"Bên mua bảo hiểm không được để trống",trigger:"blur",type:"number"}],transactionOfficeId:[{required:!0,message:"Đơn vị kinh doanh không được để trống",trigger:"blur"}],consultantMemberId:[{required:!0,message:"Nhân viên đứng code không được để trống",trigger:"blur"}],salesMemberId:[{required:!0,message:"Nhân viên tư vấn không được để trống",trigger:"blur"}],feeType:[{required:!0,message:"Loại phí không được để trống",trigger:"blur"}],customerChannel:[{required:!0,message:"Nguồn hợp đồng không được để trống",trigger:"blur"}],certCode:[{required:!0,message:"Mã code không được để trống",trigger:"blur"}]},t.formEmulationRule={rules:{productId:[{required:!0,message:"Không được để trống",trigger:"blur"}],basicAmount:[{required:!0,message:"Không được để trống",trigger:"blur"}]},dataTable:[{}]},t}return Object(l["a"])(a,[{key:"resetItems",value:function(){this.loadBtn=!1,this.description="",this.salesMember="",this.refMemberId="",this.totalBasicAmount=0,this.totalBasicAmount=0,this.formEmulationRule.dataTable=[{}],this.btnAdd=!1,this.dataInput={feeType:"",customerChannel:"",currentFeeYear:"",payFeeDate:new Date,issueDate:new Date,applyFormNo:"",loanCode:"",contractNo:"",numOfFeeYear:"",numOfContractYear:"",paymentPeriod:"",customerType:"",customerId:null,bmbhId:"",transactionOfficeId:"",consultantMemberId:"",salesMemberId:"",code:"",certCode:"",offerProgramId:""},this.validateError=!1,this.errorCurrentFeeYear=!1,this.errorPayFeeDate=!1,this.openLoanCode=!1,this.dataPropCustomer={title:"",id:"",code:""},this.dataPropBmbh={title:"",id:"",code:""},this.nameBmbh="",this.errorCustomer=!1,this.arrayCategory=[],this.errorCategory=!1,this.messErrorCategory=""}},{key:"getTimeToday",value:function(){var t=String(this.dataInput.payFeeDate.getDate()).padStart(2,"0"),e=String(this.dataInput.payFeeDate.getMonth()+1).padStart(2,"0"),a=this.dataInput.payFeeDate.getFullYear();this.dataInput.payFeeDate=a+"-"+e+"-"+t}},{key:"getTimeToday2",value:function(){var t=String(this.dataInput.issueDate.getDate()).padStart(2,"0"),e=String(this.dataInput.issueDate.getMonth()+1).padStart(2,"0"),a=this.dataInput.issueDate.getFullYear();this.dataInput.issueDate=a+"-"+e+"-"+t}},{key:"checkPayFeeDate",value:function(t){var e=Object(v["filter"])(this.user.permissionUserRoles,(function(t){return"ADMIN"==t.roleCode}));if(e.length<=0&&!this.dataProp.code){var a=new Date,s=a.setDate(a.getDate());if(1==this.user.permissionUserRoles.length&&"TRANSACTION_OFFICE_MEMBER"==this.user.permissionUserRoles[0].roleCode){var r,i=a.setDate(a.getDate()-1);0===new Date(i).getDay()&&(i=a.setDate(a.getDate()-2)),6===new Date(i).getDay()&&(i=a.setDate(a.getDate()-1)),t<(null===(r=this.$options.filters)||void 0===r?void 0:r.formatDateTime(i).split("/").reverse().join("-"))?this.errorPayFeeDate=!0:this.errorPayFeeDate=!1}else if(1==a.getDate()||2==a.getDate()||3==a.getDate()&&1===new Date(s).getDay())this.errorPayFeeDate=!1;else{var n,o=a.setDate(a.getDate()-1);0===new Date(o).getDay()&&(o=a.setDate(a.getDate()-2)),6===new Date(o).getDay()&&(o=a.setDate(a.getDate()-1)),t<(null===(n=this.$options.filters)||void 0===n?void 0:n.formatDateTime(o).split("/").reverse().join("-"))?this.errorPayFeeDate=!0:this.errorPayFeeDate=!1}}}},{key:"checkFeeType",value:function(t){if("dang-doi-soat"==this.$route.name||"edit"==this.dataProp.code&&("8"==this.contractDetail.auditStatus||"2"==this.contractDetail.auditStatus))return this.rules.applyFormNo[0].required=!0,void(this.rules.contractNo[0].required=!0);this.dataProp.code?"1"==t&&"1"==this.contractDetail.auditStatus?(this.rules.contractNo[0].required=!1,this.rules.applyFormNo[0].required=!0):(this.rules.contractNo[0].required=!0,this.rules.applyFormNo[0].required=!1):"1"==t?(this.rules.contractNo[0].required=!1,this.rules.applyFormNo[0].required=!0):(this.rules.contractNo[0].required=!0,this.rules.applyFormNo[0].required=!1)}},{key:"checkContractNo",value:function(t){if(10==t.length?(1==this.dataInput.customerChannel&&("EA"!=t.slice(0,2)?this.validateError=!0:this.validateError=!1),2==this.dataInput.customerChannel&&("LV"!=t.slice(0,2)?this.validateError=!0:this.validateError=!1)):this.validateError=!1,this.dataProp.code){if("dang-doi-soat"==this.$route.name||"edit"==this.dataProp.code&&("8"==this.contractDetail.auditStatus||"2"==this.contractDetail.auditStatus))return this.rules.applyFormNo[0].required=!0,void(this.rules.contractNo[0].required=!0);var e;if(t&&"0"!=t)this.rules.applyFormNo[0].required=!1,null===(e=this.$refs.dataInput)||void 0===e||e.clearValidate("applyFormNo");else 2==this.dataInput.feeType?this.rules.applyFormNo[0].required=!1:this.rules.applyFormNo[0].required=!0}}},{key:"checkApplyFormNo",value:function(t){if(this.dataProp.code){if("dang-doi-soat"==this.$route.name||"edit"==this.dataProp.code&&("8"==this.contractDetail.auditStatus||"2"==this.contractDetail.auditStatus))return this.rules.applyFormNo[0].required=!0,void(this.rules.contractNo[0].required=!0);var e;if(t&&"0"!=t)this.rules.applyFormNo[0].required=!1,null===(e=this.$refs.dataInput)||void 0===e||e.clearValidate("applyFormNo");else this.rules.applyFormNo[0].required=!0}}},{key:"checkType",value:function(t){2==t?this.openLoanCode=!0:(this.dataInput.loanCode="",this.openLoanCode=!1),2==t||3==t||5==t?(this.rules.customerId[0].required=!0,this.rules.customerId[0].type="number"):(delete this.rules.customerId[0].type,this.rules.customerId[0].required=!1),1==this.dataInput.customerType||4==this.dataInput.customerType?this.checkCustomerType=!0:this.checkCustomerType=!1}},{key:"convertNumOfFeeYear",value:function(){isNaN(Number(this.dataInput.numOfFeeYear))?this.dataInput.numOfFeeYear="":this.dataInput.numOfFeeYear=Number(this.dataInput.numOfFeeYear)}},{key:"convertNumOfContractYear",value:function(){isNaN(Number(this.dataInput.numOfContractYear))?this.dataInput.numOfContractYear="":this.dataInput.numOfContractYear=Number(this.dataInput.numOfContractYear)}},{key:"convertCurrentFeeYear",value:function(){this.errorCurrentFeeYear=!1,1==this.dataInput.feeType&&(1!=this.dataInput.currentFeeYear?this.errorCurrentFeeYear=!0:this.errorCurrentFeeYear=!1),isNaN(Number(this.dataInput.currentFeeYear))?this.dataInput.currentFeeYear="":this.dataInput.currentFeeYear=Number(this.dataInput.currentFeeYear)}},{key:"fillHSYCBH",value:function(){var t=this.dataInput.applyFormNo.slice(0,2);1==this.dataInput.customerChannel&&("LV"!=t&&"EA"==t||(this.dataInput.applyFormNo="EA")),2==this.dataInput.customerChannel&&("EA"!=t&&"LV"==t||(this.dataInput.applyFormNo="LV"))}},{key:"clearCertCode",value:function(t){t||(this.dataInput.certCode="")}},{key:"fillGetRefMember",value:function(t){t&&this.getRefMember("")}},{key:"handleClose",value:function(){this.resetAllQuery(),this.resetItems(),this.$refs.dataInput&&this.$refs.dataInput.clearValidate(),this.$refs.formRule&&this.$refs.formRule.clearValidate(),this.setOpenPopup({popupName:"create-cost",isOpen:!1}),this.$forceUpdate()}},{key:"validateForm",value:function(){var t=this.$refs.dataInput,e=!1,a=!1;t.validate((function(t){e=t}));var s=this.$refs.formRule;return s.validate((function(t){a=t})),e&&a}},{key:"handleCreate",value:function(){var t=this;if(this.errorCategory=!1,1==this.dataInput.feeType){var e=Object(v["filter"])(this.arrayCategory,(function(e){return e.code==t.formEmulationRule.dataTable[0].code}));if(e.length>0){var a=0,s=0;Object(v["forEach"])(this.formEmulationRule.dataTable,(function(r){r.code!=e[0].code&&(t.messErrorCategory="Không được nhập nhiều hơn 1 loại sản phẩm trên 1 hợp đồng",t.errorCategory=!0),"MAIN"==r.productType&&(a+=1),"SUB"==r.productType&&(s+=1)})),"edit"==this.dataProp.code&&a!=e[0].minMainProduct&&(this.messErrorCategory="Cần nhập ".concat(e[0].minMainProduct," sản phẩm chính"),this.errorCategory=!0),("edit"!=this.dataProp.code&&a!=e[0].minMainProduct||"edit"!=this.dataProp.code&&s<e[0].minSubProduct)&&(this.messErrorCategory="Cần nhập ".concat(e[0].minMainProduct," sản phẩm chính và tối thiểu ").concat(e[0].minSubProduct," sản phẩm phụ"),this.errorCategory=!0)}}if(this.errorCustomer=!1,1==this.dataInput.customerType){var r=Object(v["filter"])(this.arrayCustomer,(function(e){return e.id==t.dataInput.customerId}));r.length>0&&(r[0].customerCifCode?this.errorCustomer=!0:this.errorCustomer=!1)}this.loadBtn=!0;var i=this.validateForm();if(!i||this.validateError||this.errorCurrentFeeYear||this.errorPayFeeDate||this.errorCustomer||this.errorCategory)this.errorCategory?(this.$message.error(this.messErrorCategory),this.loadBtn=!1):(this.$message.error("Nhập đầy đủ thông tin bắt buộc!"),this.loadBtn=!1);else{var c;this.formEmulationRule.dataTable.length>0&&Object(v["forEach"])(this.formEmulationRule.dataTable,(function(t){"string"===typeof t.basicAmount&&(t.basicAmount=parseFloat(t.basicAmount.replace(/,/g,""))),"string"===typeof t.extraAmount&&(t.extraAmount=parseFloat(t.extraAmount.replace(/,/g,""))),t.extraAmount||(t.extraAmount=0)}));var l,u,d,m={feeType:this.dataInput.feeType,customerChannel:this.dataInput.customerChannel,payFeeDate:this.dataInput.payFeeDate,issueDate:this.dataInput.issueDate,description:this.description,applyFormNo:this.dataInput.applyFormNo,loanCode:this.dataInput.loanCode,contractNo:this.dataInput.contractNo,numOfFeeYear:this.dataInput.numOfFeeYear,currentFeeYear:this.dataInput.currentFeeYear,numOfContractYear:this.dataInput.numOfContractYear,paymentPeriod:this.dataInput.paymentPeriod,customerType:this.dataInput.customerType,customerId:this.dataInput.customerId,bmbhId:this.dataInput.bmbhId,consultantMemberId:this.dataInput.consultantMemberId,salesMemberId:this.dataInput.salesMemberId,refMemberId:this.refMemberId,transactionOfficeId:this.dataInput.transactionOfficeId,productList:this.formEmulationRule.dataTable,consultantNo:this.dataInput.certCode,subContracts:this.formEmulationRule.dataTable,offerProgramId:this.dataInput.offerProgramId};if(null!==(c=this.dataProp)&&void 0!==c&&c.code){if(isNaN(this.dataInput.customerId)&&delete m.customerId,isNaN(this.dataInput.bmbhId)&&delete m.bmbhId,"edit"==(null===(l=this.dataProp)||void 0===l?void 0:l.code)&&this.api.updateContract(Object(o["a"])(Object(o["a"])({},this.contractDetail),m)).then((function(){t.$emit("reload"),t.$message.success("Cập nhật thông tin thành công"),t.handleClose()})).catch((function(e){console.log(e),t.$message.error("Cập nhật thông tin thất bại"),t.handleClose()})),"edit-auditing"==(null===(u=this.dataProp)||void 0===u?void 0:u.code)||"add"==(null===(d=this.dataProp)||void 0===d?void 0:d.code)){var p,h={paymentDiffId:this.dataProp.value.id,paymentSource:"add"===(null===(p=this.dataProp)||void 0===p?void 0:p.code)?"DAICHI":null},f=Object(n["a"])(this.formEmulationRule.dataTable);f.length>0&&Object(v["forEach"])(f,(function(t){t.auditStatus="9"}));var b=Object(o["a"])(Object(o["a"])({},m),{},{productList:f,subContracts:f}),C=Object(o["a"])(Object(o["a"])(Object(o["a"])({},this.contractDetail),b),{},{auditStatus:"9"});this.api.updatePaymentDiff(h,C,!0).then((function(){t.$emit("reload"),t.$message.success("Cập nhật thông tin thành công"),t.handleClose()})).catch((function(e){console.log(e),t.$message.error("Cập nhật thông tin thất bại"),t.handleClose()}))}}else this.api.AddCost(m).then((function(){t.$emit("apply"),t.$message.success("Thêm mới thành công"),t.handleClose()})).catch((function(e){console.log(e),t.loadBtn=!1,t.$message.error("Thêm mới thất bại"),t.handleClose()}))}}},{key:"handleOpen",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a,s,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return"khach-hang"===(null===(e=this.dataProp)||void 0===e?void 0:e.type)&&(this.dataInput.customerId=+this.$route.params.id),this.isLoading=!0,t.next=4,Promise.all([this.getTimeToday(),this.getTimeToday2()]);case 4:return t.next=6,Promise.all([this.checkCategoryProduct(),this.getTransactionOffice(""),this.getAllListCustomer(),this.getListOffer("")]);case 6:return t.next=8,this.getTransOffice();case 8:if("audit"==(null===(a=this.dataProp)||void 0===a?void 0:a.type)){t.next=11;break}return t.next=11,this.getSalesMember();case 11:if("edit"!=(null===(s=this.dataProp)||void 0===s?void 0:s.code)){t.next=14;break}return t.next=14,this.getContractDetail();case 14:if("edit-auditing"!=(null===(r=this.dataProp)||void 0===r?void 0:r.code)&&"add"!=(null===(i=this.dataProp)||void 0===i?void 0:i.code)){t.next=17;break}return t.next=17,this.getDetailAuditing();case 17:return this.getIndex(),this.initData(),t.next=21,this.getProductList();case 21:this.handleTotal(),this.isLoading=!1;case 23:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"checkCategoryProduct",value:function(){var t=this;this.apiCategory.checkProductCategory().then((function(e){t.arrayCategory=e.data}))}},{key:"getDetailAuditing",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.api.getDetailPaymentDiff("add"!==this.dataProp.code?this.dataProp.value.bankContractNo:this.dataProp.value.bankContractNo1,{paymentSource:"add"!==this.dataProp.code?"LPB":"DAICHI"}).then((function(t){var a,s;t.bmbhFullName&&!t.bmbhId&&(e.nameBmbh=t.bmbhFullName),e.contractDetail=t,e.dataInput.certCode=t.consultantNo,e.dataInput.feeType=t.feeType,e.dataInput.customerChannel=t.customerChannel,e.dataInput.payFeeDate=null===(a=e.$options.filters)||void 0===a?void 0:a.formatDateHourReverse(t.payFeeDate),e.dataInput.issueDate=null===(s=e.$options.filters)||void 0===s?void 0:s.formatDateHourReverse(t.issueDate),e.description=t.description,e.dataInput.contractNo=t.contractNo,e.dataInput.applyFormNo=t.applyFormNo,e.dataInput.loanCode=t.loanCode,e.dataInput.numOfFeeYear=t.numOfFeeYear,e.dataInput.currentFeeYear=t.currentFeeYear,e.dataInput.numOfContractYear=t.numOfContractYear,e.dataInput.currentContractYear=t.currentContractYear,e.dataInput.paymentPeriod=t.paymentPeriod,e.dataInput.customerType=t.customerType,e.dataInput.customerId=t.customerId,e.dataInput.beneficiaryName=t.beneficiaryName,e.dataInput.consultantMemberId=t.consultantMemberId,e.refMemberId=t.refMemberId,t.transactionOfficeId&&(e.dataInput.transactionOfficeId=t.transactionOfficeId,e.saleMembersListTransactionOffice.unshift({locationCode:t.transactionOfficeCode,name:t.transactionOfficeName,id:t.transactionOfficeId}),e.getAllListMemBer(t.transactionOfficeId),t.salesMemberId&&(e.saleMembersList.unshift({memberNo:t.salesMemberNo,fullName:t.salesFullName,id:t.salesMemberId,phone:t.salesMobilePhone,refWorkPhone:t.salesWorkPhone,email:t.salesEmail}),e.dataInput.salesMemberId=parseInt(t.salesMemberId)),t.refMemberId&&e.saleMembersListRefMember.unshift({memberNo:t.refMemberNo,fullName:t.refFullName,id:t.refMemberId,phone:t.refMobilePhone,refWorkPhone:t.refWorkPhone,email:t.refEmail}),t.consultantMemberId&&e.saleMembersListConsultantMember.unshift({memberNo:t.consultantMemberNo,fullName:t.consultantName,id:t.consultantMemberId})),e.formEmulationRule.dataTable=t.subContracts,Object(v["forEach"])(e.formEmulationRule.dataTable,(function(t){var a,s,r=t.basicAmount,i=t.extraAmount;return t.basicAmount=null===(a=e.$options.filters)||void 0===a?void 0:a.formatNumber(parseInt(r)),t.extraAmount=null===(s=e.$options.filters)||void 0===s?void 0:s.formatNumber(parseInt(i)),t}));var r={customerCifCode:t.customerCifCode,customerFullName:t.customerFullName,id:t.customerId};if(r.id?e.arrayCustomer.unshift(r):e.dataInput.customerId=t.customerFullName,t.bmbhId){var i=Object(v["filter"])(e.arrayBmbh,(function(e){return e.id==t.bmbhId}));if(i.length>0)e.dataInput.bmbhId=parseInt(t.bmbhId);else{var o={customerCifCode:t.bmbhCifCode,customerFullName:t.bmbhFullName,id:parseInt(t.bmbhId)};e.arrayBmbh.push(o),e.dataInput.bmbhId=parseInt(t.bmbhId)}}var c="id",l=Object(n["a"])(new Map(e.saleMembersListConsultantMember.map((function(t){return[t[c],t]}))).values()),u=Object(n["a"])(new Map(e.arrayCustomer.map((function(t){return[t[c],t]}))).values());e.saleMembersListConsultantMember=l,e.arrayCustomer=u}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getContractDetail",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.api.getDataDetail(null===(e=this.dataProp)||void 0===e?void 0:e.bankContractNo).then((function(t){var e,s;a.contractDetail=t,a.dataInput.certCode=t.consultantNo,a.dataInput.feeType=t.feeType,a.dataInput.customerChannel=t.customerChannel,a.dataInput.payFeeDate=null===(e=a.$options.filters)||void 0===e?void 0:e.formatDateHourReverse(t.payFeeDate),a.dataInput.issueDate=null===(s=a.$options.filters)||void 0===s?void 0:s.formatDateHourReverse(t.issueDate),a.description=t.description,a.dataInput.contractNo=t.contractNo,a.dataInput.applyFormNo=t.applyFormNo,a.dataInput.loanCode=t.loanCode,a.dataInput.numOfFeeYear=t.numOfFeeYear,a.dataInput.currentFeeYear=t.currentFeeYear,a.dataInput.numOfContractYear=t.numOfContractYear,a.dataInput.currentContractYear=t.currentContractYear,a.dataInput.paymentPeriod=String(t.paymentPeriod),a.dataInput.customerType=t.customerType,a.dataInput.customerId=t.customerId,a.dataInput.beneficiaryName=t.beneficiaryName,a.dataInput.consultantMemberId=t.consultantMemberId,a.refMemberId=t.refMemberId,t.transactionOfficeId&&(a.dataInput.transactionOfficeId=t.transactionOfficeId,a.saleMembersListTransactionOffice.unshift({locationCode:t.transactionOfficeCode,name:t.transactionOfficeName,id:t.transactionOfficeId}),a.getAllListMemBer(t.transactionOfficeId),t.salesMemberId&&(a.saleMembersList.unshift({memberNo:t.salesMemberNo,fullName:t.salesFullName,id:t.salesMemberId,phone:t.salesMobilePhone,refWorkPhone:t.salesWorkPhone,email:t.salesEmail}),a.dataInput.salesMemberId=parseInt(t.salesMemberId)),t.refMemberId&&a.saleMembersListRefMember.unshift({memberNo:t.refMemberNo,fullName:t.refFullName,id:t.refMemberId,phone:t.refMobilePhone,refWorkPhone:t.refWorkPhone,email:t.refEmail}),t.consultantMemberId&&a.saleMembersListConsultantMember.unshift({memberNo:t.consultantMemberNo,fullName:t.consultantName,id:t.consultantMemberId})),a.formEmulationRule.dataTable=t.subContracts,Object(v["forEach"])(a.formEmulationRule.dataTable,(function(t){var e,s,r=t.basicAmount,i=t.extraAmount;return t.basicAmount=null===(e=a.$options.filters)||void 0===e?void 0:e.formatNumber(parseInt(r)),t.extraAmount=null===(s=a.$options.filters)||void 0===s?void 0:s.formatNumber(parseInt(i)),t}));var r={customerCifCode:t.customerCifCode,customerFullName:t.customerFullName,id:t.customerId};if(r.id?a.arrayCustomer.unshift(r):a.dataInput.customerId=t.customerFullName,t.bmbhId){var i=Object(v["filter"])(a.arrayBmbh,(function(e){return e.id==t.bmbhId}));if(i.length>0)a.dataInput.bmbhId=parseInt(t.bmbhId);else{var o={customerCifCode:t.bmbhCifCode,customerFullName:t.bmbhFullName,id:parseInt(t.bmbhId)};a.arrayBmbh.push(o),a.dataInput.bmbhId=parseInt(t.bmbhId)}}var c="id",l=Object(n["a"])(new Map(a.arrayCustomer.map((function(t){return[t[c],t]}))).values());a.arrayCustomer=l,t.offerProgramId&&(a.dataInput.offerProgramId=parseInt(t.offerProgramId))}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSizeChange",value:function(t){this.table.limit=t}},{key:"summaryMethod",value:function(t){var e=this,a=t.columns,s=[];return Object(v["forEach"])(a,(function(t,a){var r,i,n,o;a<1?s[a]="":1!==a?2!==a?3!==a?4!==a?5!==a||(s[a]=null===(r=e.$options.filters)||void 0===r?void 0:r.formatNumber(e.totalBasicAmount+10*e.totalBasicExtraAmount/100)):s[a]=null===(i=e.$options.filters)||void 0===i?void 0:i.formatNumber(e.totalBasicAmount+e.totalBasicExtraAmount):s[a]=null===(n=e.$options.filters)||void 0===n?void 0:n.formatNumber(e.totalBasicExtraAmount):s[a]=null===(o=e.$options.filters)||void 0===o?void 0:o.formatNumber(e.totalBasicAmount):s[a]="Tổng"})),s}},{key:"handleAddRule",value:function(){var t={};this.formEmulationRule.dataTable.push(t)}},{key:"handleDeleteRule",value:function(t){var e=this.formEmulationRule.dataTable.indexOf(t);this.formEmulationRule.dataTable.splice(e,1),this.handleTotal()}},{key:"getIndex",value:function(){this.index=this.formEmulationRule.dataTable.length-1}},{key:"getSalesMember",value:function(){var t=this,e=Object(v["filter"])(this.saleMembersList,(function(e){return e.id==t.user.memberId}));if(e.length)this.dataInput.salesMemberId=this.user.memberId;else{var a={id:this.user.memberId,memberNo:this.user.memberNo,fullName:this.user.fullName};this.saleMembersList.push(a),this.dataInput.salesMemberId=this.user.memberId}}},{key:"getTransOffice",value:function(){var t=this,e=Object(v["filter"])(this.saleMembersListTransactionOffice,(function(e){return e.id==t.user.transactionOfficeId}));if(e.length)this.dataInput.transactionOfficeId=this.user.transactionOfficeId;else{var a={id:this.user.transactionOfficeId,locationCode:this.user.transactionOfficeCode,name:this.user.transactionOfficeName};this.saleMembersListTransactionOffice.push(a),this.dataInput.transactionOfficeId=this.user.transactionOfficeId}this.getAllIdMember(this.user.transactionOfficeId)}},{key:"getAllIdMember",value:function(t){var e=this;this.apiEmployee.getEmployeeList({i:0,ps:20,memberType:"CONSULTANT",locationId:t}).then((function(t){e.saleMembersListConsultantMember=t.data||[]})),this.apiEmployee.getEmployeeList({i:0,ps:20,memberType:"SALES",locationId:t}).then((function(t){e.saleMembersList=t.data||[]}))}},{key:"created",value:function(){var t,e,a,s,r,i,n=this;this.apiEmployee=Object(f["a"])("employee",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.api=Object(f["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(s=a.districts)||void 0===s?void 0:s[0].id}),this.apiParam=Object(f["a"])("param",{districtId:null===(r=this.user)||void 0===r||null===(i=r.districts)||void 0===i?void 0:i[0].id}),this.locationRes=Object(f["a"])("location",{districtId:this.districtId}),this.apiDeal=Object(f["a"])("deal",{districtId:this.districtId}),this.apiOffer=Object(f["a"])("offer",{districtId:this.districtId}),this.apiCategory=Object(f["a"])("category",{districtId:this.districtId}),N["a"].$on("pushIdCustomer",(function(t){n.arrayCustomer=[],n.apiDeal.getCustomer({page:1,limit:20}).then((function(e){n.arrayCustomer=e.data.content;var a=Object(v["filter"])(e.data.content,(function(e){return e.id==t.id}));a.length>0||n.arrayCustomer.push(t),n.dataInput.customerId=t.id}))})),N["a"].$on("pushIdBmbh",(function(t){n.arrayBmbh=[],n.apiDeal.getCustomer({page:1,limit:20}).then((function(e){n.arrayBmbh=e.data.content;var a=Object(v["filter"])(e.data.content,(function(e){return e.id==t.id}));a.length>0||n.arrayBmbh.push(t),n.dataInput.bmbhId=t.id}))}))}},{key:"handleAddCustomer",value:function(t){"bmbh"==t&&(this.dataPropBmbh.title="Thêm mới bên mua bảo hiểm",this.dataPropBmbh.code="add",this.setOpenPopup({popupName:"addbmbh-popup",isOpen:!0})),"customer"==t&&(this.dataPropCustomer.title="Thêm mới khách hàng",this.dataPropCustomer.code="add",1==this.dataInput.customerType||4==this.dataInput.customerType?N["a"].$emit("checkNullCif"):N["a"].$emit("checkNullCif2"),this.setOpenPopup({popupName:"addcustomer-popup",isOpen:!0}))}},{key:"saveCustomer",value:function(t){t&&t.id>0&&(this.arrayCustomer.unshift({id:t.id,customerCifCode:t.customerCifCode,customerFullName:t.customerFullName,address:t.address}),this.dataInput.customerId=t.id)}},{key:"saveBmbh",value:function(t){t&&t.id>0&&(this.arrayBmbh.unshift({id:t.id,customerCifCode:t.customerCifCode,customerFullName:t.customerFullName}),this.dataInput.bmbhId=t.id)}},{key:"loadMoreProduct",value:function(){this.queryDropProduct.queryProduct.page+=1;var t=Object(v["debounce"])(this.getProductList,500);t()}},{key:"handleProduct",value:function(){var t=this;this.queryDropProduct.queryProduct.search="",this.queryDropProduct.queryProduct.page=1,this.queryDropProduct.queryProduct.limit=20,this.api.getProduct(this.queryDropProduct.queryProduct).then((function(e){t.arrayProduct=e.data.content}))}},{key:"addProduct",value:function(t,e){var a=Object(v["filter"])(this.arrayProduct,(function(t){return t.id==e}));a.length>0&&(this.formEmulationRule.dataTable[t].productType=a[0].productType,this.formEmulationRule.dataTable[t].code=a[0].categoryCode)}},{key:"remoteProduct",value:function(t){var e=this;this.queryDropProduct.queryProduct.search=t,this.queryDropProduct.queryProduct.page=1,this.queryDropProduct.queryProduct.limit=20,this.api.getProduct(this.queryDropProduct.queryProduct).then((function(t){e.arrayProduct=t.data.content}))}},{key:"getProductList",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.api.getProduct(this.queryDropProduct.queryProduct).then((function(t){if(e.arrayProduct=[].concat(Object(n["a"])(e.arrayProduct),Object(n["a"])(t.data.content)),"edit-auditing"==e.dataProp.code||"edit"==e.dataProp.code||"add"==e.dataProp.code){var a=e.formEmulationRule.dataTable.map((function(t){return{id:t.productId,productName:t.productName,productCode:t.productCode,totalAmount:t.totalAmount,extraAmount:t.extraAmount,basicAmount:t.basicAmount}})),s=[].concat(Object(n["a"])(e.arrayProduct),Object(n["a"])(a)),r=Object(n["a"])(new Map(s.map((function(t){return[t["id"],t]}))).values());e.arrayProduct=r}}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"loadMoreSaleMember",value:function(){this.querySaleMember.i+=20;var t=Object(v["debounce"])(this.getSaleMember,500);t(this.querySaleMember.search,!0)}},{key:"remoteSaleMembers",value:function(t){this.querySaleMember.search=Object(v["trim"])(t),this.querySaleMember.i=0;var e=Object(v["debounce"])(this.getSaleMember,500);e(t)}},{key:"getSaleMember",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,s,r,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=i.length>1&&void 0!==i[1]&&i[1],t.prev=1,t.next=4,this.apiEmployee.getEmployeeList({search:Object(v["trim"])(e),i:this.querySaleMember.i,ps:this.querySaleMember.ps,memberType:"SALES",locationId:this.dataInput.transactionOfficeId});case 4:s=t.sent,a?(r=s.data||[],this.saleMembersList=[].concat(Object(n["a"])(this.saleMembersList),Object(n["a"])(r))):this.saleMembersList=s.data||[],this.isLoading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),this.isLoading=!1,this.saleMembersList=[];case 13:case"end":return t.stop()}}),t,this,[[1,9]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadMoreTransactionOffice",value:function(){this.queryLocation.i+=20,this.queryLocation.ps=20;var t=Object(v["debounce"])(this.getTransactionOffice,500);t(this.queryLocation.search,!0)}},{key:"remoteTransactionOffice",value:function(t){this.queryLocation.search=Object(v["trim"])(t),this.queryLocation.i=0,this.queryLocation.ps=20;var e=Object(v["debounce"])(this.getTransactionOffice,500);e(t)}},{key:"getTransactionOffice",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,s,r,i,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=o.length>1&&void 0!==o[1]&&o[1],t.prev=1,t.next=4,null===(s=this.locationRes)||void 0===s?void 0:s.list("office",{search:Object(v["trim"])(e),i:this.queryLocation.i,ps:this.queryLocation.ps});case 4:r=t.sent,a?(i=r||[],this.saleMembersListTransactionOffice=[].concat(Object(n["a"])(this.saleMembersListTransactionOffice),Object(n["a"])(i))):this.saleMembersListTransactionOffice=r||[],t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),this.isLoading=!1,this.saleMembersListTransactionOffice=[];case 12:case"end":return t.stop()}}),t,this,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadMoreConsultantMember",value:function(){this.queryConsulantMember.ps=20,this.queryConsulantMember.i+=20;var t=Object(v["debounce"])(this.getConsultantMember,500);t(this.queryConsulantMember.search,!0)}},{key:"remoteConsultantMember",value:function(t){this.queryConsulantMember.search=Object(v["trim"])(t),this.queryConsulantMember.i=0,this.queryConsulantMember.ps=20;var e=Object(v["debounce"])(this.getConsultantMember,500);e(t)}},{key:"getConsultantMember",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,s,r,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=i.length>1&&void 0!==i[1]&&i[1],t.prev=1,t.next=4,this.apiEmployee.getEmployeeList({search:Object(v["trim"])(e),i:this.queryConsulantMember.i,ps:this.queryConsulantMember.ps,memberType:"CONSULTANT",locationId:this.dataInput.transactionOfficeId});case 4:s=t.sent,a?(r=s.data||[],this.saleMembersListConsultantMember=[].concat(Object(n["a"])(this.saleMembersListConsultantMember),Object(n["a"])(r))):this.saleMembersListConsultantMember=s.data||[],this.isLoading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),this.isLoading=!1,this.saleMembersListConsultantMember=[];case 13:case"end":return t.stop()}}),t,this,[[1,9]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadMoreOffer",value:function(){this.queryOffer.limit=20,this.queryOffer.page+=1;var t=Object(v["debounce"])(this.getListOffer,500);t(this.queryOffer.search,!0)}},{key:"remoteOffer",value:function(t){this.queryOffer.search=Object(v["trim"])(t),this.queryOffer.page=1,this.queryOffer.limit=20;var e=Object(v["debounce"])(this.getListOffer,500);e(t)}},{key:"getListOffer",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,s,r,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=i.length>1&&void 0!==i[1]&&i[1],t.prev=1,t.next=4,this.apiOffer.getOffer({search:Object(v["trim"])(e),page:this.queryOffer.page,limit:this.queryOffer.limit});case 4:s=t.sent,a?(r=s.content||[],this.optionsOffer=[].concat(Object(n["a"])(this.optionsOffer),Object(n["a"])(r))):this.optionsOffer=s.content||[],this.isLoading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),this.isLoading=!1,this.optionsOffer=[];case 13:case"end":return t.stop()}}),t,this,[[1,9]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadRefMember",value:function(){this.queryRefMember.ps=20,this.queryRefMember.i+=20;var t=Object(v["debounce"])(this.getRefMember,500);t(this.queryRefMember.search,!0)}},{key:"remoteRefMember",value:function(t){this.queryRefMember.search=Object(v["trim"])(t),this.queryRefMember.i=0,this.queryRefMember.ps=20;var e=Object(v["debounce"])(this.getRefMember,500);e(t)}},{key:"getRefMember",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,s,r,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=i.length>1&&void 0!==i[1]&&i[1],t.prev=1,t.next=4,this.apiEmployee.getEmployeeList({search:Object(v["trim"])(e),i:this.queryRefMember.i,ps:this.queryRefMember.ps,memberType:"REF",locationId:this.dataInput.transactionOfficeId});case 4:s=t.sent,a?(r=s.data||[],this.saleMembersListRefMember=[].concat(Object(n["a"])(this.saleMembersListRefMember),Object(n["a"])(r))):this.saleMembersListRefMember=s.data||[],this.isLoading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),this.isLoading=!1,this.saleMembersListRefMember=[];case 13:case"end":return t.stop()}}),t,this,[[1,9]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadMoreCustomer",value:function(){this.queryCustomer.page+=1,this.queryCustomer.limit=20;var t=Object(v["debounce"])(this.getCustomerList,500);t(this.queryCustomer.search,!0)}},{key:"remoteCustomer",value:function(t){this.queryCustomer.search=Object(v["trim"])(t),this.queryCustomer.page=1,this.queryCustomer.limit=20;var e=Object(v["debounce"])(this.getCustomerList,500);e(t)}},{key:"getCustomerList",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,s,r,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=i.length>1&&void 0!==i[1]&&i[1],t.prev=1,t.next=4,this.apiDeal.getCustomer({search:Object(v["trim"])(e),page:this.queryCustomer.page,limit:this.queryCustomer.limit});case 4:s=t.sent,a?(r=s.data.content||[],this.arrayCustomer=[].concat(Object(n["a"])(this.arrayCustomer),Object(n["a"])(r))):this.arrayCustomer=s.data.content||[],t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),this.isLoading=!1,this.arrayCustomer=[];case 12:case"end":return t.stop()}}),t,this,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadMoreBmbh",value:function(){this.queryBmbh.page+=1,this.queryBmbh.limit=20;var t=Object(v["debounce"])(this.getBmbhList,500);t(this.queryBmbh.search,!0)}},{key:"remoteBmbh",value:function(t){this.queryBmbh.search=Object(v["trim"])(t),this.queryBmbh.page=1,this.queryBmbh.limit=20;var e=Object(v["debounce"])(this.getBmbhList,500);e(t)}},{key:"getBmbhList",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,s,r,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=i.length>1&&void 0!==i[1]&&i[1],t.prev=1,t.next=4,this.apiDeal.getCustomer({search:Object(v["trim"])(e),page:this.queryBmbh.page,limit:this.queryBmbh.limit});case 4:s=t.sent,a?(r=s.data.content||[],this.arrayBmbh=[].concat(Object(n["a"])(this.arrayBmbh),Object(n["a"])(r))):this.arrayBmbh=s.data.content||[],t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),this.isLoading=!1,this.arrayBmbh=[];case 12:case"end":return t.stop()}}),t,this,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getAllListCustomer",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.apiDeal.getCustomer({page:this.queryBmbh.page,limit:this.queryBmbh.limit});case 3:e=t.sent,this.arrayCustomer=e.data.content,this.arrayBmbh=e.data.content,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"resetAllQuery",value:function(){this.querySaleMember={i:0,ps:20,search:""},this.queryConsulantMember={i:0,ps:20,search:""},this.queryOffer={page:1,limit:20,search:""},this.queryRefMember={i:0,ps:20,search:""},this.queryLocation={i:0,ps:20,search:"",type:3},this.queryCustomer={limit:20,page:1,search:""},this.queryBmbh={limit:20,page:1,search:""}}},{key:"initData",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.apiParam.getParamRelationship().then((function(t){e.optionsRelationship=t.data}));case 2:return t.next=4,this.apiParam.getEmulationProgramSource().then((function(t){e.typeProgramSource=t.data}));case 4:return t.next=6,this.apiParam.getEmulationApplyFeeTypel().then((function(t){e.typeApplyFee=t.data}));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getRelationship",value:function(t){return y["RELATIONSHIP_TYPE"][t]}},{key:"getNameCustomerChannel",value:function(t){var e="";return"DAICHI"===t&&(e="E-app"),"BANK"===t&&(e="Truyền thống"),e}},{key:"handleTotal",value:function(){var t=this;this.totalBasicAmount=0,this.totalBasicExtraAmount=0,Object(v["forEach"])(this.formEmulationRule.dataTable,(function(e){e.basicAmount&&(t.totalBasicAmount+=parseFloat(e.basicAmount.replace(/,/g,""))),e.extraAmount&&(t.totalBasicExtraAmount+=parseFloat(e.extraAmount.replace(/,/g,"")))}))}},{key:"numberFormat",value:function(t,e,a){var s=t,r=s.target.value;if(r.length>0){var i,n;if("-"===r)if(r=parseInt(r),!isNaN(r))r=null===(n=this.$options.filters)||void 0===n?void 0:n.formatNumber(r),s.target.value=r,this.formEmulationRule.dataTable[e][a]=r;r=r.replaceAll(",",""),r=parseInt(r),r=null===(i=this.$options.filters)||void 0===i?void 0:i.formatNumber(r),s.target.value=r,this.formEmulationRule.dataTable[e][a]=r}this.handleTotal()}},{key:"getTotal",value:function(t,e){var a,s=0;return t&&(s+=parseFloat(t.replace(/,/g,""))),e&&(s+=parseFloat(e.replace(/,/g,""))),null===(a=this.$options.filters)||void 0===a?void 0:a.formatNumber(s)}},{key:"getFYP",value:function(t,e){var a,s=0;return t&&(s+=parseFloat(t.replace(/,/g,""))),e&&(s+=10*parseFloat(e.replace(/,/g,""))/100),null===(a=this.$options.filters)||void 0===a?void 0:a.formatNumber(s)}},{key:"getNameCustomer",value:function(t,e){var a="";return t&&e?a=t+" - "+e.toUpperCase():e&&(a=e.toUpperCase()),a}},{key:"getNameBmbh",value:function(t,e){var a="";return t&&e?a=t+" - "+e.toUpperCase():e&&(a=e.toUpperCase()),a}},{key:"getNameOffer",value:function(t,e){var a="";return a=t?t+" - "+e:e,a}},{key:"fillCode",value:function(){var t=this,e=Object(v["filter"])(this.saleMembersListConsultantMember,(function(e){return e.id===t.dataInput.consultantMemberId}));e.length>0&&(this.dataInput.certCode=e[0].certCode)}},{key:"changeTransactionOfficeId",value:function(){this.dataInput.salesMemberId="",this.dataInput.consultantMemberId="",this.dataInput.certCode="",this.dataInput.transactionOfficeId&&this.getAllIdMember(this.dataInput.transactionOfficeId)}},{key:"disabledExtraAmount",value:function(t){var e=!1;return"SUB"==t.row.productType||"9"===t.row.auditStatus?(t.row.extraAmount=0,e=!0):e=!1,e}},{key:"handleEditCustomer",value:function(t,e){e.stopPropagation(),this.dataPropCustomer.id=t,this.dataPropCustomer.title="Chỉnh sửa khách hàng",this.dataPropCustomer.code="edit",1==this.dataInput.customerType||4==this.dataInput.customerType?N["a"].$emit("checkNullCif"):N["a"].$emit("checkNullCif2"),this.setOpenPopup({popupName:"addcustomer-popup",isOpen:!0})}},{key:"handleEditBmbh",value:function(t,e){e.stopPropagation(),this.dataPropBmbh.id=t,this.dataPropBmbh.title="Chỉnh sửa bên mua bảo hiểm",this.dataPropBmbh.code="edit",this.setOpenPopup({popupName:"addbmbh-popup",isOpen:!0})}},{key:"handleFocusNameBmbh",value:function(){this.nameBmbh=""}},{key:"getAllListMemBer",value:function(t){var e=this;this.apiEmployee.getEmployeeList({i:this.querySaleMember.i,ps:this.querySaleMember.ps,memberType:"SALES",locationId:t}).then((function(t){e.saleMembersList=t.data})).catch((function(t){console.log(t),e.saleMembersList=[]})),this.apiEmployee.getEmployeeList({i:this.queryConsulantMember.i,ps:this.queryConsulantMember.ps,memberType:"CONSULTANT",locationId:t}).then((function(t){e.saleMembersListConsultantMember=t.data})).catch((function(t){console.log(t),e.saleMembersListConsultantMember=[]}))}}]),a}(Object(p["b"])(h["a"],b["a"]));Object(m["a"])([Object(p["c"])()],F.prototype,"dataProp",void 0),Object(m["a"])([w.State("user")],F.prototype,"user",void 0),Object(m["a"])([Object(p["e"])("dataInput.payFeeDate")],F.prototype,"checkPayFeeDate",null),Object(m["a"])([Object(p["e"])("dataInput.feeType")],F.prototype,"checkFeeType",null),Object(m["a"])([Object(p["e"])("dataInput.applyFormNo")],F.prototype,"checkContractNo",null),Object(m["a"])([Object(p["e"])("dataInput.contractNo")],F.prototype,"checkApplyFormNo",null),Object(m["a"])([Object(p["e"])("dataInput.customerType")],F.prototype,"checkType",null),Object(m["a"])([Object(p["e"])("dataInput.numOfFeeYear")],F.prototype,"convertNumOfFeeYear",null),Object(m["a"])([Object(p["e"])("dataInput.numOfContractYear")],F.prototype,"convertNumOfContractYear",null),Object(m["a"])([Object(p["e"])("dataInput.currentFeeYear")],F.prototype,"convertCurrentFeeYear",null),Object(m["a"])([Object(p["e"])("dataInput.customerChannel")],F.prototype,"fillHSYCBH",null),Object(m["a"])([Object(p["e"])("dataInput.consultantMemberId")],F.prototype,"clearCertCode",null),Object(m["a"])([Object(p["e"])("dataInput.transactionOfficeId")],F.prototype,"fillGetRefMember",null),F=Object(m["a"])([Object(p["a"])({components:{AddCustomer:g["a"],AddBmbh:x}})],F);var T=F,A=T,S=(a("4f79"),Object(P["a"])(A,s,r,!1,null,"4a17d8f8",null));e["a"]=S.exports},"567c":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"search flex"},[a("base-icon",{staticClass:"icon-search",attrs:{icon:"search"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.valueSearch,expression:"valueSearch"}],staticClass:"searchBar",attrs:{type:"text",placeholder:"Tìm kiếm..."},domProps:{value:t.valueSearch},on:{input:function(e){e.target.composing||(t.valueSearch=e.target.value)}}})],1)},r=[],i=a("f3f3"),n=a("276c"),o=a("e954"),c=a("920b"),l=a("92a6"),u=(a("ac1f"),a("841c"),a("b0c0"),a("9ab4")),d=a("2ef0"),m=a("1b40"),p=a("4bb5"),h=Object(p["a"])("beAudit"),f=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(n["a"])(this,a),t=e.apply(this,arguments),t.valueSearch=t.search,t.searchText=Object(d["debounce"])((function(e){t.$emit("search",Object(d["trim"])(e))}),500),t}return Object(o["a"])(a,[{key:"handleSearch",value:function(t){var e;if(t!==this.search&&this.searchText(t),null!==(e=this.$route)&&void 0!==e&&e.name){var a=this.getFilter(this.$route.name);a?this.setReportFilter({contract:this.$route.name,filters:Object(i["a"])(Object(i["a"])({},a.filters),{},{search:Object(d["trim"])(t)})}):this.setReportFilter({contract:this.$route.name,filters:{search:Object(d["trim"])(t)}})}}},{key:"checkRoute",value:function(t){this.init(t)}},{key:"init",value:function(t){var e=this.getFilter(t.name);e&&e.filters?this.valueSearch=e.filters.search:this.valueSearch=""}}]),a}(m["d"]);Object(u["a"])([h.Getter("getFilter")],f.prototype,"getFilter",void 0),Object(u["a"])([h.Action("setReportFilter")],f.prototype,"setReportFilter",void 0),Object(u["a"])([Object(m["c"])({default:"",required:!1})],f.prototype,"search",void 0),Object(u["a"])([Object(m["e"])("valueSearch",{immediate:!1})],f.prototype,"handleSearch",null),Object(u["a"])([Object(m["e"])("$route")],f.prototype,"checkRoute",null),f=Object(u["a"])([Object(m["a"])({components:{}})],f);var b=f,v=b,C=(a("61d3"),a("2877")),y=Object(C["a"])(v,s,r,!1,null,"f42d5708",null);e["a"]=y.exports},"61d3":function(t,e,a){"use strict";a("48c2")},7836:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"flex",attrs:{name:"popup-confirm",width:"420px",open:t.handleOpen,hiddenFooter:!0}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("Xác nhận Hủy")]),a("div",{staticClass:"body-content"},[t._v(" Bạn có chắc chắn muốn hủy hợp đồng "),t.dataProp&&t.dataProp.message?a("br"):t._e(),a("b",[t._v(t._s(t.dataProp&&t.dataProp.message?t.dataProp.message:""))]),t._v("? ")]),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex jc-flex-end"},[a("div",{},[a("el-button",{staticClass:"be-button-unset",attrs:{size:"mini"},on:{click:t.handleCancel}},[t._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:t.handleConfirm}},[t._v("Xác nhận")])],1)])])])],2)},r=[],i=a("276c"),n=a("e954"),o=a("920b"),c=a("92a6"),l=a("9ab4"),u=a("1b40"),d=a("9f48"),m=a("c56f"),p=function(t){Object(o["a"])(a,t);var e=Object(c["a"])(a);function a(){return Object(i["a"])(this,a),e.apply(this,arguments)}return Object(n["a"])(a,[{key:"handleCancel",value:function(){this.setOpenPopup({popupName:"popup-confirm",isOpen:!1})}},{key:"handleConfirm",value:function(){this.$emit("confirm")}},{key:"handleOpen",value:function(){console.log("open")}},{key:"handleClose",value:function(){console.log("close")}}]),a}(Object(u["b"])(d["a"],m["a"]));Object(l["a"])([Object(u["c"])()],p.prototype,"dataProp",void 0),p=Object(l["a"])([Object(u["a"])({components:{}})],p);var h=p,f=h,b=(a("c77f"),a("2877")),v=Object(b["a"])(f,s,r,!1,null,"1e31216e",null);e["a"]=v.exports},"9a0c":function(t,e,a){var s=a("342f");t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(s)},"9d58":function(t,e,a){"use strict";a("19f1")},"9fc4":function(t,e,a){"use strict";a("e741")},b41e:function(t,e,a){},bf7b:function(t,e,a){},c77f:function(t,e,a){"use strict";a("0a19")},d9b0:function(t,e,a){"use strict";a("4a22")},de10:function(t,e,a){},e741:function(t,e,a){},e9bb:function(t,e,a){"use strict";a("bf7b")},f719:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"action",attrs:{name:"actionContract",open:t.handleOpen,close:t.handleClose,hiddenFooter:!0,width:"370px"}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s("date"===t.type?"Cập nhật ngày bàn giao HĐ":"Cập nhật ngày phát hành HĐ"))]),a("div",{staticClass:"body-content"},[a("el-form",{ref:"dataAction",staticClass:"form_customer customerr",attrs:{model:t.dataAction,rules:t.rules}},[a("el-form-item",{staticClass:"itemlabel w-100",attrs:{label:"date"===t.type?"Ngày bàn giao HĐ":"Ngày phát hành HĐ",prop:"valueDate"}},[a("el-date-picker",{staticClass:"dateTime w-100",attrs:{type:"date",format:"dd/MM/yyyy","value-format":"yyyy-MM-dd",placeholder:"Chọn ngày"},model:{value:t.dataAction.valueDate,callback:function(e){t.$set(t.dataAction,"valueDate",e)},expression:"dataAction.valueDate"}})],1)],1)],1),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex"},[a("div",{staticClass:"bt-center"},[a("el-button",{staticClass:"be-button-unset",attrs:{size:"mini"},on:{click:t.handleClose}},[t._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:t.handleSave}},[t._v("Lưu")])],1)])])])],2)},r=[],i=a("276c"),n=a("e954"),o=a("920b"),c=a("92a6"),l=(a("a15b"),a("9ab4")),u=a("1b40"),d=a("08ba"),m=a("4bb5"),p=a("9f48"),h=a("2ef0"),f=a("1f2a"),b=Object(m["a"])("beUser"),v=function(t){Object(o["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(i["a"])(this,a),t=e.apply(this,arguments),t.contract={},t.params={},t.rules={valueDate:[{required:!0,message:"Vui lòng chọn ngày bàn giao HĐ",trigger:"blur"}]},t.dataAction={valueDate:""},t}return Object(n["a"])(a,[{key:"handleOpen",value:function(){var t,e,a;if(null===(t=this.$refs["dataAction"])||void 0===t||t.resetFields(),"multi"===this.status){if(this.select.length>1)if(this.select[0].applyFormNo!=this.select[1].applyFormNo)this.dataAction.valueDate="";else if(this.select[this.select.length-1].applyFormNo!=this.select[this.select.length-2].applyFormNo)this.dataAction.valueDate="";else{var s,r;this.dataAction.valueDate="date"===this.type?null===(s=this.$options.filters)||void 0===s?void 0:s.formatDateHourReverse(this.select[0].handOverDate):null===(r=this.$options.filters)||void 0===r?void 0:r.formatDateHourReverse(this.select[0].issueDate)}else if(1==this.select.length){var i,n;this.dataAction.valueDate="date"===this.type?null===(i=this.$options.filters)||void 0===i?void 0:i.formatDateHourReverse(this.select[0].handOverDate):null===(n=this.$options.filters)||void 0===n?void 0:n.formatDateHourReverse(this.select[0].issueDate)}}else this.dataAction.valueDate="date"===this.type?null===(e=this.$options.filters)||void 0===e?void 0:e.formatDateHourReverse(this.action.handOverDate):null===(a=this.$options.filters)||void 0===a?void 0:a.formatDateHourReverse(this.action.issueDate)}},{key:"handleClose",value:function(){this.dataAction.valueDate="",this.setOpenPopup({popupName:"actionContract",isOpen:!1}),this.$emit("close"),this.$emit("update")}},{key:"handleSave",value:function(){var t=this,e={},a=[],s=[],r="",i="";"row"===this.status?(e.bankContractNoArray=this.action.bankContractNo,e.contractNoArray=this.action.contractNo,"date"===this.type?e.handOverDate=this.dataAction.valueDate:e.issueDate=this.dataAction.valueDate):(Object(h["forEach"])(this.select,(function(t){t.contractNo&&a.push(t.contractNo),s.push(t.bankContractNo)})),i=s.join(","),r=a.join(","),e.bankContractNoArray=i,e.contractNoArray=r,"date"===this.type?e.handOverDate=this.dataAction.valueDate:e.issueDate=this.dataAction.valueDate);var n=this.$refs.dataAction;console.log("param",e);var o="date"===this.type?"Cập nhật ngày bàn giao HĐ thành công":"Cập nhật ngày phát hành HĐ thành công";n.validate((function(a){if(!a)return console.log("error validate data!"),!1;t.apiContract.updateAuditSelect(e).then((function(e){t.$message.success(o),t.$emit("saveSuccess",e.data),t.$emit("reset"),t.handleClose(),f["a"].$emit("reloadDetail")})).catch((function(e){t.$message.error(e.message)}))}))}},{key:"created",value:function(){var t,e;this.apiContract=Object(d["a"])("contract",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id})}}]),a}(Object(u["b"])(p["a"]));Object(l["a"])([Object(u["c"])({required:!1,type:Object,default:{}})],v.prototype,"action",void 0),Object(l["a"])([Object(u["c"])({required:!1,type:Array,default:[]})],v.prototype,"select",void 0),Object(l["a"])([Object(u["c"])({required:!1,type:String,default:"row"})],v.prototype,"status",void 0),Object(l["a"])([Object(u["c"])({required:!1,type:String,default:"issue"})],v.prototype,"type",void 0),Object(l["a"])([b.State("user")],v.prototype,"user",void 0),v=Object(l["a"])([Object(u["a"])({components:{}})],v);var C=v,y=C,g=(a("e9bb"),a("2877")),I=Object(g["a"])(y,s,r,!1,null,null,null);e["a"]=I.exports}}]);
//# sourceMappingURL=chunk-18fe2b4b.f88d30d5.js.map