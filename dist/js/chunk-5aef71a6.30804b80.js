(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5aef71a6"],{"0c64":function(t,e,a){"use strict";a("54a5")},"13fb":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"style_cancer_pop",attrs:{name:"cancel-popup",width:"1240px","max-height:75vh":"",top:"5vh",open:t.handleOpen,close:t.handleClose}},[a("div",{staticClass:"style_send_Approve",attrs:{slot:"title"},slot:"title"},[t._v(t._s("yeu-cau-hieu-chinh"==t.$route.name?"Từ chối hiệu chỉnh":"Từ chối"))]),a("div",{staticClass:"textbutton flex jc-space-between"},[a("div",{staticClass:"content"},[t._v(t._s("yeu-cau-hieu-chinh"==t.$route.name?"Danh sách yêu cầu hiệu chỉnh":"Danh sách chờ phê duyệt"))]),a("div",{},[a("el-button",{staticClass:"be-btn-danger",attrs:{type:"warning",loading:t.isBtnLoading},on:{click:function(e){return t.handleConfirm()}}},[t._v(t._s("yeu-cau-hieu-chinh"==t.$route.name?"Từ chối hiệu chỉnh":"Từ chối"))])],1)]),a("div",{staticClass:"dataa"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Số hợp đồng")]),a("div",{staticClass:"number-data"},[t._v(t._s(this.summary.numOfContract))])]),a("div",{staticClass:"be-flex number"},[a("div",{staticClass:"contractnumber"},[t._v("Số NVKD")]),a("div",{staticClass:"number-data"},[t._v(t._s(this.summary.numOfSalesMember))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng phí năm")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(this.summary.totalAmount)))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng IP")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(this.summary.ipAmount)))])])])]),a("div",{staticClass:"tabledata"},[a("base-table",{attrs:{border:"",data:t.dataSelect.length>0?t.dataSelect:t.tableData,showPagination:!0,table:t.dataSelect.length>0?t.selectQuery:t.pageQuery,paginationInfo:"hợp đồng"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,selectionChange:t.handleSelection,filterChange:t.handleFilter}},[a("el-table-column",{attrs:{prop:"applyFormNo",label:"Số HSYCBH",width:"110",align:"left"}}),a("el-table-column",{attrs:{prop:"contractNo",label:"Số HĐBH",width:"120",align:"left"}}),a("el-table-column",{attrs:{prop:"branchName",label:"Chi nhánh",width:"210"}}),a("el-table-column",{attrs:{label:"Đơn vị kinh doanh",prop:"transactionOfficeName",width:"210"}}),a("el-table-column",{attrs:{prop:"salesMemberNo",label:"Mã NVTV",width:"110",align:"left"}}),a("el-table-column",{attrs:{label:"NV tư vấn",prop:"salesFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"customerCifCode",label:"Số CIF",width:"110",align:"center"}}),a("el-table-column",{attrs:{label:"Tên BMBH",prop:"customerFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"productCode",label:"Mã SP",width:"100",align:"center"}}),a("el-table-column",{attrs:{label:"Sản phẩm",prop:"productName","min-width":"210"}}),a("el-table-column",{staticClass:"checkLength",attrs:{label:"Phí năm (APE)",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.apeAmount)))]}}])}),a("el-table-column",{attrs:{label:"Trạng thái",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.auditStatus?a("span",{staticClass:"not-approve cell-status"},[t._v("Chưa đối soát")]):t._e(),"2"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Đang đối soát")]):t._e(),"3"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Chờ duyệt")]):t._e(),"4"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Đã duyệt")]):t._e(),"5"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),"6"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối duyệt")]):t._e(),"7"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối hiệu chỉnh")]):t._e(),"8"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Hiệu chỉnh")]):t._e(),"8"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Khớp")]):t._e()]}}])}),a("el-table-column",{attrs:{width:"180",label:"NGÀY PH",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDateTime")(e.row.issueDate)))])]}}])})],1)],1)])},s=[],n=a("f3f3"),r=a("c964"),o=a("276c"),l=a("e954"),u=a("920b"),c=a("92a6"),d=(a("96cf"),a("b0c0"),a("a15b"),a("d81d"),a("ac1f"),a("1276"),a("a434"),a("9ab4")),h=a("1b40"),p=a("08ba"),m=a("4bb5"),f=a("9f48"),b=Object(m["a"])("beUser"),v=function(t){Object(u["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(o["a"])(this,a),t=e.apply(this,arguments),t.total=0,t.data={},t.summary={},t.isLoading=!1,t.tableData=[],t.updateValue={newAuditStatus:6},t.pageQuery={page:1,search:"",limit:20,total:0,orderByClause:""},t.selectQuery={page:1,search:"",limit:20,total:0,orderByClause:""},t.newquery={areaIdArray:[],branchIdArray:[],transOfficeIdArray:[],salesMemberIdArray:[],consultantMemberIdArray:[],refMemberIdArray:[],productIdArray:[],paymentPeriod:"",currentContractYear:"",currentFeeYear:"",numOfContractYear:"",salesChannel:"",consultantType:"",customerType:"",contractStatus:"",expireStatus:"",auditStatus:3,fromApplyFormDate:"",toApplyFormDate:"",fromIssueDate:"",toIssueDate:"",fromLastPayDate:"",toLastPayDate:"",fromExpireDate:"",toExpireDate:"",fromBasicAmount:"",toBasicAmount:"",fromExtraAmount:"",toExtraAmount:"",fromTotalAmount:"",toTotalAmount:""},t.params={searchType:"CONTRACT",auditStatus:"3",page:1,limit:20},t.newparams={searchType:"CONTRACT",auditStatus:"3"},t.dataInput={keywordString:"",areaIdArray:[],branchIdArray:"",transOfficeIdArray:"",salesMemberIdArray:"",consultantMemberIdArray:"",refMemberIdArray:"",productIdArray:"",paymentPeriod:"",currentContractYear:"",currentFeeYear:"",numOfContractYear:"",salesChannel:"",consultantType:"",customerType:"",contractStatus:"",expireStatus:"",auditStatus:2,fromApplyFormDate:"",toApplyFormDate:"",fromIssueDate:"",toIssueDate:"",fromLastPayDate:"",toLastPayDate:"",fromExpireDate:"",toExpireDate:"",fromBasicAmount:"",toBasicAmount:"",fromExtraAmount:"",toExtraAmount:"",fromTotalAmount:"",toTotalAmount:""},t.newData={},t.pageInfor={total:1e3,page:1,limit:10},t.isBtnLoading=!1,t}return Object(l["a"])(a,[{key:"handleConfirm",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,i,s,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isBtnLoading=!0,this.query&&(this.query.auditStatus="yeu-cau-hieu-chinh"==this.$route.name?"5":"3",this.query.newAuditStatus="yeu-cau-hieu-chinh"==this.$route.name?"7":"6",this.query.limit="",this.query.page=""),!(this.dataSelect&&this.dataSelect.length>0)){t.next=9;break}return a=this.dataSelect.map((function(t){return t.bankContractNo})).join(","),i=this.dataSelect.map((function(t){return t.contractNo})).join(","),t.next=7,null===(e=this.api)||void 0===e?void 0:e.updateAuditSelect({bankContractNoArray:a,auditStatus:"yeu-cau-hieu-chinh"==this.$route.name?7:6,contractNoArray:i}).then((function(){n.tableData=[],n.$message.success("".concat("yeu-cau-hieu-chinh"==n.$route.name?"Từ chối hiệu chỉnh thành công":"Từ chối duyệt thành công"))})).catch((function(){n.$message.warning("".concat("yeu-cau-hieu-chinh"==n.$route.name?"Từ chối hiệu chỉnh thất bại":"Yêu cầu phê duyệt thất bại"))}));case 7:t.next=11;break;case 9:return t.next=11,null===(s=this.api)||void 0===s?void 0:s.updateAuditFilter(this.query).then((function(){n.tableData=[],n.$message.success("".concat("yeu-cau-hieu-chinh"==n.$route.name?"Từ chối hiệu chỉnh thành công":"Từ chối duyệt thành công"))})).catch((function(){n.$message.warning("".concat("yeu-cau-hieu-chinh"==n.$route.name?"Từ chối hiệu chỉnh thất bại":"Từ chối duyệt thất bại"))}));case 11:this.setOpenPopup({popupName:"cancel-popup",isOpen:!1}),this.isBtnLoading=!1,this.$emit("update");case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSelection",value:function(){}},{key:"handleSizeChange",value:function(t){this.params.page=1,this.params.limit=t,this.pageQuery.page=1,this.pageQuery.limit=t,this.selectQuery.page=1,this.selectQuery.limit=t,this.setData()}},{key:"handleCurrentChange",value:function(t){this.params.page=t,this.setData()}},{key:"checkLength",value:function(t){return t.split(" ").length>5?t.split(" ").splice(0,4).join(" ")+"...":t}},{key:"getDataSumary",value:function(){var t=this;if(this.dataSelect&&this.dataSelect.length>0){var e,a=this.dataSelect.map((function(t){return t.bankContractNo})).join(","),i=this.dataSelect.map((function(t){return t.contractNo})).join(",");null===(e=this.apiContract)||void 0===e||e.getSalaryContractSelect({bankContractNoArray:a,contractNoArray:i}).then((function(e){t.summary=e.data})).catch((function(){return t.isLoading=!1}))}else{var s;null===(s=this.apiContract)||void 0===s||s.getSalaryContract(this.query).then((function(e){t.summary=e.data})).catch((function(){return t.isLoading=!1}))}}},{key:"setData",value:function(){var t,e,a=this;this.dataSelect&&this.dataSelect.length>0&&(this.selectQuery.total=this.dataSelect.length),this.query.limit=this.params.limit,this.query.page=this.params.page,this.isLoading=!0,null===(t=this.apiContract)||void 0===t||t.getData(this.query).then((function(t){a.data=t,a.tableData=a.data.data,a.isLoading=!1,a.pageInfor.total=t.total})).catch((function(){return a.isLoading=!1})),null===(e=this.apiContract)||void 0===e||e.getContractCount(this.query).then((function(t){a.pageQuery.total=t.data,a.isLoading=!1})).catch((function(){return a.isLoading=!1}))}},{key:"init",value:function(){this.isLoading=!1}},{key:"created",value:function(){var t,e,a,i;this.api=Object(p["a"])("audit",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiContract=Object(p["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.init(),this.isLoading=!1}},{key:"handleOpen",value:function(){this.setData(),this.getDataSumary(),this.newquery=Object(n["a"])(Object(n["a"])({},this.query),this.updateValue)}},{key:"handleClose",value:function(){this.$emit("reset")}},{key:"handleChangeAction",value:function(){}},{key:"handleFilter",value:function(){}},{key:"filters",value:function(){}}]),a}(Object(h["b"])(f["a"]));Object(d["a"])([Object(h["c"])({required:!0,type:Object,default:{}})],v.prototype,"query",void 0),Object(d["a"])([Object(h["c"])({default:[]})],v.prototype,"dataSelect",void 0),Object(d["a"])([b.State("user")],v.prototype,"user",void 0),v=Object(d["a"])([Object(h["a"])({components:{}})],v);var y=v,g=y,C=(a("e762"),a("2877")),S=Object(C["a"])(g,i,s,!1,null,"03065e4a",null);e["a"]=S.exports},2647:function(t,e,a){},3956:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"style_cancer_pop",attrs:{name:"requestcancel-popup",width:"1240px","max-height:75vh":"",top:"5vh",open:t.handleOpen,close:t.handleClose}},[a("div",{staticClass:"style_send_Approve",attrs:{slot:"title"},slot:"title"},[t._v("Gửi yêu cầu hiệu chỉnh")]),a("div",{staticClass:"textbutton flex jc-space-between"},[a("div",{staticClass:"content"},[t._v("Danh sách chờ phê duyệt")]),a("div",{},[a("el-button",{staticClass:"be-btn-danger",attrs:{type:"warning",loading:t.isBtnLoading},on:{click:function(e){return t.handleConfirm()}}},[t._v("Từ chối")])],1)]),a("div",{staticClass:"dataa"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Số hợp đồng")]),a("div",{staticClass:"number-data"},[t._v(t._s(this.summary.numOfContract))])]),a("div",{staticClass:"be-flex number"},[a("div",{staticClass:"contractnumber"},[t._v("Số NVKD")]),a("div",{staticClass:"number-data"},[t._v(t._s(this.summary.numOfSalesMember))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng phí năm")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(this.summary.totalAmount)))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng IP")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(this.summary.ipAmount)))])])])]),a("div",{staticClass:"tabledata"},[a("base-table",{attrs:{border:"",data:t.dataSelect.length>0?t.dataSelect:t.tableData,showPagination:!0,table:t.dataSelect.length>0?t.selectQuery:t.pageQuery,paginationInfo:"hợp đồng"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,selectionChange:t.handleSelection,filterChange:t.handleFilter}},[a("el-table-column",{attrs:{prop:"applyFormNo",label:"Số HSYCBH",width:"110",align:"left"}}),a("el-table-column",{attrs:{prop:"contractNo",label:"Số HĐBH",width:"120",align:"left"}}),a("el-table-column",{attrs:{prop:"branchName",label:"Chi nhánh",width:"210"}}),a("el-table-column",{attrs:{label:"Đơn vị kinh doanh",prop:"transactionOfficeName",width:"210"}}),a("el-table-column",{attrs:{prop:"salesMemberNo",label:"Mã NVTV",width:"110",align:"left"}}),a("el-table-column",{attrs:{label:"NV tư vấn",prop:"salesFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"customerCifCode",label:"Số CIF",width:"110",align:"center"}}),a("el-table-column",{attrs:{label:"Tên BMBH",prop:"customerFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"productCode",label:"Mã SP",width:"100",align:"center"}}),a("el-table-column",{attrs:{label:"Sản phẩm",prop:"productName","min-width":"210"}}),a("el-table-column",{staticClass:"checkLength",attrs:{label:"Phí năm (APE)",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.apeAmount)))]}}])}),a("el-table-column",{attrs:{label:"Trạng thái",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.auditStatus?a("span",{staticClass:"not-approve cell-status"},[t._v("Chưa đối soát")]):t._e(),"2"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Đang đối soát")]):t._e(),"3"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Chờ duyệt")]):t._e(),"4"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Đã duyệt")]):t._e(),"5"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),"6"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối duyệt")]):t._e(),"7"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối hiệu chỉnh")]):t._e(),"8"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Hiệu chỉnh")]):t._e(),"9"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Khớp")]):t._e()]}}])}),a("el-table-column",{attrs:{width:"180",label:"NGÀY PH",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDateTime")(e.row.issueDate)))])]}}])})],1)],1)])},s=[],n=a("f3f3"),r=a("c964"),o=a("276c"),l=a("e954"),u=a("920b"),c=a("92a6"),d=(a("96cf"),a("a15b"),a("d81d"),a("ac1f"),a("1276"),a("a434"),a("9ab4")),h=a("1b40"),p=a("08ba"),m=a("4bb5"),f=a("9f48"),b=Object(m["a"])("beUser"),v=function(t){Object(u["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(o["a"])(this,a),t=e.apply(this,arguments),t.total=0,t.data={},t.summary={},t.isLoading=!1,t.tableData=[],t.updateValue={newAuditStatus:6},t.pageQuery={page:1,search:"",limit:20,total:0,orderByClause:""},t.selectQuery={page:1,search:"",limit:20,total:0,orderByClause:""},t.newquery={areaIdArray:[],branchIdArray:[],transOfficeIdArray:[],salesMemberIdArray:[],consultantMemberIdArray:[],refMemberIdArray:[],productIdArray:[],paymentPeriod:"",currentContractYear:"",currentFeeYear:"",numOfContractYear:"",salesChannel:"",consultantType:"",customerType:"",contractStatus:"",expireStatus:"",auditStatus:3,fromApplyFormDate:"",toApplyFormDate:"",fromIssueDate:"",toIssueDate:"",fromLastPayDate:"",toLastPayDate:"",fromExpireDate:"",toExpireDate:"",fromBasicAmount:"",toBasicAmount:"",fromExtraAmount:"",toExtraAmount:"",fromTotalAmount:"",toTotalAmount:""},t.params={searchType:"CONTRACT",auditStatus:"3",page:1,limit:20},t.newparams={searchType:"CONTRACT",auditStatus:"3"},t.dataInput={keywordString:"",areaIdArray:[],branchIdArray:"",transOfficeIdArray:"",salesMemberIdArray:"",consultantMemberIdArray:"",refMemberIdArray:"",productIdArray:"",paymentPeriod:"",currentContractYear:"",currentFeeYear:"",numOfContractYear:"",salesChannel:"",consultantType:"",customerType:"",contractStatus:"",expireStatus:"",auditStatus:2,fromApplyFormDate:"",toApplyFormDate:"",fromIssueDate:"",toIssueDate:"",fromLastPayDate:"",toLastPayDate:"",fromExpireDate:"",toExpireDate:"",fromBasicAmount:"",toBasicAmount:"",fromExtraAmount:"",toExtraAmount:"",fromTotalAmount:"",toTotalAmount:""},t.newData={},t.pageInfor={total:1e3,page:1,limit:10},t.isBtnLoading=!1,t}return Object(l["a"])(a,[{key:"handleConfirm",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,i,s,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isBtnLoading=!0,this.query&&(this.query.auditStatus="3",this.query.newAuditStatus="6",this.query.limit="",this.query.page=""),!(this.dataSelect&&this.dataSelect.length>0)){t.next=9;break}return a=this.dataSelect.map((function(t){return t.bankContractNo})).join(","),i=this.dataSelect.map((function(t){return t.contractNo})).join(","),t.next=7,null===(e=this.api)||void 0===e?void 0:e.updateAuditSelect({bankContractNoArray:a,auditStatus:6,contractNoArray:i}).then((function(){n.tableData=[],n.$message.success("Yêu cầu hiệu chỉnh thành công")})).catch((function(){n.$message.warning("Yêu cầu hiệu chỉnh thất bại")}));case 7:t.next=11;break;case 9:return t.next=11,null===(s=this.api)||void 0===s?void 0:s.updateAuditFilter(this.query).then((function(){n.tableData=[],n.$message.success("Yêu cầu hiệu chỉnh thành công")})).catch((function(){n.$message.warning("Yêu cầu hiệu chỉnh thất bại")}));case 11:this.setOpenPopup({popupName:"requestcancel-popup",isOpen:!1}),this.isBtnLoading=!1,this.$emit("update");case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSelection",value:function(){}},{key:"handleSizeChange",value:function(t){this.params.page=1,this.params.limit=t,this.pageQuery.page=1,this.pageQuery.limit=t,this.selectQuery.page=1,this.selectQuery.limit=t,this.setData()}},{key:"handleCurrentChange",value:function(t){this.params.page=t,this.setData()}},{key:"checkLength",value:function(t){return t.split(" ").length>5?t.split(" ").splice(0,4).join(" ")+"...":t}},{key:"getDataSumary",value:function(){var t=this;if(this.dataSelect&&this.dataSelect.length>0){var e,a=this.dataSelect.map((function(t){return t.bankContractNo})).join(","),i=this.dataSelect.map((function(t){return t.contractNo})).join(",");null===(e=this.apiContract)||void 0===e||e.getSalaryContractSelect({bankContractNoArray:a,contractNoArray:i}).then((function(e){t.summary=e.data})).catch((function(){return t.isLoading=!1}))}else{var s;null===(s=this.apiContract)||void 0===s||s.getSalaryContract(this.query).then((function(e){t.summary=e.data})).catch((function(){return t.isLoading=!1}))}}},{key:"setData",value:function(){var t,e,a=this;this.isLoading=!0,this.query.limit=this.params.limit,this.query.page=this.params.page,null===(t=this.apiContract)||void 0===t||t.getData(this.query).then((function(t){a.data=t,a.tableData=a.data.data,a.isLoading=!1,a.pageInfor.total=t.total})).catch((function(){return a.isLoading=!1})),null===(e=this.apiContract)||void 0===e||e.getContractCount(this.query).then((function(t){a.pageQuery.total=t.data,a.isLoading=!1})).catch((function(){return a.isLoading=!1}))}},{key:"init",value:function(){this.isLoading=!1}},{key:"created",value:function(){var t,e,a,i;this.api=Object(p["a"])("audit",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiContract=Object(p["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.init(),this.isLoading=!1}},{key:"handleOpen",value:function(){this.setData(),this.getDataSumary(),this.newquery=Object(n["a"])(Object(n["a"])({},this.query),this.updateValue)}},{key:"handleClose",value:function(){this.$emit("reset")}},{key:"handleChangeAction",value:function(){}},{key:"handleFilter",value:function(){}},{key:"filters",value:function(){}}]),a}(Object(h["b"])(f["a"]));Object(d["a"])([Object(h["c"])({required:!0,type:Object,default:{}})],v.prototype,"query",void 0),Object(d["a"])([Object(h["c"])({default:[]})],v.prototype,"dataSelect",void 0),Object(d["a"])([b.State("user")],v.prototype,"user",void 0),v=Object(d["a"])([Object(h["a"])({components:{}})],v);var y=v,g=y,C=(a("df66"),a("2877")),S=Object(C["a"])(g,i,s,!1,null,"02ad1ecc",null);e["a"]=S.exports},4777:function(t,e,a){},"4897c":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{attrs:{name:"audit-action",open:t.handleOpen,close:t.handleClose,top:"30vh",width:"540px",hiddenFooter:!0}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v(" "+t._s(t.data&&t.data.title)+" ")]),a("div",{staticClass:"body-content"},[a("div",{staticClass:"field"}),a("div",{staticClass:"field"},[a("label",[t._v(t._s(t.data&&t.data.label))]),a("p",["relationship"!==t.data.code?a("el-select",{staticClass:"select-popup-audit",attrs:{"remote-method":t.remoteMethod,filterable:"",remote:"","popper-class":"customerCif"===t.data.code?"uploader-select select-extend-item":"uploader-select",placeholder:t.data.title,clearable:""},on:{change:t.handleItemClick,clear:t.handleClearData},model:{value:t.valueSelect,callback:function(e){t.valueSelect=e},expression:"valueSelect"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},[t._l(t.selectOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),"customerCif"===t.data.code?a("div",{staticClass:"option-extend"},[a("a",{on:{click:t.handleAddCustomer}},[a("base-icon",{staticClass:"style_avatar",attrs:{icon:"add-user"}}),t._v(" Thêm khách hàng mới ")],1)]):t._e(),t.selectOptions.length<=0?a("el-option",{staticClass:"custom-select-empty-audit-item",attrs:{value:""}},[a("div",{staticClass:"text-no-data"},[t._v("Không tìm thấy dữ liệu")])]):t._e()],2)]):a("el-select",{staticClass:"select-action",attrs:{placeholder:"Phân loại KH",clearable:""},model:{value:t.valueRelationship,callback:function(e){t.valueRelationship=e},expression:"valueRelationship"}},t._l(t.optionsRelationship,(function(e){return a("el-option",{key:e.id,attrs:{value:e.value,label:t.getRelationship(e.code)}})})),1)],1)]),t.valueSelect?a("div",{staticClass:"field-text"},[a("p",[a("label",[t._v("Email : "+t._s(t.emailSelect))])]),a("p",[a("label",[t._v("SĐT : "+t._s(t.phoneSelect))])])]):t._e()]),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex"},[a("div",{staticClass:"bt-center"},[a("el-button",{staticClass:"be-button-unset",attrs:{size:"mini"},on:{click:t.handleClose}},[t._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:t.handleSave}},[t._v("Lưu")])],1)])])]),a("add-customer",{attrs:{dataProp:t.dataPropCustomer,checkCustomerType:this.checkCustomerType},on:{saveSuccess:t.saveCustomer}})],2)},s=[],n=a("d0ff"),r=a("c964"),o=a("276c"),l=a("e954"),u=a("920b"),c=a("92a6"),d=(a("96cf"),a("7db0"),a("ac1f"),a("841c"),a("4de4"),a("99af"),a("d81d"),a("9ab4")),h=a("1b40"),p=a("9f13"),m=a("08ba"),f=a("9f48"),b=a("fa00"),v=a("4bb5"),y=a("2ef0"),g=a("1f2a"),C=Object(v["a"])("beUser"),S=function(t){Object(u["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(o["a"])(this,a),t=e.apply(this,arguments),t.show=!1,t.valueSelect="",t.selectOptions=[],t.listOptions=[],t.loading=!1,t.queryDrop={i:0,ps:20,search:""},t.optionsRelationship=[],t.emailSelect="",t.phoneSelect="",t.valueRelationship="",t.dataPropCustomer={title:"",id:"",code:""},t}return Object(l["a"])(a,[{key:"handleItemClick",value:function(t){var e=this.dataSearch.find((function(e){return e.id==t}));e&&("customerCif"==this.data.code?(this.emailSelect=e.customerEmail,this.phoneSelect=e.customerMobilePhone):(this.emailSelect=e.email,this.phoneSelect=e.phone))}},{key:"handleOpen",value:function(){var t,e=this;(console.log("checkCustomerType",this.checkCustomerType),this.queryDrop.search="",this.queryDrop.i=0,this.data.optionsRelationship)&&(this.optionsRelationship=null===(t=this.data.optionsRelationship)||void 0===t?void 0:t.data);this.loadDataSearch(this.data.code).then((function(t){e.listOptions=t,e.selectOptions=e.listOptions.filter((function(t){return t.label.toLowerCase().indexOf(e.queryDrop.search.toLowerCase())>-1}))})).catch((function(t){console.log(t)}))}},{key:"remoteMethod",value:function(t){var e=this;this.queryDrop.search=Object(y["trim"])(t),this.queryDrop.i=0,this.loadDataSearch(this.data.code).then((function(t){e.listOptions=t,e.selectOptions=e.listOptions.filter((function(t){return t.label.toLowerCase().indexOf(e.queryDrop.search.toLowerCase())>-1}))})).catch((function(t){console.log(t)}))}},{key:"loadMore",value:function(){var t=this;"customerCif"===this.data.code?(0==this.queryDrop.i&&(this.queryDrop.i=1),this.queryDrop.i+=1):this.queryDrop.i+=this.queryDrop.ps,this.loadDataSearch(this.data.code,!0).then((function(e){t.listOptions=e,t.selectOptions=t.listOptions.filter((function(e){return e.label.toLowerCase().indexOf(t.queryDrop.search.toLowerCase())>-1}))})).catch((function(t){console.log(t)}))}},{key:"loadDataSearch",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,i,s,r,o,l=this,u=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=u.length>1&&void 0!==u[1]&&u[1],this.loading=!0,o=[],t.t0=e,t.next="advisoryStaff"===t.t0?6:"introStaff"===t.t0?10:"customerCif"===t.t0?14:"relationship"===t.t0?18:20;break;case 6:return t.next=8,null===(a=this.apiMember)||void 0===a?void 0:a.getEmployeeList({search:Object(y["trim"])(this.queryDrop.search),groupCode:"INSURANCE",i:this.queryDrop.i,ps:this.queryDrop.ps}).then((function(t){r?t.data.length>0&&(l.dataSearch=[].concat(Object(n["a"])(l.dataSearch),Object(n["a"])(t.data))):l.dataSearch=t.data})).catch((function(t){return console.log(t)}));case 8:return o=this.dataSearch.map((function(t){return{value:"".concat(t.id),label:"".concat(t.memberNo?t.memberNo:"").concat(t.memberNo&&t.fullName?" - ":"").concat(t.fullName?t.fullName:"")}})),t.abrupt("break",20);case 10:return t.next=12,null===(i=this.apiMember)||void 0===i?void 0:i.getEmployeeList({search:Object(y["trim"])(this.queryDrop.search),groupCode:"INSURANCE",i:this.queryDrop.i,ps:this.queryDrop.ps}).then((function(t){r?t.data.length>0&&(l.dataSearch=[].concat(Object(n["a"])(l.dataSearch),Object(n["a"])(t.data))):l.dataSearch=t.data})).catch((function(t){return console.log(t)}));case 12:return o=this.dataSearch.map((function(t){return{value:"".concat(t.id),label:"".concat(t.memberNo?t.memberNo:"").concat(t.memberNo&&t.fullName?" - ":""," ").concat(t.fullName?t.fullName:"")}})),t.abrupt("break",20);case 14:return t.next=16,null===(s=this.apiCustomer)||void 0===s?void 0:s.getCustomers({search:Object(y["trim"])(this.queryDrop.search),page:this.queryDrop.i,size:this.queryDrop.ps}).then((function(t){r?t.data.content.length>0&&(l.dataSearch=[].concat(Object(n["a"])(l.dataSearch),Object(n["a"])(t.data.content))):l.dataSearch=t.data.content})).catch((function(t){return console.log(t)}));case 16:return o=this.dataSearch.map((function(t){return{value:"".concat(t.id),label:"".concat(t.customerCifCode?t.customerCifCode:"").concat(t.customerCifCode&&t.customerFullName?" - ":"").concat(t.customerFullName?t.customerFullName:"")}})),t.abrupt("break",20);case 18:return o=[],t.abrupt("break",20);case 20:return this.loading=!1,t.abrupt("return",o);case 22:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"handleAddCustomer",value:function(){this.checkCustomerType?g["a"].$emit("checkNullCif"):g["a"].$emit("checkNullCif2"),this.dataPropCustomer.code="add",this.dataPropCustomer.title="Thêm mới khách hàng",this.setOpenPopup({popupName:"addcustomer-popup",isOpen:!0})}},{key:"handleClose",value:function(){this.valueSelect="",this.valueRelationship="",this.dataSearch=[],this.selectOptions=[],this.dataPropCustomer={title:"",id:"",code:""},this.setOpenPopup({popupName:"audit-action",isOpen:!1}),this.$emit("close")}},{key:"handleSave",value:function(){var t=this,e=this.data.bankContractNo,a=this.data.contractNo,i=[];Object(y["forEach"])(this.dataSelect,(function(t){i.push(t.contractNo)}));var s,n={},r=!0;switch(this.data.code){case"advisoryStaff":this.valueSelect||(r=!1),n={bankContractNoArray:e,contractNoArray:a,salesMemberId:this.valueSelect};break;case"introStaff":this.valueSelect||(r=!1),n={bankContractNoArray:e,contractNoArray:a,refMemberId:this.valueSelect};break;case"customerCif":this.valueSelect||(r=!1),n={bankContractNoArray:e,contractNoArray:a,customerId:this.valueSelect};break;case"relationship":this.valueRelationship&&""!=this.valueRelationship||(r=!1),n={bankContractNoArray:e,contractNoArray:a,customerType:this.valueRelationship};break}r?(n.handOverDate=null,console.log("prams",n),this.api.updateAuditSelect(n).then((function(){t.$message.success("Cập nhật thành công!"),t.$emit("update")})).catch((function(e){t.$message.error(e.message)})),this.handleClose()):this.$message.error("Bạn chưa "+(null===(s=this.data.title)||void 0===s?void 0:s.toLowerCase()))}},{key:"saveCustomer",value:function(t){t&&t.id>0&&(this.selectOptions=[{value:t.id,label:"".concat(t.customerCifCode," - ").concat(t.customerFullName)}],this.valueSelect=t.id,this.emailSelect=t.customerEmail,this.phoneSelect=t.customerMobilePhone)}},{key:"created",value:function(){var t,e,a,i,s,n,r,o;this.api=Object(m["a"])("audit",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiContract=Object(m["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.apiMember=Object(m["a"])("employee",{districtId:null===(s=this.user)||void 0===s||null===(n=s.districts)||void 0===n?void 0:n[0].id}),this.apiCustomer=Object(m["a"])("customer",{districtId:null===(r=this.user)||void 0===r||null===(o=r.districts)||void 0===o?void 0:o[0].id})}},{key:"getRelationship",value:function(t){return p["RELATIONSHIP_TYPE"][t]}},{key:"handleClearData",value:function(){var t=this;this.queryDrop.i=0,this.queryDrop.search="",this.loadDataSearch(this.data.code).then((function(e){t.listOptions=e,t.selectOptions=t.listOptions.filter((function(e){return e.label.toLowerCase().indexOf(t.queryDrop.search.toLowerCase())>-1}))})).catch((function(t){console.log(t)}))}}]),a}(Object(h["b"])(f["a"]));Object(d["a"])([Object(h["c"])({required:!1,default:{}})],S.prototype,"data",void 0),Object(d["a"])([Object(h["c"])({required:!1,type:Array,default:[]})],S.prototype,"dataSelect",void 0),Object(d["a"])([Object(h["c"])()],S.prototype,"checkCustomerType",void 0),Object(d["a"])([C.State("user")],S.prototype,"user",void 0),S=Object(d["a"])([Object(h["a"])({components:{AddCustomer:b["a"]}})],S);var A=S,_=A,w=(a("c5d1"),a("2877")),k=Object(w["a"])(_,i,s,!1,null,"a912e1d0",null);e["a"]=k.exports},"48b9":function(t,e,a){},"54a5":function(t,e,a){},"62dc":function(t,e,a){},"7e50":function(t,e,a){"use strict";a("48b9")},"85be":function(t,e,a){},a6fa:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"style_audit",attrs:{name:"edit-popup",width:"1240px","max-height:75vh":"",top:"5vh",open:t.handleOpen,close:t.handleClose}},[a("div",{staticClass:"style_send_Approve",attrs:{slot:"title"},slot:"title"},[t._v(t._s("da-duyet"==t.$route.name?"Yêu cầu hiệu chỉnh":"Phê duyệt hiệu chỉnh"))]),a("div",{staticClass:"textbutton flex jc-space-between"},[a("div",{staticClass:"content"},[t._v("Danh sách yêu cầu hiệu chỉnh")]),a("div",{},[a("el-button",{staticClass:"be-btn-danger",attrs:{loading:t.isBtnLoading},on:{click:t.handleConfirm}},[t._v(t._s("da-duyet"==t.$route.name?"Yêu cầu hiệu chỉnh":"Phê duyệt hiệu chỉnh"))])],1)]),a("div",{staticClass:"dataa"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Số hợp đồng")]),a("div",{staticClass:"number-data"},[t._v(t._s(this.summary.numOfContract))])]),a("div",{staticClass:"be-flex number"},[a("div",{staticClass:"contractnumber"},[t._v("Số NVKD")]),a("div",{staticClass:"number-data"},[t._v(t._s(this.summary.numOfSalesMember))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng phí năm")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(this.summary.totalAmount)))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng IP")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(this.summary.ipAmount)))])])])]),a("div",{staticClass:"tabledata"},[a("base-table",{attrs:{border:"",data:t.dataSelect.length>0?t.newDataSelect:t.tableData,showPagination:!0,table:t.dataSelect.length>0?t.selectQuery:t.pageQuery,paginationInfo:"hợp đồng"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,selectionChange:t.handleSelection,filterChange:t.handleFilter}},[a("el-table-column",{attrs:{prop:"applyFormNo",label:"Số HSYCBH",width:"110",align:"left"}}),a("el-table-column",{attrs:{prop:"contractNo",label:"Số HĐBH",width:"120",align:"left"}}),a("el-table-column",{attrs:{prop:"branchName",label:"Chi nhánh",width:"210"}}),a("el-table-column",{attrs:{label:"Đơn vị kinh doanh",prop:"transactionOfficeName",width:"210"}}),a("el-table-column",{attrs:{prop:"salesMemberNo",label:"Mã NVTV",width:"110",align:"left"}}),a("el-table-column",{attrs:{label:"NV tư vấn",prop:"salesFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"customerCifCode",label:"Số CIF",width:"110",align:"center"}}),a("el-table-column",{attrs:{label:"Tên BMBH",prop:"customerFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"productCode",label:"Mã SP",width:"110",align:"left"}}),a("el-table-column",{attrs:{label:"Sản phẩm",prop:"productName","min-width":"210"}}),a("el-table-column",{staticClass:"checkLength",attrs:{label:"Phí năm (APE)",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.apeAmount)))]}}])}),a("el-table-column",{attrs:{label:"Trạng thái",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.auditStatus?a("span",{staticClass:"not-approve cell-status"},[t._v("Chưa đối soát")]):t._e(),"2"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Đang đối soát")]):t._e(),"3"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Chờ duyệt")]):t._e(),"4"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Đã duyệt")]):t._e(),"5"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),"6"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối duyệt")]):t._e(),"7"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối hiệu chỉnh")]):t._e(),"8"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Hiệu chỉnh")]):t._e(),"9"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Hiệu chỉnh")]):t._e()]}}])}),a("el-table-column",{attrs:{width:"180",label:"NGÀY PH",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDateTime")(e.row.issueDate)))])]}}])})],1)],1)])},s=[],n=a("f3f3"),r=a("c964"),o=a("276c"),l=a("e954"),u=a("920b"),c=a("92a6"),d=(a("96cf"),a("b0c0"),a("a15b"),a("d81d"),a("ac1f"),a("1276"),a("a434"),a("fb6a"),a("99af"),a("9ab4")),h=a("1b40"),p=a("08ba"),m=a("4bb5"),f=a("9f48"),b=Object(m["a"])("beUser"),v=function(t){Object(u["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(o["a"])(this,a),t=e.apply(this,arguments),t.total=0,t.data={},t.isLoading=!1,t.tableData=[],t.listParent=[],t.listPop=[],t.responseList=[],t.newDataSelect=[],t.listDetailContract=[],t.listSubContract=[],t.dataNew=[],t.summary={},t.pageQuery={page:1,search:"",limit:20,total:0,orderByClause:""},t.selectQuery={page:1,search:"",limit:10,total:0,orderByClause:""},t.newquery={areaIdArray:[],branchIdArray:[],transOfficeIdArray:[],salesMemberIdArray:[],consultantMemberIdArray:[],refMemberIdArray:[],productIdArray:[],newAuditStatus:3,paymentPeriod:"",currentContractYear:"",currentFeeYear:"",numOfContractYear:"",salesChannel:"",consultantType:"",customerType:"",contractStatus:"",expireStatus:"",auditStatus:2,fromApplyFormDate:"",toApplyFormDate:"",fromIssueDate:"",toIssueDate:"",fromLastPayDate:"",toLastPayDate:"",fromExpireDate:"",toExpireDate:"",fromBasicAmount:"",toBasicAmount:"",fromExtraAmount:"",toExtraAmount:"",fromTotalAmount:"",toTotalAmount:""},t.params={searchType:"CONTRACT",auditStatus:"2",page:1,limit:20},t.dataInput={keywordString:"",areaIdArray:[],branchIdArray:"",transOfficeIdArray:"",salesMemberIdArray:"",consultantMemberIdArray:"",refMemberIdArray:"",productIdArray:"",paymentPeriod:"",currentContractYear:"",currentFeeYear:"",numOfContractYear:"",salesChannel:"",consultantType:"",customerType:"",contractStatus:"",expireStatus:"",auditStatus:2,fromApplyFormDate:"",toApplyFormDate:"",fromIssueDate:"",toIssueDate:"",fromLastPayDate:"",toLastPayDate:"",fromExpireDate:"",toExpireDate:"",fromBasicAmount:"",toBasicAmount:"",fromExtraAmount:"",toExtraAmount:"",fromTotalAmount:"",toTotalAmount:"",page:1,limit:20},t.newData={},t.pageInfor={total:"",page:1,limit:20},t.isBtnLoading=!1,t}return Object(l["a"])(a,[{key:"handleConfirm",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,i,s,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isBtnLoading=!0,this.query&&(this.query.newAuditStatus="yeu-cau-hieu-chinh"==this.$route.name?"8":"3",this.query.limit="",this.query.page=""),!(this.dataSelect&&this.dataSelect.length>0)){t.next=9;break}return a=this.dataSelect.map((function(t){return t.bankContractNo})).join(","),i=this.dataSelect.map((function(t){return t.contractNo})).join(","),t.next=7,null===(e=this.api)||void 0===e?void 0:e.updateAuditSelect({bankContractNoArray:a,auditStatus:5,contractNoArray:i}).then((function(){n.tableData=[],n.$message({message:"yeu-cau-hieu-chinh"==n.$route.name?"Phê duyệt hiệu chỉnh thành công":"Yêu cầu hiệu chỉnh thành công",type:"success"})})).catch((function(){n.$message({message:"yeu-cau-hieu-chinh"==n.$route.name?"Phê duyệt hiệu chỉnh thất bại":"Yêu cầu hiệu chỉnh thất bại",type:"warning"})}));case 7:t.next=11;break;case 9:return t.next=11,null===(s=this.api)||void 0===s?void 0:s.updateAuditFilter(this.query).then((function(){n.tableData=[],n.$message({message:"yeu-cau-hieu-chinh"==n.$route.name?"Phê duyệt hiệu chỉnh thành công":"Yêu cầu hiệu chỉnh thành công",type:"success"})})).catch((function(){n.$message({message:"yeu-cau-hieu-chinh"==n.$route.name?"Phê duyệt hiệu chỉnh thất bại":"Yêu cầu hiệu chỉnh thất bại",type:"warning"})}));case 11:this.setOpenPopup({popupName:"edit-popup",isOpen:!1}),this.isBtnLoading=!1,this.$emit("update");case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSelection",value:function(){}},{key:"handleSizeChange",value:function(t){this.params.page=1,this.params.limit=t,this.pageQuery.page=1,this.pageQuery.limit=t,this.selectQuery.page=1,this.selectQuery.limit=t,this.setData()}},{key:"handleCurrentChange",value:function(t){this.params.page=t,this.setData()}},{key:"checkLength",value:function(t){return t.split(" ").length>5?t.split(" ").splice(0,4).join(" ")+"...":t}},{key:"setData",value:function(){var t,e,a,i=this;if(this.isLoading=!0,this.query.limit=this.params.limit,this.query.page=this.params.page,this.dataSelect&&this.dataSelect.length>0)if(1==this.selectQuery.page&&10==this.selectQuery.limit)this.newDataSelect=null===(a=this.responseList)||void 0===a?void 0:a.slice(0,10);else if(1==this.selectQuery.page&&1!=this.selectQuery.limit){var s;this.newDataSelect=null===(s=this.responseList)||void 0===s?void 0:s.slice(0,this.selectQuery.limit)}else if(1!=this.selectQuery.page){var n;this.newDataSelect=null===(n=this.responseList)||void 0===n?void 0:n.slice(this.selectQuery.limit*(this.selectQuery.page-1),this.selectQuery.limit*this.selectQuery.page)}null===(t=this.apiContract)||void 0===t||t.getData(this.query).then((function(t){i.data=t,i.tableData=i.data.data,i.isLoading=!1,i.pageInfor.total=t.total})).catch((function(){return i.isLoading=!1})),null===(e=this.apiContract)||void 0===e||e.getContractCount(this.query).then((function(t){i.pageQuery.total=t.data,i.isLoading=!1})).catch((function(){return i.isLoading=!1}))}},{key:"init",value:function(){this.isLoading=!1}},{key:"created",value:function(){var t,e,a,i;this.api=Object(p["a"])("audit",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiContract=Object(p["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.init(),this.isLoading=!1}},{key:"getDataSumary",value:function(){var t=this;if(this.dataSelect&&this.dataSelect.length>0){var e,a=this.dataSelect.map((function(t){return t.bankContractNo})).join(","),i=this.dataSelect.map((function(t){return t.contractNo})).join(",");null===(e=this.apiContract)||void 0===e||e.getSalaryContractSelect({bankContractNoArray:a,contractNoArray:i}).then((function(e){t.summary=e.data})).catch((function(){return t.isLoading=!1}))}else{var s;null===(s=this.apiContract)||void 0===s||s.getSalaryContract(this.query).then((function(e){t.summary=e.data})).catch((function(){return t.isLoading=!1}))}}},{key:"getNumberSubContract",value:function(){var t,e,a=this;this.dataNew=null===(t=this.dataSelect)||void 0===t?void 0:t.slice(this.dataSelect.length-1),null===(e=this.apiContract)||void 0===e||e.getDataDetail(this.dataNew[0].bankContractNo).then((function(t){var e;if(a.listSubContract=t.subContracts,a.pageNumber==(null===(e=a.dataSelect)||void 0===e?void 0:e.length)){var i,s,n,r;for(var o in a.listSubContract)a.listParent.push(a.dataNew[0]);a.listPop=null===(i=a.dataSelect)||void 0===i?void 0:i.slice(0,a.dataSelect.length-1),a.responseList=null===(s=a.listPop)||void 0===s?void 0:s.concat(a.listParent),a.selectQuery.total=null===(n=a.responseList)||void 0===n?void 0:n.length,a.newDataSelect=null===(r=a.responseList)||void 0===r?void 0:r.slice(0,10)}else if(1==a.lastItem){var l,u,c,d;for(var h in a.listSubContract)a.listParent.push(a.dataNew[0]);a.listPop=null===(l=a.dataSelect)||void 0===l?void 0:l.slice(0,a.dataSelect.length-2),a.responseList=null===(u=a.listPop)||void 0===u?void 0:u.concat(a.listParent),a.selectQuery.total=null===(c=a.responseList)||void 0===c?void 0:c.length,a.newDataSelect=null===(d=a.responseList)||void 0===d?void 0:d.slice(0,10)}else{var p,m;a.responseList=a.dataSelect,a.selectQuery.total=null===(p=a.responseList)||void 0===p?void 0:p.length,a.newDataSelect=null===(m=a.responseList)||void 0===m?void 0:m.slice(0,10)}})).catch((function(t){return console.log(t)}))}},{key:"handleOpen",value:function(){this.dataSelect&&this.dataSelect.length>0&&this.getNumberSubContract(),this.getDataSumary(),this.setData(),this.newquery=Object(n["a"])({},this.query)}},{key:"handleClose",value:function(){this.listParent=[],this.$emit("reset")}},{key:"handleFilter",value:function(){}},{key:"filters",value:function(){}}]),a}(Object(h["b"])(f["a"]));Object(d["a"])([Object(h["c"])({default:0})],v.prototype,"pageNumber",void 0),Object(d["a"])([Object(h["c"])({default:!1})],v.prototype,"lastItem",void 0),Object(d["a"])([Object(h["c"])({required:!0,type:Object,default:{}})],v.prototype,"query",void 0),Object(d["a"])([Object(h["c"])({default:[]})],v.prototype,"dataSelect",void 0),Object(d["a"])([b.State("user")],v.prototype,"user",void 0),v=Object(d["a"])([Object(h["a"])({components:{}})],v);var y=v,g=y,C=(a("b86c"),a("2877")),S=Object(C["a"])(g,i,s,!1,null,"87243fb4",null);e["a"]=S.exports},a9b0:function(t,e,a){},b86c:function(t,e,a){"use strict";a("85be")},bdbd:function(t,e,a){"use strict";a("a9b0")},c5d1:function(t,e,a){"use strict";a("e99d")},c661:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"popup-pending-action",attrs:{name:"action-popup",width:"1240px","max-height:75vh":"",top:"5vh",open:t.handleOpen,close:t.handleClose}},[a("div",{staticClass:"style_send_Approve",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.getTitle))]),a("div",{staticClass:"textbutton flex jc-space-between"},[a("div",{staticClass:"content"},[t._v(t._s("yeu-cau-hieu-chinh"==t.$route.name?"Danh sách yêu cầu hiệu chỉnh":"Danh sách chờ phê duyệt"))]),a("div",{},[a("el-button",{staticClass:"be-btn-danger",attrs:{type:"warning",loading:t.isBtnLoading},on:{click:t.handleConfirm}},[t._v(t._s(t.getButtonName))])],1)]),a("div",{staticClass:"dataa"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Số hợp đồng")]),a("div",{staticClass:"number-data"},[t._v(t._s(t.summary.numOfContract))])]),a("div",{staticClass:"be-flex number"},[a("div",{staticClass:"contractnumber"},[t._v("Số NVKD")]),a("div",{staticClass:"number-data"},[t._v(t._s(t.summary.numOfCustomer))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng phí năm")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(t.summary.totalAmount)))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng IP")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(t.summary.ipAmount)))])])])]),a("div",{staticClass:"tabledata table-action-popup"},[a("base-table",{attrs:{border:"",data:t.dataTable,table:t.pageQuery,showPagination:!0,paginationInfo:"hợp đồng"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"applyFormNo",label:"Số HSYCBH",width:"110",align:"left"}}),a("el-table-column",{attrs:{prop:"contractNo",label:"Số HĐBH",width:"120",align:"left"}}),a("el-table-column",{attrs:{prop:"branchName",label:"Chi nhánh",width:"150"}}),a("el-table-column",{attrs:{label:"Đơn vị kinh doanh",prop:"transactionOfficeName",width:"210"}}),a("el-table-column",{attrs:{prop:"salesMemberNo",label:"Mã NVTV",width:"110",align:"left"}}),a("el-table-column",{attrs:{label:"NV tư vấn",prop:"salesFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"customerCifCode",label:"Số CIF",width:"110",align:"center"}}),a("el-table-column",{attrs:{label:"Tên BMBH",prop:"customerFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"productCode",label:"Mã SP",width:"130",align:"left"}}),a("el-table-column",{attrs:{label:"Sản phẩm",prop:"productName","min-width":"210"}}),a("el-table-column",{staticClass:"checkLength",attrs:{label:"Phí năm (APE)",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.apeAmount)))]}}])}),a("el-table-column",{attrs:{label:"Trạng thái",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.auditStatus?a("span",{staticClass:"not-approve cell-status"},[t._v("Chưa đối soát")]):t._e(),"2"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Đang đối soát")]):t._e(),"3"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Chờ duyệt")]):t._e(),"4"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Đã duyệt")]):t._e(),"5"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),"6"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối duyệt")]):t._e(),"7"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối hiệu chỉnh")]):t._e(),"8"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Hiệu chỉnh")]):t._e(),"9"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Khớp")]):t._e()]}}])}),a("el-table-column",{attrs:{width:"180",label:"NGÀY PH",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDateTime")(e.row.issueDate)))])]}}])})],1)],1)])},s=[],n=a("d0ff"),r=a("f3f3"),o=a("c964"),l=a("276c"),u=a("e954"),c=a("920b"),d=a("92a6"),h=(a("96cf"),a("b0c0"),a("fb6a"),a("9ab4")),p=a("1b40"),m=a("08ba"),f=a("4bb5"),b=a("9f48"),v=a("2ef0"),y=Object(f["a"])("beUser"),g=function(t){Object(c["a"])(a,t);var e=Object(d["a"])(a);function a(){var t;return Object(l["a"])(this,a),t=e.apply(this,arguments),t.total=0,t.data={},t.summary={},t.isLoading=!1,t.pageQuery={page:1,limit:20,total:0},t.isBtnLoading=!1,t.dataTable=[],t.orignalData=[],t}return Object(u["a"])(a,[{key:"getTitle",get:function(){return"cho-duyet"===this.$route.name?"reject"===this.status?"Từ chối":"Phê duyệt":"reject"===this.status?"Từ chối hiệu chỉnh":"Phê duyệt hiệu chỉnh"}},{key:"getButtonName",get:function(){return"cho-duyet"===this.$route.name?"reject"===this.status?"Từ chối":"Phê duyệt":"reject"===this.status?"Từ chối hiệu chỉnh":"Phê duyệt hiệu chỉnh"}},{key:"handleConfirm",value:function(){var t,e,a,i=this;this.isBtnLoading=!0;var s={bankContractNoArray:null!==(t=this.dataSelect)&&void 0!==t&&t.length?this.dataSelect[0].bankContractNo:null,contractNoArray:null!==(e=this.dataSelect)&&void 0!==e&&e.length?this.dataSelect[0].contractNo:null,auditStatus:"reject"===this.status&&"cho-duyet"===this.$route.name?6:"approve"===this.status&&"cho-duyet"===this.$route.name?4:"approve"===this.status&&"yeu-cau-hieu-chinh"===this.$route.name?8:7};null===(a=this.apiContract)||void 0===a||a.updateAuditSelect(s).then((function(){"cho-duyet"===i.$route.name?"reject"===i.status?i.$message.success("Từ chối thành công"):i.$message.success("Phê duyệt thành công"):"reject"===i.status?i.$message.success("Từ chối hiệu chỉnh thành công"):i.$message.success("Phê duyệt hiệu chỉnh thành công"),i.isBtnLoading=!1,i.setOpenPopup({popupName:"action-popup",isOpen:!1}),i.$emit("update")}))}},{key:"created",value:function(){var t,e;this.apiContract=Object(m["a"])("contract",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id})}},{key:"getDataSumary",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,s={bankContractNoArray:null!==(e=this.dataSelect)&&void 0!==e&&e.length?this.dataSelect[0].bankContractNo:null,contractNoArray:null!==(a=this.dataSelect)&&void 0!==a&&a.length?this.dataSelect[0].contractNo:null},t.next=4,null===(i=this.apiContract)||void 0===i?void 0:i.getSalaryContractSelect(s);case 4:n=t.sent,this.summary=n.data,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleOpen",value:function(){this.getDetail(),this.getDataSumary()}},{key:"getDetail",value:function(){var t,e=this;this.isLoading=!0,null===(t=this.apiContract)||void 0===t||t.getDataDetail(this.dataSelect[0].bankContractNo).then((function(t){for(var a=t.subContracts.length,i=Object(v["fill"])(Array(a),t),s=0;s<a;s++)i[s]=Object(r["a"])(Object(r["a"])({},i[s]),t.subContracts[s]);e.pageQuery.total=a,e.orignalData=Object(n["a"])(i),e.handlePagination(),e.isLoading=!1,e.$forceUpdate()})).catch((function(t){e.isLoading=!1,console.log(t)}))}},{key:"handlePagination",value:function(){this.dataTable=this.orignalData.slice(1===this.pageQuery.page?0:this.pageQuery.limit*(this.pageQuery.page-1),1===this.pageQuery.page?this.pageQuery.limit:this.pageQuery.page*this.pageQuery.limit)}},{key:"handleSizeChange",value:function(t){this.pageQuery.limit=t,this.handlePagination()}},{key:"handleCurrentChange",value:function(t){this.pageQuery.page=t,this.handlePagination()}},{key:"resetQuery",value:function(){this.pageQuery={page:1,limit:20,total:0}}},{key:"handleClose",value:function(){this.resetQuery()}}]),a}(Object(p["b"])(b["a"]));Object(h["a"])([Object(p["c"])({default:[]})],g.prototype,"dataSelect",void 0),Object(h["a"])([Object(p["c"])({default:""})],g.prototype,"status",void 0),Object(h["a"])([y.State("user")],g.prototype,"user",void 0),g=Object(h["a"])([Object(p["a"])({components:{}})],g);var C=g,S=C,A=(a("7e50"),a("2877")),_=Object(A["a"])(S,i,s,!1,null,"18fa9e12",null);e["a"]=_.exports},d29b:function(t,e,a){"use strict";a("4777")},df66:function(t,e,a){"use strict";a("2647")},e383:function(t,e,a){"use strict";var i=a("c964"),s=a("276c"),n=a("e954"),r=a("920b"),o=a("92a6"),l=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("99af"),a("9ab4")),u=a("2ef0"),c=a("08ba"),d=a("1b40"),h=function(t){Object(r["a"])(a,t);var e=Object(o["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.reportRes2=void 0,t.isExcelLoading=!1,t.isPdfLoading=!1,t}return Object(n["a"])(a,[{key:"handleExport",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,i,s,n,r,o,l,c,d,h,p,m,f=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=f.length>1&&void 0!==f[1]?f[1]:"excel",i=f.length>2?f[2]:void 0,s=f.length>3?f[3]:void 0,n=f.length>4?f[4]:void 0,"excel"===a&&(this.isExcelLoading=!0),"pdf"===a&&(this.isPdfLoading=!0),r="",t.t0=e,t.next="pl9a"===t.t0?10:"pl9b"===t.t0?12:"pl9c"===t.t0?14:"pl9d"===t.t0?16:"pl9e"===t.t0?18:"pl9f"===t.t0?20:"pl9g"===t.t0?22:24;break;case 10:return r="9a",t.abrupt("break",26);case 12:return r="9b",t.abrupt("break",26);case 14:return r="9c",t.abrupt("break",26);case 16:return r="9d",t.abrupt("break",26);case 18:return r="9e",t.abrupt("break",26);case 20:return r="9f",t.abrupt("break",26);case 22:return r="9g",t.abrupt("break",26);case 24:return r="9h",t.abrupt("break",26);case 26:if(null===n||void 0===n||!n.length){t.next=51;break}return t.prev=27,l=Object(u["assign"])({format:a},i,s),delete l.locationSelect,t.next=32,null===(o=this.reportRes2)||void 0===o?void 0:o.exportReport(e,l,r);case 32:c=t.sent,d=window.URL.createObjectURL(new Blob([c.data])),h=document.createElement("a"),h.href=d,p=new Date,m="".concat(p.getFullYear()).concat(p.getMonth()+1).concat(p.getDate()).concat(p.getHours()).concat(p.getMinutes()).concat(p.getMilliseconds()),h.setAttribute("download","".concat(e.toUpperCase(),"_").concat(m,".").concat("pdf"===a?"pdf":"xlsx")),document.body.appendChild(h),h.click(),this.isExcelLoading=!1,this.isPdfLoading=!1,t.next=49;break;case 45:t.prev=45,t.t1=t["catch"](27),this.isExcelLoading=!1,this.isPdfLoading=!1;case 49:t.next=54;break;case 51:this.$message.error("Không tìm thấy dữ liệu xuất file"),this.isExcelLoading=!1,this.isPdfLoading=!1;case 54:case"end":return t.stop()}}),t,this,[[27,45]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.reportRes2=Object(c["a"])("jasper",{districtId:this.districtId})}}]),a}(d["d"]);h=Object(l["a"])([d["a"]],h),e["a"]=h},e762:function(t,e,a){"use strict";a("62dc")},e99d:function(t,e,a){},fa2a:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"style_audit",attrs:{name:"auditting-popup",width:"1240px","max-height:75vh":"",top:"5vh",open:t.handleOpen,close:t.handleClose}},[a("div",{staticClass:"style_send_Approve",attrs:{slot:"title"},slot:"title"},[t._v("Yêu cầu phê duyệt")]),a("div",{staticClass:"textbutton flex jc-space-between"},[a("div",{staticClass:"content"},[t._v("Danh sách đã đối soát")]),a("div",{},[a("el-button",{staticClass:"be-btn-danger",attrs:{type:"warning",loading:t.loadingButton},on:{click:function(e){return t.handleConfirm()}}},[t._v("Yêu cầu duyệt")])],1)]),a("div",{staticClass:"dataa"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Số hợp đồng")]),a("div",{staticClass:"number-data"},[t._v(t._s(this.summary.numOfContract))])]),a("div",{staticClass:"be-flex number"},[a("div",{staticClass:"contractnumber"},[t._v("Số NVKD")]),a("div",{staticClass:"number-data"},[t._v(t._s(this.summary.numOfSalesMember))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng phí năm")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(this.summary.totalAmount)))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng IP")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(this.summary.ipAmount)))])])])]),a("div",{staticClass:"tabledata"},[a("base-table",{attrs:{border:"",data:t.dataSelect.length>0?this.newDataSelect:t.tableData,table:t.dataSelect.length>0?t.selectQuery:t.pageQuery,paginationInfo:"hợp đồng"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,selectionChange:t.handleSelection,filterChange:t.handleFilter}},[a("el-table-column",{attrs:{prop:"applyFormNo",label:"Số HSYCBH",width:"110",align:"left"}}),a("el-table-column",{attrs:{prop:"contractNo",label:"Số HĐBH",width:"120",align:"left"}}),a("el-table-column",{attrs:{prop:"branchName",label:"Chi nhánh",width:"210"}}),a("el-table-column",{attrs:{label:"Đơn vị kinh doanh",prop:"transactionOfficeName",width:"210"}}),a("el-table-column",{attrs:{prop:"salesMemberNo",label:"Mã NVTV",width:"110",align:"left"}}),a("el-table-column",{attrs:{label:"NV tư vấn",prop:"salesFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"customerCifCode",label:"Số CIF",width:"110",align:"center"}}),a("el-table-column",{attrs:{label:"Tên BMBH",prop:"customerFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"productCode",label:"Mã SP",width:"110",align:"left"}}),a("el-table-column",{attrs:{label:"Sản phẩm",prop:"productName","min-width":"210"}}),a("el-table-column",{staticClass:"checkLength",attrs:{label:"Phí năm (APE)",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.apeAmount)))]}}])}),a("el-table-column",{attrs:{label:"Trạng thái",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.auditStatus?a("span",{staticClass:"not-approve cell-status"},[t._v("Chưa đối soát")]):t._e(),"2"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Đang đối soát")]):t._e(),"3"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Chờ duyệt")]):t._e(),"4"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Đã duyệt")]):t._e(),"5"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),"6"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối duyệt")]):t._e(),"7"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối hiệu chỉnh")]):t._e(),"8"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Hiệu chỉnh")]):t._e(),"9"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Khớp")]):t._e()]}}])}),a("el-table-column",{attrs:{width:"180",label:"NGÀY PH",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDateTime")(e.row.issueDate)))])]}}])})],1)],1)])},s=[],n=a("f3f3"),r=a("c964"),o=a("d0ff"),l=a("276c"),u=a("e954"),c=a("920b"),d=a("92a6"),h=(a("96cf"),a("d3b7"),a("ddb0"),a("4ec9"),a("3ca3"),a("d81d"),a("a15b"),a("ac1f"),a("1276"),a("a434"),a("fb6a"),a("99af"),a("9ab4")),p=a("1b40"),m=a("08ba"),f=a("4bb5"),b=a("9f48"),v=a("2ef0"),y=Object(f["a"])("beUser"),g=function(t){Object(c["a"])(a,t);var e=Object(d["a"])(a);function a(){var t;return Object(l["a"])(this,a),t=e.apply(this,arguments),t.total=0,t.data={},t.isLoading=!1,t.loadingButton=!1,t.testNumber="th",t.tableData=[],t.listParent=[],t.listPop=[],t.responseList=[],t.newDataSelect=[],t.listDetailContract=[],t.listSubContract=[],t.dataNew=[],t.summary={},t.newquery={areaIdArray:[],branchIdArray:[],transOfficeIdArray:[],salesMemberIdArray:[],consultantMemberIdArray:[],refMemberIdArray:[],productIdArray:[],newAuditStatus:3,paymentPeriod:"",currentContractYear:"",currentFeeYear:"",numOfContractYear:"",salesChannel:"",consultantType:"",customerType:"",contractStatus:"",expireStatus:"",auditStatus:2,fromApplyFormDate:"",toApplyFormDate:"",fromIssueDate:"",toIssueDate:"",fromLastPayDate:"",toLastPayDate:"",fromExpireDate:"",toExpireDate:"",fromBasicAmount:"",toBasicAmount:"",fromExtraAmount:"",toExtraAmount:"",fromTotalAmount:"",toTotalAmount:""},t.pageQuery={page:1,search:"",limit:20,total:0,orderByClause:""},t.selectQuery={page:1,search:"",limit:10,total:0,orderByClause:""},t.params={searchType:"CONTRACT",auditStatus:"2",page:1,limit:20},t.sumaryselect={contractNoArray:[],bankContractNoArray:[]},t.dataInput={keywordString:"",areaIdArray:[],branchIdArray:"",transOfficeIdArray:"",salesMemberIdArray:"",consultantMemberIdArray:"",refMemberIdArray:"",productIdArray:"",paymentPeriod:"",currentContractYear:"",currentFeeYear:"",numOfContractYear:"",salesChannel:"",consultantType:"",customerType:"",contractStatus:"",expireStatus:"",auditStatus:2,fromApplyFormDate:"",toApplyFormDate:"",fromIssueDate:"",toIssueDate:"",fromLastPayDate:"",toLastPayDate:"",fromExpireDate:"",toExpireDate:"",fromBasicAmount:"",toBasicAmount:"",fromExtraAmount:"",toExtraAmount:"",fromTotalAmount:"",toTotalAmount:"",page:"",limit:""},t.newData={},t.pageInfor={total:"",page:1,limit:20},t.isBtnLoading=!1,t}return Object(u["a"])(a,[{key:"checkInfo",value:function(t){var e=0,a=Object(o["a"])(new Map(t.map((function(t){return[t["bankContractNo"],t]}))).values());return a.map((function(t){var a=!1,i=!!t.salesMemberId,s=!!t.customerType;a=!(i&&s&&("2"!=t.customerType&&"3"!=t.customerType||t.customerId&&!isNaN(t.customerId))),a&&e++})),e}},{key:"handleConfirm",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,i,s,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(this.checkInfo(this.dataSelect)>0)){t.next=3;break}return this.$message.warning("Có ".concat(this.checkInfo(this.dataSelect)," hợp đồng chưa được gán đủ thông tin")),t.abrupt("return");case 3:if(this.loadingButton=!0,this.query&&(this.query.newAuditStatus="3",this.query.limit="",this.query.page=""),!(this.dataSelect&&this.dataSelect.length>0)){t.next=12;break}return a=this.dataSelect.map((function(t){return t.bankContractNo})).join(","),i=this.dataSelect.map((function(t){return t.contractNo})).join(","),t.next=10,null===(e=this.api)||void 0===e?void 0:e.updateAuditSelect({bankContractNoArray:a,contractNoArray:i,auditStatus:"3"}).then((function(){n.tableData=[],n.$message({message:"Yêu cầu duyệt thành công",type:"success"})})).catch((function(t){n.$message.warning(t.message)}));case 10:t.next=14;break;case 12:return t.next=14,null===(s=this.api)||void 0===s?void 0:s.updateAuditFilter(this.query).then((function(){n.tableData=[],n.$message({message:"Yêu cầu duyệt thành công",type:"success"})})).catch((function(t){n.$message.warning(t.message)}));case 14:this.setOpenPopup({popupName:"auditting-popup",isOpen:!1}),this.loadingButton=!1,this.$emit("update");case 17:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSelection",value:function(){}},{key:"handleSizeChange",value:function(t){this.params.page=1,this.params.limit=t,this.pageQuery.page=this.params.page,this.pageQuery.limit=this.params.limit,this.selectQuery.page=1,this.selectQuery.limit=t,console.log("size",t),this.setData()}},{key:"handleCurrentChange",value:function(t){this.params.page=t,console.log("page",t),this.setData()}},{key:"checkLength",value:function(t){return t.split(" ").length>5?t.split(" ").splice(0,4).join(" ")+"...":t}},{key:"setData",value:function(){var t,e,a=this;if(this.isLoading=!0,this.query.limit=this.params.limit,this.query.page=this.params.page,this.dataSelect&&this.dataSelect.length>0){var i;if(1==this.selectQuery.page&&10==this.selectQuery.limit)this.newDataSelect=null===(i=this.responseList)||void 0===i?void 0:i.slice(0,10);else if(1==this.selectQuery.page&&1!=this.selectQuery.limit){var s;this.newDataSelect=null===(s=this.responseList)||void 0===s?void 0:s.slice(0,this.selectQuery.limit)}else if(1!=this.selectQuery.page){var n;this.newDataSelect=null===(n=this.responseList)||void 0===n?void 0:n.slice(this.selectQuery.limit*(this.selectQuery.page-1),this.selectQuery.limit*this.selectQuery.page)}console.log("select",this.newDataSelect)}null===(t=this.apiContract)||void 0===t||t.getData(this.query).then((function(t){a.data=t,a.tableData=a.data.data,a.isLoading=!1,a.query.total=t.total})).catch((function(){return a.isLoading=!1})),null===(e=this.apiContract)||void 0===e||e.getContractCount(this.query).then((function(t){a.pageQuery.total=t.data,a.isLoading=!1})).catch((function(){return a.isLoading=!1}))}},{key:"init",value:function(){this.isLoading=!1}},{key:"created",value:function(){var t,e,a,i;this.api=Object(m["a"])("audit",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiContract=Object(m["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.init(),this.isLoading=!1}},{key:"getDataSumary",value:function(){var t=this;if(this.dataSelect&&this.dataSelect.length>0){var e,a=this.dataSelect.map((function(t){return t.bankContractNo})).join(","),i=this.dataSelect.map((function(t){return t.contractNo})).join(",");null===(e=this.apiContract)||void 0===e||e.getSalaryContractSelect({bankContractNoArray:a,contractNoArray:i}).then((function(e){t.summary=e.data})).catch((function(){return t.isLoading=!1}))}else{var s;null===(s=this.apiContract)||void 0===s||s.getSalaryContract(this.query).then((function(e){t.summary=e.data})).catch((function(){return t.isLoading=!1}))}}},{key:"getNumberSubContract",value:function(){var t,e,a=this;this.dataNew=null===(t=this.dataSelect)||void 0===t?void 0:t.slice(this.dataSelect.length-1),console.log(this.dataNew),null===(e=this.apiContract)||void 0===e||e.getDataDetail(this.dataNew[0].bankContractNo).then((function(t){var e;if(a.listSubContract=t.subContracts,a.pageNumber==(null===(e=a.dataSelect)||void 0===e?void 0:e.length)){var i,s,r,l;for(var u in a.listSubContract)a.listParent.push(a.dataNew[0]);a.listPop=null===(i=a.dataSelect)||void 0===i?void 0:i.slice(0,a.dataSelect.length-1),a.responseList=null===(s=a.listPop)||void 0===s?void 0:s.concat(a.listParent),a.selectQuery.total=null===(r=a.responseList)||void 0===r?void 0:r.length,a.newDataSelect=null===(l=a.responseList)||void 0===l?void 0:l.slice(0,10)}else if(1==a.lastItem){var c,d;console.log("a");for(var h=t.subContracts.length,p=Object(v["fill"])(Array(h),t),m=0;m<h;m++)p[m]=Object(n["a"])(Object(n["a"])({},p[m]),t.subContracts[m]);a.responseList=Object(o["a"])(p),a.selectQuery.total=null===(c=a.responseList)||void 0===c?void 0:c.length,a.newDataSelect=null===(d=a.responseList)||void 0===d?void 0:d.slice(0,10)}else{var f,b;a.responseList=a.dataSelect,a.selectQuery.total=null===(f=a.responseList)||void 0===f?void 0:f.length,a.newDataSelect=null===(b=a.responseList)||void 0===b?void 0:b.slice(0,10)}})).catch((function(t){return console.log(t)}))}},{key:"handleOpen",value:function(){var t;this.dataSelect&&this.dataSelect.length>0&&(console.log("vao day"),this.getNumberSubContract()),this.getDataSumary(),this.setData(),console.log("number",this.pageNumber),console.log("length",null===(t=this.dataSelect)||void 0===t?void 0:t.length),this.newquery=Object(n["a"])({},this.query)}},{key:"handleClose",value:function(){this.listParent=[],this.$emit("reset")}},{key:"handleChangeAction",value:function(){}},{key:"handleFilter",value:function(){}},{key:"filters",value:function(){}}]),a}(Object(p["b"])(b["a"]));Object(h["a"])([Object(p["c"])({default:0})],g.prototype,"pageNumber",void 0),Object(h["a"])([Object(p["c"])({default:!1})],g.prototype,"lastItem",void 0),Object(h["a"])([Object(p["c"])({required:!0,type:Object,default:{}})],g.prototype,"query",void 0),Object(h["a"])([Object(p["c"])({default:[]})],g.prototype,"dataSelect",void 0),Object(h["a"])([y.State("user")],g.prototype,"user",void 0),g=Object(h["a"])([Object(p["a"])({components:{}})],g);var C=g,S=C,A=(a("d29b"),a("2877")),_=Object(A["a"])(S,i,s,!1,null,"5c540c3c",null);e["a"]=_.exports},fdb8:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"popup-chucnang",attrs:{name:"pending-popup",width:"1240px","max-height:75vh":"",top:"5vh",open:t.handleOpen,close:t.handleClose}},[a("div",{staticClass:"style_send_Approve",attrs:{slot:"title"},slot:"title"},[t._v(t._s("yeu-cau-hieu-chinh"==t.$route.name?"Phê duyệt hiệu chỉnh":"Phê duyệt"))]),a("div",{staticClass:"textbutton flex jc-space-between"},[a("div",{staticClass:"content"},[t._v(t._s("yeu-cau-hieu-chinh"==t.$route.name?"Danh sách yêu cầu hiệu chỉnh":"Danh sách chờ phê duyệt"))]),a("div",{},[a("el-button",{staticClass:"be-btn-danger",attrs:{type:"warning",loading:t.isBtnLoading},on:{click:function(e){return t.handleConfirm()}}},[t._v(t._s("yeu-cau-hieu-chinh"==t.$route.name?"Phê duyệt hiệu chỉnh":"Phê duyệt"))])],1)]),a("div",{staticClass:"dataa"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Số hợp đồng")]),a("div",{staticClass:"number-data"},[t._v(t._s(this.summary.numOfContract))])]),a("div",{staticClass:"be-flex number"},[a("div",{staticClass:"contractnumber"},[t._v("Số NVKD")]),a("div",{staticClass:"number-data"},[t._v(t._s(this.summary.numOfSalesMember))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng phí năm")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(this.summary.totalAmount)))])]),a("div",{staticClass:"be-flex"},[a("div",{staticClass:"contractnumber"},[t._v("Tổng IP")]),a("div",{staticClass:"number-data"},[t._v(t._s(t._f("formatNumber")(this.summary.ipAmount)))])])])]),a("div",{staticClass:"tabledata"},[a("base-table",{attrs:{border:"",data:t.dataSelect.length>0?t.dataSelect:t.tableData,showPagination:!0,table:t.dataSelect.length>0?t.selectQuery:t.pageQuery,paginationInfo:"hợp đồng"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,selectionChange:t.handleSelection,filterChange:t.handleFilter}},[a("el-table-column",{key:98,staticClass:"checkLength",attrs:{prop:"applyFormNo",label:"Số HSYCBH",width:"110",align:"left"}}),a("el-table-column",{attrs:{prop:"contractNo",label:"Số HĐBH",width:"120",align:"left"}}),a("el-table-column",{attrs:{prop:"branchName",label:"Chi nhánh",width:"210"}}),a("el-table-column",{attrs:{label:"Đơn vị kinh doanh",prop:"transactionOfficeName",width:"210"}}),a("el-table-column",{attrs:{prop:"salesMemberNo",label:"Mã NVTV",width:"110",align:"left"}}),a("el-table-column",{attrs:{label:"NV tư vấn",prop:"salesFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"customerCifCode",label:"Số CIF",width:"110",align:"center"}}),a("el-table-column",{attrs:{label:"Tên BMBH",prop:"customerFullName",width:"210"}}),a("el-table-column",{attrs:{prop:"productCode",label:"Mã SP",width:"100",align:"left"}}),a("el-table-column",{attrs:{label:"Sản phẩm",prop:"productName","min-width":"210"}}),a("el-table-column",{staticClass:"checkLength",attrs:{label:"Phí năm (APE)",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.apeAmount)))]}}])}),a("el-table-column",{attrs:{label:"Trạng thái",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.auditStatus?a("span",{staticClass:"not-approve cell-status"},[t._v("Chưa đối soát")]):t._e(),"2"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Đang đối soát")]):t._e(),"3"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Chờ duyệt")]):t._e(),"4"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Đã duyệt")]):t._e(),"5"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),"6"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối duyệt")]):t._e(),"7"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối hiệu chỉnh")]):t._e(),"8"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Hiệu chỉnh")]):t._e(),"9"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Khớp")]):t._e()]}}])}),a("el-table-column",{attrs:{width:"180",label:"NGÀY PH",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDateTime")(e.row.issueDate)))])]}}])})],1)],1)])},s=[],n=a("f3f3"),r=a("c964"),o=a("276c"),l=a("e954"),u=a("920b"),c=a("92a6"),d=(a("96cf"),a("a15b"),a("d81d"),a("b0c0"),a("ac1f"),a("1276"),a("a434"),a("9ab4")),h=a("1b40"),p=a("08ba"),m=a("4bb5"),f=a("9f48"),b=Object(m["a"])("beUser"),v=function(t){Object(u["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(o["a"])(this,a),t=e.apply(this,arguments),t.total=0,t.data={},t.summary={},t.isLoading=!1,t.tableData=[],t.updateValue={newAuditStatus:4},t.pageQuery={page:1,search:"",limit:20,total:0,orderByClause:""},t.selectQuery={page:1,search:"",limit:20,total:0,orderByClause:""},t.newquery={areaIdArray:[],branchIdArray:[],transOfficeIdArray:[],salesMemberIdArray:[],consultantMemberIdArray:[],refMemberIdArray:[],productIdArray:[],paymentPeriod:"",currentContractYear:"",currentFeeYear:"",numOfContractYear:"",salesChannel:"",consultantType:"",customerType:"",contractStatus:"",expireStatus:"",auditStatus:3,fromApplyFormDate:"",toApplyFormDate:"",fromIssueDate:"",toIssueDate:"",fromLastPayDate:"",toLastPayDate:"",fromExpireDate:"",toExpireDate:"",fromBasicAmount:"",toBasicAmount:"",fromExtraAmount:"",toExtraAmount:"",fromTotalAmount:"",toTotalAmount:""},t.params={searchType:"CONTRACT",auditStatus:"3",page:1,limit:20},t.dataInput={keywordString:"",areaIdArray:[],branchIdArray:"",transOfficeIdArray:"",salesMemberIdArray:"",consultantMemberIdArray:"",refMemberIdArray:"",productIdArray:"",paymentPeriod:"",currentContractYear:"",currentFeeYear:"",numOfContractYear:"",salesChannel:"",consultantType:"",customerType:"",contractStatus:"",expireStatus:"",auditStatus:2,fromApplyFormDate:"",toApplyFormDate:"",fromIssueDate:"",toIssueDate:"",fromLastPayDate:"",toLastPayDate:"",fromExpireDate:"",toExpireDate:"",fromBasicAmount:"",toBasicAmount:"",fromExtraAmount:"",toExtraAmount:"",fromTotalAmount:"",toTotalAmount:""},t.newData={},t.pageInfor={total:1e3,page:1,limit:10},t.isBtnLoading=!1,t}return Object(l["a"])(a,[{key:"handleConfirm",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,i,s,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isBtnLoading=!0,this.query&&(this.query.newAuditStatus="4",this.query.limit="",this.query.page=""),!(this.dataSelect&&this.dataSelect.length>0)){t.next=9;break}return a=this.dataSelect.map((function(t){return t.bankContractNo})).join(","),i=this.dataSelect.map((function(t){return t.contractNo})).join(","),t.next=7,null===(e=this.api)||void 0===e?void 0:e.updateAuditSelect({bankContractNoArray:a,auditStatus:"yeu-cau-hieu-chinh"==this.$route.name?"8":"4",contractNoArray:i}).then((function(){n.tableData=[],n.$message.success("".concat("cho-duyet"==n.$route.name?"Phê duyệt thành công":"Yêu cầu duyệt thành công"))})).catch((function(t){n.$message.warning(t.message)}));case 7:t.next=11;break;case 9:return t.next=11,null===(s=this.api)||void 0===s?void 0:s.updateAuditFilter(this.query).then((function(){n.tableData=[],n.$message.success("".concat("cho-duyet"==n.$route.name?"Phê duyệt thành công":"Yêu cầu duyệt thành công"))})).catch((function(t){n.$message.warning(t.message)}));case 11:this.setOpenPopup({popupName:"pending-popup",isOpen:!1}),this.isBtnLoading=!1,this.$emit("update");case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSelection",value:function(){}},{key:"getDataSumary",value:function(){var t=this;if(this.dataSelect&&this.dataSelect.length>0){var e,a=this.dataSelect.map((function(t){return t.bankContractNo})).join(","),i=this.dataSelect.map((function(t){return t.contractNo})).join(",");null===(e=this.apiContract)||void 0===e||e.getSalaryContractSelect({bankContractNoArray:a,contractNoArray:i}).then((function(e){t.summary=e.data})).catch((function(){return t.isLoading=!1}))}else{var s;null===(s=this.apiContract)||void 0===s||s.getSalaryContract(this.query).then((function(e){t.summary=e.data})).catch((function(){return t.isLoading=!1}))}}},{key:"handleSizeChange",value:function(t){this.params.page=1,this.params.limit=t,this.pageQuery.page=1,this.pageQuery.limit=t,this.selectQuery.page=1,this.selectQuery.limit=t,this.setData()}},{key:"handleCurrentChange",value:function(t){this.params.page=t,this.setData()}},{key:"checkLength",value:function(t){return t.split(" ").length>5?t.split(" ").splice(0,4).join(" ")+"...":t}},{key:"setData",value:function(){var t,e,a=this;this.dataSelect&&this.dataSelect.length>0&&(this.selectQuery.total=this.dataSelect.length),this.query.limit=this.params.limit,this.query.page=this.params.page,this.isLoading=!0,null===(t=this.apiContract)||void 0===t||t.getData(this.query).then((function(t){a.data=t,a.tableData=a.data.data,a.isLoading=!1,a.pageInfor.total=t.total})).catch((function(){return a.isLoading=!1})),null===(e=this.apiContract)||void 0===e||e.getContractCount(this.query).then((function(t){a.pageQuery.total=t.data,a.isLoading=!1})).catch((function(){return a.isLoading=!1}))}},{key:"init",value:function(){this.isLoading=!1}},{key:"created",value:function(){var t,e,a,i;this.api=Object(p["a"])("audit",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiContract=Object(p["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.init(),this.isLoading=!1}},{key:"handleOpen",value:function(){this.setData(),this.getDataSumary(),this.newquery=Object(n["a"])(Object(n["a"])({},this.query),this.updateValue)}},{key:"handleClose",value:function(){this.$emit("reset")}},{key:"handleChangeAction",value:function(){}},{key:"handleFilter",value:function(){}},{key:"filters",value:function(){}}]),a}(Object(h["b"])(f["a"]));Object(d["a"])([Object(h["c"])({required:!0,type:Object,default:{}})],v.prototype,"query",void 0),Object(d["a"])([Object(h["c"])({default:[]})],v.prototype,"dataSelect",void 0),Object(d["a"])([b.State("user")],v.prototype,"user",void 0),v=Object(d["a"])([Object(h["a"])({components:{}})],v);var y=v,g=y,C=(a("0c64"),a("2877")),S=Object(C["a"])(g,i,s,!1,null,"058c6760",null);e["a"]=S.exports},ff0e:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{attrs:{name:"audit",open:t.handleOpen,close:t.handleClose,width:"950px",hiddenFooter:t.getHidden}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v(" Đối soát hợp đồng bảo hiểm ")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.show,expression:"show"}],staticClass:"body-content"},[a("div",{staticClass:"content be-flex"},[a("div",{staticClass:"field be-flex-item"},[a("label",[t._v("Số hợp đồng")]),a("p",{staticClass:"text-contractNo"},[t._v(" "+t._s(t.oneAudit?t.oneAudit.contractNo:"")+" ")])]),a("div",{staticClass:"field be-flex-item"})]),a("div",{staticClass:"content content-bg be-flex"},[a("div",{staticClass:"left be-flex-item"},[a("div",{staticClass:"field"},[a("label",[t._v("Tên BMBH")]),a("p",[t._v(t._s(t.oneAudit?t.oneAudit.customerFullName:""))])]),a("div",{staticClass:"field"},[a("label",[t._v("Sản phẩm")]),a("p",[t._v(" "+t._s(t.oneAudit?t.oneAudit.productName+" *":"")+" "+t._s(t.oneAudit?""+t.oneAudit.productCode:"")+" ")])]),a("div",{staticClass:"field"},[a("label",[t._v("Tổng phí đóng")]),a("p",[t._v(t._s(t._f("formatNumber")(t.oneAudit?t.oneAudit.totalAmount:"")))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetail,expression:"showDetail"}],staticClass:"field"},[a("label",[t._v("Số HSYCBH")]),a("p",[t._v(t._s(t.oneAudit&&t.oneAudit.applyFormNo))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetail,expression:"showDetail"}],staticClass:"field"},[a("label",[t._v("Ngày nộp HS")]),a("p",[t._v(t._s(t._f("formatDateTime")(t.oneAudit&&t.oneAudit.applyFormDate)))])])]),a("div",{staticClass:"right be-flex-item"},[a("span",{staticClass:"btn-show-detail cursor",on:{click:t.handleToggleDetail}},[t._v(t._s(t.showDetail?"Ẩn bớt":"Xem chi tiết"))]),a("div",{staticClass:"field field-top"},[a("label",[t._v("Chi nhánh")]),a("p",[t._v(" "+t._s(t.oneAudit&&t.oneAudit.branchCode?t.oneAudit.branchCode+" - ":"")+" "+t._s(t.oneAudit&&t.oneAudit.branchName?t.oneAudit.branchName:"")+" ")])]),a("div",{staticClass:"field"},[a("label",[t._v("Đơn vị kinh doanh")]),a("p",[t._v(" "+t._s(t.oneAudit&&t.oneAudit.transactionOfficeCode?t.oneAudit.transactionOfficeCode+" - ":"")+" "+t._s(t.oneAudit&&t.oneAudit.transactionOfficeName)+" ")])]),a("div",{staticClass:"field"},[a("label",[t._v("FYP/RYP")]),a("p",[t._v(t._s(t._f("formatNumber")(t.oneAudit&&t.oneAudit.ipAmount)))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetail,expression:"showDetail"}],staticClass:"field"},[a("label",[t._v("Ngày phát hành")]),a("p",[t._v(t._s(t._f("formatDateTime")(t.oneAudit&&t.oneAudit.issueDate)))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetail,expression:"showDetail"}],staticClass:"field"},[a("label",[t._v("Ngày phí phát sinh")]),a("p",[t._v(t._s(t._f("formatDateTime")(t.oneAudit&&t.oneAudit.lastPayDate)))])])])]),a("div",{staticClass:"content be-flex"},[a("div",{staticClass:"left be-flex-item"},[a("div",{staticClass:"field"},[a("label",[t._v("Nhân viên đứng code")]),a("p",[a("el-input",{staticClass:"input-auto-complete",attrs:{disabled:""},model:{value:t.valueStaffCode,callback:function(e){t.valueStaffCode=e},expression:"valueStaffCode"}})],1)]),a("div",{staticClass:"field"},[a("label",[t._v("Nhân viên tư vấn "),a("label",[t._v("*")])]),a("p",[a("el-select",{staticClass:"select-popup-audit input-auto-complete",attrs:{"remote-method":t.remoteSale,filterable:"",remote:"",clearable:"","popper-class":"uploader-select select-extend-item sale-select",placeholder:"Nhân viên tư vấn",disabled:t.disableSelect},on:{change:t.handleChangeSale,clear:t.handleClearSale},model:{value:t.oneAudit.salesMemberId,callback:function(e){t.$set(t.oneAudit,"salesMemberId",e)},expression:"oneAudit.salesMemberId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreSale,expression:"loadMoreSale"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},t._l(t.selectSaleOptions,(function(t,e){return a("el-option",{key:e,attrs:{label:(t.memberNo?t.memberNo:"")+(t.memberNo&&t.fullName?" - ":"")+(t.fullName?t.fullName:""),value:t.id}})})),1)])],1),a("span",{directives:[{name:"show",rawName:"v-show",value:t.field.sale,expression:"field.sale"}],staticClass:"text-error"},[t._v('Vui lòng chọn "NV tư vấn"')])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showInfo.sale,expression:"showInfo.sale"}],staticClass:"field-text"},[a("p",[t._v(t._s(t.oneAudit&&t.oneAudit.salesEmail&&"Email: "+t.oneAudit.salesEmail))]),t.oneAudit&&(t.oneAudit.salesWorkPhone||t.oneAudit.salesMobilePhone)?a("p",[t._v(" SĐT: "+t._s(t.oneAudit&&t.oneAudit.salesWorkPhone&&t.oneAudit.salesWorkPhone+" / ")+t._s(t.oneAudit&&t.oneAudit.salesMobilePhone)+" ")]):t._e()]),a("div",{staticClass:"field"},[a("label",[t._v("Nhân viên giới thiệu ")]),a("p",[a("el-select",{staticClass:"select-popup-audit input-auto-complete",attrs:{"remote-method":t.remoteRef,filterable:"",remote:"",clearable:"","popper-class":"uploader-select select-extend-item ref-select",placeholder:"Nhân viên giới thiệu",disabled:t.disableSelect},on:{change:t.handleChangeRef,clear:t.handleClearRef},model:{value:t.oneAudit.refMemberId,callback:function(e){t.$set(t.oneAudit,"refMemberId",e)},expression:"oneAudit.refMemberId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreRef,expression:"loadMoreRef"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"600"}},t._l(t.selectRefOptions,(function(t,e){return a("el-option",{key:e,attrs:{label:(t.memberNo?t.memberNo:"")+" "+(t.memberNo&&t.fullName?" - ":"")+(t.fullName?t.fullName:""),value:t.id}})})),1)])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showInfo.ref,expression:"showInfo.ref"}],staticClass:"field-text"},[a("p",[t._v(t._s(t.oneAudit&&t.oneAudit.refEmail&&"Email: "+t.oneAudit.refEmail))]),t.oneAudit&&(t.oneAudit.refWorkPhone||t.oneAudit.refMobilePhone)?a("p",[t._v(" SĐT: "+t._s(t.oneAudit&&t.oneAudit.refWorkPhone&&t.oneAudit.refWorkPhone+" / ")+" "+t._s(t.oneAudit&&t.oneAudit.refMobilePhone)+" ")]):t._e()])]),a("div",{staticClass:"left be-flex-item"},[a("div",{staticClass:"field"},[a("label",[t._v("Phân loại KH "),a("label",[t._v("*")])]),a("p",[a("el-select",{staticClass:"audit-input input-auto-complete",attrs:{placeholder:"Phân loại KH",clearable:"",disabled:t.disableSelect},on:{change:t.handleChangeRelationship},model:{value:t.oneAudit.customerType,callback:function(e){t.$set(t.oneAudit,"customerType",e)},expression:"oneAudit.customerType"}},t._l(t.optionsRelationship,(function(e,i){return a("el-option",{key:i,attrs:{label:t.getRelationship(e.code),value:e.value}})})),1)],1)]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.field.relationship,expression:"field.relationship"}],staticClass:"text-error"},[t._v('Vui lòng chọn "Phân loại KH"')]),a("div",{staticClass:"field"},[a("label",[t._v("Số CIF "),"2"==t.oneAudit.customerType||"3"==t.oneAudit.customerType?a("label",[t._v("*")]):t._e()]),a("p",[a("el-select",{staticClass:"select-popup-audit input-auto-complete",attrs:{"remote-method":t.remoteCustomer,filterable:"",remote:"",clearable:"","popper-class":"uploader-select select-extend-item-audit",placeholder:"Số CIF",disabled:t.disableSelect},on:{change:t.handleChangeCustomer,clear:t.handleClearCustomer},model:{value:t.oneAudit.customerId,callback:function(e){t.$set(t.oneAudit,"customerId",e)},expression:"oneAudit.customerId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreCustomer,expression:"loadMoreCustomer"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},[t._l(t.arrayCustomer,(function(e){return a("el-option",{key:e.id,attrs:{label:t.getNameCustomer(e.customerCifCode,e.customerFullName),value:e.id}},[[a("div",{staticClass:"box-customer",class:e.address?null:"box-customer-plus"},[e.customerCifCode?a("span",[t._v(t._s(e.customerCifCode)+" - "+t._s(e.customerFullName))]):a("span",[t._v(t._s(e.customerFullName))]),e.address?a("span",{staticClass:"box-address"},[t._v(t._s(e.address))]):t._e()])]],2)})),a("div",{staticClass:"option-extend"},[a("a",{on:{click:t.handleAddCustomer}},[a("base-icon",{staticClass:"style_avatar",attrs:{icon:"add-user"}}),t._v(" Thêm khách hàng mới ")],1)]),t.arrayCustomer.length<=0?a("el-option",{attrs:{value:"",label:""}},[t._v("Không tìm thấy dữ liệu")]):t._e()],2)])],1)]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.field.customer,expression:"field.customer"}],staticClass:"text-error"},[t._v('Vui lòng chọn "Số CIF"')]),t.showInfo.customer&&(t.oneAudit.customerIdNo||t.oneAudit.customerIdNo)?a("div",{staticClass:"field-text"},[a("p",[t._v(t._s(t.oneAudit&&t.oneAudit.customerIdNo&&"CMND: "+t.oneAudit.customerIdNo))])]):t._e(),a("div",{staticClass:"field"},[a("label",[t._v("Ghi chú")]),a("el-input",{staticClass:"custom-text-area input-auto-complete",attrs:{type:"textarea",rows:"3",placeholder:t.placeholderNote,disabled:t.disableSelect},model:{value:t.oneAudit.description,callback:function(e){t.$set(t.oneAudit,"description",e)},expression:"oneAudit.description"}})],1)])])]),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex jc-space-between"},[t.hiddenFooterPopup?t._e():a("el-button",{staticClass:"btn-custom",attrs:{loading:t.isBtnLoading.prev,size:"mini",disabled:t.disableButton.prev},on:{click:t.handlePrev}},[a("i",{staticClass:"el-icon-arrow-left"}),t._v(" Trước ")]),a("div",{staticClass:"bt-center"},[a("el-button",{staticClass:"btn-custom",attrs:{size:"mini",loading:t.isBtnLoading.close},on:{click:t.handleSaveClose}},[t._v("Lưu và đóng")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.hiddenFooterPopup,expression:"!hiddenFooterPopup"}],staticClass:"btn-custom",attrs:{size:"mini",loading:t.isBtnLoading.continue},on:{click:t.handleSaveContiniue}},[t._v("Lưu và tiếp tục")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini",loading:t.isBtnLoading.req},on:{click:t.handleSaveReqApprove}},[t._v("Lưu & Yêu cầu duyệt")])],1),t.hiddenFooterPopup?t._e():a("el-button",{staticClass:"btn-custom btn-next",attrs:{loading:t.isBtnLoading.next,size:"mini",disabled:t.disableButton.next},on:{click:t.handleNext}},[t._v(" Sau "),a("i",{staticClass:"el-icon-arrow-right"})])],1)])]),a("add-customer",{attrs:{dataProp:t.dataPropCustomer,checkCustomerType:this.checkCustomerType},on:{saveSuccess:t.saveCustomer}})],2)},s=[],n=a("d0ff"),r=a("c964"),o=a("f3f3"),l=a("276c"),u=a("e954"),c=a("920b"),d=a("92a6"),h=(a("96cf"),a("b0c0"),a("ac1f"),a("841c"),a("99af"),a("d3b7"),a("ddb0"),a("4ec9"),a("3ca3"),a("d81d"),a("4de4"),a("9ab4")),p=a("1b40"),m=a("9f48"),f=a("c56f"),b=a("08ba"),v=a("4bb5"),y=a("fa00"),g=a("9f13"),C=a("2ef0"),S=a("1f2a"),A=Object(v["a"])("beUser"),_=function(t){Object(c["a"])(a,t);var e=Object(d["a"])(a);function a(){var t;return Object(l["a"])(this,a),t=e.apply(this,arguments),t.auditData=[],t.valueNote="",t.index=0,t.loading=!1,t.show=!1,t.valueStaffCode="",t.optionsRelationship=[],t.querySale={i:0,ps:10,search:""},t.queryCustomer={i:0,ps:10,search:""},t.queryRef={i:0,ps:10,search:""},t.isBtnLoading={close:!1,continue:!1,req:!1,prev:!1,next:!1},t.selectRefOptions=[],t.valueSelectRef="",t.valueSelectCustomer="",t.valueSelectSale="",t.arrayCustomer=[],t.selectSaleOptions=[],t.consultantMemberIdArray=[],t.customerType="",t.showDetail=!1,t.oneAudit={},t.hiddenFooterPopup=!1,t.disableButton={prev:!1,next:!1},t.showInfo={ref:!0,customer:!0,sale:!0},t.field={sale:!1,ref:!1,customer:!1,relationship:!1},t.dataPropCustomer={title:"",id:"",code:""},t.isLoadmore=!0,t.checkCustomerType=!1,t.debounceRemoteCus=Object(C["debounce"])((function(){t.handleSearchCus()}),600),t.debounceRemoteRef=Object(C["debounce"])((function(){t.handleSearchRef()}),600),t.debounceRemoteSale=Object(C["debounce"])((function(){t.handleSearchSale()}),600),t}return Object(u["a"])(a,[{key:"placeholderNote",get:function(){return"da-duyet"==this.$route.params.status||"cho-duyet"==this.$route.params.status||"yeu-cau-hieu-chinh"==this.$route.params.status?"":"Nhập ghi chú"}},{key:"getHidden",get:function(){return("da-khop"==this.$route.params.status||"da-khop"==this.$route.name)&&this.checkPemission("audit",["edit-input"])}},{key:"disableSelect",get:function(){return"da-khop"!=this.$route.params.status&&"da-khop"!=this.$route.name||!this.checkPemission("audit",["edit-input"])}},{key:"handleClearCustomer",value:function(){this.showInfo.customer=!1}},{key:"handleClearRef",value:function(){this.showInfo.ref=!1}},{key:"handleClearSale",value:function(){this.showInfo.sale=!1}},{key:"handleAddCustomer",value:function(){this.dataPropCustomer.code="add","1"==this.oneAudit.customerType||"4"==this.oneAudit.customerType?(this.checkCustomerType=!0,S["a"].$emit("checkNullCif")):(this.checkCustomerType=!1,S["a"].$emit("checkNullCif2")),this.setOpenPopup({popupName:"addcustomer-popup",isOpen:!0})}},{key:"handleChangeRelationship",value:function(){this.field.relationship=!1}},{key:"handleChangeCustomer",value:function(){this.showInfo.customer=!0,this.field.customer=!1}},{key:"handleChangeSale",value:function(t){var e=Object(C["filter"])(this.selectSaleOptions,(function(e){return e.id===t}));e.length&&(this.oneAudit.salesMobilePhone=e[0].phone,this.oneAudit.salesEmail=e[0].email),this.showInfo.sale=!0,this.field.sale=!1}},{key:"handleChangeRef",value:function(t){var e=Object(C["filter"])(this.selectRefOptions,(function(e){return e.id===t}));e.length&&(this.oneAudit.refMobilePhone=e[0].phone,this.oneAudit.refEmail=e[0].email),this.showInfo.ref=!0,this.field.ref=!1}},{key:"remoteCustomer",value:function(t){this.queryCustomer.search=t,this.queryCustomer.i=0,this.queryCustomer.ps=10,this.isLoadmore=!1,this.debounceRemoteCus()}},{key:"handleSearchCus",value:function(){var t,e=this,a=Object(o["a"])(Object(o["a"])({},this.queryCustomer),{},{search:Object(C["trim"])(this.queryCustomer.search),page:this.queryCustomer.i,size:this.queryCustomer.ps});null===(t=this.apiCustomer)||void 0===t||t.getCustomers(a).then((function(t){e.arrayCustomer=t.data.content,setTimeout((function(){e.isLoadmore=!0}),1e3)}))}},{key:"remoteRef",value:function(t){this.queryRef.i=0,this.queryRef.ps=10,this.queryRef.search=Object(C["trim"])(t),this.isLoadmore=!1,this.debounceRemoteRef()}},{key:"handleSearchRef",value:function(){var t,e=this,a=Object(o["a"])(Object(o["a"])({},this.queryRef),{},{search:Object(C["trim"])(this.queryRef.search),groupCode:"INSURANCE"});null===(t=this.apiMember)||void 0===t||t.getEmployeeList(a).then((function(t){e.selectRefOptions=t.data,setTimeout((function(){e.isLoadmore=!0}),1e3)}))}},{key:"remoteSale",value:function(t){this.querySale.i=0,this.querySale.ps=10,this.querySale.search=Object(C["trim"])(t),this.isLoadmore=!1,this.debounceRemoteSale()}},{key:"handleSearchSale",value:function(){var t,e=this,a=Object(o["a"])(Object(o["a"])({},this.querySale),{},{search:Object(C["trim"])(this.querySale.search),groupCode:"INSURANCE"});null===(t=this.apiMember)||void 0===t||t.getEmployeeList(a).then((function(t){e.selectSaleOptions=t.data,setTimeout((function(){e.isLoadmore=!0}),1e3)}))}},{key:"checkExitsArray",value:function(t,e){return Object(C["filter"])(e,(function(e){return e.id===t})).length}},{key:"getListSaleMember",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Object(o["a"])(Object(o["a"])({},this.querySale),{},{groupCode:"INSURANCE"}),t.next=3,null===(e=this.apiMember)||void 0===e?void 0:e.getEmployeeList(a).then((function(t){i.selectSaleOptions=[].concat(Object(n["a"])(i.selectSaleOptions),Object(n["a"])(t.data));var e={memberNo:i.oneAudit.salesMemberNo,fullName:i.oneAudit.salesFullName,id:i.oneAudit.salesMemberId,phone:i.oneAudit.salesMobilePhone,refWorkPhone:i.oneAudit.salesWorkPhone,email:i.oneAudit.salesEmail};e.id&&(i.checkExitsArray(e.id,i.selectSaleOptions)||i.selectSaleOptions.unshift(e))}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getListRefMember",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Object(o["a"])(Object(o["a"])({},this.queryRef),{},{groupCode:"INSURANCE"}),t.next=3,null===(e=this.apiMember)||void 0===e?void 0:e.getEmployeeList(a).then((function(t){i.selectRefOptions=[].concat(Object(n["a"])(i.selectRefOptions),Object(n["a"])(t.data));var e={memberNo:i.oneAudit.refMemberNo,fullName:i.oneAudit.refFullName,id:i.oneAudit.refMemberId,phone:i.oneAudit.refMobilePhone,refWorkPhone:i.oneAudit.refWorkPhone,email:i.oneAudit.refEmail};e.id&&(i.checkExitsArray(e.id,i.selectRefOptions)||i.selectRefOptions.unshift(e))})).catch((function(t){return console.log(t)}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getListCifMember",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.apiCustomer)||void 0===e?void 0:e.getCustomers({search:Object(C["trim"])(this.queryCustomer.search),page:this.queryCustomer.i,size:this.queryCustomer.ps}).then((function(t){a.arrayCustomer=[].concat(Object(n["a"])(a.arrayCustomer),Object(n["a"])(t.data.content));var e={customerCifCode:a.oneAudit.customerCifCode,customerFullName:a.oneAudit.customerFullName,id:a.oneAudit.customerId};e.id?a.checkExitsArray(e.id,a.arrayCustomer)||a.arrayCustomer.unshift(e):a.oneAudit.customerId=a.oneAudit.customerFullName}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"loadMoreCustomer",value:function(){this.isLoadmore&&(this.queryCustomer.i+=this.queryCustomer.ps,this.getListCifMember())}},{key:"loadMoreSale",value:function(){this.isLoadmore&&(this.querySale.i+=this.querySale.ps,this.getListSaleMember())}},{key:"loadMoreRef",value:function(){this.isLoadmore&&(this.queryRef.i+=this.queryRef.ps,this.getListRefMember())}},{key:"handleToggleDetail",value:function(){this.showDetail=!this.showDetail}},{key:"handleOpen",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.index=0,this.oneAudit=this.dataPopup.data[this.index],this.isBtnLoading.next=!1,this.isBtnLoading.req=!1,this.isBtnLoading.continue=!1,this.params&&(this.hiddenFooterPopup=!(this.dataPopup.data.length>1)),this.checkDisableButton(),t.next=9,this.getListSaleMember();case 9:return t.next=11,this.getListRefMember();case 11:return t.next=13,this.getListCifMember();case 13:this.setData();case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"setData",value:function(){var t="bankContractNo",e=Object(n["a"])(new Map(this.dataPopup.data.map((function(e){return[e[t],e]}))).values());if(this.dataPopup.data=e,this.data=Object(n["a"])(this.dataPopup.data),this.oneAudit=this.dataPopup.data[this.index],this.oneAudit){this.optionsRelationship=this.propCustomerType.data,this.valueStaffCode=this.oneAudit&&(this.oneAudit.consultantNo||this.oneAudit.consultantName)?"".concat(this.oneAudit.consultantNo?"".concat(this.oneAudit.consultantNo," - "):"").concat(this.oneAudit.consultantName):"";var a={customerCifCode:this.oneAudit.customerCifCode,customerFullName:this.oneAudit.customerFullName,id:this.oneAudit.customerId};a.id?this.checkExitsArray(a.id,this.arrayCustomer)||this.arrayCustomer.unshift(a):this.oneAudit.customerId=this.oneAudit.customerFullName;var i={memberNo:this.oneAudit.salesMemberNo,fullName:this.oneAudit.salesFullName,id:this.oneAudit.salesMemberId,phone:this.oneAudit.salesMobilePhone,refWorkPhone:this.oneAudit.salesWorkPhone,email:this.oneAudit.salesEmail};i.id&&(this.checkExitsArray(i.id,this.selectSaleOptions)||this.selectSaleOptions.unshift(i));var s={memberNo:this.oneAudit.refMemberNo,fullName:this.oneAudit.refFullName,id:this.oneAudit.refMemberId,phone:this.oneAudit.refMobilePhone,refWorkPhone:this.oneAudit.refWorkPhone,email:this.oneAudit.refEmail};s.id&&(this.checkExitsArray(s.id,this.selectRefOptions)||this.selectRefOptions.unshift(s));var r="id";this.arrayCustomer=Object(n["a"])(new Map(this.arrayCustomer.map((function(t){return[t[r],t]}))).values()),this.selectSaleOptions=Object(n["a"])(new Map(this.selectSaleOptions.map((function(t){return[t[r],t]}))).values()),this.selectRefOptions=Object(n["a"])(new Map(this.selectRefOptions.map((function(t){return[t[r],t]}))).values())}}},{key:"getNameCustomer",value:function(t,e){var a="";return a=t?t+" - "+e:e,a}},{key:"saveCustomer",value:function(t){t&&t.id>0&&(this.arrayCustomer.unshift({id:t.id,customerCifCode:t.customerCifCode,customerFullName:t.customerFullName,address:t.address}),this.oneAudit.customerId=t.id),console.log("array",this.arrayCustomer)}},{key:"checkDisableButton",value:function(){this.disableButton={prev:!!(this.index<=0&&this.params&&this.params.page<2),next:this.index>=this.dataPopup.data.length-1}}},{key:"resetQuery",value:function(){this.querySale={i:0,ps:10,search:""},this.queryCustomer={i:0,ps:10,search:""},this.queryRef={i:0,ps:10,search:""}}},{key:"checkNull",value:function(){this.oneAudit.customerId||(this.oneAudit.customerCifCode=null,this.oneAudit.customerFullName=null),this.oneAudit.refMemberId||(this.oneAudit.refMemberNo=null,this.oneAudit.refFullName=null,this.oneAudit.refMobilePhone=null,this.oneAudit.refWorkPhone=null,this.oneAudit.refEmail=null,this.oneAudit.refLocationId=null,this.oneAudit.refLocationName=null,this.oneAudit.refTransactionOfficeType=null),this.oneAudit.salesMemberId||(this.oneAudit.salesMemberNo=null,this.oneAudit.salesFullName=null,this.oneAudit.salesMobilePhone=null,this.oneAudit.salesWorkPhone=null,this.oneAudit.salesEmail=null)}},{key:"handleClose",value:function(){this.index=0,this.field={sale:!1,ref:!1,customer:!1,relationship:!1},this.show=!1,this.selectSaleOptions=[],this.selectRefOptions=[],this.arrayCustomer=[],this.resetQuery()}},{key:"handleSaveClose",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isBtnLoading.close=!0,this.oneAudit.customerId&&!isNaN(this.oneAudit.customerId)||"2"!=this.oneAudit.customerType&&"3"!=this.oneAudit.customerType){t.next=7;break}return this.field.customer=!0,this.isBtnLoading.close=!1,t.abrupt("return");case 7:this.field.customer=!1;case 8:if(this.oneAudit.salesMemberId){t.next=14;break}return this.field.sale=!0,this.isBtnLoading.close=!1,t.abrupt("return");case 14:this.field.sale=!1;case 15:if(this.oneAudit.customerType){t.next=21;break}return this.field.relationship=!0,this.isBtnLoading.close=!1,t.abrupt("return");case 21:this.field.relationship=!1;case 22:if(this.oneAudit.salesMemberId){t.next=28;break}return this.field.sale=!0,this.isBtnLoading.close=!1,t.abrupt("return");case 28:this.field.sale=!1;case 29:if(!this.oneAudit){t.next=36;break}return isNaN(this.oneAudit.customerId)&&(this.oneAudit.customerId=null),this.checkNull(),a=this.oneAudit.bankContractNo,t.next=35,null===(e=this.apiContract)||void 0===e?void 0:e.updateOneAudit(a,this.oneAudit).then((function(){i.$message.success("Cập nhập thành công")})).catch((function(t){i.$message.error(t.message)}));case 35:this.setOpenPopup({popupName:"audit",isOpen:!1});case 36:this.field={sale:!1,ref:!1,customer:!1,relationship:!1},this.$emit("update"),this.isBtnLoading.close=!1;case 39:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSaveContiniue",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isBtnLoading.continue=!0,!this.oneAudit){t.next=4;break}return t.next=4,this.handleNext();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSaveReqApprove",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isBtnLoading.req=!0,!this.oneAudit){t.next=6;break}return this.oneAudit.auditStatus="3",t.next=5,this.handleNext();case 5:this.isBtnLoading.req=!1;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getRelationship",value:function(t){return g["RELATIONSHIP_TYPE"][t]}},{key:"handlePrev",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.checkDisableButton(),this.field={sale:!1,ref:!1,customer:!1,relationship:!1},this.index>0&&this.index--,!(this.params&&this.params.page>1&&this.index<1)){t.next=8;break}return this.isBtnLoading.prev=!0,t.next=7,this.$emit("handlePrev");case 7:this.dataPopup.count&&(this.index=this.index+this.dataPopup.count);case 8:this.isBtnLoading.prev=!1,this.setData();case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleNext",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isBtnLoading.continue||this.isBtnLoading.req?(this.isBtnLoading.req=!1,this.isBtnLoading.continue=!1):this.isBtnLoading.next=!0,this.checkDisableButton(),this.oneAudit.customerId&&!isNaN(this.oneAudit.customerId)||"2"!=this.oneAudit.customerType&&"3"!=this.oneAudit.customerType){t.next=8;break}return this.field.customer=!0,this.resetBtnLoading(),t.abrupt("return");case 8:this.field.customer=!1;case 9:if(this.oneAudit.customerType){t.next=15;break}return this.field.relationship=!0,this.resetBtnLoading(),t.abrupt("return");case 15:this.field.relationship=!1;case 16:if(this.oneAudit.salesMemberId){t.next=22;break}return this.field.sale=!0,this.resetBtnLoading(),t.abrupt("return");case 22:this.field.sale=!1;case 23:if(!this.oneAudit){t.next=29;break}return isNaN(this.oneAudit.customerId)&&(this.oneAudit.customerId=null),this.checkNull(),a=this.oneAudit.bankContractNo,t.next=29,null===(e=this.apiContract)||void 0===e?void 0:e.updateOneAudit(a,this.oneAudit).then((function(){if(i.$message.success("Cập nhập thành công"),"3"==i.oneAudit.auditStatus){var t=i.dataPopup.data.filter((function(t){return t.bankContractNo!=i.oneAudit.bankContractNo}));i.dataPopup.data=t}(i.dataPopup.data.length<1||"detail"==i.dataPopup.action)&&i.setOpenPopup({popupName:"audit",isOpen:!1}),i.isBtnLoading.next=!1})).catch((function(){i.$message.error("Cập nhập thất bại"),i.isBtnLoading.next=!1}));case 29:this.index++,this.index>0?this.disableButton.prev=!1:this.disableButton.prev=!0,this.index>=this.dataPopup.data.length-2&&"detail"!=this.dataPopup.action&&this.$emit("handleNext"),this.field={sale:!1,ref:!1,customer:!1,relationship:!1},"detail"!=this.dataPopup.action&&this.setData(),this.$emit("update");case 35:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"resetBtnLoading",value:function(){this.isBtnLoading.next=!1,this.isBtnLoading.continue=!1,this.isBtnLoading.req=!1,this.isBtnLoading.close=!1}},{key:"created",value:function(){var t,e,a,i,s,n,r,o;this.api=Object(b["a"])("audit",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiContract=Object(b["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.apiMember=Object(b["a"])("employee",{districtId:null===(s=this.user)||void 0===s||null===(n=s.districts)||void 0===n?void 0:n[0].id}),this.apiCustomer=Object(b["a"])("customer",{districtId:null===(r=this.user)||void 0===r||null===(o=r.districts)||void 0===o?void 0:o[0].id})}}]),a}(Object(p["b"])(m["a"],f["a"]));Object(h["a"])([Object(p["c"])()],_.prototype,"dataPopup",void 0),Object(h["a"])([Object(p["c"])()],_.prototype,"propCustomerType",void 0),Object(h["a"])([Object(p["c"])()],_.prototype,"params",void 0),Object(h["a"])([A.State("user")],_.prototype,"user",void 0),_=Object(h["a"])([Object(p["a"])({components:{AddCustomer:y["a"]}})],_);var w=_,k=w,O=(a("bdbd"),a("2877")),N=Object(O["a"])(k,i,s,!1,null,"dfd3d9f8",null);e["a"]=N.exports}}]);
//# sourceMappingURL=chunk-5aef71a6.30804b80.js.map