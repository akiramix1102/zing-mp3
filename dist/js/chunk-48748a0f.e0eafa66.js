(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48748a0f"],{"03a0":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"flex",attrs:{name:"popupDeleteContract",width:"420px",open:t.handleOpen,hiddenFooter:!0}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.data&&t.data.title?t.data.title:""))]),a("div",{staticClass:"body-content"},[t._v(" Bạn có chắc chắn muốn xóa thu phí "),a("br"),a("b",[t._v(t._s(t.data&&t.data.message?t.data.message:""))]),t._v("? ")]),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex jc-flex-end"},[a("div",{},[a("el-button",{staticClass:"be-button-unset",attrs:{size:"mini"},on:{click:t.handleCancel}},[t._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:t.handleConfirm}},[t._v("Xác nhận")])],1)])])])],2)},n=[],s=a("276c"),o=a("e954"),c=a("920b"),r=a("92a6"),l=a("9ab4"),u=a("1b40"),p=a("9f48"),d=a("c56f"),h=function(t){Object(c["a"])(a,t);var e=Object(r["a"])(a);function a(){return Object(s["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"handleCancel",value:function(){this.setOpenPopup({popupName:"popupDeleteContract",isOpen:!1})}},{key:"handleConfirm",value:function(){this.$emit("delete"),this.setOpenPopup({popupName:"popupDeleteContract",isOpen:!1})}},{key:"handleOpen",value:function(){console.log("open")}},{key:"handleClose",value:function(){console.log("close")}}]),a}(Object(u["b"])(p["a"],d["a"]));Object(l["a"])([Object(u["c"])()],h.prototype,"data",void 0),h=Object(l["a"])([Object(u["a"])({components:{}})],h);var m=h,f=m,b=(a("2267"),a("2877")),g=Object(b["a"])(f,i,n,!1,null,"1eea04f4",null);e["a"]=g.exports},2267:function(t,e,a){"use strict";a("a7ba")},2348:function(t,e,a){},6323:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"audit audit-page"},[a("div",{staticClass:"audit-table"},[a("base-table",{ref:"auditTable",attrs:{data:t.dataTable,filters:t.filters,showPagination:!0,table:t.query,paginationInfo:"hợp đồng",emptyText:"Không có dữ liệu hợp đồng"},on:{selectionChange:t.handleSelection,filterChange:t.handleFilter,sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,rowClick:t.handleRowClick}},[a("template",{slot:"header"},[a("div",{staticClass:"audit-action be-flex jc-space-between"},[a("div",{staticClass:"aciton-left flex"},[a("search-bar",{attrs:{search:t.params.search},on:{search:t.handleSearch}}),a("el-button",{staticClass:"be-button-unset btn-audit",staticStyle:{"margin-right":"20px","margin-left":"20px"},on:{click:t.handleOpentFilter}},[a("base-icon",{attrs:{icon:"filter"}}),t._v(" Bộ lọc ")],1),a("el-dropdown",{staticClass:"import-sort",attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("el-button",{staticClass:"be-button-unset custom-button"},[a("base-icon",{staticClass:"icon",attrs:{icon:"sort"}}),t._v(" Sắp xếp ")],1),a("el-dropdown-menu",{staticClass:"sort-menu-popper",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.option,(function(e){return a("el-dropdown-item",{key:e.id,class:e.active?"active":null,attrs:{command:e,divided:e.divided}},[a("span",{staticClass:"be-flex"},[a("span",{staticClass:"be-flex-item"},[t._v(" "+t._s(e.name)+" ")])])])})),1)],1)],1),a("div",{staticClass:"action-right flex actions"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.dataSelect.length>0,expression:"dataSelect.length > 0"}],attrs:{size:"medium"},on:{click:t.handleDestroyContract}},[t._v("Hủy thu phí")]),a("el-button",{staticClass:"custom-button",attrs:{loading:t.isLoadingButton},on:{click:t.handleOpenExportFile}},[a("span",{staticClass:"be-inline-flex align-center"},[a("base-icon",{staticClass:"icon",attrs:{icon:"excel-fullcolor"}}),t._v(" Xuất Excel ")],1)])],1)])]),a("el-table-column",{key:1,attrs:{type:"index",index:t.indexMethod,label:"#",width:"61",align:"center"}}),t.getRoleCbx?a("el-table-column",{key:100,attrs:{type:"selection"}}):t._e(),a("el-table-column",{key:98,staticClass:"checkLength",attrs:{prop:"applyFormNo",label:"Số HSYCBH",width:"110",align:"left"}}),a("el-table-column",{key:2,staticClass:"checkLength",attrs:{prop:"contractNo",label:"Số HĐBH",width:"120",align:"left"}}),t.getRoleBtnApp?a("el-table-column",{key:1e4,attrs:{width:"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-popover",{attrs:{placement:"bottom","popper-class":"popper-action-audit"},nativeOn:{click:function(e){return t.handleConflictClick.apply(null,arguments)}}},[a("div",{staticClass:"be-flex-column content poper-text"},["1"!==e.row.auditStatus&&"8"!==e.row.auditStatus||!t.checkSaleMember(e.row)?t._e():a("div",{staticClass:"content-item cursor",staticStyle:{"padding-bottom":"10px"},on:{click:function(a){return t.handleActionAudit({status:"edit",row:e.row})}}},[a("span",[t._v("Chỉnh sửa HĐ")])]),t.showActionDestroy(e.row)?a("div",{staticClass:"content-item cursor",staticStyle:{"padding-bottom":"10px"},on:{click:function(a){return t.handleActionAudit({status:"destroy",row:e.row})}}},[a("span",[t._v("Hủy thu phí")])]):t._e(),"1"===e.row.auditStatus||"8"===e.row.auditStatus?a("div",{staticClass:"content-item cursor",staticStyle:{"line-height":"36px","border-top":"1px solid #dbdbdb"},on:{click:function(a){return t.handleActionAudit({status:"delete",row:e.row})}}},[a("span",[t._v("Xóa")])]):t._e()]),a("div",{staticClass:"reference",attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"el-icon-more"})])])],1)]}}],null,!1,2962439568)}):t._e(),a("el-table-column",{key:99,staticClass:"checkLength",attrs:{label:"Chi nhánh",prop:"branchName",width:"220"}}),a("el-table-column",{key:4,staticClass:"checkLength",attrs:{label:"Đơn vị kinh doanh",prop:"transactionOfficeName",width:"220"}}),a("el-table-column",{key:5,staticClass:"checkLength",attrs:{label:"Mã NVTV",prop:"salesMemberNo",width:"110",align:"left"}}),a("el-table-column",{key:35,staticClass:"checkLength",attrs:{label:"NV tư vấn",prop:"salesFullName",width:"210"}}),a("el-table-column",{key:105,staticClass:"checkLength",attrs:{label:"Mã NV đứng code",prop:"consultantMemberNo",width:"155",align:"left"}}),a("el-table-column",{key:135,staticClass:"checkLength",attrs:{label:"NV đứng code",prop:"consultantName",width:"210"}}),a("el-table-column",{key:205,staticClass:"checkLength",attrs:{label:"Mã code",prop:"consultantNo",width:"110",align:"center"}}),a("el-table-column",{key:6,staticClass:"checkLength",attrs:{label:"Số CIF",prop:"customerCifCode",width:"110",align:"center"}}),a("el-table-column",{key:36,attrs:{label:"Tên BMBH",prop:"customerFullName",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("p",{staticClass:"checkLength uppercase"},[t._v(t._s(i.customerFullName))])]}}])}),a("el-table-column",{key:7,attrs:{label:"Mã Sản phẩm",prop:"productCode",width:"120",align:"left"}}),a("el-table-column",{key:37,attrs:{label:"Sản phẩm",prop:"productName",width:"265"}}),a("el-table-column",{key:8,staticClass:"checkLength",attrs:{label:"Phí năm (APE)",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.apeAmount)))]}}])}),a("el-table-column",{key:9,attrs:{label:"Trạng thái",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.auditStatus?a("span",{staticClass:"not-approve cell-status"},[t._v("Chưa đối soát")]):t._e(),"2"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Đang đối soát")]):t._e(),"3"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Chờ duyệt")]):t._e(),"4"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v(" Đã duyệt ")]):t._e(),"5"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),"6"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối duyệt")]):t._e(),"7"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v(" Từ chối hiệu chỉnh ")]):t._e(),"8"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Hiệu chỉnh")]):t._e(),"9"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Khớp")]):t._e()]}}])}),a("el-table-column",{key:10,staticClass:"checkLength",attrs:{label:"Phân loại KH",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.getRelationShip(e.row.customerType))+" ")]}}])}),a("el-table-column",{key:11,staticClass:"checkLength",attrs:{label:"Ngày nộp hs",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDateTime")(e.row.applyFormDate))+" ")]}}])}),a("el-table-column",{key:12,staticClass:"checkLength",attrs:{label:"Ngày ph",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDateTime")(e.row.issueDate))+" ")]}}])}),a("el-table-column",{key:13,staticClass:"checkLength",attrs:{label:"Ngày phí ps",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatDateTime")(e.row.lastPayDate)))]}}])}),a("el-table-column",{key:1111,attrs:{label:"Ngày dòng phí",align:"center",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDateTime")(e.row.daichiPayFeeDate))+" ")]}}])}),a("el-table-column",{key:14,staticClass:"checkLength",attrs:{label:"Ngày hết hạn",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatDateTime")(e.row.expireDate)))]}}])}),a("el-table-column",{key:15,staticClass:"checkLength",attrs:{label:"Định kỳ",width:"90",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("parsePaymentPeriod")(e.row.paymentPeriod)))]}}])}),a("el-table-column",{key:16,staticClass:"checkLength",attrs:{label:"năm hđ",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatTextLength")(e.row.currentContractYear)))]}}])}),a("el-table-column",{key:17,attrs:{label:"Năm phí",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatTextLength")(e.row.currentFeeYear)))]}}])}),a("el-table-column",{key:18,attrs:{label:"Phí cơ bản",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.basicAmount)))]}}])}),a("el-table-column",{key:19,attrs:{label:"Phí đóng thêm",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.extraAmount)))]}}])}),a("el-table-column",{key:20,attrs:{label:"Tổng phí",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.totalAmount))+" ")]}}])})],2)],1),a("pending-popup",{attrs:{query:t.params,dataSelect:t.dataSelect},on:{update:t.init,reset:t.resetSelectAudit}}),a("cancel-popup",{attrs:{query:t.params,dataSelect:t.dataSelect},on:{update:t.init,reset:t.resetSelectAudit}}),a("auditting-popup",{attrs:{pageNumber:t.pageSize,lastItem:t.checkLastItemSelect,query:t.params,dataSelect:t.dataSelect},on:{update:t.init,reset:t.resetSelectAudit}}),a("edit-request",{attrs:{pageNumber:t.pageSize,query:t.params,dataSelect:t.dataSelect},on:{update:t.init,reset:t.resetSelectAudit}}),a("request-cancel",{attrs:{query:t.params,dataSelect:t.dataSelect},on:{update:t.init,reset:t.resetSelectAudit}}),a("audit-popup-filter",{attrs:{type:t.$route.name},on:{apply:t.handleFilter}}),a("audit-popup-action",{attrs:{data:t.dataPopupAction,"data-select":t.dataSelect},on:{close:t.resetSelectAudit,update:t.init}}),a("action-popup",{attrs:{"data-select":t.dataClick,status:t.statusClick},on:{update:t.handleUpdatePage}}),a("detail-contract",{attrs:{dataEdit:t.dataEdit,detail:t.contractInfor,dataPopupconfirm:t.dataPopupconfirm},on:{reset:t.init,openDestroy:t.handleActionAudit}}),a("popup-confirm",{attrs:{dataProp:t.dataPopupconfirm},on:{confirm:t.handleConfirmDestroy}}),a("create-cost",{attrs:{dataProp:t.dataEdit},on:{reload:t.init}}),a("delete-contract",{attrs:{data:t.dataPopupconfirm},on:{delete:t.handleDelete}})],1)},n=[],s=a("f3f3"),o=a("c964"),c=a("276c"),r=a("e954"),l=a("920b"),u=a("92a6"),p=(a("96cf"),a("b0c0"),a("7db0"),a("a15b"),a("d81d"),a("99af"),a("ac1f"),a("841c"),a("4de4"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9ab4")),d=a("08ba"),h=a("1b40"),m=a("9f48"),f=a("ff0e"),b=a("fa2a"),g=a("3956"),v=a("a6fa"),y=a("fdb8"),k=a("13fb"),C=a("4a47e"),S=a("4897c"),w=a("4bb5"),_=a("e383"),O=a("2ef0"),N=a("567c"),P=a("9f13"),x=a("2b17"),A=a("c661"),T=a("4a7b8"),D=a("7836"),j=a("4f98"),L=a("03a0"),R=Object(w["a"])("beUser"),B=Object(w["a"])("beAudit"),F=function(t){Object(l["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(c["a"])(this,a),t=e.apply(this,arguments),t.isLoadingButton=!1,t.data={},t.valueSearch="",t.isLoading=!1,t.testData=[],t.dataTable=[],t.textButton="Đối soát",t.statusRoute="",t.pageSize="",t.dataSelect=[],t.dataClick=[],t.statusClick="",t.params={search:"",auditStatus:"",page:1,limit:20,orderByClause:"1",searchType:"CONTRACT",contractStatus:""},t.query={total:0,page:t.params.page,limit:t.params.limit},t.isConflickClick=!1,t.dataPopup={total:t.data.total,data:[],action:""},t.valueFilter={},t.option=[{id:1,name:"Đơn vị kinh doanh",divided:!1},{id:6,name:"Tổng phí",divided:!0},{id:2,name:"Ngày phát hành",divided:!0},{id:3,name:"Ngày đóng phí",divided:!1},{id:4,name:"Ngày hết hạn",divided:!1},{id:5,name:"Mã sản phẩm",divided:!0}],t.listType=[],t.isShow=!1,t.propValueSearch="",t.contractInfor={},t.dataPopupconfirm={title:"",message:"",text:"",ids:[]},t.dataEdit={title:"Sửa thu phí",code:"detail",bankContractNo:"",type:"audit"},t.dataPopupAction={title:"",label:"",code:"",contractNo:[]},t.checkLastItemSelect=!1,t.checkReqToEdit=!1,t.fileName="",t.listFilter=[],t.checkCustomerType=!1,t.filters={name:"Bộ lọc"},t.url="",t}return Object(r["a"])(a,[{key:"splitButton",get:function(){return"da-duyet"!=this.$route.params.status}},{key:"nameButtonAction",get:function(){var t="Gán nhân viên tư vấn",e=this.$route.params.status;return"cho-duyet"==e&&(t="Từ chối duyệt"),"da-duyet"==e&&(t="Yêu cầu hiệu chỉnh"),"yeu-cau-hieu-chinh"==e&&(t="Từ chối hiệu chỉnh"),t}},{key:"getRoleBtnAudit",get:function(){return!this.$route.params.status&&this.checkPemission("audit",["edit-no-audit"])}},{key:"getRoleBtnCancelHc",get:function(){return this.checkPemission("audit",["edit-request"])}},{key:"getRoleBtnCancelTc",get:function(){return this.checkPemission("audit",["edit-pending"])}},{key:"getRoleBtnReq",get:function(){return this.checkPemission("audit",["edit-auditing"])}},{key:"getRoleBtnApp",get:function(){return this.checkPemission("audit",["edit-pending","edit-no-audit"])}},{key:"getRoleBtnAppRq",get:function(){return this.checkPemission("audit",["edit-request"])}},{key:"getRoleCbx",get:function(){return this.checkPemission("audit",["cbx-action-edit-no-audit"])}},{key:"changeTab",value:function(t){this.resetData();var e=this.getFilter(this.$route.name);e?(this.params=Object(O["assign"])(this.params,e.filters),this.checkRouteStatus(t)):(this.params={search:"",page:1,limit:20,orderByClause:"1",searchType:"CONTRACT"},this.checkRouteStatus(t));var a=document.getElementsByClassName("el-table__body-wrapper")[0];a&&(a.scrollTop=0,a.scrollLeft=0),this.init()}},{key:"checkBetweenDay",value:function(t){var e=864e5,a=new Date(t).getTime()+e;return(new Date).getTime()>=new Date(t).getTime()&&(new Date).getTime()<=a}},{key:"checkSaleMember",value:function(t){var e=1===this.role.userRole.length&&this.role.userRole.find((function(t){return"TRANSACTION_OFFICE_MEMBER"===t}));return!(e&&t.createdBy===this.user.id&&t.salesMemberId!==this.user.memberId&&!this.checkBetweenDay(t.createdAt))}},{key:"showActionDestroy",value:function(t){var e=new Date,a=!1;if(t.allowCancelDate){var i=new Date(t.allowCancelDate);a=i>e}else a=!0;return!("2"===t.contractStatus||!a)}},{key:"indexMethod",value:function(t){return(this.params.page-1)*this.params.limit+t+1}},{key:"handleConflictClick",value:function(){this.isConflickClick=!0}},{key:"handleConfirmDestroy",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=this.dataPopupconfirm.ids,t.next=3,null===(e=this.apiContract)||void 0===e?void 0:e.deleteContract({ids:a}).then((function(){i.$message({type:"success",message:"Hủy thành công"}),i.setOpenPopup({popupName:"popup-confirm",isOpen:!1}),i.dataSelect=[],i.init()})).catch((function(t){i.$message({dangerouslyUseHTMLString:!0,type:"warning",message:t.message}),i.setOpenPopup({popupName:"popup-confirm",isOpen:!1})}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"resetData",value:function(){this.dataSelect=[],this.params.limit=20,this.params.page=1,this.query.page=this.params.page,this.query.limit=this.params.limit,this.dataPopup={total:this.data.total,data:[],action:""}}},{key:"handleActionAudit",value:function(t){var e=t.status,a=t.row;if("destroy"==e){var i=[];for(var n in a){var s;if("applyFormNo"==n&&a[n]&&i.push(a[n]),"contractNo"==n&&a[n]&&i.push(a[n]),"totalAmount"==n&&a[n])i.push(null===(s=this.$options.filters)||void 0===s?void 0:s.formatNumberDot(a[n]))}var o=i?i.join(" / "):"";this.dataPopupconfirm={title:"Xác nhận hủy",text:"Bạn có chắc chắn hủy",message:o,ids:[a.id]},this.setOpenPopup({popupName:"popup-confirm",isOpen:!0})}if("destroy-detail"==e){if(a.subContracts.length>0){this.dataPopupconfirm.ids=a.subContracts.map((function(t){return t.id}));var c=a.subContracts.map((function(t){return"".concat(a.applyFormNo?a.applyFormNo+" / ":"").concat(t.contractNo?t.contractNo:"")})).join(", ");this.dataPopupconfirm.message=c}else this.dataPopupconfirm.ids=[a.id],this.dataPopupconfirm.message="".concat(a.applyFormNo?a.applyFormNo+" / ":"").concat(a.contractNo?a.contractNo:"");this.setOpenPopup({popupName:"popup-confirm",isOpen:!0})}if("edit"==e&&(this.dataEdit.code=e,this.dataEdit.bankContractNo=a.bankContractNo,this.dataEdit.type="audit",this.setOpenPopup({popupName:"create-cost",isOpen:!0})),"delete"==e){var r=[];for(var l in a){var u;if("applyFormNo"==l&&a[l]&&r.push(a[l]),"contractNo"==l&&a[l]&&r.push(a[l]),"productCode"==l&&a[l]&&r.push(a[l]),"totalAmount"==l&&a[l])r.push(null===(u=this.$options.filters)||void 0===u?void 0:u.formatNumberDot(a[l]))}var p=r?r.join(" / "):"";this.dataPopupconfirm={title:"Xác nhận xóa",text:"Bạn có chắc chắn xóa",message:p,ids:[a.id]},this.setOpenPopup({popupName:"popupDeleteContract",isOpen:!0})}}},{key:"handleDelete",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.apiContract)||void 0===e?void 0:e.deleteContract2(this.dataPopupconfirm.ids).then((function(){a.$message({type:"success",message:"Xóa thành công"}),a.setOpenPopup({popupName:"popupDeleteContract",isOpen:!1}),a.init()})).catch((function(t){a.$message.error(t.message)}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleDestroyContract",value:function(){if(this.dataSelect){var t=this.dataSelect.map((function(t){return t.id}));this.dataPopupconfirm={title:"Xác nhận hủy",text:"Bạn có chắc chắn hủy",message:"",ids:t},this.setOpenPopup({popupName:"popup-confirm",isOpen:!0})}}},{key:"handleRowClick",value:function(t){this.isConflickClick?this.isConflickClick=!1:1!=this.checkReqToEdit&&(this.contractInfor=t.row,this.dataPopup.action="detail",this.dataPopup.data=[t.row],this.dataPopup.total=this.dataPopup.data.length,this.setOpenPopup({popupName:"contractDetail",isOpen:!0}))}},{key:"handleSizeChange",value:function(t){var e;this.params.page=1,this.params.limit=t,this.query.page=this.params.page,this.query.limit=this.params.limit,this.init(),null===(e=this.apiContract)||void 0===e||e.getData(this.params)}},{key:"handleCurrentChange",value:function(t){this.params.page=t,this.init()}},{key:"handleOpentFilter",value:function(){this.setOpenPopup({popupName:"audit-filter",isOpen:!0})}},{key:"handleCloseLoading",value:function(){var t=this;setTimeout((function(){t.isLoading=!1}),1e3)}},{key:"handleCommand",value:function(t){Object(O["forEach"])(this.option,(function(e){t.id===e.id?e.active=!0:e.active=!1})),this.params.orderByClause=t.id,this.init()}},{key:"handleChangeAction",value:function(t){if(!(this.dataSelect.length<1))switch(this.dataPopupAction={action:t,total:this.dataSelect.length,contractNo:this.dataSelect.map((function(t){return t.contractNo})).join(","),bankContractNo:this.dataSelect.map((function(t){return t.bankContractNo})).join(",")},this.dataPopupAction.code=t,t){case"introStaff":this.dataPopupAction.title="Gán nhân viên giới thiệu",this.dataPopupAction.label="Nhân viên giới thiệu",this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"customerCif":this.dataPopupAction.title="Gán CIF khách hàng ",this.dataPopupAction.label="Số CIF khách hàng ",this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"relationship":this.dataPopupAction.title="Gán Phân loại KH",this.dataPopupAction.label="Phân loại KH",this.dataPopupAction.optionsRelationship=this.listType,this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"request-approve":this.setOpenPopup({popupName:"auditting-popup",isOpen:!0});break;case"value-request-correction":this.setOpenPopup({popupName:"edit-popup",isOpen:!0});break;case"value-decline":this.setOpenPopup({popupName:"cancel-popup",isOpen:!0});break;case"value-aprrove":this.setOpenPopup({popupName:"pending-popup",isOpen:!0});break}}},{key:"resetSelectAudit",value:function(){this.checkReqToEdit=!1,this.dataPopup.data=[],this.dataSelect=[],this.$refs.auditTable&&this.$refs.auditTable.clearSelection()}},{key:"checkRouteStatus",value:function(t){switch(console.log(t),t){case"dang-doi-soat":this.textButton="Yêu cầu duyệt",this.params.auditStatus="2",this.fileName="dang_doi_soat";break;case"cho-duyet":this.textButton="Phê duyệt",this.params.auditStatus="3",this.fileName="cho_duyet";break;case"tu-choi":this.params.auditStatus="6",this.textButton="",this.fileName="tu_choi";break;case"da-duyet":this.textButton="Đã duyệt",this.params.auditStatus="4",this.fileName="da_duyet";break;case"yeu-cau-hieu-chinh":this.textButton="Đã duyệt",this.params.auditStatus="5",this.fileName="yeu_cau_hieu_chinh";break;case"audit":this.textButton="Đối soát",this.params.auditStatus="1",this.fileName="chua_doi_soat";break;case void 0:this.textButton="Đối soát",this.params.auditStatus="1",this.fileName="chua_doi_soat";break}}},{key:"getRelationShip",value:function(t){return P["RELATIONSHIP_VALUE_TO_TYPE"][t]}},{key:"handleOpenDeclinePopup",value:function(){this.dataSelect=[],this.setOpenPopup({popupName:"cancel-popup",isOpen:!0})}},{key:"handleOpenAuditPopup",value:function(){var t=this.$route.params.status;switch(this.dataSelect=[],this.dataPopup.action="",t){case"dang-doi-soat":this.setOpenPopup({popupName:"auditting-popup",isOpen:!0});break;case"cho-duyet":this.setOpenPopup({popupName:"pending-popup",isOpen:!0});break;case"yeu-cau-hieu-chinh":this.setOpenPopup({popupName:"edit-popup",isOpen:!0});break;case"tu-choi":this.setOpenPopup({popupName:"requestcancel-popup",isOpen:!0});break;default:this.dataPopup.action="",this.dataPopup.data=this.dataTable,this.setOpenPopup({popupName:"audit",isOpen:!0});break}}},{key:"handleSearch",value:function(t){this.params.page=1,this.params.search=t,this.init()}},{key:"handleSelection",value:function(t,e){if(this.pageSize=this.params.limit,e){var a=t.find((function(t){return t.id==e.id}));if(a&&a.id>0){var i=this.dataTable.filter((function(t){return t.bankContractNo===(null===e||void 0===e?void 0:e.bankContractNo)&&t.id!==(null===e||void 0===e?void 0:e.id)}));this.$refs.auditTable.updateSelection(i),this.dataSelect=this.$refs.auditTable.getSelection()}else this.dataSelect=t.filter((function(t){return t.bankContractNo!==(null===e||void 0===e?void 0:e.bankContractNo)})),this.$refs.auditTable.clearSelection(),this.$refs.auditTable.updateSelection(this.dataSelect);var n=this.dataTable[this.dataTable.length-1].bankContractNo,s=this.dataSelect.some((function(t){return t.bankContractNo==n}));this.checkLastItemSelect=!!s}else this.dataSelect=t;var o=this.listFilter.filter((function(t){return"1"===t.customerType||"4"===t.customerType}));o.length>0&&(this.checkCustomerType=!0)}},{key:"handleOpenFilter",value:function(){this.setOpenPopup({popupName:"audit-popup-filter",isOpen:!0})}},{key:"handleClickReqEdit",value:function(t){this.checkReqToEdit=!0,this.dataSelect=this.dataTable.filter((function(e){return e.bankContractNo==t.bankContractNo})),this.setOpenPopup({popupName:"edit-popup",isOpen:!0})}},{key:"handleFilter",value:function(t){this.params=Object(s["a"])(Object(s["a"])({},this.params),t),this.params.page=1,this.init()}},{key:"handleOpenExportFile",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(this.dataTable.length<1)){t.next=3;break}return this.$message.warning("Không tìm thấy dữ liệu xuất file"),t.abrupt("return");case 3:if(!(this.query.total>=5e4)){t.next=6;break}return this.$message.warning("Số lượng bản ghi vượt quá 50000, vui lòng sử dụng bộ lọc"),t.abrupt("return");case 6:return this.isLoadingButton=!0,i=new Date,n="".concat(i.getFullYear()).concat(i.getMonth()+1).concat(i.getDate(),"_").concat(i.getHours()).concat(i.getMinutes()).concat(i.getSeconds()),delete this.params.newAuditStatus,t.next=12,null===(e=this.apiExport)||void 0===e?void 0:e.exportAuditExcel(this.params).then((function(t){a=t;var e=window.URL.createObjectURL(new Blob([a.data])),i=document.createElement("a");i.href=e,i.setAttribute("download","Danh_sach_".concat(s.fileName,"_").concat(n,".xlsx")),document.body.appendChild(i),i.click(),s.isLoadingButton=!1})).catch((function(){s.isLoadingButton=!1}));case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"init",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoading=!0,this.dataEdit={title:"Sửa thu phí",code:"detail",bankContractNo:"",type:"audit"},this.dataSelect=[],i=this.getFilter(this.$route.name),i&&(this.params=Object(O["assign"])(this.params,i.filters)),this.checkRouteStatus(this.$route.name),this.params.page||(this.params.page=1),this.params.limit||(this.params.limit=20),this.params.orderByClause||(this.params.orderByClause="1"),this.dataPopup.action="",this.query.page=this.params.page,this.query.limit=this.params.limit,delete this.params.newAuditStatus,t.next=15,null===(e=this.apiContract)||void 0===e?void 0:e.getData(this.params).then((function(t){n.data=t,n.dataTable=n.data.data,n.isLoading=!1})).catch((function(){n.dataTable=[],n.isLoading=!1}));case 15:null===(a=this.apiContract)||void 0===a||a.getContractCount(this.params).then((function(t){n.query.total=t.data,n.isLoading=!1})).catch((function(){n.query.total=0,n.isLoading=!1}));case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"setParamsForUser",value:function(){var t,e,a,i;this.getDisableArea&&(this.params.areaIdArray="".concat(null===(t=this.user)||void 0===t?void 0:t.areaId),this.params.branchIdArray="".concat(null===(e=this.user)||void 0===e?void 0:e.branchId));this.getDisableTransaction&&(this.params.transOfficeIdArray="".concat(null===(a=this.user)||void 0===a?void 0:a.transactionOfficeId));this.getDisableSaleMember&&(this.params.salesMemberIdArray="".concat(null===(i=this.user)||void 0===i?void 0:i.id))}},{key:"created",value:function(){var t,e,a,i,n,s,o,c;this.api=Object(d["a"])("audit",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiContract=Object(d["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.apiParam=Object(d["a"])("param",{districtId:null===(n=this.user)||void 0===n||null===(s=n.districts)||void 0===s?void 0:s[0].id}),this.apiExport=Object(d["a"])("export",{districtId:null===(o=this.user)||void 0===o||null===(c=o.districts)||void 0===c?void 0:c[0].id}),this.init()}},{key:"handleUpdatePage",value:function(){this.init()}}]),a}(Object(h["b"])(m["a"],_["a"],x["a"]));Object(p["a"])([B.Getter("getFilter")],F.prototype,"getFilter",void 0),Object(p["a"])([R.State("role")],F.prototype,"role",void 0),Object(p["a"])([Object(h["e"])("$route.name")],F.prototype,"changeTab",null),F=Object(p["a"])([Object(h["a"])({components:{CreateCost:j["a"],DeleteContract:L["a"],PopupConfirm:D["a"],DetailContract:T["a"],AuditPopup:f["a"],AudittingPopup:b["a"],PendingPopup:y["a"],AuditPopupFilter:C["a"],AuditPopupAction:S["a"],CancelPopup:k["a"],SearchBar:N["a"],EditRequest:v["a"],RequestCancel:g["a"],ActionPopup:A["a"]}})],F);var q=F,E=q,I=(a("9723"),a("2877")),$=Object(I["a"])(E,i,n,!1,null,"5155b29c",null);e["default"]=$.exports},9723:function(t,e,a){"use strict";a("2348")},a7ba:function(t,e,a){}}]);
//# sourceMappingURL=chunk-48748a0f.e0eafa66.js.map