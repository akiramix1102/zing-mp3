(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f15ec138"],{1380:function(t,e,a){},3982:function(t,e,a){"use strict";a("b492")},"3b23":function(t,e,a){"use strict";a("b5c0")},"3e29c":function(t,e,a){"use strict";a("1380")},"494c":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"import-filter"},[a("div",{staticClass:"be-flex jc-space-between"},[a("div",{staticClass:"action-left flex"},[a("div",{staticClass:"search"},[a("span",{staticClass:"flex"},[a("base-icon",{staticClass:"icon-search",attrs:{icon:"search"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.search,expression:"filter.search"}],staticClass:"searchBar",attrs:{type:"text",placeholder:"Tìm kiếm..."},domProps:{value:t.filter.search},on:{input:function(e){e.target.composing||t.$set(t.filter,"search",e.target.value)}}})],1)]),a("div",{staticClass:"filter-item"},[a("el-popover",{attrs:{placement:"bottom","popper-class":"popper-filter-import",width:"340",trigger:"click"},on:{show:t.handleShowPopper}},[a("div",{staticClass:"content"},[a("div",{staticClass:"be-flex-column uploader"},[a("span",{staticClass:"label small"},[t._v("Người tải lên")]),a("el-select",{attrs:{"remote-method":t.remoteMethod,multiple:"",filterable:"",remote:"",clearable:"","popper-class":"uploader-select",placeholder:"Người tải lên"},on:{change:t.handleChangeUser},model:{value:t.filter.userId,callback:function(e){t.$set(t.filter,"userId",e)},expression:"filter.userId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},t._l(t.members,(function(t){return a("el-option",{key:t.id,attrs:{label:t.memberNo+" - "+t.fullName,value:t.userId}})})),1)])],1)]),a("div",{staticClass:"be-flex-column select-date-upload"},[a("span",{staticClass:"label small"},[t._v("Ngày tải lên")]),a("div",{staticClass:"be-flex select-date-time"},[a("div",{staticClass:"date-item"},[a("el-date-picker",{attrs:{format:"dd/MM/yyyy","value-format":"timestamp",type:"date",placeholder:"Từ ngày"},on:{change:t.handleChangeDate},model:{value:t.filter.dateStart,callback:function(e){t.$set(t.filter,"dateStart",e)},expression:"filter.dateStart"}})],1),a("div",{staticClass:"date-item"},[a("el-date-picker",{attrs:{"picker-options":t.dateOption,format:"dd/MM/yyyy","value-format":"timestamp",type:"date",placeholder:"Đến ngày"},on:{change:t.handleChangeDate},model:{value:t.filter.dateEnd,callback:function(e){t.$set(t.filter,"dateEnd",e)},expression:"filter.dateEnd"}})],1)])]),a("div",{staticClass:"status"},[a("div",{staticClass:"label small"},[t._v("Trạng thái")]),a("el-checkbox-group",{staticClass:"checkbox-status",on:{change:t.handleChangeCheckBox},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[a("el-checkbox",{attrs:{label:"IN_PROGRESS",value:"abc"}},[t._v("Đang xử lý")]),a("el-checkbox",{attrs:{label:"FAIL"}},[t._v("Lỗi dữ liệu")]),a("el-checkbox",{attrs:{label:"COMPLETED"}},[t._v("Đã xử lý")])],1)],1),a("div",{staticClass:"cursor text-filter",attrs:{slot:"reference"},slot:"reference"},[a("base-icon",{attrs:{icon:"filter"}}),a("span",[t._v("Bộ lọc")])],1)])],1)])])])},l=[],n=a("d0ff"),s=a("276c"),r=a("e954"),o=a("920b"),c=a("92a6"),u=(a("4de4"),a("ac1f"),a("841c"),a("a15b"),a("1276"),a("99af"),a("9ab4")),d=a("1b40"),h=a("6d3f"),p=a("08ba"),f=a("2ef0"),m=Object(p["a"])("employee",{districtId:14}),b=function(t){Object(o["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.members=[],t.filter={userId:[],dateStart:null,dateEnd:null,status:[],search:""},t.queryUser={i:0,ps:20,groupCode:"INSURANCE",statusAccount:3,search:""},t}return Object(r["a"])(a,[{key:"handleRouteNameChange",value:function(){this.members=[],this.filter={userId:[],dateStart:null,dateEnd:null,status:[],search:""},this.resetQuery()}},{key:"dateOption",get:function(){var t=this;return{disabledDate:function(e){return t.disabledDate(e)}}}},{key:"disabledDate",value:function(t){if(this.filter.dateStart)return t.getTime()<this.filter.dateStart+864e5}},{key:"handleSearch",value:function(t){this.$emit("search",t)}},{key:"remoteMethod",value:function(t){var e=this;this.resetQuery(),this.queryUser.search=Object(f["trim"])(t),m.all(this.queryUser).then((function(t){e.members=t}))}},{key:"resetQuery",value:function(){this.queryUser={i:0,ps:20,search:"",groupCode:"INSURANCE",statusAccount:3}}},{key:"handleChangeDate",value:function(){if(this.filter.dateStart&&this.filter.dateEnd){var t=new Date(this.filter.dateStart),e=new Date(this.filter.dateEnd),a=this.$options.filters.formatDateTime(t),i=a.split("/").reverse().join("-"),l=this.$options.filters.formatDateTime(e),n=l.split("/").reverse().join("-");this.$emit("filterDate",{fd:i,td:n})}if(!this.filter.dateStart&&!this.filter.dateEnd){var s=null,r=null;this.$emit("filterDate",{fd:s,td:r})}}},{key:"handleShowPopper",value:function(){this.members.length||this.handleGetMembers()}},{key:"handleGetMembers",value:function(){var t=this;m.all(this.queryUser).then((function(e){t.members=[].concat(Object(n["a"])(t.members),Object(n["a"])(e))}))}},{key:"handleChangeCheckBox",value:function(t){this.$emit("filterStatus",t)}},{key:"handleChangeUser",value:function(t){this.$emit("filterUser",t)}},{key:"load",value:function(){this.queryUser.i+=20,this.handleGetMembers()}}]),a}(d["d"]);Object(u["a"])([Object(d["e"])("$route.name")],b.prototype,"handleRouteNameChange",null),Object(u["a"])([Object(d["e"])("filter.search")],b.prototype,"handleSearch",null),b=Object(u["a"])([Object(d["a"])({components:{BaseIcon:h["a"]}})],b);var g=b,v=g,y=(a("3b23"),a("2877")),C=Object(y["a"])(v,i,l,!1,null,"444f3890",null);e["a"]=C.exports},"80d0":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"import-page"},[a("div",{staticClass:"be-flex main-action"},[a("div",{staticClass:"main-action__left"},[a("import-filter",{on:{search:t.handleSearch,filterDate:t.handleFilterDate,filterStatus:t.handleFilterStatus,filterUser:t.handleFilterUser}})],1),a("div",{staticStyle:{display:"flex"}},[a("el-button",{staticClass:"custom-button",staticStyle:{"margin-right":"10px"},attrs:{loading:t.isLoadingButton},on:{click:t.handleOpenExportFile}},[a("span",{staticClass:"be-inline-flex align-center"},[a("base-icon",{staticClass:"icon",attrs:{icon:"excel-fullcolor"}}),t._v(" Tải file mẫu ")],1)]),a("button",{staticClass:"cursor btn_upload",on:{click:t.UploadFileYear}},[t._v("Upload file")])],1)]),a("div",{staticClass:"import-table"},[a("base-table",{attrs:{data:t.data,table:t.query,paginationInfo:"file","is-loading":t.isLoading,emptyText:"Không có dữ liệu cập nhật"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,rowClick:t.handleGetDetail}},[a("el-table-column",{attrs:{index:t.getIndex,type:"index",label:"#",width:"80",align:"center"}}),a("el-table-column",{attrs:{prop:"fileName",label:"TÊN"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.fileName))]),e.row.size?a("span",{staticClass:"small"},[t._v(t._s(t._f("bytesToSize")(e.row.size)))]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"peopleUpload",label:"NGƯỜI TẢI LÊN",width:"280"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"flex wrap-name"},[a("div",{staticClass:"flex-item-avatar"},[a("base-avatar",{attrs:{url:e.row.avatar,size:"xs"}})],1),a("div",{staticClass:"flex-item-name"},[t._v(" "+t._s(e.row.userName)),a("br"),a("span",{staticClass:"small"},[t._v(" "+t._s(e.row.userCode))])])])]}}])}),a("el-table-column",{attrs:{prop:"date_time",label:"NGÀY GIỜ",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDateHour")(e.row.createdAt)))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"TRẠNG THÁI",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["IN_PROGRESS"===e.row.status||"NEW"===e.row.status||"SUCCESS"===e.row.status?a("span",{staticClass:"status processing"},[t._v("Đang xử lý")]):t._e(),"FAIL"===e.row.status?a("span",{staticClass:"status error_data"},[t._v("Lỗi dữ liệu")]):t._e(),"COMPLETED"===e.row.status?a("span",{staticClass:"status processed"},[t._v("Đã xử lý")]):t._e()]}}])})],1)],1),a("import-file-detail",{attrs:{"detail-file":t.detailFile,"is-error":t.isError}}),a("upload-file",{on:{apply:t.init}})],1)},l=[],n=a("f3f3"),s=a("c964"),r=a("276c"),o=a("e954"),c=a("920b"),u=a("92a6"),d=(a("96cf"),a("4de4"),a("ac1f"),a("841c"),a("b0c0"),a("a15b"),a("9ab4")),h=a("1b40"),p=a("9f48"),f=a("c56f"),m=a("08ba"),b=a("4bb5"),g=a("494c"),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"popup-file-detail popup-file-cttd",attrs:{name:"popup-detail-cttd",open:t.handleOpen,close:t.handleClose,width:t.getRouteName?"1200px":"900px",hiddenFooter:!0}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("Chi tiết file kết quả chương trình thi đua")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoadingPopup,expression:"isLoadingPopup"}],staticClass:"body-content"},[a("div",{staticClass:"body-content__header"},[a("div",{staticClass:"be-flex-column header-file-name"},[a("span",{staticClass:"file-name"},[t._v(t._s(t.fileName))]),a("div",{staticClass:"be-flex wrap-user-name"},[a("base-avatar",{attrs:{url:t.detailFile.avatar,size:"xs"}}),a("span",{staticClass:"user-name"},[t._v(t._s(t.detailFile.userName))]),a("span",{staticClass:"date-time"},[t._v(t._s(t._f("formatDateHour")(t.detailFile.createdAt)))])],1)])]),t.isError?t._e():a("div",{staticClass:"body-content__table body-content__table--error"},[t.getRouteName?a("base-tree-table",{attrs:{data:t.data,table:t.query,isLoading:t.isLoading,paginationInfo:"dòng",showPagination:!0},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange}},[a("el-table-column",{attrs:{index:t.getIndex,type:"index",label:"#",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"Mã nv",width:"120",align:"left",prop:"memberCode"}}),a("el-table-column",{attrs:{width:"40"}}),a("el-table-column",{attrs:{label:"Tên cbnv",align:"left",width:"240px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.memberName))])]}}],null,!1,1503834321)}),a("el-table-column",{attrs:{label:"Mã ĐVKD",width:"100",align:"center",prop:"transactionOfficeCode"}}),a("el-table-column",{attrs:{width:"40"}}),a("el-table-column",{attrs:{label:"Tên ĐVKD",align:"left",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e.row.transactionOfficeName))])]}}],null,!1,4156176622)}),a("el-table-column",{attrs:{label:"kết quả",prop:"fypAmount",align:"right",width:"170px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.fypAmount))+" ")]}}],null,!1,180211879)}),a("el-table-column",{attrs:{label:"Hỗ trợ",prop:"supportAmount",align:"right",width:"170px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.supportAmount))+" ")]}}],null,!1,4162193319)})],1):a("base-tree-table",{attrs:{data:t.data,table:t.query,isLoading:t.isLoading,paginationInfo:"dòng",showPagination:!0},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange}},[a("el-table-column",{attrs:{index:t.getIndex,type:"index",label:"#",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"Mã ĐVKD",width:"120",align:"center",prop:"transactionOfficeCode"}}),a("el-table-column",{attrs:{width:"40"}}),a("el-table-column",{attrs:{label:"Tên ĐVKD",align:"left",width:"260px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(e.row.transactionOfficeName))])]}}],null,!1,4156176622)}),a("el-table-column",{attrs:{label:"kết quả",prop:"result",align:"right",width:"180px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.fypAmount))+" ")]}}],null,!1,180211879)}),a("el-table-column",{attrs:{label:"Hỗ trợ",prop:"support",align:"right",width:"180px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.supportAmount))+" ")]}}],null,!1,4162193319)})],1)],1),t.isError?a("div",{staticClass:"body-content__content body-content__content--error"},[a("div",{staticClass:"text-column"},[a("div",{staticClass:"be-flex text-item"},[a("span",{staticClass:"text-item__title"},[t._v("Số dòng lỗi format")]),a("span",{staticClass:"text-item__number text-bold"},[t._v(t._s(t.totalErrorCount))])])])]):t._e(),t.isError?a("div",{staticClass:"body-content__table body-content__table--error"},[a("base-table",{attrs:{data:t.dataError,table:t.query,isLoading:t.isLoading,paginationInfo:"dòng"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange}},[a("el-table-column",{attrs:{index:t.getIndex,type:"index",label:"#",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"stt dòng",width:"90",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.rowIndex)+" ")]}}],null,!1,3765580137)}),a("el-table-column",{attrs:{width:"20"}}),a("el-table-column",{attrs:{label:"mô tả lỗi"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.description)+" ")]}}],null,!1,1461819547)})],1)],1):t._e()])])},y=[],C=a("6d3f"),_=a("ef28"),k=Object(m["a"])("import"),O=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.data=[],t.detail={},t.tableHeight="auto",t.errorRow=[],t.dataError=[],t.totalErrorCount=0,t.sheetAactive="KHKD",t.isLoading=!1,t.isLoadingPopup=!1,t.query={page:1,limit:20,total:0},t}return Object(o["a"])(a,[{key:"getRouteName",get:function(){return"importCbnv"===this.$route.name}},{key:"getHeightOfTable",value:function(){this.tableHeight="".concat(window.innerHeight-123,"px")}},{key:"mounted",value:function(){this.getHeightOfTable()}},{key:"getIndex",get:function(){return this.query.limit*(this.query.page-1)+1}},{key:"fileName",get:function(){return this.detailFile&&this.detailFile.fileName?this.detailFile.fileName.replaceAll(".xlsx"," "):""}},{key:"handleOpen",value:function(){this.init()}},{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?this.isLoading=!0:this.isLoadingPopup=!0;var a=this.isError?null:"importCbnv"===this.$route.name?"CTTD_CBNV":"CTTD_DVKD",i=Object(n["a"])(Object(n["a"])({},this.query),{},{total:null,fileId:this.detailFile.id,sheetName:a});k.getDetail(this.districtId,this.isError,i).then((function(a){var i;t.isError?(t.dataError=a.list,t.totalErrorCount=a.total,t.query.total=a.total):(t.detail=a.total,t.data=a.list,t.query.total=null===(i=a.total)||void 0===i?void 0:i.numOfRow);e?t.isLoading=!1:t.isLoadingPopup=!1})).catch((function(a){e?t.isLoading=!1:t.isLoadingPopup=!1,t.$message.error(a.message)}))}},{key:"resetQuery",value:function(){this.query={page:1,limit:20,total:0}}},{key:"handleClose",value:function(){this.detail={},this.dataError=[],this.errorRow=[],this.resetQuery()}},{key:"handleSizeChange",value:function(t){this.query.limit=t,this.init(!0)}},{key:"handleCurrentChange",value:function(t){this.query.page=t,this.init(!0)}}]),a}(Object(h["b"])(p["a"],f["a"]));Object(d["a"])([Object(h["c"])({required:!1,type:Object,default:{}})],O.prototype,"detailFile",void 0),Object(d["a"])([Object(h["c"])({required:!1,type:Boolean,default:!1})],O.prototype,"isError",void 0),O=Object(d["a"])([Object(h["a"])({components:{BaseTable:_["a"],BaseIcon:C["a"]}})],O);var w=O,x=w,j=(a("3982"),a("2877")),S=Object(j["a"])(x,v,y,!1,null,"08e9c909",null),N=S.exports,I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"upload-file-year popup-upload-cttd",attrs:{name:"upload-file-year",width:"500px",top:"20vh",hiddenFooter:!0,close:t.handleClose,open:t.handleOpen}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("Thêm mới")]),a("div",{staticClass:"content"},[a("div",{staticClass:"content-right"},[a("el-form",[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"Chương trình thi đua"}},[a("el-select",{attrs:{placeholder:"Mã - Tên chương trình thi đua",remote:"",filterable:"","remote-method":t.remoteCttd,clearable:""},model:{value:t.form.programId,callback:function(e){t.$set(t.form,"programId",e)},expression:"form.programId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreCttd,expression:"loadMoreCttd"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},t._l(t.listCttd,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.programCode+" - "+t.programName}})})),1)])],1)],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"Tháng lương chi trả"}},[a("el-select",{attrs:{placeholder:"Chọn tháng",clearable:""},model:{value:t.form.month,callback:function(e){t.$set(t.form,"month",e)},expression:"form.month"}},t._l(12,(function(t){return a("el-option",{key:t,attrs:{value:t,label:"Tháng "+t}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"opcity",attrs:{label:"a"}},[a("el-date-picker",{attrs:{type:"year",placeholder:"Chọn năm",clearable:""},model:{value:t.form.year,callback:function(e){t.$set(t.form,"year",e)},expression:"form.year"}})],1)],1)],1)],1)],1)]),a("div",{staticClass:"bottom"},[a("button",{staticClass:"btn-close",on:{click:t.handleCancel}},[t._v("Huỷ")]),a("el-upload",{staticClass:"upload-demo",attrs:{action:"","auto-upload":!1,accept:t._f("joinArray")(t.fileAccept),"show-file-list":!1,"on-change":t.handleChangeFile}},[a("button",{staticClass:"btn-upload",on:{click:t.handleChangeFile}},[t._v("Upload file")])])],1)])},E=[],R=a("d0ff"),q=(a("99af"),a("c178")),F=a("2ef0"),D=Object(m["a"])("import"),L=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.listCttd=[],t.form={year:(new Date).getFullYear()+"",month:(new Date).getMonth()+1},t.query={pageNo:1,pageSize:20,search:""},t.fileAccept=q["a"],t.listProgram=[],t}return Object(o["a"])(a,[{key:"created",value:function(){this.programReq=Object(m["a"])("program",{districtId:this.districtId})}},{key:"handleOpen",value:function(){this.getListCttd("")}},{key:"loadMoreCttd",value:function(){this.query.pageNo+=1;var t=Object(F["debounce"])(this.getListCttd,200);t(this.query.search,!0)}},{key:"remoteCttd",value:function(t){this.query.search=Object(F["trim"])(t),this.query.pageNo=1,this.query.pageSize=20;var e=Object(F["debounce"])(this.getListCttd,500);e(t)}},{key:"getListCttd",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,i,l,n=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=n.length>1&&void 0!==n[1]&&n[1],t.prev=1,t.next=4,this.programReq.search({keywordString:Object(F["trim"])(e),pageNo:this.query.pageNo,pageSize:this.query.pageSize});case 4:i=t.sent,a?(l=i||[],this.listCttd=[].concat(Object(R["a"])(this.listCttd),Object(R["a"])(l))):this.listCttd=i||[],t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),this.listCttd=[];case 11:case"end":return t.stop()}}),t,this,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"handleCancel",value:function(){this.form={year:(new Date).getFullYear()+"",month:(new Date).getMonth()+1},this.handleClose()}},{key:"handleClose",value:function(){this.query={pageNo:1,pageSize:20,search:""},this.setOpenPopup({popupName:"upload-file-year",isOpen:!1})}},{key:"handleChangeFile",value:function(t){this.uploadFile(t)}},{key:"uploadFile",value:function(t){var e=this,a=new FormData,i="importCbnv"===this.$route.name?"PROGRAM_MEMBER":"PROGRAM_BRANCH",l=new Date(this.form.year).getFullYear();if("ready"===t.status){a.append("file",t.raw),a.append("name",t.name),a.append("type",i),a.append("year",l),a.append("month",this.form.month),a.append("programId",this.form.programId);var n=this.$message({message:"Đang tải file lên",type:"success",duration:0});this.$message.close(),D.uploadFile(this.districtId,a).then((function(){n.close(),e.$message.success("Tải lên thành công"),e.$emit("apply"),e.handleCancel()})).catch((function(t){n.close(),e.handleClose(),429===t.errorCode?e.$message.error("Không upload được file khi hệ thống đang cập nhật dữ liệu. Vui lòng thử lại sau ít phút"):e.$message.error("Tải lên thất bại")}))}}}]),a}(Object(h["b"])(p["a"]));L=Object(d["a"])([Object(h["a"])({components:{}})],L);var $=L,M=$,T=(a("3e29c"),Object(j["a"])(M,I,E,!1,null,"525ef686",null)),A=T.exports,P=Object(b["a"])("beUser"),U=Object(m["a"])("import"),z=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.data=[],t.isLoadingButton=!1,t.query={page:1,limit:20,total:0},t.filter={search:"",fd:"",td:"",status:"",userIds:""},t.detailFile={},t.isError=!1,t.isLoading=!1,t.params={type:"kpi-year"},t.isSpace=!1,t.handleSearch=Object(F["debounce"])((function(e){t.resetQuery(),t.isLoading||(t.filter.search=Object(F["trim"])(e),t.init())}),500),t}return Object(o["a"])(a,[{key:"handleRouteNameChange",value:function(){this.params={page:1,limit:20,total:0},this.filter={search:"",fd:"",td:"",status:"",userIds:""},this.init()}},{key:"mounted",value:function(){this.init()}},{key:"getIndex",get:function(){return this.query.limit*(this.query.page-1)+1}},{key:"init",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoading=!0,e=Object(n["a"])(Object(n["a"])({},this.query),{},{search:this.filter.search?this.filter.search:null,fd:this.filter.fd?this.filter.fd:null,td:this.filter.td?this.filter.td:null,status:this.filter.status?this.filter.status:null,userIds:this.filter.userIds?this.filter.userIds:null,total:null,type:"importCbnv"===this.$route.name?"PROGRAM_MEMBER":"PROGRAM_BRANCH"}),t.next=4,U.getData(this.districtId,e);case 4:a=t.sent,this.data=a.files,this.query.total=a.total,this.isLoading=!1;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"UploadFileYear",value:function(){this.setOpenPopup({popupName:"upload-file-year",isOpen:!0})}},{key:"created",value:function(){var t,e;this.apiImport=Object(m["a"])("import",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id})}},{key:"handleOpenExportFile",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,i,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoadingButton=!0,i={type:"importCbnv"===this.$route.name?"PROGRAM_MEMBER":"PROGRAM_BRANCH"},t.next=4,null===(e=this.apiImport)||void 0===e?void 0:e.spamleFile(this.districtId,i).then((function(t){a=t.data;var e=document.createElement("a");e.style.display="none",e.href=a,document.body.appendChild(e),e.click(),document.body.removeChild(e),l.isLoadingButton=!1})).catch((function(t){console.log(t),l.isLoadingButton=!1}));case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleFilterDate",value:function(t){this.resetQuery(),this.filter.fd=t.fd,this.filter.td=t.td,this.init()}},{key:"handleFilterStatus",value:function(t){this.resetQuery(),this.filter.status=t.join(","),this.init()}},{key:"handleFilterUser",value:function(t){this.resetQuery(),this.filter.userIds=t.join(","),this.init()}},{key:"handleSizeChange",value:function(t){this.query.limit=t,this.init()}},{key:"handleCurrentChange",value:function(t){this.query.page=t,this.init()}},{key:"handleGetDetail",value:function(t){this.detailFile=t.row,this.isError="FAIL"===t.row.status,"IN_PROGRESS"!==t.row.status&&"NEW"!==t.row.status&&"SUCCESS"!==t.row.status?this.setOpenPopup({popupName:"popup-detail-cttd",isOpen:!0}):this.$message.error("File đang xử lý, vui lòng đợi")}},{key:"resetQuery",value:function(){this.query.page=1,this.query.limit=20}},{key:"hasWhiteSpace",value:function(t){t.indexOf(" ")>=0&&(this.isSpace=!0)}}]),a}(Object(h["b"])(p["a"],f["a"]));Object(d["a"])([P.State("user")],z.prototype,"user",void 0),Object(d["a"])([Object(h["e"])("$route.name")],z.prototype,"handleRouteNameChange",null),z=Object(d["a"])([Object(h["a"])({components:{ImportFilter:g["a"],ImportFileDetail:N,UploadFile:A}})],z);var B=z,G=B,H=(a("ecfc"),Object(j["a"])(G,i,l,!1,null,"2213d0f8",null));e["default"]=H.exports},b492:function(t,e,a){},b5c0:function(t,e,a){},c178:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var i=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.presentationml.presentation"]},ce0c:function(t,e,a){},ecfc:function(t,e,a){"use strict";a("ce0c")}}]);
//# sourceMappingURL=chunk-f15ec138.28f4f201.js.map