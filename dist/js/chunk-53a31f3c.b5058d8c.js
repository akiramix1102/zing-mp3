(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53a31f3c"],{"56c0":function(t,e,a){"use strict";a("b028")},aab5:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"audit audit-page"},[a("div",{staticClass:"audit-table"},[a("base-table",{ref:"auditTable",attrs:{data:t.dataTable,filters:t.filters,showPagination:!0,table:t.query,paginationInfo:"hợp đồng",emptyText:"Không có dữ liệu hợp đồng"},on:{selectionChange:t.handleSelection,filterChange:t.handleFilter,sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,rowClick:t.handleRowClick}},[a("template",{slot:"header"},[a("div",{staticClass:"audit-action be-flex jc-space-between"},[a("div",{staticClass:"aciton-left flex"},[a("search-bar",{attrs:{search:t.params.search},on:{search:t.handleSearch}}),a("el-button",{staticClass:"be-button-unset btn-audit",staticStyle:{"margin-right":"20px","margin-left":"20px"},on:{click:t.handleOpentFilter}},[a("base-icon",{attrs:{icon:"filter"}}),t._v(" Bộ lọc ")],1),a("el-dropdown",{staticClass:"import-sort",attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("el-button",{staticClass:"be-button-unset custom-button"},[a("base-icon",{staticClass:"icon",attrs:{icon:"sort"}}),t._v(" Sắp xếp ")],1),a("el-dropdown-menu",{staticClass:"sort-menu-popper",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.option,(function(e){return a("el-dropdown-item",{key:e.id,class:e.active?"active":null,attrs:{command:e,divided:e.divided}},[a("span",{staticClass:"be-flex"},[a("span",{staticClass:"be-flex-item"},[t._v(" "+t._s(e.name)+" ")])])])})),1)],1)],1),a("div",{staticClass:"action-right flex actions"},[a("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:t.dataSelect.length>0&&t.splitButton,expression:"dataSelect.length > 0 && splitButton"}],attrs:{"split-button":"",size:"medium"},on:{click:t.handleClickAction,command:t.handleChangeAction}},[t._v(" "+t._s(t.nameButtonAction)+" "),a("el-dropdown-menu",{staticClass:"audit-custom-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"introStaff"}},[t._v("Gán nhân viên giới thiệu")]),a("el-dropdown-item",{attrs:{command:"customerCif"}},[t._v("Gán CIF khách hàng ")]),a("el-dropdown-item",{attrs:{command:"relationship"}},[t._v("Phân loại khách hàng")]),a("el-dropdown-item",{attrs:{divided:"",command:"request-approve"}},[t._v("Yêu cầu duyệt")])],1)],1),t.dataTable.length>0&&t.getRoleBtnAudit?a("el-button",{staticClass:"btn-audit",attrs:{size:"medium"},on:{click:function(e){return t.handleOpenAuditPopup("")}}},[t._v(" Gán thông tin ")]):t._e(),t.dataTable.length>0&&t.getRoleBtnReq?a("el-button",{staticClass:"be-btn-danger btn-audit",attrs:{size:"medium"},on:{click:function(e){return t.handleOpenAuditPopup("da-khop")}}},[t._v(" Yêu cầu duyệt ")]):t._e(),a("el-button",{staticClass:"custom-button",attrs:{loading:t.isLoadingButton},on:{click:t.handleOpenExportFile}},[a("span",{staticClass:"be-inline-flex align-center"},[a("base-icon",{staticClass:"icon",attrs:{icon:"excel-fullcolor"}}),t._v(" Xuất Excel ")],1)])],1)])]),a("el-table-column",{key:1,attrs:{type:"index",index:t.indexMethod,label:"#",width:"61",align:"center"}}),t.getRoleCbx?a("el-table-column",{key:100,attrs:{type:"selection"}}):t._e(),a("el-table-column",{key:98,staticClass:"checkLength",attrs:{prop:"applyFormNo",label:"Số HSYCBH",width:"110",align:"left"}}),a("el-table-column",{key:2,staticClass:"checkLength",attrs:{prop:"contractNo",label:"Số HĐBH",width:"120",align:"left"}}),t.getRoleBtnApp?a("el-table-column",{key:1e4,attrs:{width:"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-popover",{attrs:{placement:"bottom","popper-class":"popper-action-audit"},nativeOn:{click:function(e){return t.handleConflictClick.apply(null,arguments)}}},[a("div",{staticClass:"be-flex-column content"},[a("div",{staticClass:"content-item cursor",staticStyle:{"padding-bottom":"10px"},on:{click:function(a){return t.handleActionAudit("audit",e.row)}}},[a("span",[t._v("Gán thông tin")])]),a("div",{staticClass:"content-item cursor",on:{click:function(a){return t.handleActionAudit("approve",e.row)}}},[a("span",[t._v("Yêu cầu duyệt")])])]),a("div",{staticClass:"reference",attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"el-icon-more"})])])],1)]}}],null,!1,1702287004)}):t._e(),a("el-table-column",{key:99,staticClass:"checkLength",attrs:{label:"Chi nhánh",prop:"branchName",width:"220"}}),a("el-table-column",{key:4,staticClass:"checkLength",attrs:{label:"Đơn vị kinh doanh",prop:"transactionOfficeName",width:"220"}}),a("el-table-column",{key:5,staticClass:"checkLength",attrs:{label:"Mã NVTV",prop:"salesMemberNo",width:"110",align:"left"}}),a("el-table-column",{key:35,staticClass:"checkLength",attrs:{label:"NV tư vấn",prop:"salesFullName",width:"210"}}),a("el-table-column",{key:105,staticClass:"checkLength",attrs:{label:"Mã NV đứng code",prop:"consultantMemberNo",width:"155",align:"left"}}),a("el-table-column",{key:135,staticClass:"checkLength",attrs:{label:"NV đứng code",prop:"consultantName",width:"210"}}),a("el-table-column",{key:205,staticClass:"checkLength",attrs:{label:"Mã code",prop:"consultantNo",width:"110",align:"center"}}),a("el-table-column",{key:6,staticClass:"checkLength",attrs:{label:"Số CIF",prop:"customerCifCode",width:"110",align:"center"}}),a("el-table-column",{key:36,attrs:{label:"Tên BMBH",prop:"customerFullName",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("p",{staticClass:"checkLength uppercase"},[t._v(t._s(i.customerFullName))])]}}])}),a("el-table-column",{key:7,attrs:{label:"Mã Sản phẩm",prop:"productCode",width:"120",align:"left"}}),a("el-table-column",{key:37,attrs:{label:"Sản phẩm",prop:"productName",width:"265"}}),a("el-table-column",{key:8,staticClass:"checkLength",attrs:{label:"Phí năm (APE)",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.apeAmount)))]}}])}),a("el-table-column",{key:9,attrs:{label:"Trạng thái",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.auditStatus?a("span",{staticClass:"not-approve cell-status"},[t._v("Chưa đối soát")]):t._e(),"2"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Đang đối soát")]):t._e(),"3"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Chờ duyệt")]):t._e(),"4"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v(" Đã duyệt ")]):t._e(),"5"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),"6"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v("Từ chối duyệt")]):t._e(),"7"==e.row.auditStatus?a("span",{staticClass:"decline cell-status"},[t._v(" Từ chối hiệu chỉnh ")]):t._e(),"8"==e.row.auditStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Hiệu chỉnh")]):t._e(),"9"==e.row.auditStatus?a("span",{staticClass:"approve cell-status"},[t._v("Khớp")]):t._e()]}}])}),a("el-table-column",{key:10,staticClass:"checkLength",attrs:{label:"Phân loại KH",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.getRelationShip(e.row.customerType))+" ")]}}])}),a("el-table-column",{key:11,staticClass:"checkLength",attrs:{label:"Ngày nộp hs",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDateTime")(e.row.applyFormDate))+" ")]}}])}),a("el-table-column",{key:12,staticClass:"checkLength",attrs:{label:"Ngày ph",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDateTime")(e.row.issueDate))+" ")]}}])}),a("el-table-column",{key:13,staticClass:"checkLength",attrs:{label:"Ngày phí ps",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatDateTime")(e.row.lastPayDate)))]}}])}),a("el-table-column",{key:1111,attrs:{label:"Ngày dòng phí",align:"center",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDateTime")(e.row.daichiPayFeeDate))+" ")]}}])}),a("el-table-column",{key:14,staticClass:"checkLength",attrs:{label:"Ngày hết hạn",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatDateTime")(e.row.expireDate)))]}}])}),a("el-table-column",{key:15,staticClass:"checkLength",attrs:{label:"Định kỳ",width:"90",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("parsePaymentPeriod")(e.row.paymentPeriod)))]}}])}),a("el-table-column",{key:16,staticClass:"checkLength",attrs:{label:"năm hđ",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatTextLength")(e.row.currentContractYear)))]}}])}),a("el-table-column",{key:17,attrs:{label:"Năm phí",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatTextLength")(e.row.currentFeeYear)))]}}])}),a("el-table-column",{key:18,attrs:{label:"Phí cơ bản",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.basicAmount)))]}}])}),a("el-table-column",{key:19,attrs:{label:"Phí đóng thêm",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumber")(e.row.extraAmount)))]}}])}),a("el-table-column",{key:20,attrs:{label:"Tổng phí",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.totalAmount))+" ")]}}])})],2)],1),a("audit-popup",{attrs:{params:t.params,dataPopup:t.dataPopup,propCustomerType:t.listType},on:{handlePrev:t.handlePrevPopupAudit,handleNext:t.handleNextPopupAudit,update:t.handleFilter}}),a("pending-popup",{attrs:{query:t.params,dataSelect:t.dataSelect},on:{update:t.init,reset:t.resetSelectAudit}}),a("cancel-popup",{attrs:{query:t.params,dataSelect:t.dataSelect},on:{update:t.init,reset:t.resetSelectAudit}}),a("auditting-popup",{attrs:{pageNumber:t.pageSize,lastItem:t.checkLastItemSelect,query:t.params,dataSelect:t.dataSelect},on:{update:t.init,reset:t.resetSelectAudit}}),a("edit-request",{attrs:{pageNumber:t.pageSize,query:t.params,dataSelect:t.dataSelect},on:{update:t.init,reset:t.resetSelectAudit}}),a("request-cancel",{attrs:{query:t.params,dataSelect:t.dataSelect},on:{update:t.init,reset:t.resetSelectAudit}}),a("audit-popup-filter",{attrs:{type:t.$route.name},on:{apply:t.handleFilter}}),a("audit-popup-action",{attrs:{data:t.dataPopupAction,"data-select":t.dataSelect,checkCustomerType:this.checkCustomerType},on:{close:t.resetSelectAudit,update:t.init}}),a("detail-contract",{attrs:{detail:t.contractInfor}})],1)},n=[],s=a("c964"),o=a("d0ff"),c=a("f3f3"),l=a("276c"),r=a("e954"),u=a("920b"),p=a("92a6"),d=(a("96cf"),a("b0c0"),a("d3b7"),a("ddb0"),a("4ec9"),a("3ca3"),a("d81d"),a("99af"),a("a15b"),a("ac1f"),a("841c"),a("7db0"),a("4de4"),a("2b3d"),a("9ab4")),h=a("08ba"),m=a("1b40"),f=a("9f48"),g=a("ff0e"),b=a("fa2a"),k=a("3956"),v=a("a6fa"),y=a("fdb8"),C=a("13fb"),S=a("4a47e"),_=a("4897c"),w=a("4bb5"),P=a("e383"),N=a("2ef0"),O=a("567c"),A=a("9f13"),T=a("2b17"),x=a("c661"),L=a("4a7b8"),R=Object(w["a"])("beAudit"),j=function(t){Object(u["a"])(a,t);var e=Object(p["a"])(a);function a(){var t;return Object(l["a"])(this,a),t=e.apply(this,arguments),t.isLoadingButton=!1,t.data={},t.valueSearch="",t.isLoading=!1,t.testData=[],t.dataTable=[],t.textButton="Đối soát",t.statusRoute="",t.pageSize=0,t.dataSelect=[],t.dataClick=[],t.statusClick="",t.params={search:"",auditStatus:"",page:1,limit:20,orderByClause:"1",searchType:"CONTRACT",contractStatus:""},t.paramPopupAudit={page:1,filterStatus:1e3},t.query={total:0,page:t.params.page,limit:t.params.limit},t.isConflickClick=!1,t.dataPopup={total:t.data.total,data:[],action:""},t.option=[{id:1,name:"Đơn vị kinh doanh",divided:!1},{id:6,name:"Tổng phí",divided:!0},{id:2,name:"Ngày phát hành",divided:!0},{id:3,name:"Ngày đóng phí",divided:!1},{id:4,name:"Ngày hết hạn",divided:!1},{id:5,name:"Mã sản phẩm",divided:!0}],t.listType=[],t.isShow=!1,t.propValueSearch="",t.contractInfor={},t.dataPopupAction={title:"",label:"",code:"",contractNo:[]},t.checkLastItemSelect=!1,t.checkReqToEdit=!1,t.paramsFilter={noAudit:{},auditting:{},pending:{},approve:{},reqEdit:{}},t.fileName="",t.listFilter=[],t.checkCustomerType=!1,t.filters={name:"Bộ lọc"},t.url="",t}return Object(r["a"])(a,[{key:"splitButton",get:function(){return"da-duyet"!=this.$route.name}},{key:"roleExportExcel",get:function(){return this.checkPemission("audit",["export-excel"])}},{key:"nameButtonAction",get:function(){var t="Gán nhân viên tư vấn",e=this.$route.name;return"cho-duyet"==e&&(t="Từ chối duyệt"),"da-duyet"==e&&(t="Yêu cầu hiệu chỉnh"),"yeu-cau-hieu-chinh"==e&&(t="Từ chối hiệu chỉnh"),t}},{key:"getRoleBtnAudit",get:function(){return this.checkPemission("audit",["edit-matched-page"])}},{key:"getRoleBtnCancelHc",get:function(){return this.checkPemission("audit",["edit-request"])}},{key:"getRoleBtnCancelTc",get:function(){return this.checkPemission("audit",["edit-pending"])}},{key:"getRoleBtnReq",get:function(){return this.checkPemission("audit",["edit-auditing"])}},{key:"getRoleBtnApp",get:function(){return this.checkPemission("audit",["edit-auditing"])}},{key:"getRoleBtnAppRq",get:function(){return this.checkPemission("audit",["edit-request"])}},{key:"getRoleCbx",get:function(){return"da-khop"===this.$route.name?this.checkPemission("audit",["cbx-action"]):"cho-duyet"!==this.$route.name&&("da-duyet"===this.$route.name?this.checkPemission("audit",["cbx-action-da-duyet"]):"yeu-cau-hieu-chinh"!==this.$route.name)}},{key:"changeTab",value:function(t){this.resetData();var e=this.getFilter(this.$route.name);e?(this.params=Object(N["assign"])(this.params,e.filters),console.log(this.params),this.checkRouteStatus(t)):(this.params={search:"",page:1,limit:20,orderByClause:"1",searchType:"CONTRACT"},this.checkRouteStatus(t));var a=document.getElementsByClassName("el-table__body-wrapper")[0];a&&(a.scrollTop=0,a.scrollLeft=0),this.init()}},{key:"indexMethod",value:function(t){return(this.params.page-1)*this.params.limit+t+1}},{key:"handleConflictClick",value:function(){this.isConflickClick=!0}},{key:"resetData",value:function(){this.dataSelect=[],this.params.limit=20,this.params.page=1,this.query.page=this.params.page,this.query.limit=this.params.limit,this.dataPopup={total:this.data.total,data:[],action:""}}},{key:"handleRowClick",value:function(t){this.isConflickClick?this.isConflickClick=!1:1!=this.checkReqToEdit&&(this.contractInfor=t.row,this.dataPopup.action="detail",this.dataPopup.data=[t.row],this.dataPopup.total=this.dataPopup.data.length,this.setOpenPopup({popupName:"contractDetail",isOpen:!0}))}},{key:"handlePrevPopupAudit",value:function(){var t,e=this;this.paramPopupAudit.page>1&&(this.paramPopupAudit.page--,null===(t=this.apiContract)||void 0===t||t.getData(Object(c["a"])(Object(c["a"])({},this.params),this.paramPopupAudit)).then((function(t){var a="bankContractNo",i=Object(o["a"])(new Map(t.data.map((function(t){return[t[a],t]}))).values());e.dataPopup.count=i.length-1,e.dataPopup.data=[].concat(Object(o["a"])(i),Object(o["a"])(e.dataPopup.data))})).catch((function(t){return e.$message.error(t.message)})))}},{key:"handleNextPopupAudit",value:function(){var t,e=this;this.paramPopupAudit.page++,null===(t=this.apiContract)||void 0===t||t.getData(Object(c["a"])(Object(c["a"])({},this.params),this.paramPopupAudit)).then((function(t){var a="bankContractNo",i=[].concat(Object(o["a"])(e.dataPopup.data),Object(o["a"])(t.data)),n=Object(o["a"])(new Map(i.map((function(t){return[t[a],t]}))).values());e.dataPopup.data=n})).catch((function(t){return e.$message.error(t.message)}))}},{key:"handleSizeChange",value:function(t){var e;this.params.page=1,this.params.limit=t,this.query.page=this.params.page,this.query.limit=this.params.limit,this.init(),null===(e=this.apiContract)||void 0===e||e.getData(this.params)}},{key:"handleCurrentChange",value:function(t){this.params.page=t,this.init()}},{key:"handleOpentFilter",value:function(){this.setOpenPopup({popupName:"audit-filter",isOpen:!0})}},{key:"handleCloseLoading",value:function(){var t=this;setTimeout((function(){t.isLoading=!1}),1e3)}},{key:"handleCommand",value:function(t){Object(N["forEach"])(this.option,(function(e){t.id===e.id?e.active=!0:e.active=!1})),this.params.orderByClause=t.id,this.init()}},{key:"handleClickAction",value:function(){if(!(this.dataSelect.length<1)){var t="advisoryStaff";switch(this.dataPopupAction={action:t,total:this.dataSelect.length,contractNo:this.dataSelect.map((function(t){return t.contractNo})).join(","),bankContractNo:this.dataSelect.map((function(t){return t.bankContractNo})).join(",")},this.dataPopupAction.code=t,this.$route.name){case"da-khop":this.dataPopupAction.title="Gán nhân viên tư vấn",this.dataPopupAction.label="Nhân viên tư vấn",this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"cho-duyet":this.setOpenPopup({popupName:"cancel-popup",isOpen:!0});break;case"da-duyet":this.setOpenPopup({popupName:"edit-popup",isOpen:!0});break;case"yeu-cau-hieu-chinh":this.setOpenPopup({popupName:"cancel-popup",isOpen:!0});break;case void 0:this.dataPopupAction.title="Gán nhân viên tư vấn",this.dataPopupAction.label="Nhân viên tư vấn",this.setOpenPopup({popupName:"audit-action",isOpen:!0});break}}}},{key:"handleChangeAction",value:function(t){if(!(this.dataSelect.length<1))switch(this.dataPopupAction={action:t,total:this.dataSelect.length,contractNo:this.dataSelect.map((function(t){return t.contractNo})).join(","),bankContractNo:this.dataSelect.map((function(t){return t.bankContractNo})).join(",")},this.dataPopupAction.code=t,t){case"introStaff":this.dataPopupAction.title="Gán nhân viên giới thiệu",this.dataPopupAction.label="Nhân viên giới thiệu",this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"customerCif":this.dataPopupAction.title="Gán CIF khách hàng ",this.dataPopupAction.label="Số CIF khách hàng ",this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"relationship":this.dataPopupAction.title="Gán Phân loại KH",this.dataPopupAction.label="Phân loại KH",this.dataPopupAction.optionsRelationship=this.listType,this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"request-approve":this.setOpenPopup({popupName:"auditting-popup",isOpen:!0});break;case"value-request-correction":this.setOpenPopup({popupName:"edit-popup",isOpen:!0});break;case"value-decline":this.setOpenPopup({popupName:"cancel-popup",isOpen:!0});break;case"value-aprrove":this.setOpenPopup({popupName:"pending-popup",isOpen:!0});break}}},{key:"resetSelectAudit",value:function(){this.checkReqToEdit=!1,this.dataPopup.data=[],this.dataSelect=[],this.$refs.auditTable&&this.$refs.auditTable.clearSelection()}},{key:"checkRouteStatus",value:function(t){switch(t){case"dang-doi-soat":this.textButton="Yêu cầu duyệt",this.params.auditStatus="2",this.fileName="dang_doi_soat";break;case"cho-duyet":this.textButton="Phê duyệt",this.params.auditStatus="3",this.fileName="cho_duyet";break;case"da-duyet":this.textButton="Đã duyệt",this.params.auditStatus="4",this.fileName="da_duyet";break;case"yeu-cau-hieu-chinh":this.textButton="Đã duyệt",this.params.auditStatus="5",this.fileName="yeu_cau_hieu_chinh";break;case"da-khop":this.params.auditStatus="9",this.fileName="da_khop";break;case void 0:this.textButton="Đối soát",this.params.auditStatus="1",this.fileName="chua_doi_soat";break}}},{key:"getRelationShip",value:function(t){return A["RELATIONSHIP_VALUE_TO_TYPE"][t]}},{key:"handleOpenAuditPopup",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.dataSelect=[],this.dataPopup.action="",t.t0=e,t.next="da-khop"===t.t0?5:7;break;case 5:return this.setOpenPopup({popupName:"auditting-popup",isOpen:!0}),t.abrupt("break",11);case 7:return this.dataPopup.action="",t.next=10,null===(a=this.apiContract)||void 0===a?void 0:a.getData(Object(c["a"])(Object(c["a"])({},this.params),{},{filterStatus:1e3,page:1})).then((function(t){t.data.length>0?(i.dataPopup.data=t.data,i.setOpenPopup({popupName:"audit",isOpen:!0})):i.$message.warning("Không có hợp đồng nào chưa đủ thông tin")})).catch((function(t){return i.$message.warning(t.message)}));case 10:return t.abrupt("break",11);case 11:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"handleSearch",value:function(t){this.params.page=1,this.params.search=t,this.init()}},{key:"handleSelection",value:function(t,e){if(this.pageSize=this.params.limit,this.listFilter=this.$refs.auditTable.getSelection(),e){var a=t.find((function(t){return t.id==e.id}));if(a&&a.id>0){var i=this.dataTable.filter((function(t){return t.bankContractNo===(null===e||void 0===e?void 0:e.bankContractNo)&&t.id!==(null===e||void 0===e?void 0:e.id)}));this.$refs.auditTable.updateSelection(i),this.dataSelect=this.$refs.auditTable.getSelection()}else this.dataSelect=t.filter((function(t){return t.bankContractNo!==(null===e||void 0===e?void 0:e.bankContractNo)})),this.$refs.auditTable.clearSelection(),this.$refs.auditTable.updateSelection(this.dataSelect);var n=this.dataTable[this.dataTable.length-1].bankContractNo,s=this.dataSelect.some((function(t){return t.bankContractNo==n}));this.checkLastItemSelect=!!s}else this.dataSelect=t;var o=this.listFilter.filter((function(t){return"1"==t.customerType||"4"==t.customerType}));o.length>0?this.checkCustomerType=!0:this.checkCustomerType=!1,console.log("se",this.checkCustomerType)}},{key:"handleOpenFilter",value:function(){this.setOpenPopup({popupName:"audit-popup-filter",isOpen:!0})}},{key:"handleClickReqEdit",value:function(t){this.checkReqToEdit=!0,this.dataSelect=this.dataTable.filter((function(e){return e.bankContractNo==t.bankContractNo})),this.setOpenPopup({popupName:"edit-popup",isOpen:!0})}},{key:"handleFilter",value:function(t){this.params=Object(c["a"])(Object(c["a"])({},this.params),t),this.params.page=1,this.init()}},{key:"handleOpenExportFile",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(this.dataTable.length<1)){t.next=3;break}return this.$message.warning("Không tìm thấy dữ liệu xuất file"),t.abrupt("return");case 3:if(!(this.query.total>=5e4)){t.next=6;break}return this.$message.warning("Số lượng bản ghi vượt quá 50000, vui lòng sử dụng bộ lọc"),t.abrupt("return");case 6:return this.isLoadingButton=!0,i=new Date,n="".concat(i.getFullYear()).concat(i.getMonth()+1).concat(i.getDate(),"_").concat(i.getHours()).concat(i.getMinutes()).concat(i.getSeconds()),delete this.params.newAuditStatus,t.next=12,null===(e=this.apiExport)||void 0===e?void 0:e.exportAuditExcel(this.params).then((function(t){a=t;var e=window.URL.createObjectURL(new Blob([a.data])),i=document.createElement("a");i.href=e,i.setAttribute("download","Danh_sach_".concat(s.fileName,"_").concat(n,".xlsx")),document.body.appendChild(i),i.click(),s.isLoadingButton=!1})).catch((function(){s.isLoadingButton=!1}));case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"init",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoading=!0,this.dataSelect=[],this.checkRouteStatus(this.$route.name),i=this.getFilter(this.$route.name),i&&(this.params=Object(N["assign"])(this.params,i.filters)),this.params.page||(this.params.page=1),this.params.limit||(this.params.limit=20),this.params.orderByClause||(this.params.orderByClause="1"),this.dataPopup.action="",this.query.page=this.params.page,this.query.limit=this.params.limit,delete this.params.newAuditStatus,t.next=14,null===(e=this.apiContract)||void 0===e?void 0:e.getData(this.params).then((function(t){n.data=t,n.dataTable=n.data.data,n.isLoading=!1})).catch((function(){n.dataTable=[],n.isLoading=!1}));case 14:return t.next=16,null===(a=this.apiContract)||void 0===a?void 0:a.getContractCount(this.params).then((function(t){n.query.total=+t.data,n.isLoading=!1})).catch((function(){n.query.total=0,n.isLoading=!1}));case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"setParamsForUser",value:function(){var t,e,a,i;this.getDisableArea&&(this.params.areaIdArray="".concat(null===(t=this.user)||void 0===t?void 0:t.areaId),this.params.branchIdArray="".concat(null===(e=this.user)||void 0===e?void 0:e.branchId));this.getDisableTransaction&&(this.params.transOfficeIdArray="".concat(null===(a=this.user)||void 0===a?void 0:a.transactionOfficeId));this.getDisableSaleMember&&(this.params.salesMemberIdArray="".concat(null===(i=this.user)||void 0===i?void 0:i.id))}},{key:"created",value:function(){var t,e,a,i,n,s,o,c,l,r=this;this.api=Object(h["a"])("audit",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiContract=Object(h["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.apiParam=Object(h["a"])("param",{districtId:null===(n=this.user)||void 0===n||null===(s=n.districts)||void 0===s?void 0:s[0].id}),this.apiExport=Object(h["a"])("export",{districtId:null===(o=this.user)||void 0===o||null===(c=o.districts)||void 0===c?void 0:c[0].id}),this.init(),null===(l=this.apiParam)||void 0===l||l.getParamRelationship().then((function(t){return r.listType=t}))}},{key:"handleActionAudit",value:function(t,e){if("audit"==t)this.dataPopup.data=[e],this.setOpenPopup({popupName:"audit",isOpen:!0});else{this.dataSelect=this.dataTable.filter((function(t){return t.bankContractNo==e.bankContractNo}));var a=this.dataTable[this.dataTable.length-1].bankContractNo,i=this.dataSelect.some((function(t){return t.bankContractNo==a}));this.checkLastItemSelect=!!i,this.setOpenPopup({popupName:"auditting-popup",isOpen:!0})}}},{key:"handleUpdatePage",value:function(){this.init()}}]),a}(Object(m["b"])(f["a"],P["a"],T["a"]));Object(d["a"])([R.Getter("getFilter")],j.prototype,"getFilter",void 0),Object(d["a"])([Object(m["e"])("$route.name")],j.prototype,"changeTab",null),j=Object(d["a"])([Object(m["a"])({components:{DetailContract:L["a"],AuditPopup:g["a"],AudittingPopup:b["a"],PendingPopup:y["a"],AuditPopupFilter:S["a"],AuditPopupAction:_["a"],CancelPopup:C["a"],SearchBar:O["a"],EditRequest:v["a"],RequestCancel:k["a"],ActionPopup:x["a"]}})],j);var B=j,q=B,F=(a("56c0"),a("2877")),D=Object(F["a"])(q,i,n,!1,null,"b2b8d002",null);e["default"]=D.exports},b028:function(t,e,a){}}]);
//# sourceMappingURL=chunk-53a31f3c.b5058d8c.js.map