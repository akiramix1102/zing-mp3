(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9038266e"],{"05cd":function(t,e,a){},"106b":function(t,e,a){"use strict";a("c190")},"222c":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"popup-note",attrs:{name:"popup-note",open:t.handleOpen,hiddenFooter:!0,width:"800px"}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("p",[t._v(t._s("add"===t.type?"Tạo ghi chú":"Sửa ghi chú"))])]),a("div",{staticClass:"content"},[a("div",{staticClass:"editor"},[a("jodit-editor",{attrs:{config:t.config,buttons:t.buttons},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)]),a("template",{slot:"footer"},[a("div",{staticClass:"bottom be-flex jc-flex-end"},[a("el-button",{staticClass:"is-none-border",staticStyle:{height:"36px"},on:{click:t.handleCancel}},[t._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",staticStyle:{height:"36px"},on:{click:t.handleSave}},[t._v("Lưu")])],1)])],2)},s=[],n=a("f3f3"),r=a("276c"),l=a("e954"),o=a("920b"),c=a("92a6"),u=(a("99af"),a("9ab4")),d=a("9f48"),p=a("1b40"),h=(a("425f"),a("9f13")),m=a("69ae"),f=function(t){Object(o["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.buttons=["bold","italic","underline","link","ul","ol","image"],t.config={spellcheck:!1,showCharsCounter:!1,showWordsCounter:!1,autofocus:"add"===t.type,showXPathInStatusbar:!1,language:"vi",minHeight:170,i18n:{vi:{"Type something":"Nhập ghi chú...","Search for":"Nhập tìm kiếm"}},uploader:{url:"".concat(h["API_URL"],"/file/v1/district/").concat(t.$store.state.beUser.districtId,"/upload"),format:"json",headers:{Authorization:"Bearer ".concat(t.$store.state.beAuth.access_token)},isSuccess:function(t){return!t.error},getMessage:function(t){return t.msg},filesVariableName:function(t){return"files"},process:function(t){return{files:t.data||[]}},defaultHandlerSuccess:function(t){var e="files";if(console.log("res",t),t[e]&&t[e]["success"].length)for(var a=0;a<t[e]["success"].length;a+=1)console.log("hi",t[e]["success"][a].url),this.s.insertImage(t[e]["success"][a].url)},error:function(t){console.error(t)}}},t.content="",t}return Object(l["a"])(a,[{key:"handleOpen",value:function(){"edit"===this.type?this.content=this.post.content:this.content="<p><br></p>"}},{key:"handleSave",value:function(){var t={};t="edit"===this.type?Object(n["a"])(Object(n["a"])({},this.post),{},{content:this.content}):{content:this.content},this.$emit("update",t),this.setOpenPopup({popupName:"popup-note",isOpen:!1})}},{key:"handleCancel",value:function(){this.setOpenPopup({popupName:"popup-note",isOpen:!1})}}]),a}(Object(p["b"])(d["a"]));Object(u["a"])([Object(p["c"])({required:!1,type:Object,default:function(){return{}}})],f.prototype,"post",void 0),Object(u["a"])([Object(p["c"])({required:!0,type:String,default:"add"})],f.prototype,"type",void 0),f=Object(u["a"])([Object(p["a"])({components:{JoditEditor:m["a"]}})],f);var b=f,g=b,v=(a("106b"),a("2877")),I=Object(v["a"])(g,i,s,!1,null,"13881bd2",null);e["a"]=I.exports},c190:function(t,e,a){},d67a:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"appoint-customer",attrs:{name:"appoint-customer",open:t.handleOpen,hiddenFooter:!0,close:t.handleClose,closeClickModal:!1,width:"800px"}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("p",[t._v(t._s("create"===t.type?"Tạo lịch hẹn":"Sửa lịch hẹn"))])]),a("div",{staticClass:"popup-content"},[a("div",{staticClass:"customer-app"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"dataInput",attrs:{model:t.dataInput,rules:t.rules,"label-position":"top"}},[a("el-row",[a("el-form-item",{staticClass:"customer-title",attrs:{prop:"title",label:"Tiêu đề"}},[a("el-input",{attrs:{placeholder:"Nhập tiêu đề",clearable:""},model:{value:t.dataInput.title,callback:function(e){t.$set(t.dataInput,"title",e)},expression:"dataInput.title"}})],1),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"col"},[a("el-form-item",{staticClass:"sack_time",attrs:{label:"Thời gian",required:""}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"dueDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",format:"dd/MM/yyyy",placeholder:"Chọn ngày"},on:{change:function(e){t.isEditDate=!0}},model:{value:t.dataInput.dueDate,callback:function(e){t.$set(t.dataInput,"dueDate",e)},expression:"dataInput.dueDate"}})],1)],1),a("span",{staticClass:"dash"},[a("i",{staticClass:"el-icon-minus icon-dash"})]),a("el-col",{staticStyle:{float:"right"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"dueTime"}},[a("el-time-select",{staticStyle:{width:"100%"},attrs:{format:"HH:mm:ss",placeholder:"Chọn giờ","default-value":"09:00","picker-options":{start:"00:00",step:"00:15",end:"23:59"}},on:{change:function(e){t.isEditTime=!0}},model:{value:t.dataInput.dueTime,callback:function(e){t.$set(t.dataInput,"dueTime",e)},expression:"dataInput.dueTime"}})],1)],1)],1)],1),a("el-form-item",{attrs:{prop:"duration",label:"Thời lượng"}},[a("el-select",{staticClass:"select",attrs:{placeholder:"Chọn thời lượng"},model:{value:t.dataInput.duration,callback:function(e){t.$set(t.dataInput,"duration",e)},expression:"dataInput.duration"}},t._l(t.listDuration,(function(t){return a("el-option",{key:t.id,attrs:{label:t.nameValue,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"Địa điểm",prop:"location"}},[a("el-input",{staticClass:"select",attrs:{remote:"",clearable:"",filterable:"",multiple:"",placeholder:"Nhập địa điểm"},model:{value:t.dataInput.location,callback:function(e){t.$set(t.dataInput,"location",e)},expression:"dataInput.location"}})],1),a("el-form-item",{attrs:{label:"Ghi chú gửi khách hàng",prop:"noteForCustomer"}},[a("el-input",{staticClass:"color-textare",attrs:{type:"textarea",rows:3,placeholder:"Nhập ghi chú"},model:{value:t.dataInput.noteForCustomer,callback:function(e){t.$set(t.dataInput,"noteForCustomer",e)},expression:"dataInput.noteForCustomer"}})],1),a("el-form-item",{attrs:{label:"Ghi chú nội bộ",prop:"noteForTeam"}},[a("el-input",{staticClass:"color-textare",attrs:{type:"textarea",rows:3,placeholder:"Nhập ghi chú"},model:{value:t.dataInput.noteForTeam,callback:function(e){t.$set(t.dataInput,"noteForTeam",e)},expression:"dataInput.noteForTeam"}})],1)],1)]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"col"},[a("el-form-item",{attrs:{prop:"assignMemberId",label:"Nhân viên tham gia"}},[a("el-select",{staticClass:"select",attrs:{placeholder:"Chọn nhân viên tham gia",remote:"","remote-method":t.remoteAssignMemberId,"default-first-option":"",clearable:"",filterable:""},model:{value:t.dataInput.assignMemberId,callback:function(e){t.$set(t.dataInput,"assignMemberId",e)},expression:"dataInput.assignMemberId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreAssignMemberId,expression:"loadMoreAssignMemberId"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},t._l(t.listAsignMember,(function(t){return a("el-option",{key:t.id,attrs:{label:t.memberNo+" - "+t.fullName,value:t.id}})})),1)])],1),a("el-form-item",{attrs:{prop:"customerId",label:"Khách hàng"}},[a("el-select",{staticClass:"select",attrs:{placeholder:"Chọn khách hàng",remote:"","remote-method":t.remoteCustomerId,"default-first-option":"",disabled:"",clearable:"",filterable:""},on:{change:t.handleItemClick},model:{value:t.dataInput.customerId,callback:function(e){t.$set(t.dataInput,"customerId",e)},expression:"dataInput.customerId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreCustomerId,expression:"loadMoreCustomerId"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},t._l(t.listCustomer,(function(t){return a("el-option",{key:t.id,attrs:{label:t.customerCifCode?t.customerCifCode+" - "+t.customerFullName:t.customerFullName,value:t.id}})})),1)])],1),a("el-form-item",{attrs:{label:"Cơ hội bán hàng",prop:"dealId"}},[a("el-select",{staticClass:"select",attrs:{"popper-class":"style__SalesDeal",placeholder:"Chọn cơ hội bán hàng",remote:"",clearable:"",filterable:"",disabled:!this.$route.path.includes("khach-hang"),"remote-method":t.remoteSalesDeal,"default-first-option":""},model:{value:t.dataInput.dealId,callback:function(e){t.$set(t.dataInput,"dealId",e)},expression:"dataInput.dealId"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreSalesDeal,expression:"loadMoreSalesDeal"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},[t.listSalesDeal.length<=0?a("el-option",{staticClass:"custom-select-empty-appoint text__no-data",attrs:{value:""}},[a("div",[t._v("Khách hàng chưa có Cơ hội bán hàng")])]):t._e(),t._l(t.listSalesDeal,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2)])],1),a("el-form-item",{attrs:{label:"Đầu mối liên hệ",prop:"attendanceContractIds"}},[a("el-select",{staticClass:"select",attrs:{"popper-class":"style__SalesDeal",placeholder:"Chọn đầu mối liên hệ",multiple:"",remote:"",clearable:"",filterable:"","remote-method":t.remoteContactId,"default-first-option":""},model:{value:t.dataInput.attendanceContractIds,callback:function(e){t.$set(t.dataInput,"attendanceContractIds",e)},expression:"dataInput.attendanceContractIds"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreContactId,expression:"loadMoreContactId"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},[t.listContactId.length<=0?a("el-option",{staticClass:"custom-select-empty-appoint text__no-data",attrs:{value:""}},[a("div",[t._v("Khách hàng chưa có Đầu mối liên hệ")])]):t._e(),t._l(t.listContactId,(function(t){return a("el-option",{key:t.id,attrs:{label:t.fullName,value:t.id}})}))],2)])],1),a("div",{staticClass:"be-flex jc-space-between upload-file"},[a("div",{staticClass:"label"},[a("span",[t._v("Tài liệu đính kèm")])]),a("div",{staticClass:"upload"},[a("el-upload",{staticClass:"upload-demo",attrs:{"file-list":t.fileList,"on-change":t.handleChangeFile,"auto-upload":!1,"show-file-list":!1,action:"",multiple:""}},[a("div",{staticClass:"add__document",attrs:{size:"small",type:"primary"}},[t._v("Thêm tài liệu")])])],1)]),t.fileList&&t.fileList.length?a("div",{staticClass:"list-file"},t._l(t.fileList,(function(e){return a("div",{key:e.uid,staticClass:"flex jc-space-between file-item"},[a("div",{staticClass:"left"},[e.name?a("p",[t._v(t._s(e.name))]):a("p",[t._v(t._s(e.fileName))])]),a("div",{staticClass:"right",on:{click:function(a){return t.handleDeleteFile(e.uid)}}},[a("base-icon",{staticClass:"icon-action cursor",attrs:{icon:"delete"}})],1)])})),0):t._e()],1)])],1)],1)],1)]),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticStyle:{float:"right"}},[a("el-button",{staticStyle:{height:"36px","padding-top":"11px"},on:{click:t.handleReset}},[t._v("Làm lại")]),a("el-button",{staticClass:"apppoint-save",on:{click:t.handleClickSave}},[t._v("Lưu")])],1)])])],2)},s=[],n=a("f3f3"),r=a("d0ff"),l=a("c964"),o=a("276c"),c=a("e954"),u=a("920b"),d=a("92a6"),p=(a("ac1f"),a("841c"),a("99af"),a("b0c0"),a("a15b"),a("d3b7"),a("3ca3"),a("ddb0"),a("96cf"),a("9ab4")),h=a("9f48"),m=a("1b40"),f=a("4bb5"),b=a("08ba"),g=a("2ef0"),v=Object(f["a"])("beUser"),I=function(t){Object(u["a"])(a,t);var e=Object(d["a"])(a);function a(){var t;return Object(o["a"])(this,a),t=e.apply(this,arguments),t.dataInput={title:"",dueDate:"",dueTime:"",duration:"",location:"",noteForCustomer:"",noteForTeam:"",assignMemberId:"",customerId:"",dealId:"",attendanceContractIds:[]},t.isLoading=!1,t.isUpload=!1,t.listAsignMember=[],t.listCustomer=[],t.listSalesDeal=[],t.listContactId=[],t.listDuration=[{id:1,nameValue:"15 phút"},{id:2,nameValue:"30 phút"},{id:3,nameValue:"45 phút"},{id:4,nameValue:"1 giờ"},{id:5,nameValue:"1 giờ 15 phút"},{id:6,nameValue:"1 giờ 30 phút"},{id:7,nameValue:"1 giờ 45 phút"},{id:8,nameValue:"2 giờ"},{id:9,nameValue:"2 giờ 15 phút"},{id:10,nameValue:"2 giờ 30 phút"},{id:11,nameValue:"2 giờ 45 phút"},{id:12,nameValue:"3 giờ"}],t.isEditDate=!1,t.isEditTime=!1,t.rules={title:[{required:!0,message:"Tiêu đề không được để trống",trigger:"blur"}],dueDate:[{required:!0,message:"Ngày không được để trống",trigger:"blur"}],dueTime:[{required:!0,message:"Giờ không được để trống",trigger:"blur"}],duration:[{required:!0,message:"Thời lượng không được để trống",trigger:"blur"}],assignMemberId:[{required:!0,message:"Nhân viên tham gia không được để trống",trigger:"blur"}],customerId:[{required:!0,message:"Khách hàng không được bỏ trống",trigger:"blur"}]},t.fileList=[],t.queryAssignMemberId={i:0,ps:20,search:""},t.queryCustomerId={page:1,limit:20,search:""},t.querySalesDeal={page:1,limit:20,search:"",customerId:""},t.dealId="",t.queryContactId={page:1,limit:20,search:"",customerId:""},t.attendanceContractIds=[],t}return Object(c["a"])(a,[{key:"handleItemClick",value:function(){var t=this;this.getListSalesDeal(""),this.getListContact("").then((function(){t.getFistContact()}))}},{key:"handleChangeFile",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,i,s,n,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=new FormData,"ready"!==e.status){t.next=16;break}return e.type=e.raw.type,this.fileList.push(e),a.append("files",e.raw),e.percentage=1,i=function(t){var a=t.loaded/t.total*100;e.percentage=a},s={},s.data=a,s.progress=i,n=e.uid,t.next=13,this.apiUpload.uploadFile(s);case 13:r=t.sent,l=Object(g["findIndex"])(this.fileList,(function(t){return t.uid===n})),this.fileList[l].url=r.success[0].url;case 16:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"handleDeleteFile",value:function(t){this.fileList=Object(g["filter"])(this.fileList,(function(e){return e.uid!==t}))}},{key:"loadMoreAssignMemberId",value:function(){this.queryAssignMemberId.i+=20;var t=Object(g["debounce"])(this.getEmployeeList,200);t(this.queryAssignMemberId.search,!0)}},{key:"remoteAssignMemberId",value:function(t){this.queryAssignMemberId.search=Object(g["trim"])(t),this.queryAssignMemberId.i=0,this.queryAssignMemberId.ps=20;var e=Object(g["debounce"])(this.getEmployeeList,500);e(t)}},{key:"getEmployeeList",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,i,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=s.length>1&&void 0!==s[1]&&s[1],t.prev=1,t.next=4,this.apiEmployee.getEmployeeList({search:Object(g["trim"])(e),i:this.queryAssignMemberId.i,ps:this.queryAssignMemberId.ps});case 4:i=t.sent,this.listAsignMember=a?[].concat(Object(r["a"])(this.listAsignMember),Object(r["a"])(i.data)):i.data||[],t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),this.isLoading=!1,this.listAsignMember=[];case 12:case"end":return t.stop()}}),t,this,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getAsignMember",value:function(){var t=this,e=Object(g["filter"])(this.listAsignMember,(function(e){return e.id===t.user.id}));if(e.length)this.dataInput.assignMemberId=this.user.memberId;else{var a={id:this.user.memberId,memberNo:this.user.memberNo,fullName:this.user.fullName};this.listAsignMember.push(a),this.dataInput.assignMemberId=this.user.memberId}}},{key:"loadMoreCustomerId",value:function(){this.queryCustomerId.page+=1,this.queryCustomerId.limit+=20;var t=Object(g["debounce"])(this.getListCustomer,200);t(this.queryCustomerId.search,!0)}},{key:"remoteCustomerId",value:function(t){this.queryCustomerId.search=Object(g["trim"])(t),this.queryCustomerId.page=1,this.queryCustomerId.limit=20;var e=Object(g["debounce"])(this.getListCustomer,500);e(t)}},{key:"getListCustomer",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,i=this,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=s.length>1&&void 0!==s[1]&&s[1],t.prev=1,t.next=4,this.apiCustomer.getListCustomer({search:Object(g["trim"])(e),page:this.queryCustomerId.page,limit:this.queryCustomerId.limit}).then((function(t){i.listCustomer=[],i.listCustomer=a?[].concat(Object(r["a"])(i.listCustomer),Object(r["a"])(t.content)):t.content;var e=i.$route.fullPath.substring(0,17);if("/co-hoi-ban-hang/"==e){if(i.dataDetailDeal){if(i.listCustomer=Object(g["filter"])(i.listCustomer,(function(t){return t.id==i.dataDetailDeal.id})),i.listCustomer&&0==i.listCustomer.length){i.dataInput.customerId=+i.dataDetailDeal.customerId;var s={id:+i.dataDetailDeal.customerId,customerCifCode:i.dataDetailDeal.customerCifCode,customerFullName:i.dataDetailDeal.customerFullName};i.listCustomer.push(s)}}else if(i.listCustomer=Object(g["filter"])(i.listCustomer,(function(t){return t.id==i.dataRows.id})),i.listCustomer&&0==i.listCustomer.length){i.dataInput.customerId=+i.dataRows.customerId;var n={id:+i.dataRows.customerId,customerCifCode:i.dataRows.customerCifCode,customerFullName:i.dataRows.customerFullName};i.listCustomer.push(n),console.log("list",i.listCustomer)}}else if(i.listCustomer=Object(g["filter"])(i.listCustomer,(function(t){return t.id==i.idCustomer})),0==i.listCustomer.length)if("dealNewsfeed"==i.$route.name){if(i.listCustomer=Object(g["filter"])(i.listCustomer,(function(t){return t.id==i.$route.params.id})),i.listCustomer&&0==i.listCustomer.length){var l={id:+i.$route.params.id,customerIdNumber:12345,customerFullName:"truyen ten vao day"};i.listCustomer.push(l),console.log("list",i.listCustomer)}}else i.dataRow?i.listCustomer.push(i.dataRow):i.dataRows?i.listCustomer.push(i.dataRows):i.dataDetail?i.listCustomer.push(i.dataDetail):i.listCustomer=t.content}));case 4:t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](1),this.isLoading=!1,this.listCustomer=[];case 10:case"end":return t.stop()}}),t,this,[[1,6]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadMoreSalesDeal",value:function(){this.querySalesDeal.page+=1,this.querySalesDeal.limit+=20;var t=Object(g["debounce"])(this.getListSalesDeal,200);t(this.querySalesDeal.search,!0)}},{key:"remoteSalesDeal",value:function(t){this.querySalesDeal.search=Object(g["trim"])(t),this.querySalesDeal.page=1,this.querySalesDeal.limit=20;var e=Object(g["debounce"])(this.getListSalesDeal,500);e(t)}},{key:"getListSalesDeals",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,i=this,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=s.length>1&&void 0!==s[1]&&s[1],t.prev=1,t.next=4,this.apiSalesDeal.getListSalesDeal({search:Object(g["trim"])(e),page:this.querySalesDeal.page,limit:this.querySalesDeal.limit,customerId:this.idCustomer}).then((function(t){i.listSalesDeal=a?[].concat(Object(r["a"])(i.listSalesDeal),Object(r["a"])(t.content)):t.content,i.dataRows&&(i.listSalesDeal.push(i.dataRows),i.dataInput.dealId=i.dataRows.id),Object(g["includes"])(i.$route.path,"khach-hang")||(i.listSalesDeal.push({id:i.dataDetailDeal.id,name:i.dataDetailDeal.name}),i.dataInput.dealId=i.dataDetailDeal.id)}));case 4:t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](1),this.isLoading=!1,this.listSalesDeal=[];case 10:case"end":return t.stop()}}),t,this,[[1,6]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getListSalesDeal",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,i=this,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=s.length>1&&void 0!==s[1]&&s[1],t.prev=1,t.next=4,this.apiSalesDeal.getListSalesDeal({search:Object(g["trim"])(e),page:this.querySalesDeal.page,limit:this.querySalesDeal.limit,customerId:this.dataInput.customerId}).then((function(t){i.listSalesDeal=a?[].concat(Object(r["a"])(i.listSalesDeal),Object(r["a"])(t.content)):t.content}));case 4:t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](1),this.isLoading=!1,this.listSalesDeal=[];case 10:case"end":return t.stop()}}),t,this,[[1,6]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadMoreContactId",value:function(){this.queryContactId.page+=1,this.queryContactId.limit+=20;var t=Object(g["debounce"])(this.getListContacts,200);t(this.queryContactId.search,!0)}},{key:"remoteContactId",value:function(t){this.queryContactId.search=Object(g["trim"])(t),this.queryContactId.page=1,this.queryContactId.limit=20;var e=Object(g["debounce"])(this.getListContacts,500);e(t)}},{key:"getListContacts",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,i=this,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=s.length>1&&void 0!==s[1]&&s[1],t.prev=1,t.next=4,this.apiContact.getListContacts({search:Object(g["trim"])(e),page:this.queryContactId.page,limit:this.queryContactId.limit,customerId:this.idCustomer}).then((function(t){i.listContactId=a?[].concat(Object(r["a"])(i.listContactId),Object(r["a"])(t.data.data.content)):t.data.data.content||[]}));case 4:t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](1),this.isLoading=!1,this.listContactId=[];case 10:case"end":return t.stop()}}),t,this,[[1,6]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getListContact",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var a,i=this,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=s.length>1&&void 0!==s[1]&&s[1],t.prev=1,t.next=4,this.apiContact.getListContacts({search:Object(g["trim"])(e),page:this.queryContactId.page,limit:this.queryContactId.limit,customerId:this.dataInput.customerId}).then((function(t){i.listContactId=a?[].concat(Object(r["a"])(i.listContactId),Object(r["a"])(t.data.data.content)):t.data.data.content||[]}));case 4:t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](1),this.isLoading=!1,this.listCustomer=[];case 10:case"end":return t.stop()}}),t,this,[[1,6]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getFistContact",value:function(){this.listContactId.length>0&&(this.dataInput=Object(n["a"])(Object(n["a"])({},this.dataInput),{},{attendanceContractIds:[]}),this.dataInput.attendanceContractIds.push(this.listContactId[0].id))}},{key:"handleClickSave",value:function(){var t=this,e=this.$refs.dataInput;"create"===this.type&&this.fileList.length&&(this.dataInput.attachFiles=Object(r["a"])(this.fileList)),e.validate((function(e){if(!e)return console.log("error validate data!"),!1;if("create"===t.type){var a,i;t.fileList=[],t.dataInput.dueTime+=":00";var s=Object(n["a"])(Object(n["a"])({},t.dataInput),{},{attendanceContractIds:null!==(a=t.dataInput.attendanceContractIds)&&void 0!==a&&a.length?t.dataInput.attendanceContractIds.join(","):null});console.log("hasagi",s),null===(i=t.api)||void 0===i||i.createAppoint(s).then((function(){t.$message.success("Tạo lịch hẹn thành công"),t.$emit("apply"),t.handleClose()})).catch((function(e){t.$message.error(e.message)}))}else t.isEditDate&&(t.dataInput.dueDate+="T00:00:00.000+00:00"),t.dataInput.dueTime+=":00",t.dataInput.files=t.fileList,t.$emit("update",t.dataInput),t.handleClose()}))}},{key:"handleReset",value:function(){this.isEditDate=!1,this.isEditTime=!1,this.fileList=[],this.$refs.dataInput.clearValidate(),this.dataInput.title="",this.dataInput.dueDate="",this.dataInput.dueTime="",this.dataInput.duration="",this.dataInput.location="",this.dataInput.noteForCustomer="",this.dataInput.noteForTeam="",this.dataInput.assignMemberId="",this.dataInput.dealId="",this.dataInput.attendanceContractIds=[]}},{key:"handleClose",value:function(){this.$refs.dataInput.clearValidate(),this.isEditDate=!1,this.isEditTime=!1,this.dataInput.attendanceContractIds={},this.setOpenPopup({popupName:"appoint-customer",isOpen:!1}),this.fileList=[]}},{key:"handleOpen",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([this.getEmployeeList(""),this.getListCustomer("")]);case 3:"edit"===this.type?(this.dataInput=Object(n["a"])({},this.post),this.dataInput=Object(n["a"])({},this.post),this.fileList=this.post.files||[],this.dataInput.dueTime=null===(e=this.$options.filters)||void 0===e?void 0:e.getHoursString(this.post.dueTime)):(this.dataInput={},this.$refs.dataInput.clearValidate()),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),console.log(t.t0);case 9:this.getAsignMember(),this.idCustomer&&(this.getListSalesDeals(""),this.getListContacts("").then((function(){a.getFistContact()})),this.dataInput.customerId=parseInt(this.idCustomer));case 11:case"end":return t.stop()}}),t,this,[[0,6]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){var t,e,a,i,s,n,r,l,o,c,u,d;this.api=Object(b["a"])("deal",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiEmployee=Object(b["a"])("employee",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.apiCustomer=Object(b["a"])("category",{districtId:null===(s=this.user)||void 0===s||null===(n=s.districts)||void 0===n?void 0:n[0].id}),this.apiSalesDeal=Object(b["a"])("deal",{districtId:null===(r=this.user)||void 0===r||null===(l=r.districts)||void 0===l?void 0:l[0].id}),this.apiUpload=Object(b["a"])("upload",{districtId:null===(o=this.user)||void 0===o||null===(c=o.districts)||void 0===c?void 0:c[0].id}),this.apiContact=Object(b["a"])("deal",{districtId:null===(u=this.user)||void 0===u||null===(d=u.districts)||void 0===d?void 0:d[0].id})}}]),a}(Object(m["b"])(h["a"]));Object(p["a"])([Object(m["c"])({required:!1,type:Object,default:function(){return{}}})],I.prototype,"post",void 0),Object(p["a"])([v.State("user")],I.prototype,"user",void 0),Object(p["a"])([Object(m["c"])({required:!1,type:String,default:"create"})],I.prototype,"type",void 0),Object(p["a"])([Object(m["c"])()],I.prototype,"checkType",void 0),Object(p["a"])([Object(m["c"])()],I.prototype,"idCustomer",void 0),Object(p["a"])([Object(m["c"])()],I.prototype,"checkFillCustomer",void 0),Object(p["a"])([Object(m["c"])()],I.prototype,"dataRow",void 0),Object(p["a"])([Object(m["c"])()],I.prototype,"dataRows",void 0),Object(p["a"])([Object(m["c"])()],I.prototype,"dataDetail",void 0),Object(p["a"])([Object(m["c"])()],I.prototype,"dataDetailDeal",void 0),I=Object(p["a"])([Object(m["a"])({components:{}})],I);var C=I,y=C,O=(a("f3f8"),a("2877")),j=Object(O["a"])(y,i,s,!1,null,null,null);e["a"]=j.exports},f3f8:function(t,e,a){"use strict";a("05cd")}}]);
//# sourceMappingURL=chunk-9038266e.6f988727.js.map