(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cc990fa6"],{"2da8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"audit audit-page auditing-page"},[a("div",{staticClass:"audit-table"},["full"===t.getScreen?a("base-tree-table",{ref:"auditTable",staticClass:"auditing-table",attrs:{data:t.dataTable,filters:t.filters,border:!0,showPagination:!0,showSummary:!0,isLoading:t.isLoading,summaryMethod:t.summaryMethod,cellClassName:t.cellClassName,table:t.query,paginationInfo:"hợp đồng",emptyText:"Không có dữ liệu hợp đồng"},on:{selectionChange:t.handleSelection,filterChange:t.handleFilter,sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,rowClick:t.handleRowClick}},[a("template",{slot:"header"},[a("div",{staticClass:"audit-action be-flex jc-space-between"},[a("div",{staticClass:"aciton-left flex"},[a("search-bar",{attrs:{search:t.params.search},on:{search:t.handleSearch}}),a("el-button",{staticClass:"be-button-unset btn-audit",staticStyle:{"margin-right":"20px","margin-left":"20px"},on:{click:t.handleOpentFilter}},[a("base-icon",{attrs:{icon:"filter"}}),t._v(" Bộ lọc ")],1),a("el-dropdown",{staticClass:"import-sort",attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("el-button",{staticClass:"be-button-unset custom-button"},[a("base-icon",{staticClass:"icon",attrs:{icon:"sort"}}),t._v(" Sắp xếp ")],1),a("el-dropdown-menu",{staticClass:"sort-menu-popper",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.option,(function(e){return a("el-dropdown-item",{key:e.id,class:e.active?"active":null,attrs:{command:e,divided:e.divided}},[a("span",{staticClass:"be-flex"},[a("span",{staticClass:"be-flex-item"},[t._v(" "+t._s(e.name)+" ")])])])})),1)],1)],1),a("div",{staticClass:"action-right flex actions"},[t.getRoleBtnReq?a("el-button",{staticClass:"be-btn-danger btn-audit",attrs:{size:"medium"},on:{click:t.handleAudit}},[t._v("Đối soát ")]):t._e(),t.roleExportExcel?a("el-button",{staticClass:"custom-button",attrs:{loading:t.isLoadingButton},on:{click:t.handleOpenExportFile}},[a("span",{staticClass:"be-inline-flex align-center"},[a("base-icon",{staticClass:"icon",attrs:{icon:"excel-fullcolor"}}),t._v(" Xuất Excel ")],1)]):t._e(),t.roleSendEmail?a("el-button",{staticClass:"custom-button",attrs:{loading:t.isLoadingEmail},on:{click:t.handleSendEmail}},[a("span",{staticClass:"be-inline-flex align-center"},[a("base-icon",{staticClass:"icon",attrs:{icon:"email"}}),t._v(" Gửi mail ")],1)]):t._e()],1)])]),a("el-table-column",{key:1,attrs:{type:"index",index:t.indexMethod,label:"#",width:"70",align:"center"}}),a("el-table-column",{key:2,staticClass:"checkLength",attrs:{prop:"applyFormNo",label:"Số HSYCBH",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"be-flex be-flex-center jc-space-between"},[a("span",[t._v(t._s(e.row.applyFormNo))]),t.getRoleBtnApp&&"dang-doi-soat"===t.$route.name?a("div",[a("el-popover",{attrs:{placement:"bottom","popper-class":"popper-action-audit"},nativeOn:{click:function(e){return t.handleConflictClick.apply(null,arguments)}}},[a("div",{staticClass:"be-flex-column content"},[t.handleCheckLpbNull(e.row)?a("div",{staticClass:"content-item cursor",staticStyle:{"padding-bottom":"10px"},style:t.handleCheckLpbNull(e.row)?"padding-bottom: 0":"padding-bottom:10px",on:{click:function(a){return t.handleActionAudit({code:"add",data:e.row})}}},[a("span",[t._v("Thêm mới thu phí")])]):t._e(),t.handleCheckLpbNull(e.row)?t._e():a("div",{staticClass:"content-item cursor",staticStyle:{"padding-bottom":"7px","border-bottom":"1px solid #dbdbdb"},on:{click:function(a){return t.handleActionAudit({code:"edit-auditing",data:e.row})}}},[a("span",[t._v("Chỉnh sửa")])]),t.handleCheckLpbNull(e.row)?t._e():a("div",{staticClass:"content-item cursor",staticStyle:{"padding-top":"7px"},on:{click:function(a){return t.handleActionAudit({code:"delete",data:e.row})}}},[a("span",[t._v("Xóa")])])]),a("div",{staticClass:"reference",attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"el-icon-more"})])])],1):t._e()])]}}],null,!1,1695904582)}),a("el-table-column",{key:3,staticClass:"checkLength",attrs:{label:"Mã đvkd",prop:"transactionOfficeCode",width:"132",align:"center"}}),a("el-table-column",{key:4,attrs:{label:"Mã SP",prop:"productCode",width:"147",align:"left"}}),a("el-table-column",{key:5,staticClass:"checkLength",attrs:{label:"năm phí",width:"152",prop:"currentFeeYear",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumberAdv")(e.row.currentFeeYear)))]}}],null,!1,3084915159)}),a("el-table-column",{key:6,attrs:{label:"Tổng phí",prop:"totalAmount",width:"186",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumberAdv")(e.row.totalAmount))+" ")]}}],null,!1,1730385049)}),a("el-table-column",{key:8,staticClass:"checkLength",attrs:{label:"DL đúng",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.handleCheckDaichiNull(e.row)&&t.getRoleBtnApp?a("el-popover",{attrs:{placement:"bottom","popper-class":"popper-checkbox-audit"},nativeOn:{click:function(e){return t.handleConflictClick.apply(null,arguments)}}},[a("div",{staticClass:"reference",attrs:{slot:"reference"},slot:"reference"},[a("el-checkbox",{attrs:{value:!1},on:{change:function(a){return t.handleClickCbx(e.row,"LPB")}}})],1)]):t._e()]}}],null,!1,2470120351)}),a("el-table-column",{key:10,staticClass:"checkLength",attrs:{prop:"applyFormNo1",label:"Số HSYCBH",align:"left",width:"140"}}),a("el-table-column",{key:12,staticClass:"checkLength",attrs:{label:"Mã đvkd",prop:"transactionOfficeCode1",width:"132",align:"center"}}),a("el-table-column",{key:13,attrs:{label:"Mã SP",prop:"productCode1",width:"147",align:"left"}}),a("el-table-column",{key:14,staticClass:"checkLength",attrs:{label:"năm phí",width:"152",align:"center",prop:"currentFeeYear1"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumberAdv")(e.row.currentFeeYear1)))]}}],null,!1,3087182470)}),a("el-table-column",{key:15,attrs:{label:"Tổng phí",prop:"totalAmount1",width:"180",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumberAdv")(e.row.totalAmount1))+" ")]}}],null,!1,1041274056)}),a("el-table-column",{key:17,staticClass:"checkLength",attrs:{label:"DL đúng",prop:"branchName",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.getRoleBtnApp?a("el-popover",{attrs:{placement:"bottom","popper-class":"popper-checkbox-audit"},nativeOn:{click:function(e){return t.handleConflictClick.apply(null,arguments)}}},[a("div",{staticClass:"reference",attrs:{slot:"reference"},slot:"reference"},[a("el-checkbox",{attrs:{value:!1},on:{change:function(a){return t.handleClickCbx(e.row,"DAICHI")}}})],1)]):t._e()]}}],null,!1,241216568)})],2):t._e(),"hd"===t.getScreen?a("base-tree-table",{ref:"auditTable",staticClass:"auditing-table",class:"hd"===t.getScreen?"table-hd":null,attrs:{data:t.dataTable,filters:t.filters,border:!0,showPagination:!0,showSummary:!0,isLoading:t.isLoading,summaryMethod:t.summaryMethod,cellClassName:t.cellClassName,table:t.query,paginationInfo:"hợp đồng"},on:{selectionChange:t.handleSelection,filterChange:t.handleFilter,sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange,rowClick:t.handleRowClick}},[a("template",{slot:"header"},[a("div",{staticClass:"audit-action be-flex jc-space-between"},[a("div",{staticClass:"aciton-left flex"},[a("search-bar",{attrs:{search:t.params.search},on:{search:t.handleSearch}}),a("el-button",{staticClass:"be-button-unset btn-audit",staticStyle:{"margin-right":"20px","margin-left":"20px"},on:{click:t.handleOpentFilter}},[a("base-icon",{attrs:{icon:"filter"}}),t._v(" Bộ lọc ")],1),a("el-dropdown",{staticClass:"import-sort",attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("el-button",{staticClass:"be-button-unset custom-button"},[a("base-icon",{staticClass:"icon",attrs:{icon:"sort"}}),t._v(" Sắp xếp ")],1),a("el-dropdown-menu",{staticClass:"sort-menu-popper",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.option,(function(e){return a("el-dropdown-item",{key:e.id,class:e.active?"active":null,attrs:{command:e,divided:e.divided}},[a("span",{staticClass:"be-flex"},[a("span",{staticClass:"be-flex-item"},[t._v(" "+t._s(e.name)+" ")])])])})),1)],1)],1),a("div",{staticClass:"action-right flex actions"},[t.getRoleBtnReq?a("el-button",{staticClass:"be-btn-danger btn-audit",attrs:{size:"medium"},on:{click:t.handleAudit}},[t._v("Đối soát ")]):t._e(),t.roleExportExcel?a("el-button",{staticClass:"custom-button",attrs:{loading:t.isLoadingButton},on:{click:t.handleOpenExportFile}},[a("span",{staticClass:"be-inline-flex align-center"},[a("base-icon",{staticClass:"icon",attrs:{icon:"excel-fullcolor"}}),t._v(" Xuất Excel ")],1)]):t._e(),t.roleSendEmail?a("el-button",{staticClass:"custom-button",attrs:{loading:t.isLoadingEmail},on:{click:t.handleSendEmail}},[a("span",{staticClass:"be-inline-flex align-center"},[a("base-icon",{staticClass:"icon",attrs:{icon:"email"}}),t._v(" Gửi mail ")],1)]):t._e()],1)])]),a("el-table-column",{key:1,attrs:{type:"index",index:t.indexMethod,label:"#",width:"70",align:"center"}}),a("el-table-column",{key:2,staticClass:"checkLength",attrs:{prop:"applyFormNo",label:"Số HSYCBH",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"be-flex be-flex-center jc-space-between"},[a("span",[t._v(t._s(e.row.applyFormNo))]),t.getRoleBtnApp&&"dang-doi-soat"===t.$route.name?a("div",[a("el-popover",{attrs:{placement:"bottom","popper-class":"popper-action-audit"},nativeOn:{click:function(e){return t.handleConflictClick.apply(null,arguments)}}},[a("div",{staticClass:"be-flex-column content"},[t.handleCheckLpbNull(e.row)?a("div",{staticClass:"content-item cursor",style:t.handleCheckLpbNull(e.row)?"padding-bottom: 0":"padding-bottom:10px",on:{click:function(a){return t.handleActionAudit({code:"add",data:e.row})}}},[a("span",[t._v("Thêm mới thu phí")])]):t._e(),t.handleCheckLpbNull(e.row)?t._e():a("div",{staticClass:"content-item cursor",staticStyle:{"padding-bottom":"7px","border-bottom":"1px solid #dbdbdb"},on:{click:function(a){return t.handleActionAudit({code:"edit-auditing",data:e.row})}}},[a("span",[t._v("Chỉnh sửa")])]),t.handleCheckLpbNull(e.row)?t._e():a("div",{staticClass:"content-item cursor",staticStyle:{"padding-top":"7px"},on:{click:function(a){return t.handleActionAudit({code:"delete",data:e.row})}}},[a("span",[t._v("Xóa")])])]),a("div",{staticClass:"reference",attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"el-icon-more"})])])],1):t._e()])]}}],null,!1,2096755609)}),a("el-table-column",{key:3,staticClass:"checkLength",attrs:{label:"Mã đvkd",prop:"transactionOfficeCode",width:"100",align:"center"}}),a("el-table-column",{key:4,attrs:{label:"Mã SP",prop:"productCode",width:"130",align:"left"}}),a("el-table-column",{key:5,staticClass:"checkLength",attrs:{label:"năm phí",width:"80",prop:"currentFeeYear",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumberAdv")(e.row.currentFeeYear)))]}}],null,!1,3084915159)}),a("el-table-column",{key:6,attrs:{label:"Tổng phí",prop:"totalAmount",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumberAdv")(e.row.totalAmount))+" ")]}}],null,!1,1730385049)}),a("el-table-column",{key:8,staticClass:"checkLength",attrs:{label:"DL đúng",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.handleCheckDaichiNull(e.row)&&t.getRoleBtnApp?a("el-popover",{attrs:{placement:"bottom","popper-class":"popper-checkbox-audit"},nativeOn:{click:function(e){return t.handleConflictClick.apply(null,arguments)}}},[a("div",{staticClass:"reference",attrs:{slot:"reference"},slot:"reference"},[a("el-checkbox",{attrs:{value:!1},on:{change:function(a){return t.handleClickCbx(e.row,"LPB")}}})],1)]):t._e()]}}],null,!1,2470120351)}),a("el-table-column",{key:10,staticClass:"checkLength",attrs:{prop:"applyFormNo1",label:"Số HSYCBH",align:"left",width:"140"}}),a("el-table-column",{key:12,staticClass:"checkLength",attrs:{label:"Mã đvkd",prop:"transactionOfficeCode1",width:"100",align:"center"}}),a("el-table-column",{key:13,attrs:{label:"Mã SP",prop:"productCode1",width:"130",align:"left"}}),a("el-table-column",{key:14,staticClass:"checkLength",attrs:{label:"năm phí",width:"80",align:"center",prop:"currentFeeYear1"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatNumberAdv")(e.row.currentFeeYear1)))]}}],null,!1,3087182470)}),a("el-table-column",{key:15,attrs:{label:"Tổng phí",prop:"totalAmount1",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumberAdv")(e.row.totalAmount1))+" ")]}}],null,!1,1041274056)}),a("el-table-column",{key:17,staticClass:"checkLength",attrs:{label:"DL đúng",prop:"branchName",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.getRoleBtnApp?a("el-popover",{attrs:{placement:"bottom","popper-class":"popper-checkbox-audit"},nativeOn:{click:function(e){return t.handleConflictClick.apply(null,arguments)}}},[a("div",{staticClass:"reference",attrs:{slot:"reference"},slot:"reference"},[a("el-checkbox",{attrs:{value:!1},on:{change:function(a){return t.handleClickCbx(e.row,"DAICHI")}}})],1)]):t._e()]}}],null,!1,241216568)})],2):t._e()],1),a("audit-popup",{attrs:{params:t.params,dataPopup:t.dataPopup,propCustomerType:t.listType},on:{handlePrev:t.handlePrevPopupAudit,handleNext:t.handleNextPopupAudit,update:t.handleFilter}}),a("audit-popup-filter",{attrs:{type:t.$route.name},on:{apply:t.handleFilter}}),a("popup-confirm-auditing",{attrs:{data:t.detailConfirm},on:{reload:t.handleReload}}),a("popup-detail-diff",{attrs:{data:t.dataTable,"index-row":t.indexRow,dataEdit:t.dataEdit},on:{reload:t.handleReload,delete:t.handleDeleteDetail,openEdit:t.handleActionAudit}}),a("create-cost",{attrs:{dataProp:t.dataEdit},on:{reload:t.handleReload}})],1)},n=[],o=a("c964"),s=a("f3f3"),l=a("d0ff"),r=a("276c"),c=a("e954"),d=a("920b"),u=a("92a6"),p=(a("96cf"),a("d3b7"),a("ddb0"),a("4ec9"),a("3ca3"),a("d81d"),a("99af"),a("a15b"),a("ac1f"),a("841c"),a("7db0"),a("4de4"),a("2b3d"),a("b0c0"),a("5319"),a("9ab4")),h=a("08ba"),m=a("1b40"),f=a("9f48"),b=a("ff0e"),v=a("fa2a"),g=a("3956"),y=a("a6fa"),C=a("fdb8"),k=a("13fb"),w=a("4a47e"),N=a("4897c"),_=a("4bb5"),O=a("e383"),P=a("2ef0"),x=a("567c"),A=a("9f13"),S=a("2b17"),R=a("c661"),L=a("4a7b8"),D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"dialog-confirm-audit",attrs:{name:"popup-confirm-auditing",width:"420px",hiddenFooter:!0}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.data.delete?"Xác nhận xóa":"Xác nhận đối soát"))]),a("div",{staticClass:"body-content"},[t.data.delete?a("span",{staticStyle:{"word-break":"break-word","line-height":"1.7"}},[t._v("Bạn có chắc chắn muốn xóa thu phí "),a("b",[t._v(t._s(t.data.applyFormNo?t.data.applyFormNo:""))]),t._v("/ "),a("b",[t._v(t._s(t.data.contractNo?t.data.contractNo:""))]),t._v("/ "),a("b",[t._v(t._s(t.data.productCode?t.data.productCode:""))]),t._v("/ "),a("b",[t._v(t._s(t.data.totalAmount?t.totalAmount:""))]),t._v(" ?")]):a("span",{staticStyle:{"word-break":"break-word","line-height":"1.7"}},[t._v("Bạn có chắc chắn muốn chọn "),a("b",[t._v("DL "+t._s(t.data.type))]),t._v(" cho "),a("b",[t._v(t._s(t.data.applyFormNo?t.data.applyFormNo:""))]),t._v("/ "),a("b",[t._v(t._s(t.data.contractNo?t.data.contractNo:""))]),t._v("/ "),a("b",[t._v(t._s(t.data.productCode?t.data.productCode:""))]),t._v("/ "),a("b",[t._v(t._s(t.data.totalAmount?t.totalAmount:""))]),t._v(" ?")])]),a("template",{slot:"footer"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex jc-flex-end"},[a("div",{},[a("el-button",{staticClass:"be-button-unset",attrs:{size:"mini"},on:{click:t.handleCancel}},[t._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:t.handleConfirm}},[t._v("Xác nhận")])],1)])])])],2)},F=[],T=a("c56f"),j=function(t){Object(d["a"])(a,t);var e=Object(u["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(c["a"])(a,[{key:"created",value:function(){this.apiContract=Object(h["a"])("contract",{districtId:this.districtId})}},{key:"totalAmount",get:function(){var t,e;return null!==(t=this.data)&&void 0!==t&&t.totalAmount?null===(e=this.$options.filters)||void 0===e?void 0:e.formatNumber(this.data.totalAmount):""}},{key:"handleCancel",value:function(){this.setOpenPopup({popupName:"popup-confirm-auditing",isOpen:!1})}},{key:"handleConfirm",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n,o,s,l,r,c,d,u,p,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,d="LPB"===(null===(e=this.data)||void 0===e?void 0:e.type)?{contractNo:null===(a=this.data)||void 0===a?void 0:a.contractNo,applyFormNo:null===(i=this.data)||void 0===i?void 0:i.applyFormNo}:null!==(n=this.data)&&void 0!==n&&n.isNull?{}:{contractNo:null===(o=this.data)||void 0===o?void 0:o.contractNo,applyFormNo:null===(s=this.data)||void 0===s?void 0:s.applyFormNo},u={paymentDiffId:null===(l=this.data)||void 0===l?void 0:l.id,paymentSource:null===(r=this.data)||void 0===r?void 0:r.type},null===(c=this.data)||void 0===c||!c.delete){t.next=12;break}return t.next=6,null===(p=this.apiContract)||void 0===p?void 0:p.deletePaymentDiff(this.data.id,{paymentSource:"LPB"});case 6:this.$message.success("Xóa thành công"),this.setOpenPopup({popupName:"popup-confirm-auditing",isOpen:!1}),this.setOpenPopup({popupName:"popup-detail-auditing",isOpen:!1}),this.$emit("reload"),t.next=17;break;case 12:return t.next=14,null===(h=this.apiContract)||void 0===h?void 0:h.updatePaymentDiff(u,d,!0);case 14:this.$emit("reload"),this.setOpenPopup({popupName:"popup-confirm-auditing",isOpen:!1}),this.$message.success("Cập nhật thông tin thành công");case 17:t.next=24;break;case 19:t.prev=19,t.t0=t["catch"](0),this.setOpenPopup({popupName:"popup-confirm-auditing",isOpen:!1}),this.$message.error(t.t0.message),console.log(t.t0);case 24:case"end":return t.stop()}}),t,this,[[0,19]])})));function e(){return t.apply(this,arguments)}return e}()}]),a}(Object(m["b"])(f["a"],T["a"]));Object(p["a"])([Object(m["c"])({required:!1,default:{type:"",code:""}})],j.prototype,"data",void 0),j=Object(p["a"])([Object(m["a"])({components:{}})],j);var V=j,E=V,B=(a("a960"),a("2877")),$=Object(B["a"])(E,D,F,!1,null,"4f6a3f9a",null),I=$.exports,M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"popup-detail-diff",attrs:{name:"popup-detail-auditing",open:t.handleOpen,close:t.handleClose,top:"5vh",width:"725px",hiddenFooter:!0}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"be-flex title-popup"},[a("span",[t._v("Chi tiết")]),t.isShowAction&&t.getRole?a("div",{staticClass:"be-flex titte-action"},[a("div",{staticClass:"aciton-item cursor",staticStyle:{"margin-right":"20px"},on:{click:t.handleEdit}},[a("base-icon",{staticStyle:{"margin-right":"5px"},attrs:{icon:"action"}}),t._v("Sửa DL LPB")],1),a("div",{staticClass:"aciton-item cursor",on:{click:t.handleDelete}},[a("base-icon",{staticStyle:{"margin-right":"5px"},attrs:{icon:"delete"}}),t._v("Xóa DL LPB")],1)]):a("div",{staticClass:"titte-action"},[t.getRole?a("div",{staticClass:"aciton-item cursor",on:{click:t.handleAddCost}},[a("base-icon",{staticStyle:{"margin-right":"5px"},attrs:{icon:"plus"}}),t._v("Thêm thu phí")],1):t._e()])])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"body-content"},[a("div",{staticClass:"content"},[a("div",{staticClass:"be-flex content__header"},[a("div",{staticClass:"content__header-empty"}),a("div",{staticClass:"content__header-item"},[a("span",[t._v("LPB")])]),a("div",{staticClass:"content__header-item content__header-item--red"},[a("span",[t._v("DAI-ICHI")])])]),t._l(t.arrayRow,(function(e,i){return a("div",{key:e.id,staticClass:"be-flex content__row",class:t.objDiff[e.id]?"row-diff":null},[a("div",{staticClass:"content_row-item",class:i===t.arrayRow.length-1?"last-item":12===i?"item-code":null},[a("span",[t._v(t._s(e.title))])]),a("div",{staticClass:"content_row-item",class:i===t.arrayRow.length-1?"last-item":12===i?"item-code":null},["payFeeDate"!==e.lpbValue&&"issueDate"!==e.lpbValue||!e.lpbValue?"number"===typeof t.dataRow[e.lpbValue]?a("span",[t._v(t._s(t._f("formatNumberSpecical")(t.dataRow[e.lpbValue])))]):"consultantName"!==e.lpbValue&&"salesFullName"!==e.lpbValue||!e.lpbValue?a("span",[t._v(t._s(t.dataRow[e.lpbValue]?t.dataRow[e.lpbValue]:"-"))]):a("span",{staticStyle:{width:"100%","text-align":"center"}},[a("span",{staticStyle:{display:"block","text-align":"center",width:"100%"}},[t._v(t._s(t.dataRow[e.lpbValue]))]),a("small",[t._v(t._s(t.dataRow[e.consultantMemberNo]))])]):a("span",[t._v(t._s(t._f("formatDateTimeAdv")(t.dataRow[e.lpbValue])))])]),a("div",{staticClass:"content_row-item",class:i===t.arrayRow.length-1?"last-item":null},["payFeeDate1"!==e.daiichiValue&&"issueDate1"!==e.daiichiValue||!e.daiichiValue?"number"===typeof t.dataRow[e.daiichiValue]?a("span",[t._v(t._s(t._f("formatNumberSpecical")(t.dataRow[e.daiichiValue])))]):a("span",[t._v(t._s(t.dataRow[e.daiichiValue]?t.dataRow[e.daiichiValue]:"-"))]):a("span",[t._v(t._s(t._f("formatDateTimeAdv")(t.dataRow[e.daiichiValue])))])])])}))],2)]),a("template",{slot:"footer"},[t.getRole?a("div",{staticClass:"be-flex content__footer"},[a("div",{staticClass:"content__footer-item width"},[a("span",[t._v("DL đúng")])]),a("div",{staticClass:"content__footer-item"},[a("el-radio",{attrs:{disabled:t.isDisableLpb,label:"LPB"},model:{value:t.radioTrue,callback:function(e){t.radioTrue=e},expression:"radioTrue"}},[t._v("DL LPB đúng")])],1),a("div",{staticClass:"content__footer-item"},[a("el-radio",{attrs:{label:"DAICHI"},model:{value:t.radioTrue,callback:function(e){t.radioTrue=e},expression:"radioTrue"}},[t._v("DL Dai-ichi đúng")])],1)]):t._e(),a("div",{staticClass:"bottom"},[a("div",{staticClass:"bt-top flex",class:t.getRole?"jc-space-between":"bottom-else"},[a("el-button",{staticClass:"btn-custom el-button--default",attrs:{disabled:t.getDisablePrev,size:"mini"},on:{click:t.handlePrevData}},[a("i",{staticClass:"el-icon-arrow-left"}),t._v(" Trước ")]),a("div",{staticClass:"bt-center"},[t.getRole?a("el-button",{staticClass:"btn-custom el-button--default",attrs:{size:"mini"},on:{click:t.handleSaveClose}},[t._v("Lưu & đóng")]):t._e(),t.getRole?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:t.handleSaveNext}},[t._v("Lưu & tiếp tục")]):t._e()],1),a("el-button",{staticClass:"btn-custom btn-next el-button--default",attrs:{disabled:t.getDisableNext,size:"mini"},on:{click:t.handleNextData}},[t._v(" Sau "),a("i",{staticClass:"el-icon-arrow-right"})])],1)])])],2)},q=[],Y=a("4f98"),H=function(t){Object(d["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.isLoading=!1,t.isShowAction=!0,t.radioTrue="",t.objDiff={},t.dataRow={},t.index=0,t.isEdit=!1,t.arrayRow=[{id:1,title:"Ngày phí phát sinh",lpbValue:"payFeeDate",daiichiValue:"payFeeDate1"},{id:2,title:"Số HSYCBH",lpbValue:"applyFormNo",daiichiValue:"applyFormNo1"},{id:3,title:"Số HĐ",lpbValue:"contractNo",daiichiValue:"contractNo1"},{id:18,title:"Ngày phát hành",lpbValue:"issueDate",daiichiValue:"issueDate1"},{id:4,title:"Thời hạn HĐ",lpbValue:"numOfContractYear",daiichiValue:"numOfContractYear1"},{id:5,title:"Thời hạn đóng phí",lpbValue:"numOfFeeYear",daiichiValue:"numOfFeeYear1"},{id:6,title:"Năm phí hiện tại",lpbValue:"currentFeeYear",daiichiValue:"currentFeeYear1"},{id:17,title:"Định kỳ đóng phí",lpbValue:"paymentPeriod",daiichiValue:"paymentPeriod1"},{id:7,title:"Mã ĐVKD",lpbValue:"transactionOfficeCode",daiichiValue:"transactionOfficeCode1"},{id:15,title:"Mã NVTV",lpbValue:"salesMemberNo",daiichiValue:"salesMemberNo1"},{id:16,title:"Tên NVTV",lpbValue:"salesFullName",daiichiValue:"salesFullName1"},{id:8,title:"Mã code",lpbValue:"consultantNo",daiichiValue:"consultantNo1"},{id:9,title:"NV đứng code",lpbValue:"consultantName",lpbValueCode:"consultantMemberNo",daiichiValueCode:"consultantMemberNo1",daiichiValue:"consultantName1"},{id:10,title:"Tên BMBH",lpbValue:"customerFullName",daiichiValue:"customerFullName1"},{id:11,title:"Mã SP",lpbValue:"productCode",daiichiValue:"productCode1"},{id:12,title:"Phí cơ bản",lpbValue:"basicAmount",daiichiValue:"basicAmount1"},{id:13,title:"Phí đóng thêm",lpbValue:"extraAmount",daiichiValue:"extraAmount1"},{id:14,title:"Tổng phí",lpbValue:"totalAmount",daiichiValue:"totalAmount1"}],t.propertyLpb=["payFeeDate","applyFormNo","contractNo","issueDate","numOfContractYear","numOfFeeYear","currentFeeYear","salesMemberNo","salesFullName","transactionOfficeCode","consultantNo","consultantName","customerFullName","productCode","basicAmount","extraAmount","totalAmount"],t.propertyDaiichi=["payFeeDate1","applyFormNo1","contractNo1","issueDate","numOfContractYear1","numOfFeeYear1","currentFeeYear1","salesMemberNo1","salesFullName1","transactionOfficeCode1","consultantNo1","consultantName1","customerFullName1","productCode1","basicAmount1","extraAmount1","totalAmount1"],t.isDisableLpb=!1,t.isNullDaiichi=!1,t}return Object(c["a"])(a,[{key:"getRole",get:function(){return this.checkPemission("audit",["edit-auditing"])}},{key:"getDisableNext",get:function(){var t;return this.index===(this.data&&(null===(t=this.data)||void 0===t?void 0:t.length)-1)}},{key:"getDisablePrev",get:function(){return 0===this.index}},{key:"created",value:function(){this.apiContract=Object(h["a"])("contract",{districtId:this.districtId})}},{key:"handleEdit",value:function(){var t=this,e="edit-auditing";this.$emit("openEdit",{code:e,data:this.dataRow}),setTimeout((function(){t.setOpenPopup({popupName:"popup-detail-auditing",isOpen:!1})}),1e3)}},{key:"handleAddCost",value:function(){var t=this,e="add";this.$emit("openEdit",{code:e,data:this.dataRow}),setTimeout((function(){t.setOpenPopup({popupName:"popup-detail-auditing",isOpen:!1})}),1e3)}},{key:"handleDelete",value:function(){var t={delete:!0,applyFormNo:this.dataRow.applyFormNo,id:this.dataRow.id,contractNo:this.dataRow.contractNo,totalAmount:this.dataRow.totalAmount,productCode:this.dataRow.productCode};this.$emit("delete",{code:"delete",data:t})}},{key:"handleNextData",value:function(){var t;this.isLoading=!0,this.index+=1,this.index!==(null===(t=this.data)||void 0===t?void 0:t.length)?(this.dataRow=this.data[this.index],this.objDiff={},this.handleCompareDiff(),this.isLoading=!1):this.setOpenPopup({popupName:"popup-detail-auditing",isOpen:!1})}},{key:"handlePrevData",value:function(){this.isLoading=!0,this.index-=1,this.dataRow=this.data[this.index],this.objDiff={},this.handleCompareDiff(),this.isLoading=!1}},{key:"handleSaveClose",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!this.radioTrue){t.next=11;break}return a="LPB"===this.radioTrue?{contractNo:this.dataRow.contractNo,applyFormNo:this.dataRow.applyFormNo}:this.isNullDaiichi?{}:{contractNo:this.dataRow.contractNo1,applyFormNo:this.dataRow.applyFormNo1},i={paymentDiffId:this.dataRow.id,paymentSource:this.radioTrue},t.next=6,null===(e=this.apiContract)||void 0===e?void 0:e.updatePaymentDiff(i,a,!0);case 6:this.$emit("reload"),this.setOpenPopup({popupName:"popup-detail-auditing",isOpen:!1}),this.$message.success("Cập nhật thông tin thành công"),t.next=12;break;case 11:this.$message.error("Cần chọn dữ liệu đúng để đối soát");case 12:t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](0),this.$message.error(t.t0.message);case 17:case"end":return t.stop()}}),t,this,[[0,14]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSaveNext",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!this.radioTrue){t.next=11;break}return a="LPB"===this.radioTrue?{contractNo:this.dataRow.contractNo,applyFormNo:this.dataRow.applyFormNo}:{contractNo:this.dataRow.contractNo1,applyFormNo:this.dataRow.applyFormNo1},i={paymentDiffId:this.dataRow.id,paymentSource:this.radioTrue},t.next=6,null===(e=this.apiContract)||void 0===e?void 0:e.updatePaymentDiff(i,a,!0);case 6:this.$message.success("Cập nhật thông tin thành công"),this.handleNextData(),this.isEdit=!0,t.next=12;break;case 11:this.$message.error("Cần chọn dữ liệu đúng để đối soát");case 12:t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](0),this.$message.error(t.t0.message);case 17:case"end":return t.stop()}}),t,this,[[0,14]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleOpen",value:function(){var t;this.objDiff={},this.isEdit=!1,this.radioTrue="LPB",this.isLoading=!0,this.index=this.indexRow,this.dataRow=(null===(t=this.data)||void 0===t?void 0:t.length)&&this.data[this.index],this.handleCompareDiff(),this.isLoading=!1}},{key:"handleClose",value:function(){this.isDisableLpb=!1,this.isEdit&&this.$emit("reload"),this.setOpenPopup({popupName:"popup-detail-auditing",isOpen:!1})}},{key:"convertPaymentPeriod",value:function(){1===this.dataRow.paymentPeriod&&(this.dataRow.paymentPeriod="Năm"),2===this.dataRow.paymentPeriod&&(this.dataRow.paymentPeriod="Nửa năm"),4===this.dataRow.paymentPeriod&&(this.dataRow.paymentPeriod="Quý"),12===this.dataRow.paymentPeriod&&(this.dataRow.paymentPeriod="Tháng"),0===this.dataRow.paymentPeriod&&(this.dataRow.paymentPeriod="1 lần"),1===this.dataRow.paymentPeriod1&&(this.dataRow.paymentPeriod1="Năm"),2===this.dataRow.paymentPeriod1&&(this.dataRow.paymentPeriod1="Nửa năm"),4===this.dataRow.paymentPeriod1&&(this.dataRow.paymentPeriod1="Quý"),12===this.dataRow.paymentPeriod1&&(this.dataRow.paymentPeriod="Tháng"),0===this.dataRow.paymentPeriod1&&(this.dataRow.paymentPeriod="1 lần")}},{key:"handleCompareDiff",value:function(){var t=this;this.convertPaymentPeriod();var e=!1,a=!1;this.isDisableLpb=!1;for(var i=0;i<this.propertyLpb.length;i++){if(this.dataRow[this.propertyLpb[i]]){e=!1;break}e=!0}for(var n=0;n<this.propertyDaiichi.length;n++){if(this.dataRow[this.propertyDaiichi[n]]){a=!1;break}a=!0}e&&!a&&(this.isShowAction=!1,this.radioTrue=""),!e&&a&&(this.isShowAction=!0,this.radioTrue="",this.isDisableLpb=!0),e||a||(this.isShowAction=!0,this.radioTrue="",Object(P["forEach"])(this.arrayRow,(function(e){t.dataRow[e.lpbValue]!==t.dataRow[e.daiichiValue]?t.objDiff[e.id]=!0:t.objDiff[e.id]=!1}))),this.isNullDaiichi=a}}]),a}(Object(m["b"])(f["a"],T["a"]));Object(p["a"])([Object(m["c"])({required:!1,default:{}})],H.prototype,"data",void 0),Object(p["a"])([Object(m["c"])()],H.prototype,"dataEdit",void 0),Object(p["a"])([Object(m["c"])({required:!0,default:0})],H.prototype,"indexRow",void 0),H=Object(p["a"])([Object(m["a"])({components:{CreateCost:Y["a"]}})],H);var z=H,G=z,X=(a("5d2a"),Object(B["a"])(G,M,q,!1,null,"7bd23e5b",null)),U=X.exports,K=Object(_["a"])("beAudit"),J=function(t){Object(d["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.isLoadingButton=!1,t.data={},t.dataEdit={title:"Sửa thu phí",code:"edit-auditing",value:{},type:"audit"},t.indexRow=0,t.callAction=null,t.dataRow={},t.detailConfirm={},t.valueSearch="",t.isLoading=!1,t.testData=[],t.dataTable=[],t.textButton="Đối soát",t.statusRoute="",t.pageSize="",t.dataSelect=[],t.dataClick=[],t.statusClick="",t.propertyLpb=["applyFormNo","transactionOfficeCode","productCode","currentFeeYear","totalAmount"],t.propertyDaichi=["applyFormNo1","transactionOfficeCode1","productCode1","currentFeeYear1","totalAmount1"],t.params={auditStatus:"2",page:1,limit:20,searchType:"CONTRACT"},t.query={total:0,page:t.params.page,limit:t.params.limit},t.isConflickClick=!1,t.dataPopup={total:t.data.total,data:[],action:""},t.valueFilter={},t.option=[{id:1,name:"Đơn vị kinh doanh",divided:!1},{id:6,name:"Tổng phí",divided:!0},{id:2,name:"Ngày phát hành",divided:!0},{id:3,name:"Ngày đóng phí",divided:!1},{id:4,name:"Ngày hết hạn",divided:!1},{id:5,name:"Mã sản phẩm",divided:!0}],t.listType=[],t.isLoadingEmail=!1,t.isShow=!1,t.propValueSearch="",t.contractInfor={},t.dataPopupAction={title:"",label:"",code:"",contractNo:[]},t.checkLastItemSelect=!1,t.checkReqToEdit=!1,t.paramsFilter={noAudit:{},auditting:{},pending:{},approve:{},reqEdit:{}},t.fileName="",t.filters={name:"Bộ lọc"},t.url="",t}return Object(c["a"])(a,[{key:"getScreen",get:function(){return window.screen.availWidth>=1600?"full":"hd"}},{key:"splitButton",get:function(){return"da-duyet"!=this.$route.params.status}},{key:"nameButtonAction",get:function(){var t="Gán nhân viên tư vấn",e=this.$route.params.status;return"cho-duyet"==e&&(t="Từ chối duyệt"),"da-duyet"==e&&(t="Yêu cầu hiệu chỉnh"),"yeu-cau-hieu-chinh"==e&&(t="Từ chối hiệu chỉnh"),t}},{key:"getRoleBtnAudit",get:function(){return!this.$route.params.status&&this.checkPemission("audit",["edit-no-audit"])}},{key:"roleSendEmail",get:function(){return this.checkPemission("audit",["send-mail"])}},{key:"roleExportExcel",get:function(){return this.checkPemission("audit",["export-excel"])}},{key:"getRoleBtnCancelHc",get:function(){return this.checkPemission("audit",["edit-request"])}},{key:"getRoleBtnCancelTc",get:function(){return this.checkPemission("audit",["edit-pending"])}},{key:"getRoleBtnReq",get:function(){return this.checkPemission("audit",["edit-auditing"])}},{key:"getRoleBtnApp",get:function(){return this.checkPemission("audit",["edit-auditing"])}},{key:"getRoleBtnAppRq",get:function(){return this.checkPemission("audit",["edit-request"])}},{key:"getRoleCbx",get:function(){return this.$route.params.status&&"dang-doi-soat"!==this.$route.params.status?"cho-duyet"!==this.$route.params.status&&("da-duyet"===this.$route.params.status?this.checkPemission("audit",["cbx-action-da-duyet"]):"yeu-cau-hieu-chinh"!==this.$route.params.status):this.checkPemission("audit",["cbx-action"])}},{key:"indexMethod",value:function(t){return(this.params.page-1)*this.params.limit+t+1}},{key:"handleConflictClick",value:function(){this.isConflickClick=!0}},{key:"reinit",value:function(){this.dataSelect=[],this.params.limit=20,this.params.page=1,this.query.page=this.params.page,this.query.limit=this.params.limit,this.dataPopup={total:this.data.total,data:[],action:""}}},{key:"handleRowClick",value:function(t){console.log(t),this.indexRow=Object(P["findIndex"])(this.dataTable,{id:t.row.id}),this.isConflickClick?this.isConflickClick=!1:1!=this.checkReqToEdit&&(this.contractInfor=t.row,this.dataPopup.action="detail",this.dataPopup.data=[t.row],this.dataPopup.total=this.dataPopup.data.length,this.dataRow=t.row,this.setOpenPopup({popupName:"popup-detail-auditing",isOpen:!0}))}},{key:"handlePrevPopupAudit",value:function(){var t,e=this;this.params.page>1&&(this.params.page--,null===(t=this.apiContract)||void 0===t||t.getData(this.params).then((function(t){var a="bankContractNo",i=Object(l["a"])(new Map(t.data.map((function(t){return[t[a],t]}))).values());e.dataPopup.count=i.length-1,e.dataPopup.data=[].concat(Object(l["a"])(i),Object(l["a"])(e.dataPopup.data))})).catch((function(t){return e.$message.error(t.message)})))}},{key:"handleNextPopupAudit",value:function(){var t,e=this;this.params.page++,null===(t=this.apiContract)||void 0===t||t.getData(this.params).then((function(t){var a="bankContractNo",i=[].concat(Object(l["a"])(e.dataPopup.data),Object(l["a"])(t.data)),n=Object(l["a"])(new Map(i.map((function(t){return[t[a],t]}))).values());e.dataPopup.data=n})).catch((function(t){return e.$message.error(t.message)}))}},{key:"handleSizeChange",value:function(t){var e;this.params.page=1,this.params.limit=t,this.query.page=this.params.page,this.query.limit=this.params.limit,this.init(),null===(e=this.apiContract)||void 0===e||e.getData(this.params)}},{key:"handleCurrentChange",value:function(t){this.params.page=t,this.init()}},{key:"handleOpentFilter",value:function(){this.setOpenPopup({popupName:"audit-filter",isOpen:!0})}},{key:"handleCloseLoading",value:function(){var t=this;setTimeout((function(){t.isLoading=!1}),1e3)}},{key:"handleCommand",value:function(t){Object(P["forEach"])(this.option,(function(e){t.id===e.id?e.active=!0:e.active=!1})),this.params.orderByClause=t.id,this.init()}},{key:"handleClickAction",value:function(){if(!(this.dataSelect.length<1)){var t="advisoryStaff";switch(this.dataPopupAction={action:t,total:this.dataSelect.length,contractNo:this.dataSelect.map((function(t){return t.contractNo})).join(","),bankContractNo:this.dataSelect.map((function(t){return t.bankContractNo})).join(",")},this.dataPopupAction.code=t,this.$route.params.status){case"dang-doi-soat":this.dataPopupAction.title="Gán nhân viên tư vấn",this.dataPopupAction.label="Nhân viên tư vấn",this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"cho-duyet":this.setOpenPopup({popupName:"cancel-popup",isOpen:!0});break;case"da-duyet":this.setOpenPopup({popupName:"edit-popup",isOpen:!0});break;case"yeu-cau-hieu-chinh":this.setOpenPopup({popupName:"cancel-popup",isOpen:!0});break;case void 0:this.dataPopupAction.title="Gán nhân viên tư vấn",this.dataPopupAction.label="Nhân viên tư vấn",this.setOpenPopup({popupName:"audit-action",isOpen:!0});break}}}},{key:"handleChangeAction",value:function(t){if(!(this.dataSelect.length<1))switch(this.dataPopupAction={action:t,total:this.dataSelect.length,contractNo:this.dataSelect.map((function(t){return t.contractNo})).join(","),bankContractNo:this.dataSelect.map((function(t){return t.bankContractNo})).join(",")},this.dataPopupAction.code=t,t){case"introStaff":this.dataPopupAction.title="Gán nhân viên giới thiệu",this.dataPopupAction.label="Nhân viên giới thiệu",this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"customerCif":this.dataPopupAction.title="Gán CIF khách hàng ",this.dataPopupAction.label="Số CIF khách hàng ",this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"relationship":this.dataPopupAction.title="Gán phân loại KH",this.dataPopupAction.label="Phân loại KH",this.dataPopupAction.optionsRelationship=this.listType,this.setOpenPopup({popupName:"audit-action",isOpen:!0});break;case"request-approve":this.setOpenPopup({popupName:"auditting-popup",isOpen:!0});break;case"value-request-correction":this.setOpenPopup({popupName:"edit-popup",isOpen:!0});break;case"value-decline":this.setOpenPopup({popupName:"cancel-popup",isOpen:!0});break;case"value-aprrove":this.setOpenPopup({popupName:"pending-popup",isOpen:!0});break}}},{key:"resetSelectAudit",value:function(){this.checkReqToEdit=!1,this.dataPopup.data=[],this.dataSelect=[],this.$refs.auditTable&&this.$refs.auditTable.clearSelection()}},{key:"getRelationShip",value:function(t){return A["RELATIONSHIP_VALUE_TO_TYPE"][t]}},{key:"handleOpenDeclinePopup",value:function(){this.dataSelect=[],this.setOpenPopup({popupName:"cancel-popup",isOpen:!0})}},{key:"handleOpenAuditPopup",value:function(){var t=this.$route.params.status;switch(this.dataSelect=[],this.dataPopup.action="",t){case"dang-doi-soat":this.setOpenPopup({popupName:"auditting-popup",isOpen:!0});break;case"cho-duyet":this.setOpenPopup({popupName:"pending-popup",isOpen:!0});break;case"yeu-cau-hieu-chinh":this.setOpenPopup({popupName:"edit-popup",isOpen:!0});break;case"tu-choi":this.setOpenPopup({popupName:"requestcancel-popup",isOpen:!0});break;default:this.dataPopup.action="",this.dataPopup.data=this.dataTable,this.setOpenPopup({popupName:"audit",isOpen:!0});break}}},{key:"handleSearch",value:function(t){this.params.page=1,this.params.search=t,this.init()}},{key:"handleSelection",value:function(t,e){if(this.pageSize=this.params.limit,e){var a=t.find((function(t){return t.id==e.id}));if(a&&a.id>0){var i=this.dataTable.filter((function(t){return t.bankContractNo===(null===e||void 0===e?void 0:e.bankContractNo)&&t.id!==(null===e||void 0===e?void 0:e.id)}));this.$refs.auditTable.updateSelection(i),this.dataSelect=this.$refs.auditTable.getSelection()}else this.dataSelect=t.filter((function(t){return t.bankContractNo!==(null===e||void 0===e?void 0:e.bankContractNo)})),this.$refs.auditTable.clearSelection(),this.$refs.auditTable.updateSelection(this.dataSelect);var n=this.dataTable[this.dataTable.length-1].bankContractNo,o=this.dataSelect.some((function(t){return t.bankContractNo==n}));this.checkLastItemSelect=!!o}else this.dataSelect=t}},{key:"handleOpenFilter",value:function(){this.setOpenPopup({popupName:"audit-popup-filter",isOpen:!0})}},{key:"handleClickReqEdit",value:function(t){this.checkReqToEdit=!0,this.dataSelect=this.dataTable.filter((function(e){return e.bankContractNo==t.bankContractNo})),this.setOpenPopup({popupName:"edit-popup",isOpen:!0})}},{key:"handleFilter",value:function(t){this.params=Object(s["a"])(Object(s["a"])({},this.params),t),this.params.page=1,this.init()}},{key:"checkDataRoute",value:function(t){return"new"===t?1:"cancel"===t?2:"effective"===t?3:"lapse"===t?4:"contract"===t?"":"pending"===t?3:"lapse"===t||"refuse"===t?4:void 0}},{key:"handleOpenExportFile",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n,o=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(this.dataTable.length<1)){t.next=3;break}return this.$message.warning("Không tìm thấy dữ liệu xuất file"),t.abrupt("return");case 3:if(!(this.query.total>=5e4)){t.next=6;break}return this.$message.warning("Số lượng bản ghi vượt quá 50000, vui lòng sử dụng bộ lọc"),t.abrupt("return");case 6:return this.isLoadingButton=!0,i=new Date,n="".concat(i.getFullYear()).concat(i.getMonth()+1).concat(i.getDate(),"_").concat(i.getHours()).concat(i.getMinutes()).concat(i.getSeconds()),delete this.params.newAuditStatus,t.next=12,null===(e=this.apiContract)||void 0===e?void 0:e.exportAuditingExcel(this.params,this.districtId).then((function(t){a=t;var e=window.URL.createObjectURL(new Blob([a.data])),i=document.createElement("a");i.href=e,i.setAttribute("download","Danh_sach_doi_soat_".concat(n,".xlsx")),document.body.appendChild(i),i.click(),o.isLoadingButton=!1})).catch((function(){o.isLoadingButton=!1}));case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSendEmail",value:function(){var t,e=this;this.isLoadingEmail=!0,null===(t=this.apiContract)||void 0===t||t.sendEmail(this.params).then((function(){e.$message.success("Gửi mail thành công"),e.isLoadingEmail=!1})).catch((function(t){e.isLoadingEmail=!1,e.$message.error(t.message)}))}},{key:"handleCheckLpbNull",value:function(t){for(var e=!1,a=0;a<this.propertyLpb.length;a++){if(t[this.propertyLpb[a]]){e=!1;break}e=!0}return e}},{key:"handleCheckDaichiNull",value:function(t){for(var e=!1,a=0;a<this.propertyDaichi.length;a++){if(t[this.propertyDaichi[a]]){e=!1;break}e=!0}return console.log("isNullDaichi",e),e}},{key:"init",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoading=!0,this.dataSelect=[],this.dataPopup.action="",i=this.getFilter(this.$route.name),i&&(this.params=Object(P["assign"])(this.params,i.filters)),this.params.page||(this.params.page=1),this.params.limit||(this.params.limit=20),this.params.orderByClause||(this.params.orderByClause="1"),this.query.page=this.params.page,this.query.limit=this.params.limit,delete this.params.newAuditStatus,t.next=13,null===(e=this.apiContract)||void 0===e?void 0:e.getData(this.params).then((function(t){n.data=t,n.dataTable=n.data.data,n.isLoading=!1})).catch((function(){n.dataTable=[],n.isLoading=!1}));case 13:null===(a=this.apiContract)||void 0===a||a.getContractCount(this.params).then((function(t){n.query.total=t.data,n.isLoading=!1})).catch((function(){n.query.total=0,n.isLoading=!1}));case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"setParamsForUser",value:function(){var t,e,a,i;this.getDisableArea&&(this.params.areaIdArray="".concat(null===(t=this.user)||void 0===t?void 0:t.areaId),this.params.branchIdArray="".concat(null===(e=this.user)||void 0===e?void 0:e.branchId));this.getDisableTransaction&&(this.params.transOfficeIdArray="".concat(null===(a=this.user)||void 0===a?void 0:a.transactionOfficeId));this.getDisableSaleMember&&(this.params.salesMemberIdArray="".concat(null===(i=this.user)||void 0===i?void 0:i.id))}},{key:"setData",value:function(){var t,e=this;null===(t=this.apiParam)||void 0===t||t.getParamRelationship().then((function(t){return e.listType=t})),this.init()}},{key:"created",value:function(){var t,e,a,i,n,o;this.api=Object(h["a"])("audit",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.apiContract=Object(h["a"])("contract",{districtId:null===(a=this.user)||void 0===a||null===(i=a.districts)||void 0===i?void 0:i[0].id}),this.apiParam=Object(h["a"])("param",{districtId:null===(n=this.user)||void 0===n||null===(o=n.districts)||void 0===o?void 0:o[0].id}),this.setData()}},{key:"beforeDestroy",value:function(){clearInterval(this.callAction)}},{key:"handleDeleteDetail",value:function(t){this.detailConfirm=t.data,this.setOpenPopup({popupName:"popup-confirm-auditing",isOpen:!0})}},{key:"handleActionAudit",value:function(t){var e=t.code,a=t.data;"delete"===e?(this.detailConfirm={delete:!0,applyFormNo:a.applyFormNo,id:a.id,contractNo:a.contractNo,totalAmount:a.totalAmount,productCode:a.productCode},this.setOpenPopup({popupName:"popup-confirm-auditing",isOpen:!0})):"edit-auditing"!==e&&"add"!==e||(this.dataEdit.title="add"==e?"Thêm mới thu phí":"Sửa thu phí",this.dataEdit.code=e,this.dataEdit.value=a,this.dataEdit.type="audit",this.setOpenPopup({popupName:"create-cost",isOpen:!0}))}},{key:"handleUpdatePage",value:function(){this.init()}},{key:"handleReload",value:function(){this.init()}},{key:"summaryMethod",value:function(t){var e=t.columns,a=[];return Object(P["forEach"])(e,(function(t,e){a[e]=4!==e?10!==e?"":"DỮ LIỆU Dai-ichi":"DỮ LIỆU LPB"})),a}},{key:"handleCompareValue",value:function(t,e){var a=this.dataTable[t][e.property],i=this.dataTable[t][e.property+"1"];return a!==i}},{key:"handleCompareValueRight",value:function(t,e){var a=this.dataTable[t][e.property],i=e.property.replace("1",""),n=this.dataTable[t][i];return a!==n}},{key:"cellClassName",value:function(t){var e=t.rowIndex,a=t.row,i=t.column,n=t.columnIndex;if(0!==n&&6!==n&&12!==n){if(n<=5){if(!a.totalAmount&&!a.currentFeeYear&&!a.productCode&&!a.applyFormNo&&!a.transactionOfficeCode)return"no-data";var o=this.handleCompareValue(e,i);if(o)return"diff"}if(n>=7&&n<=11){if(!a.totalAmount1&&!a.currentFeeYear1&&!a.productCode1&&!a.applyFormNo1&&!a.transactionOfficeCode1)return"";var s=this.handleCompareValueRight(e,i);if(s)return"diff"}}return""}},{key:"handleClickCbx",value:function(t,e){this.detailConfirm={type:e,applyFormNo:"LPB"===e?t.applyFormNo:t.applyFormNo1,id:t.id,contractNo:"LPB"===e?t.contractNo:t.contractNo1,totalAmount:"LPB"===e?t.totalAmount:t.totalAmount1,productCode:"LPB"===e?t.productCode:t.productCode1,isNull:this.handleCheckDaichiNull(t)},this.setOpenPopup({popupName:"popup-confirm-auditing",isOpen:!0})}},{key:"handleSetInterval",value:function(){var t=this;this.callAction=setInterval((function(){t.handleGetStatusLog()}),2e3)}},{key:"handleAudit",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,null===(e=this.apiContract)||void 0===e?void 0:e.createAuditLog();case 3:a=t.sent,this.$message.success("Hệ thống đang thực hiện đối soát. Vui lòng xem kết quả sau ít phút nữa"),this.setAuditLog(a),this.handleSetInterval(),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),this.$message.error(t.t0.message),console.log(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,9]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleGetStatusLog",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,null===(e=this.apiContract)||void 0===e?void 0:e.getStatusLog(this.auditLog.id);case 3:a=t.sent,"COMPLETED"===a.status&&(clearInterval(this.callAction),this.init()),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}()}]),a}(Object(m["b"])(f["a"],O["a"],S["a"]));Object(p["a"])([K.Getter("getFilter")],J.prototype,"getFilter",void 0),Object(p["a"])([K.Action("setAuditLog")],J.prototype,"setAuditLog",void 0),Object(p["a"])([K.State("auditLog")],J.prototype,"auditLog",void 0),J=Object(p["a"])([Object(m["a"])({components:{DetailContract:L["a"],AuditPopup:b["a"],AudittingPopup:v["a"],PendingPopup:C["a"],PopupConfirmAuditing:I,AuditPopupFilter:w["a"],AuditPopupAction:N["a"],CancelPopup:k["a"],SearchBar:x["a"],EditRequest:y["a"],RequestCancel:g["a"],ActionPopup:R["a"],PopupDetailDiff:U,CreateCost:Y["a"]}})],J);var Q=J,W=Q,Z=(a("f9e9"),Object(B["a"])(W,i,n,!1,null,"087109b0",null));e["default"]=Z.exports},"2e0e":function(t,e,a){},"5d2a":function(t,e,a){"use strict";a("f621")},a960:function(t,e,a){"use strict";a("2e0e")},bdc0:function(t,e,a){},f621:function(t,e,a){},f9e9:function(t,e,a){"use strict";a("bdc0")}}]);
//# sourceMappingURL=chunk-cc990fa6.16409277.js.map