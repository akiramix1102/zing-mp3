(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4040d6fe"],{15:function(t,e){},1522:function(t,e,i){},16:function(t,e){},17:function(t,e){},18:function(t,e){},"181e":function(t,e,i){"use strict";i("1522")},19:function(t,e){},"1af0":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrap-newsfeed"},[i("header-news-feed",{ref:"headerNewsFeed",on:{create:t.handleCreateNote,addCalendar:t.handleOpenPopup}}),i("div",{staticClass:"content"},[i("div",{staticClass:"incomming"},[i("span",{staticClass:"title"},[t._v("Sắp diễn ra")]),t._l(t.dataUpcomming,(function(e){return i("div",{key:e.id,staticClass:"post box",attrs:{id:"topPost"}},[i("post-item",{attrs:{post:e},on:{edit:t.handleEdit,delete:t.handleDelete}})],1)})),t.dataUpcomming.length?t._e():i("div",{staticClass:"no-data"},[i("span",[t._v("Không có hoạt động nào sắp diễn ra")])])],2),i("div",{staticClass:"happend"},[i("span",{staticClass:"title"},[t._v("Đã diễn ra")]),i("div",{staticClass:"be-flex tab-menu"},t._l(t.tabRouter,(function(e){return i("div",{key:e.id,staticClass:"cursor tab-item",class:e.value===t.active?"active":null,on:{click:function(i){return t.handleChangeTab(e.value)}}},[i("span",[t._v(t._s(e.title))])])})),0),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoadingPost,expression:"isLoadingPost"}]},t._l(t.dataPast,(function(e){return i("div",{key:e.id,staticClass:"post box",attrs:{id:"topPost"}},[i("post-item",{attrs:{post:e},on:{edit:t.handleEdit,delete:t.handleDelete}})],1)})),0),t.dataPast.length?t._e():i("div",{staticClass:"no-data"},[i("base-icon",{staticStyle:{"font-size":"160px"},attrs:{icon:"no-post"}}),i("div",[t._v("Không có hoạt động nào đã diễn ra")])],1)])]),i("popup-note",{attrs:{post:t.post,type:t.type},on:{update:t.handleUpdatePost}}),i("popup-apoint-customer",{attrs:{idCustomer:this.customerId,dataDetail:t.dataDetail,dataDetailDeal:t.dataDetailDeal,post:t.post,type:t.type},on:{apply:t.handleLoad,update:t.handleUpdatePost}}),i("popup-delete-all",{attrs:{post:t.post,type:t.type}}),i("popup-confirm-type",{attrs:{message:t.message},on:{confirm:t.handleConfirmDelete}}),i("popup-add-upload-file",{attrs:{idUpload:this.customerId,idUploadDeal:this.idUploadDeal},on:{load:t.loadData}}),i("popup-delete-all",{attrs:{post:t.post,type:t.type}})],1)},s=[],o=i("d0ff"),a=i("fc11"),c=i("f3f3"),l=i("c964"),r=i("276c"),u=i("e954"),d=i("920b"),p=i("92a6"),h=(i("96cf"),i("caad"),i("2532"),i("99af"),i("9ab4")),m=i("1b40"),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"header"},[i("div",{staticClass:"be-flex tab-menu"},t._l(t.tabs,(function(e){return i("div",{key:e.id,staticClass:"cursor tab-item",class:e.value===t.active?"active":null,on:{click:function(i){return t.handleChangeTab(e.value)}}},[i("base-icon",{attrs:{icon:e.icon}}),i("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.title))])],1)})),0),i("div",{staticStyle:{position:"relative"}},[i("jodit-editor",{attrs:{config:t.config,buttons:t.buttons},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),i("div",{staticClass:"wrap-btn-action"},[i("span",{staticClass:"cursor item",on:{click:t.cancelNote}},[t._v("Hủy")]),i("span",{staticClass:"cursor item",on:{click:t.handleCreateNote}},[t._v("Lưu")])])],1)])},v=[],b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-upload",{staticClass:"upload-newsfeed",attrs:{action:"https://jsonplaceholder.typicode.com/posts/",drag:!0,"show-file-list":!1,multiple:"","on-exceed":t.handleExceed,"file-list":t.fileList}},[i("div",[t._v("Kéo thả file hoặc "),i("span",{staticClass:"high-light"},[t._v("Chọn từ máy tính")])])])],1)},y=[],g=function(t){Object(d["a"])(i,t);var e=Object(p["a"])(i);function i(){var t;return Object(r["a"])(this,i),t=e.apply(this,arguments),t.fileList=[],t}return Object(u["a"])(i,[{key:"handleExceed",value:function(){console.log("error")}}]),i}(m["d"]);g=Object(h["a"])([m["a"]],g);var C=g,k=C,O=(i("9413"),i("2877")),j=Object(O["a"])(k,b,y,!1,null,"029a1f0c",null),x=j.exports,_=(i("425f"),i("9f48")),w=i("d67a"),E=i("7461"),L=i("9f13"),S=i("69ae"),T=function(t){Object(d["a"])(i,t);var e=Object(p["a"])(i);function i(){var t;return Object(r["a"])(this,i),t=e.apply(this,arguments),t.content="<p><br></p>",t.buttons=["bold","italic","underline","link","ul","ol","image"],t.config={spellcheck:!1,showCharsCounter:!1,showWordsCounter:!1,autofocus:!0,showXPathInStatusbar:!1,language:"vi",minHeight:120,i18n:{vi:{"Type something":"Nhập ghi chú...","Search for":"Nhập tìm kiếm"}},uploader:{url:"".concat(L["API_URL"],"/file/v1/district/").concat(t.$store.state.beUser.districtId,"/upload"),format:"json",headers:{Authorization:"Bearer ".concat(t.$store.state.beAuth.access_token)},isSuccess:function(t){return!t.error},getMessage:function(t){return t.msg},filesVariableName:function(t){return"files"},process:function(t){return{files:t.data||[]}},defaultHandlerSuccess:function(t){var e="files";if(console.log("res",t),t[e]&&t[e]["success"].length)for(var i=0;i<t[e]["success"].length;i+=1)console.log("hi",t[e]["success"][i].url),this.s.insertImage(t[e]["success"][i].url)},error:function(t){console.error(t)}}},t.active="note",t.tabs=[{id:1,title:"Ghi chú",icon:"note",value:"note"},{id:2,title:"Lịch hẹn",icon:"calendar",value:"calendar"},{id:3,title:"File đính kèm",icon:"file",value:"file"}],t}return Object(u["a"])(i,[{key:"handleChangeTab",value:function(t){"calendar"===t&&this.$emit("addCalendar",{popupName:"appoint-customer",type:"create"}),"file"===t&&this.$emit("addCalendar",{popupName:"add-upload-file",type:"create"})}},{key:"cancelNote",value:function(){console.log(this.$store.state),this.content="<p><br></p>"}},{key:"handleCreateNote",value:function(){this.$emit("create",this.content)}}]),i}(Object(m["b"])(_["a"]));T=Object(h["a"])([Object(m["a"])({components:{JoditEditor:S["a"],UploadFile:x,AppointCustomer:w["a"],PopupAddUploadFile:E["a"]}})],T);var P=T,N=P,I=(i("ded8"),Object(O["a"])(N,f,v,!1,null,"981dd9da",null)),A=I.exports,$=i("c56f"),D=i("08ba"),F=i("4bb5"),R=i("2ef0"),U=i("222c"),H=i("be17"),q=i("1f2a"),V=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("base-popup",{staticClass:"flex",attrs:{name:"popup-confirm-type",width:"420px",hiddenFooter:!0}},[i("div",{attrs:{slot:"title"},slot:"title"},[t._v("Xác nhận xóa")]),i("div",{staticClass:"body-content"},[i("p",[t._v(t._s("Bạn có chắc chắn muốn xóa "+t.message+" này?"))])]),i("template",{slot:"footer"},[i("div",{staticClass:"bottom"},[i("div",{staticClass:"bt-top flex jc-flex-end"},[i("div",{},[i("el-button",{staticClass:"be-button-unset",attrs:{size:"mini"},on:{click:t.handleCancel}},[t._v("Hủy")]),i("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:t.handleConfirm}},[t._v("Xác nhận")])],1)])])])],2)},z=[],M=function(t){Object(d["a"])(i,t);var e=Object(p["a"])(i);function i(){return Object(r["a"])(this,i),e.apply(this,arguments)}return Object(u["a"])(i,[{key:"handleCancel",value:function(){this.setOpenPopup({popupName:"popup-confirm-type",isOpen:!1})}},{key:"handleConfirm",value:function(){this.setOpenPopup({popupName:"popup-confirm-type",isOpen:!1}),this.$emit("confirm")}}]),i}(Object(m["b"])(_["a"],$["a"]));Object(h["a"])([Object(m["c"])()],M.prototype,"message",void 0),M=Object(h["a"])([Object(m["a"])({components:{}})],M);var B=M,K=B,W=(i("93f9"),Object(O["a"])(K,V,z,!1,null,"7cfbce46",null)),X=W.exports,G=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"head flex"},[i("div",{staticClass:"flex"},[i("base-icon",{staticStyle:{"font-size":"40px"},attrs:{icon:t.getIcon}}),i("div",{staticClass:"info flex-space-between"},[i("span",{staticClass:"title"},[t._v(t._s(t.getTitle))]),i("div",[i("span",{staticClass:"sub-title"},[t._v(t._s(t.post.logFullName)+" tạo "+t._s(t._f("timeAgo")(t.post.createdAt)))])])])],1),i("div",{staticClass:"actions"},[i("el-popover",{attrs:{placement:"bottom-end","popper-class":"t-popper"}},[i("el-button",{staticClass:"is-create-color is-white is-none-border icon-btn pt-0 pb-0 pl-1 pr-1 ml-0",staticStyle:{display:"block"},on:{click:function(e){return t.handleEdit(t.post)}}},[i("span",[t._v(t._s(t.getTitleAction.edit))])]),i("el-button",{staticClass:"is-create-color is-white is-none-border icon-btn pt-0 pb-0 pl-1 pr-1 ml-0",staticStyle:{display:"block"},on:{click:function(e){return t.handleDelete(t.post)}}},[i("span",[t._v(t._s(t.getTitleAction.delete))])]),i("el-button",{staticClass:"is-create-color is-white is-none-border icon-btn icon-middle",staticStyle:{padding:"0"},attrs:{slot:"reference"},slot:"reference"},[i("base-icon",{staticStyle:{"margin-left":"1px","font-size":"16px"},attrs:{icon:"threedot"}})],1)],1)],1)]),i("div",{staticClass:"body"},["NOTE"===t.post.newsfeedType?i("div",{staticClass:"post post-note"},[i("div",{staticClass:"content pb-2",staticStyle:{"white-space":"pre-line","word-break":"break-word","line-height":"22px"}},[i("span",{domProps:{innerHTML:t._s(t.post.content)}})]),void 0,i("div",{staticClass:"flex item content-footer"},[i("div",{staticClass:"footer-item"},[i("base-icon",{staticClass:"icon",attrs:{icon:"person"}}),i("span",[t._v(t._s(t.detailCustomer.customerFullName))])],1),t.post.dealName?i("div",{staticClass:"dot"}):t._e(),t.post.dealName?i("div",{staticClass:"footer-item"},[i("base-icon",{staticClass:"icon",attrs:{icon:"icon-deal"}}),i("span",[t._v(t._s(t.post.dealName))])],1):t._e()])],2):"CALENDAR"===t.post.newsfeedType?i("div",{staticClass:"post post-calendar"},[i("div",{staticClass:"content"},[i("p",{staticClass:"item"},[t._v(t._s(t.post.title))]),i("div",{staticClass:"item flex time"},[i("span",[t._v("Thời gian: "+t._s(t._f("formatDateTimeAdv")(t.post.dueDate)))]),i("span",{staticClass:"dot"}),i("span",[t._v(t._s(t._f("getHoursString")(t.post.dueTime)))]),i("span",{staticClass:"dot"}),i("span",[t._v(t._s(t._f("getDuration")(t.post.duration)))])]),i("div",{staticClass:"item address"},[i("span",[t._v(t._s(t.post.location))])]),i("div",{staticClass:"flex item content-footer"},[i("div",{staticClass:"footer-item"},[i("base-icon",{staticClass:"icon",attrs:{icon:"3-person"}}),i("span",[t._v("1 người tham gia")])],1),i("div",{staticClass:"dot"}),i("div",{staticClass:"footer-item"},[i("base-icon",{staticClass:"icon",attrs:{icon:"person"}}),i("span",[t._v(t._s(t.post.customerFullName))])],1),t.post.dealName?i("div",{staticClass:"dot"}):t._e(),t.post.dealName?i("div",{staticClass:"footer-item"},[i("base-icon",{staticClass:"icon",attrs:{icon:"icon-deal"}}),i("span",[t._v(t._s(t.post.dealName))])],1):t._e()])])]):"FILE"===t.post.newsfeedType?i("div",{staticClass:"post post-file"},[i("div",{staticClass:"content"},[i("div",{staticClass:"list-file"},[i("div",{staticClass:"cursor file-item",on:{click:function(e){return t.downloadFile(t.post.attachmentUrl)}}},[t._v(" "+t._s(t.post.fileName)+" ")])]),i("div",{staticClass:"flex content-footer"},[i("div",{staticClass:"footer-item"},[i("base-icon",{staticClass:"icon",attrs:{icon:"person"}}),i("span",[t._v(t._s(t.detailCustomer.customerFullName))])],1),t.post.dealName?i("div",{staticClass:"dot"}):t._e(),t.post.dealName?i("div",{staticClass:"footer-item"},[i("base-icon",{staticClass:"icon",attrs:{icon:"icon-deal"}}),i("span",[t._v(t._s(t.post.dealName))])],1):t._e()])])]):i("div",{staticClass:"post post-deal"},[i("div",{staticClass:"content"},[i("p",{staticClass:"item",domProps:{innerHTML:t._s(t.post.content)}}),i("div",{staticClass:"flex item content-footer"},[i("div",{staticClass:"footer-item"},[i("base-icon",{staticClass:"icon",attrs:{icon:"person"}}),i("span",[t._v(t._s(t.detailCustomer.customerFullName))])],1),i("div",{staticClass:"dot"}),i("div",{staticClass:"footer-item"},[i("base-icon",{staticClass:"icon",attrs:{icon:"icon-deal"}}),i("span",[t._v(t._s(t.post.dealName))])],1)])])]),t.isShowComment?i("div",{staticClass:"comment"},[i("comment",t._b({attrs:{"focus-id":t.focusId,"is-post":t.isPost},on:{handleViewPost:t.handleViewPost}},"comment",t.postData,!1))],1):t._e()])])},Q=[],Y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.post.numOfLike&&0!==t.post.numOfLike?i("div",{staticClass:"flex flex-middle",on:{click:t.handleShow}},[i("el-button",{staticClass:"is-none-border fb-reaction"},t._l(t.topEmoji,(function(e,n){return i("base-icon",{key:n,staticClass:"icon-border",attrs:{icon:t.iconEmoji[e]?t.iconEmoji[e]:"fb_like"}})})),1),i("span",{staticStyle:{"padding-let":"5px"}},[t._v(t._s(t.post.numOfLike)+" ")])],1):t._e()},J=[],Z=i("97c1"),tt=function(t){Object(d["a"])(i,t);var e=Object(p["a"])(i);function i(){var t;return Object(r["a"])(this,i),t=e.apply(this,arguments),t.iconEmoji=Z["b"],t}return Object(u["a"])(i,[{key:"topEmoji",get:function(){return Object(R["split"])(this.post.topEmoji,",")}},{key:"handleShow",value:function(){return""}}]),i}(m["d"]);Object(h["a"])([Object(m["c"])({required:!1,type:Boolean,default:!1})],tt.prototype,"isShort",void 0),Object(h["a"])([Object(m["c"])({required:!0,type:Object,default:{}})],tt.prototype,"post",void 0),tt=Object(h["a"])([m["a"]],tt);var et=tt,it=et,nt=(i("6590"),Object(O["a"])(it,Y,J,!1,null,"1c485762",null)),st=nt.exports,ot=i("a1fe"),at=i("786c"),ct=Object(F["a"])("beCustomer"),lt=function(t){Object(d["a"])(i,t);var e=Object(p["a"])(i);function i(){var t;return Object(r["a"])(this,i),t=e.apply(this,arguments),t.isShowComment=!1,t.isEnd=!1,t.focusId=0,t.isReset=!1,t.openPost=-1,t.showFullText=[],t.textConvert={text:"",links:[]},t.isOpenPopver=!1,t.changeType=!1,t.topEmoji=[],t.likeConflict=!1,t.isPlayVideo=!1,t}return Object(u["a"])(i,[{key:"postData",get:function(){return{post:this.post}}},{key:"getListImage",get:function(){var t=[];return Object(R["forEach"])(this.post.images,(function(e){t.push(e.url)})),t}},{key:"getTitleAction",get:function(){return"NOTE"===this.post.newsfeedType?{edit:"Sửa ghi chú",delete:"Xóa ghi chú"}:"CALENDAR"===this.post.newsfeedType?{edit:"Sửa lịch hẹn",delete:"Xóa lịch hẹn"}:"DEAL"===this.post.newsfeedType?{edit:"Sửa cơ hội bán hàng",delete:"Xóa cơ hội bán hàng"}:{edit:"Sửa file tài liệu",delete:"Xóa file tài liệu"}}},{key:"getTitle",get:function(){return"NOTE"===this.post.newsfeedType?"Ghi chú":"CALENDAR"===this.post.newsfeedType?"Hẹn lịch tư vấn gói bảo hiểm":"DEAL"===this.post.newsfeedType?"Cơ hội bán hàng":"File tài liệu"}},{key:"getIcon",get:function(){return"NOTE"===this.post.newsfeedType?"icon-note":"CALENDAR"===this.post.newsfeedType?"icon-calendar":"DEAL"===this.post.newsfeedType?"icon-sale":"icon-file"}},{key:"clickFile",value:function(){this.handleViewPost()}},{key:"handleViewPost",value:function(){this.post.isView||this.post.iViewedThis||(this.post.isView=!0,this.post.iViewedThis=!0,this.post.numOfView++)}},{key:"handleViewMoreImage",value:function(){var t=this.$refs.image[1].$el,e=t.querySelector(".el-image__inner");e.click()}},{key:"handleViewImage",value:function(t,e){this.handleViewPost()}},{key:"openView",value:function(t){console.log("view popup like + comment")}},{key:"focusPost",value:function(t){var e=this;this.isShowComment=!this.isShowComment,this.focusId=t.id,this.$nextTick((function(){e.focusId=-1}))}},{key:"handleLike",value:function(){console.log("a")}},{key:"downloadFile",value:function(t){window.open("".concat(t),"_blank")}},{key:"handleEdit",value:function(t){this.$emit("edit",t)}},{key:"handleDelete",value:function(t){this.$emit("delete",t)}}]),i}(m["d"]);Object(h["a"])([Object(m["c"])({required:!1,type:Boolean,default:!0})],lt.prototype,"isPost",void 0),Object(h["a"])([Object(m["c"])({required:!0,type:Object,default:{}})],lt.prototype,"post",void 0),Object(h["a"])([ct.State("detailCustomer")],lt.prototype,"detailCustomer",void 0),lt=Object(h["a"])([Object(m["a"])({components:{Reaction:st,PostEmoji:ot["a"],Comment:at["default"]}})],lt);var rt=lt,ut=rt,dt=(i("e09c"),Object(O["a"])(ut,G,Q,!1,null,"1ae017ba",null)),pt=dt.exports,ht=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("base-popup",{staticClass:"flex",attrs:{name:"popup-delete-all",width:"420px",open:t.handleOpen,hiddenFooter:!0}},[i("div",{attrs:{slot:"title"},slot:"title"},[t._v("Xóa")]),i("div",{staticClass:"body-content"},[i("span",[t._v(" Bạn chắc chắn muốn Xóa lịch hẹn này ? ")])]),i("template",{slot:"footer"},[i("div",{staticClass:"bottom"},[i("div",{staticClass:"bt-top flex jc-flex-end"},[i("div",{},[i("el-button",{staticClass:"be-button-unset",staticStyle:{padding:"8px 10px"},attrs:{size:"mini"},on:{click:t.handleCancel}},[t._v("Hủy")]),i("el-button",{staticClass:"be-btn-danger",attrs:{size:"mini"},on:{click:t.handleConfirm}},[t._v("Xác nhận")])],1)])])])],2)},mt=[],ft=function(t){Object(d["a"])(i,t);var e=Object(p["a"])(i);function i(){return Object(r["a"])(this,i),e.apply(this,arguments)}return Object(u["a"])(i,[{key:"handleCancel",value:function(){this.setOpenPopup({popupName:"popup-delete",isOpen:!1})}},{key:"handleConfirm",value:function(){this.handleCancel(),this.$emit("confirm")}},{key:"handleOpen",value:function(){console.log(this.isDelete)}},{key:"handleClose",value:function(){console.log("dóng")}}]),i}(Object(m["b"])(_["a"],$["a"]));Object(h["a"])([Object(m["c"])()],ft.prototype,"isDelete",void 0),ft=Object(h["a"])([Object(m["a"])({components:{}})],ft);var vt=ft,bt=vt,yt=(i("d04c2"),Object(O["a"])(bt,ht,mt,!1,null,"f9cac444",null)),gt=yt.exports,Ct=Object(F["a"])("beCustomer"),kt=function(t){Object(d["a"])(i,t);var e=Object(p["a"])(i);function i(){var t;return Object(r["a"])(this,i),t=e.apply(this,arguments),t.dataUpcomming=[],t.dataPast=[],t.active="",t.tabs=[{id:0,title:"Tất cả",value:""},{id:1,title:"Ghi chú",value:"NOTE"},{id:2,title:"Lịch hẹn",value:"CALENDAR"},{id:3,title:"File đính kèm",value:"FILE"},{id:4,title:"Cơ hội bán hàng",value:"DEAL"}],t.post={},t.type="edit",t.customerId=0,t.idUploadDeal=0,t.message="",t.propDeal={},t.dataCustomer={id:"",customerFullName:"",customerCifCode:""},t.propCalendar={},t.isLoadingPost=!1,t.isEndPost=!1,t.query={page:1,limit:20,timeType:"PAST",newsfeedType:""},t.dataDetail={},t.dataDetailDeal={},t.debounceLoad=Object(R["debounce"])((function(){t.getListPast(!0)}),500),t}return Object(u["a"])(i,[{key:"tabRouter",get:function(){return this.$route.path.includes("khach-hang")?this.tabs:[{id:0,title:"Tất cả",value:""},{id:1,title:"Ghi chú",value:"NOTE"},{id:2,title:"Lịch hẹn",value:"CALENDAR"},{id:3,title:"File đính kèm",value:"FILE"}]}},{key:"created",value:function(){var t=this;this.apiCustomer=Object(D["a"])("deal",{districtId:this.districtId}),Object(R["includes"])(this.$route.path,"khach-hang")?(this.customerId=this.$route.params.id,this.dataDetail=this.detailCustomer,console.log("khach hang",this.detailCustomer)):(this.customerId=this.detailCustomer.customerId,this.idUploadDeal=this.detailCustomer.id,this.dataDetailDeal=this.detailCustomer,console.log("deal",this.detailCustomer)),q["a"].$on("reloadDeal",(function(){t.init()})),q["a"].$on("editPost",(function(e){t.handleUpdatePost(e)})),q["a"].$on("reloadNewsfeed",(function(){t.init()}))}},{key:"mounted",value:function(){var t=this;this.init();var e=document.querySelector(".el-main.customer");setTimeout((function(){e.addEventListener("scroll",t.handleScroll)}),1e3)}},{key:"destroyed",value:function(){q["a"].$off("reloadDeal"),q["a"].$off("editPost")}},{key:"handleScroll",value:function(){var t=document.querySelector(".el-main.customer");t.scrollTop>=t.scrollHeight-t.offsetHeight&&!this.isEndPost&&(this.query.page+=1,this.debounceLoad())}},{key:"init",value:function(){this.getListUpcomming(),this.getListPast()}},{key:"getListPast",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,i,n,s,l,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]&&r[0],i=Object(R["includes"])(this.$route.path,"khach-hang")?"CUSTOMER":"DEAL",n="CUSTOMER"===i?"customerId":"dealId",t.prev=3,s=Object(c["a"])(Object(c["a"])({},this.query),{},Object(a["a"])({},"".concat(n),"CUSTOMER"===i?this.customerId+"":this.$route.params.id)),t.next=7,this.apiCustomer.getNewsFeed(s);case 7:l=t.sent,this.isEndPost=!l.content||!l.content.length,this.dataPast=e?[].concat(Object(o["a"])(this.dataPast),Object(o["a"])(l.content)):l.content,t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](3),console.log(t.t0);case 15:case"end":return t.stop()}}),t,this,[[3,12]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"getListUpcomming",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,i,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=Object(R["includes"])(this.$route.path,"khach-hang")?"CUSTOMER":"DEAL",i="CUSTOMER"===e?"customerId":"dealId",t.prev=2,n=Object(a["a"])({timeType:"UPCOMMING",newsfeedType:"CALENDAR"},"".concat(i),"CUSTOMER"===e?this.customerId+"":this.$route.params.id),t.next=6,this.apiCustomer.getNewsFeed(n);case 6:s=t.sent,this.dataUpcomming=s.content,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),console.log(t.t0);case 13:case"end":return t.stop()}}),t,this,[[2,10]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"resetQuery",value:function(){this.query.page=1,this.query.limit=20}},{key:"handleChangeTab",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoadingPost=!0,this.isEndPost=!1,this.active=e,this.query.page=1,this.query.limit=20,this.query.newsfeedType=e,t.next=8,this.getListPast();case 8:this.isLoadingPost=!1;case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"handleCreateNote",value:function(t){var e=this,i=Object(R["includes"])(this.$route.path,"khach-hang")?"CUSTOMER":"DEAL",n="CUSTOMER"===i?"customerId":"dealId",s=Object(a["a"])({description:t},"".concat(n),"CUSTOMER"===i?this.customerId+"":this.$route.params.id);this.apiCustomer.createNote(i,s).then((function(){var t;e.$message.success("Tạo ghi chú thành công"),null===(t=e.$refs.headerNewsFeed)||void 0===t||t.cancelNote(),e.resetQuery(),e.init()}))}},{key:"checkTypePost",value:function(t){switch(t){case"NOTE":return"ghi chú";case"CALENDAR":return"lịch hẹn";case"DEAL":return"cơ hội bán hàng";default:return"file tài liệu"}}},{key:"handleUpdatePost",value:function(t){var e=this;this.apiCustomer.updatePost(t.id,t).then((function(){var i=e.checkTypePost(t.newsfeedType);e.$message.success("Sửa ".concat(i," thành công")),e.resetQuery(),e.init()}))}},{key:"handleLoad",value:function(){this.resetQuery(),this.init()}},{key:"loadData",value:function(){this.resetQuery(),this.init()}},{key:"handleEdit",value:function(t){this.post=Object(c["a"])({},t),"NOTE"===t.newsfeedType&&this.handleOpenPopup({popupName:"popup-note",type:"edit"}),"DEAL"===t.newsfeedType&&q["a"].$emit("openEditDeal",this.post),"CALENDAR"===t.newsfeedType&&this.handleOpenPopup({popupName:"appoint-customer",type:"edit"}),"FILE"===t.newsfeedType&&this.handleOpenPopup({popupName:"add-upload-file",type:"edit"})}},{key:"handleDelete",value:function(t){this.message=this.checkTypePost(t.newsfeedType),this.setOpenPopup({popupName:"popup-confirm-type",isOpen:!0}),this.post=Object(c["a"])({},t)}},{key:"handleConfirmDelete",value:function(){var t=this;this.apiCustomer.deletePost(this.post.id).then((function(){var e=t.checkTypePost(t.post.newsfeedType);t.$message.success("Xóa ".concat(e," thành công")),t.resetQuery(),t.init()}))}},{key:"handleOpenPopup",value:function(t){var e=t.popupName,i=t.type;this.type=i,console.log("sdsds",t),this.setOpenPopup({popupName:e,isOpen:!0})}}]),i}(Object(m["b"])($["a"],_["a"]));Object(h["a"])([Ct.State("detailCustomer")],kt.prototype,"detailCustomer",void 0),kt=Object(h["a"])([Object(m["a"])({components:{PostItem:pt,HeaderNewsFeed:A,PopupNote:U["a"],CreateDeal:H["a"],PopupApointCustomer:w["a"],PopupAddUploadFile:E["a"],PopupConfirmType:X,PopupDeleteAll:gt}})],kt);var Ot=kt,jt=Ot,xt=(i("6093"),Object(O["a"])(jt,n,s,!1,null,"69a6e969",null));e["default"]=xt.exports},"1fca":function(t,e,i){},20:function(t,e){},"20d2":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return s}));var n=["image/png","image/jpeg","video/mp4","video/MP4V-ES","video/quicktime","video/x-flv","video/x-msvideo","video/x-ms-wmv"],s=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.presentationml.presentation"]},"40ce":function(t,e,i){},"4b9b":function(t,e,i){},6093:function(t,e,i){"use strict";i("1fca")},6109:function(t,e,i){"use strict";i("40ce")},6590:function(t,e,i){"use strict";i("d609")},"6cc7b":function(t,e,i){"use strict";i("f615")},"6e44":function(t,e,i){},7461:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("base-popup",{staticClass:"addUploadFile",attrs:{name:"add-upload-file",open:t.handleOpen,close:t.handleClose,hiddenFooter:!0,width:"520px",top:"5vh"}},[i("div",{attrs:{slot:"title"},slot:"title"},[t._v("Thêm file tài liệu")]),i("el-upload",{staticClass:"upload body-Upload",attrs:{drag:"",":file-list":t.fileList,"on-change":t.handleChangeFile,"auto-upload":!1,"show-file-list":!1,action:"",multiple:""}},[i("div",{staticClass:"el-upload__text"},[t._v("Kéo thả file hoặc"),i("em",[t._v(" Chọn từ máy tính")])])]),t.fileList.length?i("div",{staticClass:"list-file"},t._l(t.fileList,(function(e){return i("div",{key:e.uid,staticClass:"flex jc-space-between file-item"},[i("div",{staticClass:"left"},[i("p",[t._v(t._s(e.name))])]),i("div",{staticClass:"right",on:{click:function(i){return t.handleDeleteFile(e.uid)}}},[i("base-icon",{staticClass:"icon-action cursor",attrs:{icon:"delete"}})],1)])})),0):t._e(),i("template",{slot:"footer"},[i("div",{staticClass:"bottom"},[i("div",{staticClass:"bt-top flex"},[i("div",{staticClass:"bt-center"},[i("el-button",{staticClass:"group-button-cencel",on:{click:t.handleClose}},[t._v("Hủy")]),t.fileList.length?i("el-button",{staticClass:"be-btn-danger group-button-save",on:{click:t.handleAddFile}},[t._v("Thêm")]):t._e()],1)])])])],2)},s=[],o=i("d0ff"),a=i("c964"),c=i("276c"),l=i("e954"),r=i("920b"),u=i("92a6"),d=(i("b0c0"),i("96cf"),i("9ab4")),p=i("9f48"),h=i("1b40"),m=i("4bb5"),f=i("08ba"),v=i("2ef0"),b=Object(m["a"])("beUser"),y=function(t){Object(r["a"])(i,t);var e=Object(u["a"])(i);function i(){var t;return Object(c["a"])(this,i),t=e.apply(this,arguments),t.fileList=[],t.dataInput={attachFiles:[]},t}return Object(l["a"])(i,[{key:"handleChangeFile",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var i,n,s,o,a,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=new FormData,"ready"!==e.status){t.next=16;break}return e.type=e.raw.type,this.fileList.push(e),i.append("files",e.raw),e.percentage=1,n=function(t){var i=t.loaded/t.total*100;e.percentage=i},s={},s.data=i,s.progress=n,o=e.uid,t.next=13,this.apiUpload.uploadFile(s);case 13:a=t.sent,c=Object(v["findIndex"])(this.fileList,(function(t){return t.uid===o})),this.fileList[c].url=a.success[0].url;case 16:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"handleDeleteFile",value:function(t){this.fileList=Object(v["filter"])(this.fileList,(function(e){return e.uid!==t}))}},{key:"handleAddFile",value:function(){var t,e,i=this;(this.fileList.length&&(this.dataInput.attachFiles=Object(o["a"])(this.fileList)),this.idUpload&&"customer"==this.$route.name||"customerNewsfeed"==this.$route.name)?null===(t=this.api)||void 0===t||t.uploadFile(this.idUpload,this.dataInput).then((function(t){i.$message.success("Upload file thành công"),i.fileList=[],i.$emit("load"),i.handleClose()})).catch((function(t){console.log(t)})):null===(e=this.api)||void 0===e||e.uploadFileDeal(this.idUploadDeal,this.dataInput).then((function(t){i.$message.success("Upload file thành công"),i.fileList=[],i.$emit("load"),i.handleClose()})).catch((function(t){console.log(t)}))}},{key:"handleOpen",value:function(){console.log("test id bên khách hàng",this.idUpload),console.log("test id dell",this.idUploadDeal),console.log("route",this.$route)}},{key:"handleClose",value:function(){this.fileList=[],this.setOpenPopup({popupName:"add-upload-file",isOpen:!1})}},{key:"created",value:function(){var t,e,i,n;this.apiUpload=Object(f["a"])("upload",{districtId:null===(t=this.user)||void 0===t||null===(e=t.districts)||void 0===e?void 0:e[0].id}),this.api=Object(f["a"])("category",{districtId:null===(i=this.user)||void 0===i||null===(n=i.districts)||void 0===n?void 0:n[0].id})}}]),i}(Object(h["b"])(p["a"]));Object(d["a"])([b.State("user")],y.prototype,"user",void 0),Object(d["a"])([Object(h["c"])()],y.prototype,"idUpload",void 0),Object(d["a"])([Object(h["c"])()],y.prototype,"idUploadDeal",void 0),y=Object(d["a"])([Object(h["a"])({components:{}})],y);var g=y,C=g,k=(i("181e"),i("2877")),O=Object(k["a"])(C,n,s,!1,null,null,null);e["a"]=O.exports},"786c":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.isShowNextButton&&!t.isEnd?i("el-button",{staticClass:"is-white is-none-border icon-btn btn-link p-0 btn-more-cmt",on:{click:function(e){t.showComment(t.isReverse=!0)}}},[i("span",[t._v(" Xem thêm các bình luận khác "),t.isLoading?i("i",{staticClass:"el-icon-loading"}):t._e()])]):t._e(),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isSubLoading,expression:"isSubLoading"}]},t._l(t.tableList,(function(e){return i("div",{key:e.id,staticClass:"comment-items el-loading-mask-trans"},[i("div",[i("div",{staticClass:"flex"},[i("base-avatar",{attrs:{url:e.creatorAvatar,size:"small",alt:"logo"}}),t.checkCommentEdit(e)?t._e():i("div",{staticClass:"content-comment",staticStyle:{"white-space":"pre-line","word-break":"break-word"}},[i("span",{staticClass:"user-name outline-none"},[t._v(t._s(e.creatorName))]),i("span",{domProps:{innerHTML:t._s(e.comment)}}),e.video&&null!==e.video||e.image&&null!==e.image||!e.numOfLike||!(e.numOfLike>0)?t._e():i("el-tooltip",{attrs:{placement:"bottom"}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tooltipLoading,expression:"tooltipLoading"}],attrs:{slot:"content"},slot:"content"},t._l(e.listEmoji,(function(e,n){return i("div",{key:n,staticClass:"tooltip-icon"},[i("base-icon",{staticStyle:{"font-size":"16px"},attrs:{"icon-class":t.iconEmoji1[e.type]?t.iconEmoji1[e.type]:"fb_like"}}),i("span",{staticClass:"pl-05"},[t._v(t._s(": "+e.value))])],1)})),0),i("div",{staticClass:"like-view",on:{mouseenter:function(i){return t.handleHoverTooltip(e)},click:function(i){return t.handleClickTooltip(e)}}},[t._l(t.getListEmoji(e),(function(e,n){return i("base-icon",{key:n,staticStyle:{"font-size":"16px"},attrs:{"icon-class":t.iconEmoji1[e]?t.iconEmoji1[e]:"fb_like"}})})),i("span",{staticClass:"pl-05"},[t._v(t._s(e.numOfLike))])],2)])],1),i("el-popover",{attrs:{value:e.id===t.openActionId,placement:"bottom-end",width:"150",trigger:"click"},on:{hide:function(e){t.openActionId=-1}}},[i("el-button",{staticClass:"is-white is-none-border icon-btn",on:{click:function(i){return t.handleDelete(e)}}},[i("base-icon",{staticStyle:{"font-size":"18px"},attrs:{icon:"delete"}}),i("span",[t._v("Xóa bình luận")])],1),i("el-button",{staticClass:"is-create-color is-white is-none-border icon-btn",on:{click:function(i){return t.handleEdit(e)}}},[i("base-icon",{staticStyle:{"font-size":"18px"},attrs:{icon:"edit"}}),i("span",[t._v("Sửa bình luận")])],1),i("el-button",{staticClass:"is-create-color is-white is-none-border icon-btn icon-middle p-0 delete-handle",staticStyle:{"margin-left":"5px"},attrs:{slot:"reference"},on:{click:function(i){return t.actionClick(e.id)}},slot:"reference"},[i("base-icon",{staticStyle:{"margin-left":"1px","font-size":"14px","margin-top":"10px"},attrs:{icon:"threedot"}})],1)],1)],1),e.image&&null!=e.image&&e.image.url&&!t.checkCommentEdit(e)?i("div",{staticStyle:{position:"relative","max-width":"300px","max-height":"200px","margin-left":"46px","margin-top":"2px",display:"inline-block"}},[i("img",{staticStyle:{"max-width":"300px","max-height":"200px","border-radius":"20px","object-fit":"fill"},attrs:{src:e.image.url},on:{click:function(i){return t.handleViewImage(e.image,0)}}}),e.image.percentage?i("div",{staticClass:"custom-progess__"},[i("el-progress",{staticClass:"custom-progess",attrs:{percentage:Math.floor(e.image.percentage),status:100===e.image.percentage?"success":void 0,width:40,"stroke-width":3,"text-inside":!1,type:"circle"}})],1):t._e(),e.numOfLike&&e.numOfLike>0?i("el-tooltip",{attrs:{placement:"bottom"}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tooltipLoading,expression:"tooltipLoading"}],attrs:{slot:"content"},slot:"content"},t._l(e.listEmoji,(function(e,n){return i("div",{key:n,staticClass:"tooltip-icon"},[i("base-icon",{staticStyle:{"font-size":"16px"},attrs:{icon:t.iconEmoji1[e.type]?t.iconEmoji1[e.type]:"fb_like"}}),i("span",{staticClass:"pl-05"},[t._v(t._s(": "+e.value))])],1)})),0),i("div",{staticClass:"like-view",on:{mouseenter:function(i){return t.handleHoverTooltip(e)},click:function(i){return t.handleClickTooltip(e)}}},[t._l(t.getListEmoji(e),(function(e,n){return i("base-icon",{key:n,staticStyle:{"font-size":"16px"},attrs:{icon:t.iconEmoji1[e]?t.iconEmoji1[e]:"fb_like"}})})),i("span",{staticClass:"pl-05"},[t._v(t._s(e.numOfLike))])],2)]):t._e()],1):t._e(),e.video&&null!=e.video&&e.video.url&&!t.checkCommentEdit(e)?i("div",{key:e.video.url,staticStyle:{position:"relative","max-width":"300px","max-height":"200px","margin-left":"46px","margin-top":"7px"}},[e.video.percentage?i("div",[i("span",{staticStyle:{display:"block","line-height":"5px","font-size":"13px"}},[t._v(" "+t._s(e.video.name)+" ")]),e.video.percentage?i("el-progress",{staticClass:"custom-el-progress-bar",attrs:{percentage:Math.floor(e.video.percentage),status:100===e.video.percentage?"success":void 0}}):t._e()],1):i("video",{attrs:{width:"300",height:"200",controls:""},on:{play:t.handleViewPost}},[i("source",{attrs:{src:e.video.url}})]),e.numOfLike&&e.numOfLike>0?i("el-tooltip",{attrs:{placement:"bottom"}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tooltipLoading,expression:"tooltipLoading"}],attrs:{slot:"content"},slot:"content"},t._l(e.listEmoji,(function(e,n){return i("div",{key:n,staticClass:"tooltip-icon"},[i("base-icon",{staticStyle:{"font-size":"16px"},attrs:{"icon-class":t.iconEmoji1[e.type]?t.iconEmoji1[e.type]:"fb_like"}}),i("span",{staticClass:"pl-05"},[t._v(t._s(": "+e.value))])],1)})),0),i("div",{staticClass:"like-view",on:{mouseenter:function(i){return t.handleHoverTooltip(e)},click:function(i){return t.handleClickTooltip(e)}}},[t._l(t.getListEmoji(e),(function(e,n){return i("base-icon",{key:n,staticStyle:{"font-size":"16px"},attrs:{"icon-class":t.iconEmoji1[e]?t.iconEmoji1[e]:"fb_like"}})})),i("span",{staticClass:"pl-05"},[t._v(t._s(e.numOfLike))])],2)]):t._e()],1):t._e(),null===e.previewLinks||0===e.previewLinks.length||t.checkCommentEdit(e)?t._e():i("LinkPreview",{staticStyle:{"margin-top":"10px","margin-left":"48px"},attrs:{data:e.previewLinks[0],orientation:"horizontal",type:"data"}}),i("div",{staticClass:"bottom-comment",staticStyle:{padding:"1px 0px 1px 62px"}},[t.checkCommentEdit(e)?t._e():[i("PostEmoji",{key:e.id,staticStyle:{padding:"0"},attrs:{like:e.iLikeThis,id:e.id,type:e.emojiType?e.emojiType:"LIKE",position:"comment"},on:{like:t.handleLike}}),void 0===t.comment_.id?i("el-button",{staticClass:"btn-link is-white is-none-border icon-btn btn-reply",on:{click:function(i){return t.handleOpenCommentSub(e)}}},[e.numOfComment>0&&!e.isEndSubComment?i("span",[i("base-icon",{staticStyle:{"margin-left":"1px","font-size":"16px"},attrs:{icon:"reply"}}),t._v(" "+t._s(e.numOfComment)+" phản hồi ")],1):i("span",[t._v("Trả lời")]),e.isSubloading?i("i",{staticClass:"el-icon-loading"}):t._e()]):t._e(),i("span",{staticClass:"light sub-des",staticStyle:{"padding-left":"10px"}},[t._v(t._s(t._f("timeAgo")(e.createdAt)))])],e.isOpenChild?i("CommentChild",{staticStyle:{"margin-bottom":"10px"},attrs:{"is-post":t.isPost,post:t.post,comment_:e},on:{endSubComment:function(i){e.isEndSubComment=i,t.$forceUpdate()},subLoading:function(i){e.isSubloading=i,t.$forceUpdate()}}}):t._e()],2)],1)])})),0),i("div",{staticClass:"comment-action"},[i("div",{staticClass:"flex"},[i("base-avatar",{staticStyle:{"margin-right":"15px"},attrs:{url:t.user.avatar,size:"small",alt:"logo"}}),i("div",{staticClass:"input-comment w-100"},[i("el-form",{ref:"form",attrs:{"label-width":"0px"}},[i("el-form-item",{staticClass:"mb-0"},[i("InputChat",{ref:"divEditText",attrs:{"icon-position":t.iconPosition,"open-mention":!0,"props-class":"comment-input",placeholder:"Viết bình luận"},on:{submit:t.handle},model:{value:t.content_,callback:function(e){t.content_=e},expression:"content_"}},[i("el-upload",{ref:"msgUploadMedia",staticClass:"upload",staticStyle:{display:"inline-block"},attrs:{slot:"media","file-list":t.mediaList,"auto-upload":!1,"http-request":t.sendImg,"on-change":t.changeImgFile,limit:t.imageLimit,"show-file-list":!1,"on-exceed":t.onExceedImg,accept:t._f("joinArray")(t.mediaAccept),action:"","list-type":"picture"},slot:"media"},[i("a",{attrs:{slot:"trigger",href:"javascript:void(0)"},slot:"trigger"},[i("base-icon",{staticStyle:{"font-size":"19px"},attrs:{icon:"picture_"}})],1)])],1)],1)],1)],1)],1)]),t.mediaList.length>0?i("div",{staticClass:"images"},t._l(t.mediaList,(function(e,n){return i("div",{key:n,staticClass:"item"},[i("el-button",{staticClass:"icon-btn is-white is-none-border p-0",staticStyle:{"z-index":"2000"},on:{click:function(e){return t.removeItem(n,t.mediaList)}}},[i("i",{staticClass:"el-icon-close"})]),e.raw.type.startsWith("image")?i("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.url,fit:"scale-down"}}):i("video",{attrs:{width:"200",controls:""}},[i("source",{attrs:{src:e.url}})])],1)})),0):t._e()],1)},s=[],o=i("c964"),a=i("d0ff"),c=i("276c"),l=i("e954"),r=i("920b"),u=i("92a6"),d=(i("96cf"),i("d3b7"),i("3ca3"),i("ddb0"),i("d81d"),i("159b"),i("2ca0"),i("a434"),i("a9e3"),i("9ab4")),p=i("1b40"),h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"inputChat",staticClass:"input-chat",class:{"full-input":t.isFull}},[i("div",{class:t.getClass},[i("div",{staticClass:"input-flex",class:{"input-flex-item":t.inline&&!t.isFull},style:{height:t.inline?"auto":"calc(100% - 40px)"},attrs:{contenteditable:"false"}},[i("div",{ref:"text",staticClass:"input-flex-item div-input",style:t.inline?"padding: 10px":"",attrs:{id:"input-text",placeholder:t.placeholder,contenteditable:""},on:{input:t.onLiveEdit,keypress:t.handleKeypress,paste:t.pasteEvent,keydown:t.handleKeypressDelete,blur:t.handleBlur}})]),i("div",{staticClass:"input-flex",attrs:{contenteditable:"false"}},[i("div",{staticClass:"input-flex input-action"},[t._l(t.iconPosition,(function(e,n){return["emoji"===e?i("emoji",{key:n,attrs:{visible:t.visible},on:{select:t.choose,setVisible:function(e){t.visible=e}}},[i("el-button",{staticClass:"is-create-color is-white is-none-border icon-btn p-0 pr-1",staticStyle:{background:"transparent"},style:{height:"18px"===t.emojiFont?"30px":"40px"},on:{click:t.handleClickEmoji}},[i("base-icon",{style:{fontSize:t.emojiFont},attrs:{icon:"smile"}})],1)],1):t._e(),"file"===e?t._t("file"):t._e(),"media"===e?t._t("media"):t._e(),"other"===e?t._t("other"):t._e()]})),t._t("send")],2)])])])},m=[],f=(i("4d63"),i("ac1f"),i("25f0"),i("b0c0"),i("8a79"),i("99af"),i("2ef0")),v=i("5e22"),b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-popover",{attrs:{"visible-arrow":!1,"popper-class":"p-0"},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[i("picker",{attrs:{data:t.emojiIndex,i18n:t.i18n,"show-skin-tones":!1,color:"var(--bw-color-active)",title:"Chọn một biểu tượng"},on:{select:t.choose}}),t._t("default",null,{slot:"reference"})],2)},y=[],g=(i("01ce"),i("364d")),C=i("41fb"),k=new C["EmojiIndex"](g),O=function(t){Object(r["a"])(i,t);var e=Object(u["a"])(i);function i(){var t;return Object(c["a"])(this,i),t=e.apply(this,arguments),t.emojiIndex=k,t.i18n={search:"Tìm kiếm",notfound:"Không thấy biểu tượng",categories:{search:"Kết quả",recent:"Gần đây",people:"Mặt cười & con người",nature:"Động vật & Thiên nhiên",foods:"Đồ ăn & Thức uống",activity:"Hoạt động",places:"Du lịch & Địa điểm",objects:"Đồ vật",symbols:"Biểu tượng",flags:"Quốc kỳ",custom:"Custom"}},t.isShow=!1,t}return Object(l["a"])(i,[{key:"choose",value:function(t){this.$emit("select",t)}}]),i}(p["d"]);Object(d["a"])([Object(p["c"])({required:!0,type:Boolean,default:!1})],O.prototype,"visible",void 0),O=Object(d["a"])([Object(p["a"])({components:{Picker:C["Picker"]}})],O);var j=O,x=j,_=i("2877"),w=Object(_["a"])(x,b,y,!1,null,"6f8b1363",null),E=w.exports,L=function(t){Object(r["a"])(i,t);var e=Object(u["a"])(i);function i(){var t;return Object(c["a"])(this,i),t=e.apply(this,arguments),t.visible=!1,t.text="",t.isSubmit=!1,t.isMentionSelect=!1,t.lastCusorPositon=0,t.mention={isStart:!1,spaceCount:0,key:"",startPosition:0,endPosition:0},t.listKeyCode="~^-`'\"!*'();:@&=+$.,/?%[]{}<>|",t.regexVni=new RegExp(/^[a-zA-ZÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂẾưăạảấầẩẫậắằẳẵặẹẻẽềềểếỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳỵỷỹ\s\W|_]+$/),t.hashTag={isStart:!1,spaceCount:0,key:"",startPosition:0,endPosition:0},t.mentionsList=[],t.hashtagList=[],t.searchMention=null,t.mentionsSelected=[],t.listUserPostition={},t.globalPosition={x:0,y:0},t}return Object(l["a"])(i,[{key:"watchIsFull",value:function(t){this.doSetCaretPosition(this.$refs.text,this.text.length)}},{key:"getClass",get:function(){var t={"not-inline":!this.inline,"input-flex":this.inline,"full-input":this.isFull};return t[this.propsClass]=!0,t}},{key:"mounted",value:function(){var t=this.$refs.inputChat.getBoundingClientRect();this.globalPosition={x:t.x,y:t.y}}},{key:"focus",value:function(){this.$refs.text&&(this.$refs.text.focus(),this.doSetCaretPosition(this.$refs.text,this.$refs.text.innerText.length))}},{key:"pasteEvent",value:function(t){t.preventDefault();var e=t.clipboardData.getData("text/plain");document.execCommand("insertText",!1,e)}},{key:"choose",value:function(t){var e=this.text.substring(0,this.lastCusorPositon),i=this.text.substring(this.lastCusorPositon);this.text=e+t.native+i,this.lastCusorPositon=(e+t.native).length,this.$refs.text.innerHTML=this.convertStringToHtml(),this.$emit("input",this.text)}},{key:"handleClickEmoji",value:function(){this.visible=!0}},{key:"handleBlur",value:function(){this.lastCusorPositon=this.getCaretPosition(this.$refs.text)}},{key:"getTitle",value:function(t){var e=[];return t.groupTitleName&&e.push(t.groupTitleName),t.locationName&&e.push(t.locationName),Object(f["join"])(e," - ")}},{key:"handleKeypress",value:function(t){if(t.shiftKey||13!==t.keyCode&&"Enter"!==t.key)64===t.keyCode||"@"===t.key||35===t.keyCode||t.key;else{if(this.mention.isStart&&this.mentionsList.length>0);else if(this.enterToSubmit)return this.text="",this.$refs.text.innerText="",this.$emit("submit",this.mentionsSelected),void t.preventDefault();this.mention.isStart&&(this.mention={isStart:!1,spaceCount:0,key:"",startPosition:0,endPosition:0})}}},{key:"handleKeypressDelete",value:function(t){"Backspace"===t.key||8===t.keyCode||40===t.keyCode||"ArrowDown"===t.key||38===t.keyCode||t.key}},{key:"getCaretPosition",value:function(t){var e=0,i=0,n=0;if(window.getSelection)i=window.getSelection(),i.rangeCount&&(n=i.getRangeAt(0),n.commonAncestorContainer.parentNode!==t&&n.commonAncestorContainer.parentNode.parentNode!==t||Object(f["forEach"])(t.childNodes,(function(t){if(n.commonAncestorContainer===t)return e+=n.endOffset,!1;e+=t.innerText?t.innerText.length:t.textContent.length})));else if(document.selection&&document.selection.createRange&&(n=document.selection.createRange(),n.parentElement()===t)){var s=document.createElement("span");t.insertBefore(s,t.firstChild);var o=n.duplicate();o.moveToElementText(s),o.setEndPoint("EndToEnd",n),e=o.text.length}return e}},{key:"convertHtmlToString",value:function(t){var e=this,i="",n=[];return Object(f["forEach"])(t,(function(t){if("#text"===t.nodeName)i+=t.textContent;else if("SPAN"===t.nodeName||"span"===t.nodeName)if(t.id&&Object(f["includes"])(t.id,"mention-user-")){var s=Object(f["replace"])(t.id,"mention-user-",""),o=Object(f["find"])(e.mentionsSelected,(function(t){return parseInt(s)===parseInt(t.userId)}));if(o&&Object(f["startsWith"])(o.name,t.innerText)&&""!==t.innerText)i+="@".concat(s),n.push(parseInt(s));else if(t.innerText)t.classList.remove("mention-user"),t.removeAttribute("id"),i+=t.innerText;else{var a=t.parentNode;a.removeChild(t)}}else i+=t.innerText;else t.innerText.endsWith("\n")?i+="\n"+t.innerText.substring(0,t.innerText.length-1):i+="\n"+t.innerText})),this.mentionsSelected=Object(f["filter"])(this.mentionsSelected,(function(t){return-1!==Object(f["findIndex"])(n,(function(e){return e===parseInt(t.userId)}))})),i}},{key:"onLiveEdit",value:function(t){this.text=this.convertHtmlToString(t.target.childNodes),""===Object(f["trim"])(this.$refs.text.innerText)&&this.openHashtag&&(this.$refs.text.innerHTML=""),this.$emit("input",this.text)}},{key:"doSetCaretPosition",value:function(t,e){if(e>=0){var i=window.getSelection(),n=this.createRange(t,{count:e});n&&(n.collapse(!1),i.removeAllRanges(),i.addRange(n))}}},{key:"createRange",value:function(t,e,i){if(i||(i=document.createRange(),i.selectNode(t),i.setStart(t,0)),0===e.count)i.setEnd(t,e.count);else if(t&&e.count>0)if(t.nodeType===Node.TEXT_NODE)t.textContent.length<e.count?e.count-=t.textContent.length:(i.setEnd(t,e.count),e.count=0);else for(var n=0;n<t.childNodes.length;n++)if(i=this.createRange(t.childNodes[n],e,i),0===e.count)break;return i}},{key:"setData",value:function(t,e,i){this.text=v(t),this.mentionsSelected=e,this.hashtagList=i,this.$refs.text.innerHTML=this.convertStringToHtml(),this.focus()}},{key:"convertStringToHtml",value:function(){var t=this.text;return Object(f["forEach"])(this.hashtagList,(function(e){if(e.startsWith("#")){var i='<span class="hashtag-edit" contenteditable="true">'.concat(e,"</span>");t=Object(f["replace"])(t,new RegExp("".concat(e),"g"),i)}})),Object(f["forEach"])(this.mentionsSelected,(function(e){var i='<span id="mention-user-'.concat(e.userId,'" class="mention-user" contenteditable="false">').concat(e.name,"</span>");t=Object(f["replace"])(t,new RegExp("@".concat(e.userId),"g"),i)})),t}}]),i}(p["d"]);Object(d["a"])([Object(p["c"])({required:!1,type:String,default:""})],L.prototype,"value",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:String,default:""})],L.prototype,"propsClass",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:String,default:"18px"})],L.prototype,"emojiFont",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:String,default:"bottom"})],L.prototype,"mentionsPosition",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:Boolean,default:!1})],L.prototype,"showEmoji",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:Boolean,default:!1})],L.prototype,"openMention",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:Boolean,default:!1})],L.prototype,"openHashtag",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:Boolean,default:!1})],L.prototype,"isFull",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:Boolean,default:!0})],L.prototype,"enterToSubmit",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:Boolean,default:!0})],L.prototype,"inline",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:String,default:""})],L.prototype,"placeholder",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:Array,default:["emoji","media","file","other"]})],L.prototype,"iconPosition",void 0),Object(d["a"])([Object(p["e"])("isFull",{immediate:!1})],L.prototype,"watchIsFull",null),L=Object(d["a"])([Object(p["a"])({components:{Emoji:E}})],L);var S=L,T=S,P=(i("6cc7b"),Object(_["a"])(T,h,m,!1,null,"5d6ddbe8",null)),N=P.exports,I=i("a1fe"),A=i("20d2"),$=i("97c1"),D=i("4bb5"),F=function(){return Promise.resolve().then(i.bind(null,"786c"))},R=Object(D["a"])("beUser"),U=function(t){Object(r["a"])(i,t);var e=Object(u["a"])(i);function i(){var t;return Object(c["a"])(this,i),t=e.apply(this,arguments),t.mediaAccept=A["b"],t.visible=!1,t.content_="",t.isEnd=!1,t.isLoading=!1,t.tableList=[],t.tableIndex=2,t.showFullText=[],t.inputActive=!1,t.imageLimit=1,t.fileLimit=1,t.mediaList=[],t.fileList=[],t.iconEmoji1=$["b"],t.conflictComment=!1,t.tooltipLoading=!1,t.iconPosition=["emoji","media"],t.openActionId=-1,t.editCommentId=0,t}return Object(l["a"])(i,[{key:"isSubLoading",get:function(){return this.isLoading&&void 0!==this.comment_.id}},{key:"isShowNextButton",get:function(){return void 0!==this.comment_.id?this.comment_.numOfComment&&this.comment_.numOfComment>this.tableIndex:this.post.numOfHeadComment&&this.post.numOfHeadComment>this.tableIndex}},{key:"watchfocusId",value:function(t){t===this.post.id&&this.$refs.divEditText.focus()}},{key:"watchPost",value:function(t){this.isPost||(this.resetFields(),this.init())}},{key:"mounted",value:function(){this.init()}},{key:"checkCommentEdit",value:function(t){return this.editCommentId===t.id}},{key:"init",value:function(){var t=this;if(void 0!==this.post.comments&&null!==this.post.comments&&void 0===this.comment_.id){var e,i=this.post.comments.map((function(t){var e={};return Object.assign(e,t),e.isOpenChild=!1,e.isSubloading=!1,e}));this.tableIndex=this.post.comments.length,(e=this.tableList).unshift.apply(e,Object(a["a"])(i.reverse()))}void 0!==this.comment_.id&&(console.log("init"),this.tableIndex=0,this.$emit("subLoading",!0),this.showComment().then((function(e){e.data.data.length<20&&t.$emit("endSubComment",!0),t.$emit("subLoading",!1),t.$refs.divEditText.focus(),t.$forceUpdate()})).catch((function(){t.$emit("subLoading",!1)})))}},{key:"resetFields",value:function(){var t={visible:!1,content_:"",isEnd:!1,isLoading:!1,tableList:[],tableIndex:2,showFullText:[],inputActive:!1,imageLimit:1,fileLimit:1,mediaList:[],fileList:[],iconEmoji1:$["b"],conflictComment:!1,tooltipLoading:!1};for(var e in t)this[e]=t[e]}},{key:"handleViewPost",value:function(){this.post.isView||this.post.iViewedThis||(this.post.isView=!0,this.post.iViewedThis=!0,this.post.numOfView++)}},{key:"showComment",value:function(t){this.handleViewPost(),this.isLoading=!0;void 0===this.comment_.id&&this.post.id,this.tableIndex,this.comment_.id}},{key:"handleLike",value:function(t){if(!this.conflictComment){var e=Object(f["find"])(this.tableList,(function(e){return e.id===t.id}));e&&(this.handleViewPost(),this.conflictComment=!0,e.iLikeThis&&t.type)}}},{key:"actionClick",value:function(t){this.openActionId=t}},{key:"handleEdit",value:function(t){var e=this;this.editCommentId=t.id,this.$nextTick((function(){e.openActionId=-1}))}},{key:"handleHoverTooltip",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.listEmoji){t.next=9;break}if(!this.tooltipLoading){t.next=4;break}return t.abrupt("return");case 4:this.tooltipLoading=!0,{numOfLike:"LIKE",numOfLove:"LOVE",numOfHaha:"HAHA",numOfWow:"WOW",numOfSad:"SAD",numOfAngry:"ANGRY"},i=[],e.listEmoji=i,this.tooltipLoading=!1;case 9:t.next=14;break;case 11:return t.prev=11,t.t0=t["catch"](0),t.abrupt("return",Promise.reject(t.t0));case 14:case"end":return t.stop()}}),t,this,[[0,11]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"handleClickTooltip",value:function(t){this.$nextTick((function(){}))}},{key:"getListEmoji",value:function(t){return Object(f["split"])(t.topEmoji,",")}},{key:"handle",value:function(t){this.handleViewPost(),this.content_}},{key:"handleOpenCommentSub",value:function(t){t.isOpenChild=!0,this.$forceUpdate()}},{key:"handleDelete",value:function(t){}},{key:"sendImg",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e,i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e,i){return t.apply(this,arguments)}return e}()},{key:"changeImgFile",value:function(t,e){}},{key:"onExceedImg",value:function(t,e){this.$message.warning("Gửi tối đa "+this.imageLimit+" tập tin")}},{key:"handleReduce",value:function(t){return new Promise(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(i,n){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=[],e.next=3,t.forEach(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.raw.type.startsWith("image")||s.push(n),s.length===t.length&&i(s);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}())}},{key:"removeItem",value:function(t,e){e.splice(t,1)}},{key:"handleViewImage",value:function(t){}}]),i}(p["d"]);Object(d["a"])([Object(p["c"])({required:!1,type:Boolean,default:!0})],U.prototype,"isPost",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:Object,default:{}})],U.prototype,"post",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:Object,default:function(){return{}}})],U.prototype,"comment_",void 0),Object(d["a"])([Object(p["c"])({required:!1,type:Number,default:0})],U.prototype,"focusId",void 0),Object(d["a"])([R.State("user")],U.prototype,"user",void 0),Object(d["a"])([Object(p["e"])("focusId")],U.prototype,"watchfocusId",null),Object(d["a"])([Object(p["e"])("post")],U.prototype,"watchPost",null),U=Object(d["a"])([Object(p["a"])({components:{InputChat:N,PostEmoji:I["a"],CommentChild:F}})],U);var H=U,q=H,V=(i("d50d"),Object(_["a"])(q,n,s,!1,null,"37ec359d",null));e["default"]=V.exports},9079:function(t,e,i){},"93f9":function(t,e,i){"use strict";i("e24a")},9413:function(t,e,i){"use strict";i("9079")},"97c1":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return s}));var n={LIKE:"fb_like",LOVE:"emoji-heart",HAHA:"emoji-haha",WOW:"emoji-wow",SAD:"emoji-cry",ANGRY:"emoji-angry"},s={LIKE:"like_active",LOVE:"emoji-heart",HAHA:"emoji-haha",WOW:"emoji-wow",SAD:"emoji-cry",ANGRY:"emoji-angry"}},a1fe:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"post-emoji",class:{"comment-emoji":"comment"===t.position}},[i("el-popover",{attrs:{"close-delay":200,"open-delay":200,"visible-arrow":!1,width:"275",placement:"top","popper-class":"post-emoji-custom",trigger:"hover"},model:{value:t.hover,callback:function(e){t.hover=e},expression:"hover"}},[i("div",{staticClass:"list-emoji"},[i("div",{staticClass:"flex-left-right"},t._l(t.iconEmoji1,(function(e,n){return i("a",{key:n,staticClass:"flex-item",attrs:{href:"javascript:;"},on:{click:function(e){return t.handleChoose(n)}}},[i("base-icon",{staticStyle:{"font-size":"36px"},attrs:{icon:e}})],1)})),0)]),"post"===t.position?[i("el-button",{class:["is-create-color is-white is-none-border icon-btn icon-middle like-button my-button",t.like?"like-active":""],attrs:{slot:"reference"},on:{click:t.handleLike},slot:"reference"},[t.like?[i("base-icon",{staticClass:"icon-emoji",attrs:{icon:t.icons[t.type]?t.icons[t.type]:"like_active"}}),i("span",{staticClass:"pl-05",staticStyle:{"line-height":"25px"},style:{color:t.colors[t.type]+" !important"}},[t._v(t._s(t.label[t.type]?t.label[t.type]:"Thích"))])]:[i("base-icon",{staticClass:"icon-emoji",attrs:{icon:"like"}}),i("span",{staticClass:"pl-05",staticStyle:{"line-height":"25px",color:"#262626"}},[t._v("Thích")])]],2)]:[i("el-button",{staticClass:"is-none-border",attrs:{slot:"reference"},on:{click:t.handleLike},slot:"reference"},[i("span",{class:{w700:t.like},style:{color:t.colors[t.type]+" !important"}},[t._v(t._s(t.label[t.type]?t.label[t.type]:"Thích"))])])]],2)],1)},s=[],o=i("276c"),a=i("e954"),c=i("920b"),l=i("92a6"),r=(i("a9e3"),i("9ab4")),u=i("1b40"),d=i("97c1"),p=function(t){Object(c["a"])(i,t);var e=Object(l["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.icons=d["a"],t.iconEmoji1=d["b"],t.label={LIKE:"Thích",HAHA:"Haha",ANGRY:"Phẫn nộ",SAD:"Buồn",LOVE:"Yêu thích",WOW:"Wow"},t.hover=!1,t.clearId=null,t.colors={LIKE:"#1962EF",HAHA:"#F7A738",ANGRY:"#E66B14",SAD:"#F7A738",LOVE:"#E2243B",WOW:"#F7A738"},t}return Object(a["a"])(i,[{key:"handleLike",value:function(){this.like?(this.hover=!1,"post"===this.position?this.$emit("like","UNLIKE"):this.$emit("like",{type:"UNLIKE",id:this.id})):(this.hover=!1,"post"===this.position?this.$emit("like","LIKE"):this.$emit("like",{type:"LIKE",id:this.id}))}}]),i}(u["d"]);Object(r["a"])([Object(u["c"])({required:!1,type:Number,default:0})],p.prototype,"id",void 0),Object(r["a"])([Object(u["c"])({required:!0,type:Boolean,default:!1})],p.prototype,"like",void 0),Object(r["a"])([Object(u["c"])({required:!1,type:String,default:"LIKE"})],p.prototype,"type",void 0),Object(r["a"])([Object(u["c"])({required:!1,type:String,default:"post"})],p.prototype,"position",void 0),p=Object(r["a"])([u["a"]],p);var h=p,m=h,f=(i("6109"),i("2877")),v=Object(f["a"])(m,n,s,!1,null,"0968280c",null);e["a"]=v.exports},b320:function(t,e,i){},c4f8:function(t,e,i){},d04c2:function(t,e,i){"use strict";i("4b9b")},d50d:function(t,e,i){"use strict";i("c4f8")},d609:function(t,e,i){},ded8:function(t,e,i){"use strict";i("b320")},e09c:function(t,e,i){"use strict";i("6e44")},e24a:function(t,e,i){},f615:function(t,e,i){}}]);
//# sourceMappingURL=chunk-4040d6fe.a43fb484.js.map