(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e22565a"],{"1fbb":function(e,t,s){"use strict";s("4ea9")},"36d2":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"employee",attrs:{id:"employee"}},[s("base-table",{attrs:{data:e.members,showPagination:!0,table:e.paginitInfo,paginationInfo:"nhân sự",emptyText:"Không có dữ liệu nhân sự"},on:{sizeChange:e.handleChangeSize,currentChange:e.handleCurrentChange,filterChange:e.handleFilter,selectionChange:e.handleSelection,rowClick:e.handleRowClick}},[s("template",{slot:"header"},[s("div",{staticClass:"div-action be-flex jc-space-between"},[s("div",{staticClass:"aciton-left flex"},[s("div",{staticClass:"search"},[s("span",{staticClass:"flex"},[s("base-icon",{staticClass:"icon-search",attrs:{icon:"search"}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchValue,expression:"searchValue"}],staticClass:"searchBar",attrs:{type:"text",placeholder:"Tìm kiếm..."},domProps:{value:e.searchValue},on:{input:function(t){t.target.composing||(e.searchValue=t.target.value)}}})],1)]),s("div",{staticClass:"filter-employee"},[s("el-form",{ref:"form",attrs:{model:e.form}},[s("el-popover",{attrs:{placement:"bottom",width:"300",trigger:"click",content:"this is content, this is content, this is content"},model:{value:e.isOpenFilter,callback:function(t){e.isOpenFilter=t},expression:"isOpenFilter"}},[s("div",{staticClass:"unit be-flex-column"},[s("el-select",{staticClass:"select",attrs:{remote:"","remote-method":e.remoteTransaction,clearable:"",filterable:"",placeholder:"Chọn đơn vị kinh doanh"},model:{value:e.transOfficeIdArray,callback:function(t){e.transOfficeIdArray=t},expression:"transOfficeIdArray"}},e._l(e.transactionList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.locationCode+" - "+e.name,value:e.id}})})),1)],1),s("el-select",{staticClass:"align-employee",attrs:{placeholder:"Trạng thái tài khoản",clearable:""},model:{value:e.form.region,callback:function(t){e.$set(e.form,"region",t)},expression:"form.region"}},[s("el-option",{attrs:{label:"Tất cả nhân viên",value:"0"}}),s("el-option",{attrs:{label:"Chưa có tài khoản",value:"2"}}),s("el-option",{attrs:{label:"Tài khoản đang hoạt động",value:"3"}}),s("el-option",{attrs:{label:"Tài khoản đã bị khóa",value:"1"}}),s("el-option",{attrs:{label:"Nhân viên đã nghỉ việc",value:"4"}})],1),s("el-select",{staticClass:"align-employee",attrs:{placeholder:"Sắp xếp theo",clearable:""},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}},[s("el-option",{attrs:{label:"Xếp theo tên A-Z",value:"1"}}),s("el-option",{attrs:{label:"Xếp theo phòng ban",value:"2"}}),s("el-option",{attrs:{label:"Xếp theo cấp bậc",value:"3"}})],1),s("div",{staticClass:"btn-employee flex-btn-employee"},[s("el-button",{staticClass:"group-filter-button",on:{click:e.handleClickReset}},[e._v("Mặc định")]),s("el-button",{staticClass:"be-button-danger group-filter-button",on:{click:e.handleClickSearch}},[e._v("Tìm kiếm")])],1),s("el-button",{staticClass:"filter_employee",attrs:{slot:"reference"},slot:"reference"},[s("base-icon",{attrs:{icon:"filter"}}),e._v(" Bộ lọc ")],1)],1)],1)],1)]),s("div",{staticClass:"action-right actions"},[s("div",{staticClass:"btn"},[!0===e.isOpenBtnAddUser?s("el-button",{staticClass:"custom-button",on:{click:function(t){return e.createUser(e.userIds)}}},[s("span",{staticClass:"be-inline-flex align-center"},[e._v(" Tạo tài khoản ")])]):e._e()],1)])])]),s("el-table-column",{attrs:{type:"index",width:"80",label:"#",index:e.renderIndex,align:"center"}}),1==this.checkR?s("el-table-column",{attrs:{type:"selection",width:"30",hidden:""}}):e._e(),s("el-table-column",{attrs:{align:"left",label:"Mã nhân viên",width:"120px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(" "+e._s(t.row.memberNo)+" ")])]}}])}),s("el-table-column",{attrs:{label:"Nhân viên",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"row-user"},[t.row.avatar?s("el-avatar",{attrs:{size:"medium",src:t.row.avatar}}):s("base-icon",{staticClass:"avatar__imployee--defalt",attrs:{icon:"icon-avatar-default"}}),s("span",[e._v(" "+e._s(t.row.fullName)+" ")])],1)]}}])}),s("el-table-column",{attrs:{property:"titleName",label:"Chức danh"}}),s("el-table-column",{attrs:{property:"locationCode",label:"Mã ĐVKD",width:"100px",align:"center","show-overflow-tooltip":""}}),s("el-table-column",{attrs:{property:"locationName",label:"Đơn vị kinh doanh",width:"350px","show-overflow-tooltip":""}}),1==this.checkR?s("el-table-column",{attrs:{align:"right",width:"100px",label:"Thao tác"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"action_employee"},[s("div",[null==t.row.statusAccount?s("div",{staticStyle:{"margin-right":"10px"}},[s("el-tooltip",{staticClass:"item-tooltip",attrs:{enterable:!1,effect:"dark",content:"Tạo tài khoản",placement:"top"}},[s("el-button",{staticClass:"is-create-color is-none-border is-white icon-btn icon-middle custom-button p-0"},[s("base-icon",{staticClass:"style-color-icon",staticStyle:{"font-size":"18px",padding:"10px"},attrs:{icon:"create-account-employee"},nativeOn:{click:function(s){return e.handlePermissions(t.row,t.row.id)}}})],1)],1)],1):null!=t.row.statusAccount?s("div",{staticStyle:{"margin-right":"10px"}},[s("el-tooltip",{staticClass:"item-tooltip",attrs:{enterable:!1,effect:"dark",content:"Sửa quyền",placement:"top"}},[s("el-button",{staticClass:"is-create-color is-none-border is-white icon-btn icon-middle custom-button p-0"},[s("base-icon",{staticClass:"style-color-icon",staticStyle:{"font-size":"18px",padding:"10px"},attrs:{icon:"edit-permission"},nativeOn:{click:function(s){return e.handlePermissionsnew(t.row)}}})],1)],1)],1):e._e()])])]}}],null,!1,4028013425)}):e._e()],2),s("user-permission",{attrs:{memberInfor:e.memberInfo,idr:e.idUser,typeCreate:e.typeCreate},on:{save:e.handleFilter,apply:e.getDataMembers}}),s("info-employee",{attrs:{memberInfor:e.memberInfo}}),s("popup-accept-create-acount",{attrs:{listIdUser:e.userIds},on:{save:e.handleFilter}})],1)},a=[],n=s("276c"),o=s("e954"),r=s("920b"),c=s("92a6"),l=(s("ac1f"),s("841c"),s("4e82"),s("caad"),s("2532"),s("9ab4")),h=s("08ba"),u=s("1b40"),d=s("4bb5"),p=s("9f48"),v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("base-popup",{staticClass:"popup-permission",attrs:{name:"userPermission",open:e.handleOpen,top:"5vh",close:e.handleClose,width:"800px"}},[s("div",{staticClass:"title mb-0",attrs:{slot:"title"},slot:"title"},[s("div",{staticClass:"flex-title-employee"},["create"==this.typeCreate?s("div",[e._v(" Tạo tài khoản cho "),s("span",{staticClass:"title-name"},[e._v(e._s(e.fullName))])]):s("div",[e._v(" Phân quyền cho "),s("span",{staticClass:"title-name"},[e._v(e._s(e.fullName))])]),this.idr?s("div",[s("el-button",{staticClass:"be-btn-danger",attrs:{loading:e.loadingSubmit},on:{click:e.handleCreateUser}},[e._v("Tạo tài khoản")])],1):s("div",[s("el-button",{staticClass:"be-btn-danger",on:{click:e.handleSave}},[e._v("Lưu")])],1)])]),s("div",{staticClass:"s-dialog-content s-dialog-scroll-style contact"},[s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showPermission("TRANSACTION_OFFICE_MEMBER"),expression:"showPermission('TRANSACTION_OFFICE_MEMBER')"}],staticClass:"module-row pt-0"},[s("div",{staticClass:"one-role"},[s("div",{staticClass:"role-title"},[s("div",{staticClass:"be-flex"},[s("div",{staticClass:"icon"},[s("base-icon",{staticClass:"style_avatar",attrs:{icon:"icon_authen"}})],1),s("div",{staticClass:"permission-title"},[e._v("Quyền nhân viên tư vấn")])]),s("div",[s("el-checkbox",{staticClass:"s-checkbox",attrs:{label:"TRANSACTION_OFFICE_MEMBER"},model:{value:e.permissionRole,callback:function(t){e.permissionRole=t},expression:"permissionRole"}},[e._v(" "+e._s(" "))])],1)]),s("div",{staticClass:"permission-description"},[e._v(" Bao gồm: tra cứu thông tin hợp đồng & đối soát, cập nhật ngày bàn giao HĐ, tra cứu lương "),s("br"),e._v(" của chính họ và tra cứu thông tin nhân sự. ")])])]),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showPermission("TRANSACTION_OFFICE_LEADER"),expression:"showPermission('TRANSACTION_OFFICE_LEADER')"}],staticClass:"module-row pt-0"},[s("div",{staticClass:"one-role"},[s("div",{staticClass:"role-title"},[s("div",{staticClass:"be-flex"},[s("div",{staticClass:"icon"},[s("base-icon",{staticClass:"style_avatar",attrs:{icon:"icon_authen"}})],1),s("div",{staticClass:"permission-title"},[e._v("Quyền lãnh đạo PGD")])]),s("div",[s("el-checkbox",{staticClass:"s-checkbox",attrs:{label:"TRANSACTION_OFFICE_LEADER"},model:{value:e.permissionRole,callback:function(t){e.permissionRole=t},expression:"permissionRole"}},[e._v(" "+e._s(" "))])],1)]),s("div",{staticClass:"permission-description"},[e._v(" Bao gồm: tra cứu thông tin hợp đồng & đối soát, cập nhật ngày bàn giao HĐ, tra cứu lương "),s("br"),e._v(" của đơn vị họ quản lý và tra cứu thông tin nhân sự. ")])])]),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showPermission("BRANCH_MEMBER"),expression:"showPermission('BRANCH_MEMBER')"}],staticClass:"module-row pt-0"},[s("div",{staticClass:"one-role"},[s("div",{staticClass:"role-title"},[s("div",{staticClass:"be-flex"},[s("div",{staticClass:"icon"},[s("base-icon",{staticClass:"style_avatar",attrs:{icon:"icon_authen"}})],1),s("div",{staticClass:"permission-title"},[e._v("Quyền nhân viên đối soát")])]),s("div",[s("el-checkbox",{staticClass:"s-checkbox",attrs:{label:"BRANCH_MEMBER"},model:{value:e.permissionRole,callback:function(t){e.permissionRole=t},expression:"permissionRole"}},[e._v(" "+e._s(" "))])],1)]),s("div",{staticClass:"permission-description"},[e._v(" Bao gồm: tra cứu thông tin hợp đồng, thực hiện đối soát, gửi yêu cầu duyệt đối soát, gửi yêu cầu hiệu chỉnh, tra cứu lương, xem báo báo cáo của đơn vị họ quản lý và tra cứu thông tin "),s("br"),e._v(" nhân sự. ")]),e.checkShowRole?s("div",{staticClass:"block-branch"},[s("el-select",{staticClass:"select style-branch-permission base-form__item required",attrs:{remote:"",clearable:"","remote-method":e.remoteTransactionOffice,filterable:"",multiple:"",placeholder:"Chọn đơn vị kinh doanh *"},on:{input:function(t){return e.handleChangeInput("validTransaction")}},model:{value:e.objectIds.transOfficeIdArray,callback:function(t){e.$set(e.objectIds,"transOfficeIdArray",t)},expression:"objectIds.transOfficeIdArray"}},[s("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMoreTransactionOffice,expression:"loadMoreTransactionOffice"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},e._l(e.transactionList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.locationCode+" - "+e.name,value:e.id}})})),1)]),e.errorOffice?s("small",{staticClass:"small style-branch-permission",staticStyle:{display:"block"}},[e._v("Vui lòng chọn đơn vị kinh doanh phụ trách")]):e._e()],1):e._e()])]),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showPermission("BRANCH_LEADER"),expression:"showPermission('BRANCH_LEADER')"}],staticClass:"module-row pt-0"},[s("div",{staticClass:"one-role"},[s("div",{staticClass:"role-title"},[s("div",{staticClass:"be-flex"},[s("div",{staticClass:"icon"},[s("base-icon",{staticClass:"style_avatar",attrs:{icon:"icon_authen"}})],1),s("div",{staticClass:"permission-title"},[e._v("Quyền lãnh đạo chi nhánh")])]),s("div",[s("el-checkbox",{staticClass:"s-checkbox",attrs:{label:"BRANCH_LEADER"},model:{value:e.permissionRole,callback:function(t){e.permissionRole=t},expression:"permissionRole"}},[e._v(" "+e._s(" "))])],1)]),s("div",{staticClass:"permission-description"},[e._v(" Bao gồm: tra cứu thông tin hợp đồng, thực hiện đối soát, gửi yêu cầu duyệt đối soát, phê "),s("br"),e._v(" duyệt đối soát, gửi yêu cầu hiệu chỉnh, tra cứu lương, xem báo cáo của đơn vị họ quản lý và tra cứu thông tin nhân sự. ")])])]),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showPermission("HO_MEMBER"),expression:"showPermission('HO_MEMBER')"}],staticClass:"module-row pt-0"},[s("div",{staticClass:"one-role"},[s("div",{staticClass:"role-title"},[s("div",{staticClass:"be-flex"},[s("div",{staticClass:"icon"},[s("base-icon",{staticClass:"style_avatar",attrs:{icon:"icon_authen"}})],1),s("div",{staticClass:"permission-title"},[e._v("Quyền nhân viên hội sở")])]),s("div",[s("el-checkbox",{staticClass:"s-checkbox",attrs:{label:"HO_MEMBER"},model:{value:e.permissionRole,callback:function(t){e.permissionRole=t},expression:"permissionRole"}},[e._v(" "+e._s(" "))])],1)]),s("div",{staticClass:"permission-description"},[e._v(" Cập nhật file Dai-ichi & KPI, tra cứu thông tin hợp đồng, thực hiện đối soát, gửi yêu cầu "),s("br"),e._v(" duyệt đối soát, phê duyệt đối soát, gửi yêu cầu hiệu chỉnh, phê duyệt hiệu chỉnh, tra cứu "),s("br"),e._v(" lương, xem báo cáo của khu vực phụ trách và tra cứu thông tin nhân sự. ")]),e.checkHO?s("div",{staticClass:"block-branch"},[s("el-select",{staticClass:"select style-branch-permission",attrs:{remote:"","remote-method":e.remoteArea,filterable:"",clearable:"",multiple:"",placeholder:"Chọn khu vực *"},on:{input:function(t){return e.handleChangeInput("validArea")}},model:{value:e.objectIds.areaIdArray,callback:function(t){e.$set(e.objectIds,"areaIdArray",t)},expression:"objectIds.areaIdArray"}},[s("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMoreArea,expression:"loadMoreArea"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},e._l(e.listArea,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]),e.errorArea?s("small",{staticClass:"small style-branch-permission",staticStyle:{display:"block"}},[e._v("Vui lòng chọn khu vực phụ trách")]):e._e()],1):e._e()])]),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showPermission("HO_LEADER"),expression:"showPermission('HO_LEADER')"}],staticClass:"module-row pt-0"},[s("div",{staticClass:"one-role"},[s("div",{staticClass:"role-title"},[s("div",{staticClass:"be-flex"},[s("div",{staticClass:"icon"},[s("base-icon",{staticClass:"style_avatar",attrs:{icon:"icon_authen"}})],1),s("div",{staticClass:"permission-title"},[e._v("Quyền lãnh đạo hội sở")])]),s("div",[s("el-checkbox",{staticClass:"s-checkbox",attrs:{label:"HO_LEADER"},model:{value:e.permissionRole,callback:function(t){e.permissionRole=t},expression:"permissionRole"}},[e._v(" "+e._s(" "))])],1)]),s("div",{staticClass:"permission-description"},[e._v(" Cập nhật file Dai-ichi & KPI, tra cứu thông tin hợp đồng, thực hiện đối soát, gửi yêu cầu "),s("br"),e._v(" duyệt đối soát, phê duyệt đối soát, gửi yêu cầu hiệu chỉnh, phê duyệt hiệu chỉnh, tra cứu "),s("br"),e._v(" lương, xem báo cáo của tất cả đơn vị kinh doanh và tra cứu thông tin nhân sự. ")])])]),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showPermission("ADMIN"),expression:"showPermission('ADMIN')"}],staticClass:"module-row pt-0"},[s("div",{staticClass:"one-role"},[s("div",{staticClass:"role-title"},[s("div",{staticClass:"be-flex"},[s("div",{staticClass:"icon"},[s("base-icon",{staticClass:"style_avatar",attrs:{icon:"icon_authen"}})],1),s("div",{staticClass:"permission-title"},[e._v("Quyền quản trị")])]),s("div",[s("el-checkbox",{staticClass:"s-checkbox",attrs:{label:"ADMIN"},model:{value:e.permissionRole,callback:function(t){e.permissionRole=t},expression:"permissionRole"}},[e._v(" "+e._s(" "))])],1)]),s("div",{staticClass:"permission-description"},[e._v("Bao gồm: tạo tài khoản, phân quyền và thực hiện đầy đủ các chức năng nghiệp vụ khác.")])])])],1)])},m=[],f=s("d0ff"),b=s("c964"),y=(s("96cf"),s("99af"),s("d81d"),s("159b"),s("4de4"),s("9f13")),C=s("2ef0"),g=Object(d["a"])("beUser"),O=function(e){Object(r["a"])(s,e);var t=Object(c["a"])(s);function s(){var e;return Object(n["a"])(this,s),e=t.apply(this,arguments),e.permissionMember={},e.data={},e.permissionRole=[],e.loadingSubmit=!1,e.checkHO=!0,e.checkShowRole=!0,e.dataRole=[],e.fullName="",e.userId="",e.objectIds={transOfficeIdArray:[],areaIdArray:[]},e.branchList=[],e.listArea=[],e.transactionList=[],e.transactionOfficeList=[],e.errorOffice=!1,e.errorArea=!1,e.query={area:{i:0,ps:20,search:"",type:1},offices:{i:0,ps:20,search:"",type:3,parentId:""}},e}return Object(o["a"])(s,[{key:"loadMoreTransactionOffice",value:function(){this.query.offices.i+=20;var e=Object(C["debounce"])(this.getTransactionOffice,100);e(this.query.offices.search,!0)}},{key:"remoteTransactionOffice",value:function(e){this.query.offices.search=Object(C["trim"])(e),this.query.offices.i=0,this.query.offices.ps=20;var t=Object(C["debounce"])(this.getTransactionOffice,500);t(e)}},{key:"getTransactionOffice",value:function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(t){var s,i,a,n,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=o.length>1&&void 0!==o[1]&&o[1],e.prev=1,e.next=4,null===(i=this.locationRes)||void 0===i?void 0:i.list("office",{search:Object(C["trim"])(t),i:this.query.offices.i,ps:this.query.offices.ps,parentId:this.memberInfor.branch.id});case 4:a=e.sent,s?(n=a||[],this.transactionList=[].concat(Object(f["a"])(this.transactionList),Object(f["a"])(n))):this.transactionList=a||[],e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),this.transactionList=[];case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"remoteArea",value:function(e){this.query.area.search=Object(C["trim"])(e),this.query.area.i=0,this.query.area.ps=20;var t=Object(C["debounce"])(this.getAreaList,500);t(e)}},{key:"loadMoreArea",value:function(){this.query.area.i+=this.query.area.ps;var e=Object(C["debounce"])(this.getAreaList,100);e(this.query.area.search,!0)}},{key:"getAreaList",value:function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(t){var s,i,a,n,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=o.length>1&&void 0!==o[1]&&o[1],e.prev=1,e.next=4,null===(i=this.locationRes)||void 0===i?void 0:i.list("area",{search:Object(C["trim"])(t),i:this.query.area.i,ps:this.query.area.ps});case 4:a=e.sent,s?(n=a||[],this.listArea=[].concat(Object(f["a"])(this.listArea),Object(f["a"])(n))):this.listArea=a||[],e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0),this.listArea=[];case 12:case"end":return e.stop()}}),e,this,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleOpen",value:function(){var e,t,s;(this.errorOffice=!1,this.errorArea=!1,this.fullName=null===(e=this.memberInfor)||void 0===e?void 0:e.fullName,null!==(t=this.memberInfor)&&void 0!==t&&t.statusAccount)||(this.userId=null===(s=this.memberInfor)||void 0===s?void 0:s.id);this.permissionRole=[],this.getListRole(),this.getRoleOfMember(),this.getAreaList(""),this.getTransactionOffice(""),this.query.offices.i=0,this.query.area.i=0}},{key:"handleChangeInput",value:function(e){console.log(e),"validTransaction"===e&&(this.errorOffice=!1),"validArea"===e&&(this.errorArea=!1),this.$forceUpdate()}},{key:"getListRole",value:function(){var e,t=this;null===(e=this.apiPermission)||void 0===e||e.getPermissionRole().then((function(e){t.dataRole=e}))}},{key:"getRoleOfMember",value:function(){var e,t=this;null===(e=this.apiPermission)||void 0===e||e.getPermissionMember(this.memberInfor.id).then((function(e){t.permissionRole=e.map((function(e){return e.roleCode})),e.forEach((function(e){"BRANCH_MEMBER"==e.roleCode&&(t.objectIds.transOfficeIdArray=e.objectIds),"HO_MEMBER"==e.roleCode&&(t.objectIds.areaIdArray=e.objectIds)}))}))}},{key:"showPermission",value:function(e){if(this.permissionRole.includes("BRANCH_MEMBER")?this.checkShowRole=!0:(this.checkShowRole=!1,this.objectIds.transOfficeIdArray=""),this.permissionRole.includes("HO_MEMBER")?this.checkHO=!0:(this.checkHO=!1,this.objectIds.areaIdArray=""),this.dataRole.length>0){var t=y["ROLE_CODE"][e],s=Object(C["find"])(this.dataRole,(function(e){return e.code===t}));if(s)return!0}return!1}},{key:"handleClose",value:function(e){this.objectIds.transOfficeIdArray="",this.objectIds.areaIdArray="",console.log("e",e),this.userId="",this.query.offices.i=0,this.query.area.i=0}},{key:"handleCreateUser",value:function(){var e,t,s=this,i=this.dataRole.filter((function(e){return s.permissionRole.includes(e.code)})),a=Object(C["findIndex"])(i,(function(e){return"BRANCH_MEMBER"==e.code})),n=Object(C["findIndex"])(i,(function(e){return"HO_MEMBER"==e.code}));-1!==a&&null!==(e=this.objectIds.transOfficeIdArray)&&void 0!==e&&e.length&&(i[a].objectIds=Object(f["a"])(this.objectIds.transOfficeIdArray)),-1!==n&&null!==(t=this.objectIds.areaIdArray)&&void 0!==t&&t.length&&(i[n].objectIds=Object(f["a"])(this.objectIds.areaIdArray)),this.loadingSubmit=!0;var o={memberId:this.memberInfor.id,permissionRoles:i};this.apiPermission.createUser(o).then((function(){s.loadingSubmit=!1,s.setOpenPopup({popupName:"userPermission",isOpen:!1}),s.$message.success("Tạo tài khoản thành công!"),s.$emit("save")})).catch((function(e){return s.$message.error(e.message)}))}},{key:"handleSave",value:function(){var e,t,s=this;if(!0!==this.checkShowRole||""!==Object(C["trim"])(this.objectIds.transOfficeIdArray))if(!0!==this.checkHO||""!==Object(C["trim"])(this.objectIds.areaIdArray)){var i=this.dataRole.filter((function(e){return s.permissionRole.includes(e.code)})),a=Object(C["findIndex"])(i,(function(e){return"BRANCH_MEMBER"==e.code})),n=Object(C["findIndex"])(i,(function(e){return"HO_MEMBER"==e.code}));-1!==a&&null!==(e=this.objectIds.transOfficeIdArray)&&void 0!==e&&e.length&&(i[a].objectIds=Object(f["a"])(this.objectIds.transOfficeIdArray)),-1!==n&&null!==(t=this.objectIds.areaIdArray)&&void 0!==t&&t.length&&(i[n].objectIds=Object(f["a"])(this.objectIds.areaIdArray)),console.log("role",i);var o={memberId:this.memberInfor.id,permissionRoles:i};"create"==this.typeCreate?this.apiPermission.createUser(o).then((function(){s.$message.success("Tạo tài khoản thành công !"),s.setOpenPopup({popupName:"userPermission",isOpen:!1})})).catch((function(e){return s.$message.success(e.message)})):this.apiPermission.updatePermissionMember(o).then((function(){s.$message.success("Cập nhật quyền thành công !"),s.setOpenPopup({popupName:"userPermission",isOpen:!1})})).catch((function(e){return s.$message.success(e.message)}))}else this.errorArea=!0;else this.errorOffice=!0}},{key:"created",value:function(){var e,t;this.apiPermission=Object(h["a"])("permissionRole",{districtId:null===(e=this.user)||void 0===e||null===(t=e.districts)||void 0===t?void 0:t[0].id}),this.locationRes=Object(h["a"])("location",{districtId:this.districtId})}}]),s}(p["a"]);Object(l["a"])([g.State("user")],O.prototype,"user",void 0),Object(l["a"])([Object(u["c"])({required:!1,type:Object,default:{}})],O.prototype,"memberInfor",void 0),Object(l["a"])([Object(u["c"])()],O.prototype,"idr",void 0),Object(l["a"])([Object(u["c"])()],O.prototype,"typeCreate",void 0),O=Object(l["a"])([u["a"]],O);var _=O,k=_,I=(s("7f16"),s("2877")),j=Object(I["a"])(k,v,m,!1,null,null,null),A=j.exports,R=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("base-popup",{attrs:{name:"infoemployee-popup",width:"426px",open:e.handleOpen,close:e.handleClose,"max-height:75vh":"",top:"5vh",id:"popup-detail-employee"}},[s("div",{attrs:{slot:"title"},slot:"title"},[e._v("Thông tin nhân viên")]),s("div",{staticClass:"sack-employee"},[[s("div",{staticClass:"row-employee"},[e.responses.avatar?s("el-image",{key:e.responses.avatar,staticStyle:{width:"72px",height:"72px","border-radius":"50%",margin:"15px 0 10px 0"},attrs:{src:e.responses.avatar,lazy:"",fit:"cover"}}):s("base-icon",{staticClass:"style_avatar",attrs:{icon:"icon-avatar-default"}}),s("p",{staticClass:"fullName"},[e._v(e._s(e.responses.fullName))]),s("p",{staticClass:"position"},[e._v(e._s(e.responses.titleName))])],1)],s("el-form",{staticClass:"form_customer"},[e.responses.locationName?s("div",{staticClass:"unit"},[s("div",{staticClass:"style_title"},[e._v("Đơn vị")]),s("el-breadcrumb",{staticClass:"breadcrumb-list",attrs:{"separator-class":"el-icon-caret-right"}},e._l(e.responses.locationPathList,(function(t,i){return s("el-breadcrumb-item",{key:i},[e._v(e._s(t))])})),1)],1):e._e(),s("el-form-item",{staticClass:"form_customer-top"},[s("div",{staticClass:"info_contact"},[e._v("THÔNG TIN LIÊN HỆ")]),e.responses.phone?s("div",{staticClass:"phone-employee"},[s("div",{staticClass:"style_title"},[e._v("Điện thoại")]),s("div",{staticClass:"style_info"},[e._v(e._s(e.responses.phone))])]):e._e(),e.responses.email?s("div",{staticClass:"email-employee"},[s("div",{staticClass:"style_title"},[e._v("Email")]),s("div",{staticClass:"style_info"},[e._v(e._s(e.responses.email))])]):e._e()]),s("el-form-item",{staticClass:"form_customer-top"},[s("div",{staticClass:"info_contact info_contact-style"},[e._v("THÔNG TIN CHI TIẾT")]),e.responses.memberNo?s("div",{staticClass:"id-employee"},[s("div",{staticClass:"style_title"},[e._v("Mã nhân viên")]),s("div",{staticClass:"style_info"},[e._v(e._s(e.responses.memberNo))])]):e._e(),s("div",{staticClass:"certCode"},[s("div",{staticClass:"style_title certCode__label"},[e._v(" Mã code "),s("p",{staticClass:"icon-edit",staticStyle:{"margin-top":"-2px"},on:{click:e.addicon}},[s("base-icon",{attrs:{icon:"icon edit"}})],1)]),s("div",{staticClass:"style_certCode"},[e.formCertCode?s("div",{staticClass:"style_info-form"},[s("el-input",{staticClass:"style__input",attrs:{type:"text"},model:{value:e.responses.certCode,callback:function(t){e.$set(e.responses,"certCode",t)},expression:"responses.certCode"}}),s("el-button",{staticClass:"group-filter-button cancel",on:{click:e.handleCancel}},[e._v("Hủy")]),s("el-button",{staticClass:"be-button-danger group-filter-button",on:{click:e.handleSave}},[e._v("Lưu")])],1):s("div",[e._v(e._s(e.responses.certCode))])])]),e.responses.joinDate?s("div",{staticClass:"accede"},[s("div",{staticClass:"style_title"},[e._v("Ngày gia nhập")]),s("div",{staticClass:"style_info"},[e._v(e._s(this.convertTimestampToDate(this.responses.joinDate)))])]):e._e(),e.responses.gender?s("div",{staticClass:"gender-employee"},[s("div",{staticClass:"style_title"},[e._v("Giới tính")]),s("div",{staticClass:"style_info"},[e._v(e._s(e.responses.gender))])]):e._e(),e.responses.birthday?s("div",{staticClass:"date-employee"},[s("div",{staticClass:"style_title"},[e._v("Ngày sinh")]),s("div",{staticClass:"style_info"},[e._v(e._s(this.convertTimestampToDate(this.responses.birthday)))])]):e._e()])],1)],2)])},w=[],x=Object(d["a"])("beUser"),M=function(e){Object(r["a"])(s,e);var t=Object(c["a"])(s);function s(){var e;return Object(n["a"])(this,s),e=t.apply(this,arguments),e.adminStaff=!1,e.adminAccount=!1,e.formCertCode=!1,e.updateRole=[],e.fullName="",e.email="",e.phone="",e.avatar="",e.titleName="",e.locationPathList="",e.birthday="",e.gender="",e.memberNo="",e.joinDate="",e.certCode="",e.responses={},e}return Object(o["a"])(s,[{key:"handleOpen",value:function(){this.getDetail()}},{key:"convertTimestampToDate",value:function(e){if(e){var t=e,s=new Date(t),i="0"+s.getDate()+"/";return s.getDate()<10&&(i+="0"),i+=s.getMonth()+1,i+="/",s.getMonth(),i+=s.getFullYear(),i}return null}},{key:"getDetail",value:function(){var e,t=this;this.api.getDetailEmployee(null===(e=this.memberInfor)||void 0===e?void 0:e.id).then((function(e){t.responses=e})).catch((function(e){return console.log(e)}))}},{key:"handleClose",value:function(){this.formCertCode=!1}},{key:"handleSave",value:function(){var e,t=this;null===(e=this.apiupdateCertCode)||void 0===e||e.updateCertCode(this.responses.id,{certCode:this.responses.certCode}).then((function(){t.$message.success("Cập nhật thành công"),t.formCertCode=!1})).catch((function(e){t.$message.error(e.message)}))}},{key:"handleCancel",value:function(){this.formCertCode=!1,this.setOpenPopup({popupName:"infoemployee-popup",isOpen:!1})}},{key:"created",value:function(){var e,t,s,i;this.api=Object(h["a"])("employeeInfo",{districtId:null===(e=this.user)||void 0===e||null===(t=e.districts)||void 0===t?void 0:t[0].id}),this.apiupdateCertCode=Object(h["a"])("employeeInfo",{districtId:null===(s=this.user)||void 0===s||null===(i=s.districts)||void 0===i?void 0:i[0].id})}},{key:"addicon",value:function(){this.formCertCode=!0}}]),s}(p["a"]);Object(l["a"])([x.State("user")],M.prototype,"user",void 0),Object(l["a"])([Object(u["c"])({required:!1,type:Object,default:{}})],M.prototype,"memberInfor",void 0),M=Object(l["a"])([u["a"]],M);var E=M,N=E,T=(s("8d93"),Object(I["a"])(N,R,w,!1,null,"05bd99f0",null)),S=T.exports,P=s("567c"),L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("base-popup",{staticClass:"action",attrs:{name:"acceptCreateAcount",open:e.handleOpen,close:e.handleClose,hiddenFooter:!0,width:"463px",top:"25vh"}},[s("div",{staticClass:"title-accept",attrs:{slot:"title"},slot:"title"},[e._v("Xác nhận")]),s("div",{staticClass:"body-content"},[s("div",[s("span",{staticClass:"styleTitle"},[e._v("Bạn có chắc chắn muốn tạo tài khoản cho nhân viên không?")])])]),s("template",{slot:"footer"},[s("div",{staticClass:"bottom"},[s("div",{staticClass:"bt-top flex"},[s("div",{staticClass:"bt-center"},[s("el-button",{staticClass:"be-button-unset",attrs:{size:"mini"},on:{click:e.handleClose}},[e._v("Không")]),s("el-button",{staticClass:"be-btn-danger btnStyle",on:{click:e.handleSave}},[e._v("Có")])],1)])])])],2)},B=[],D=Object(d["a"])("beUser"),q=function(e){Object(r["a"])(s,e);var t=Object(c["a"])(s);function s(){var e;return Object(n["a"])(this,s),e=t.apply(this,arguments),e.ids=[],e.params={},e}return Object(o["a"])(s,[{key:"handleClose",value:function(){this.setOpenPopup({popupName:"acceptCreateAcount",isOpen:!1})}},{key:"handleOpen",value:function(){this.ids=this.listIdUser}},{key:"handleSave",value:function(){var e=this,t={ids:this.ids};this.api.createMutipleUser(t).then((function(){e.$message.success("Tạo tài khoản thành công !"),e.setOpenPopup({popupName:"acceptCreateAcount",isOpen:!1})})).catch((function(t){return e.$message.error(t.message)})),this.$emit("save")}},{key:"created",value:function(){var e,t;this.api=Object(h["a"])("employee",{districtId:null===(e=this.user)||void 0===e||null===(t=e.districts)||void 0===t?void 0:t[0].id})}}]),s}(Object(u["b"])(p["a"]));Object(l["a"])([Object(u["c"])({default:[]})],q.prototype,"listIdUser",void 0),Object(l["a"])([D.State("user")],q.prototype,"user",void 0),q=Object(l["a"])([Object(u["a"])({components:{}})],q);var H=q,F=H,$=(s("99e5"),Object(I["a"])(F,L,B,!1,null,null,null)),U=$.exports,V=Object(d["a"])("beEmployee"),z=Object(d["a"])("beUser"),Q=function(e){Object(r["a"])(s,e);var t=Object(c["a"])(s);function s(){var e;return Object(n["a"])(this,s),e=t.apply(this,arguments),e.isOpenFilter=!1,e.loading=!1,e.isLoading=!1,e.isActive=!0,e.isConflickClick=!1,e.conflict=!1,e.listTitle=[],e.transOfficeIdArray="",e.transactionList=[],e.members=[],e.memberInfo={},e.location=[],e.locationList=[],e.idUser=0,e.form={region:"",sort:"",unitShow:"",levelEmployee:""},e.params={parentId:""},e.paginitInfo={limit:20,page:1,search:"",sort:1,locationId:"",statusAccount:0,total:e.totalMembers},e.pageInfo={page:1,limit:10,total:1e3},e.searchValue="",e.typeCreate="",e.checkR=!1,e.search=Object(C["debounce"])((function(t){e.handleSearch(t)}),500),e.isOpenBtnAddUser=!1,e.userIds=[],e.arrayStatusAccount=[],e.arrayEmail=[],e.notificationMessage="",e}return Object(o["a"])(s,[{key:"handleClickSearch",value:function(){this.paginitInfo.locationId=this.transOfficeIdArray,this.paginitInfo.statusAccount=+this.form.region,this.paginitInfo.sort=+this.form.sort,this.paginitInfo.page=1,this.getDataMembers(),this.getTotalMembers(),this.isOpenFilter=!1}},{key:"getBranchList",value:function(e){var t,s=this;null===(t=this.apiLocation)||void 0===t||t.getLocation({params:e}).then((function(e){return s.locationList=e})).catch((function(e){return console.log(e)}))}},{key:"handleClickReset",value:function(){this.form.region="0",this.form.sort="1",this.transOfficeIdArray="",this.form.levelEmployee="",this.paginitInfo.statusAccount=+this.form.region,this.paginitInfo.sort=+this.form.sort,this.paginitInfo.locationId=this.transOfficeIdArray,this.getDataMembers(),this.getTotalMembers()}},{key:"getOfficeList",value:function(){var e,t,s=this,i={search:"",type:3,i:0,districtId:null===(e=this.user)||void 0===e||null===(t=e.districts)||void 0===t?void 0:t[0].id,ps:""};this.apiUser.getAreaList(i).then((function(e){s.transactionList=e.data,s.isLoading=!1})).catch((function(){s.isLoading=!1}))}},{key:"handlePermissions",value:function(e,t){this.isConflickClick=!0,this.memberInfo=e,this.idUser=0,this.typeCreate="create",t&&(this.idUser=t,e.email?this.setOpenPopup({popupName:"userPermission",isOpen:!0}):this.$message.error("Nhân viên ".concat(e.fullName," không có email nên không tạo được tài khoản !")))}},{key:"handlePermissionsnew",value:function(e){this.isConflickClick=!0,this.memberInfo=e,this.idUser=0,this.setOpenPopup({popupName:"userPermission",isOpen:!0})}},{key:"checkRole",value:function(e){e.includes("ADMIN")?this.checkR=!0:this.checkR=!1,console.log("check",this.checkR)}},{key:"handleRowClick",value:function(e){this.isConflickClick?this.isConflickClick=!1:(this.memberInfo=e.row,this.setOpenPopup({popupName:"infoemployee-popup",isOpen:!0}))}},{key:"handleFilter",value:function(){this.paginitInfo.page=1,this.getDataMembers(),this.getTotalMembers()}},{key:"searchText",value:function(e){this.search(e)}},{key:"handleSearch",value:function(e){this.loading=!0,this.paginitInfo.page=1,this.paginitInfo.search=Object(C["trim"])(e),this.getDataMembers(),this.getTotalMembers()}},{key:"renderTotal",value:function(){return this.totalMembers}},{key:"handleChangeSize",value:function(e){this.paginitInfo.limit=e,this.getDataMembers(),this.getTotalMembers()}},{key:"handleCurrentChange",value:function(e){this.loading=!0,this.paginitInfo.page=e,this.getDataMembers()}},{key:"renderIndex",value:function(e){return(this.paginitInfo.page-1)*this.paginitInfo.limit+e+1}},{key:"created",value:function(){var e,t,s,i,a,n;this.checkRole(this.roleMembers.userRole),this.loading=!0,this.form.region="0",this.form.sort="1",this.api=Object(h["a"])("employee",{districtId:null===(e=this.user)||void 0===e||null===(t=e.districts)||void 0===t?void 0:t[0].id}),this.apiLocation=Object(h["a"])("location",{districtId:null===(s=this.user)||void 0===s||null===(i=s.districts)||void 0===i?void 0:i[0].id}),this.apiUser=Object(h["a"])("user",{districtId:null===(a=this.user)||void 0===a||null===(n=a.districts)||void 0===n?void 0:n[0].id}),this.getDataMembers(),this.getTotalMembers(),this.getOfficeList()}},{key:"getDataMembers",value:function(){var e=this;this.loading=!0,this.api.all(this.paginitInfo).then((function(t){e.members=t,e.loading=!1})).catch((function(e){console.log(e)}))}},{key:"mounted",value:function(){this.getBranchList(this.params)}},{key:"getTotalMembers",value:function(){var e=this;this.loading=!0,this.api.getCountMembers(this.paginitInfo).then((function(t){e.loading=!1,e.setTotalMembers(t),e.paginitInfo.total=t})).catch((function(e){console.log(e)}))}},{key:"remoteTransaction",value:function(e){var t,s,i,a,n,o,r=this;""==e?null===(t=this.apiUser)||void 0===t||t.getAreaList({search:"",type:3,i:0,districtId:null===(s=this.user)||void 0===s||null===(i=s.districts)||void 0===i?void 0:i[0].id,ps:10}).then((function(e){return r.transactionList=e.data})).catch((function(e){return console.log(e)})):null===(a=this.apiUser)||void 0===a||a.getAreaList({search:Object(C["trim"])(e),type:3,i:0,districtId:null===(n=this.user)||void 0===n||null===(o=n.districts)||void 0===o?void 0:o[0].id,ps:10}).then((function(e){return r.transactionList=e.data})).catch((function(e){return console.log(e)}))}},{key:"handleSelection",value:function(e){var t=this;this.resetItem(),e.length>0&&(Object(C["forEach"])(e,(function(e){t.userIds.push(e.id),t.arrayStatusAccount.push(e.statusAccount),t.arrayEmail.push(e.email)})),!1===this.arrayStatusAccount.includes("ACTIVE")&&(this.isOpenBtnAddUser=!0,Object(C["forEach"])(this.arrayEmail,(function(e){e||(t.notificationMessage="Tồn tại nhân viên không có email nên không tạo được tài khoản")}))))}},{key:"resetItem",value:function(){this.notificationMessage="",this.isOpenBtnAddUser=!1,this.userIds=[],this.arrayStatusAccount=[],this.arrayEmail=[]}},{key:"createUser",value:function(e){this.notificationMessage?this.$message.error(this.notificationMessage):(console.log(e),this.setOpenPopup({popupName:"acceptCreateAcount",isOpen:!0}))}}]),s}(p["a"]);Object(l["a"])([z.State("role")],Q.prototype,"roleMembers",void 0),Object(l["a"])([z.State("user")],Q.prototype,"user",void 0),Object(l["a"])([V.State("totalMembers")],Q.prototype,"totalMembers",void 0),Object(l["a"])([V.Action("setMembers")],Q.prototype,"setMembers",void 0),Object(l["a"])([V.Action("setTotalMembers")],Q.prototype,"setTotalMembers",void 0),Object(l["a"])([Object(u["e"])("searchValue",{immediate:!1})],Q.prototype,"searchText",null),Q=Object(l["a"])([Object(u["a"])({components:{UserPermission:A,InfoEmployee:S,SearchBar:P["a"],PopupAcceptCreateAcount:U}})],Q);var G=Q,K=G,X=(s("1fbb"),Object(I["a"])(K,i,a,!1,null,"bde7cadc",null));t["default"]=X.exports},"48c2":function(e,t,s){},"4ea9":function(e,t,s){},"567c":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"search flex"},[s("base-icon",{staticClass:"icon-search",attrs:{icon:"search"}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.valueSearch,expression:"valueSearch"}],staticClass:"searchBar",attrs:{type:"text",placeholder:"Tìm kiếm..."},domProps:{value:e.valueSearch},on:{input:function(t){t.target.composing||(e.valueSearch=t.target.value)}}})],1)},a=[],n=s("f3f3"),o=s("276c"),r=s("e954"),c=s("920b"),l=s("92a6"),h=(s("ac1f"),s("841c"),s("b0c0"),s("9ab4")),u=s("2ef0"),d=s("1b40"),p=s("4bb5"),v=Object(p["a"])("beAudit"),m=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(o["a"])(this,s),e=t.apply(this,arguments),e.valueSearch=e.search,e.searchText=Object(u["debounce"])((function(t){e.$emit("search",Object(u["trim"])(t))}),500),e}return Object(r["a"])(s,[{key:"handleSearch",value:function(e){var t;if(e!==this.search&&this.searchText(e),null!==(t=this.$route)&&void 0!==t&&t.name){var s=this.getFilter(this.$route.name);s?this.setReportFilter({contract:this.$route.name,filters:Object(n["a"])(Object(n["a"])({},s.filters),{},{search:Object(u["trim"])(e)})}):this.setReportFilter({contract:this.$route.name,filters:{search:Object(u["trim"])(e)}})}}},{key:"checkRoute",value:function(e){this.init(e)}},{key:"init",value:function(e){var t=this.getFilter(e.name);t&&t.filters?this.valueSearch=t.filters.search:this.valueSearch=""}}]),s}(d["d"]);Object(h["a"])([v.Getter("getFilter")],m.prototype,"getFilter",void 0),Object(h["a"])([v.Action("setReportFilter")],m.prototype,"setReportFilter",void 0),Object(h["a"])([Object(d["c"])({default:"",required:!1})],m.prototype,"search",void 0),Object(h["a"])([Object(d["e"])("valueSearch",{immediate:!1})],m.prototype,"handleSearch",null),Object(h["a"])([Object(d["e"])("$route")],m.prototype,"checkRoute",null),m=Object(h["a"])([Object(d["a"])({components:{}})],m);var f=m,b=f,y=(s("61d3"),s("2877")),C=Object(y["a"])(b,i,a,!1,null,"f42d5708",null);t["a"]=C.exports},"61d3":function(e,t,s){"use strict";s("48c2")},"7f16":function(e,t,s){"use strict";s("bf2d")},8141:function(e,t,s){},"85ce":function(e,t,s){},"8d93":function(e,t,s){"use strict";s("85ce")},"99e5":function(e,t,s){"use strict";s("8141")},bf2d:function(e,t,s){}}]);
//# sourceMappingURL=chunk-3e22565a.98c7bed1.js.map