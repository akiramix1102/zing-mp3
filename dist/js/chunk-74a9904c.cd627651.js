(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74a9904c"],{"19fc":function(t,e,a){"use strict";a("eb10")},"22e5":function(t,e,a){"use strict";a("e797")},"30c3":function(t,e,a){},4030:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"audit-page salary-approve-table-page"},[a("div",{staticClass:"be-flex main-action"},[a("div",{staticClass:"be-flex main-action__left"},[a("filter-salary",{on:{search:t.handleSearch,open:t.handleOpenPopupFilter,sort:t.handleSort,change:t.handleFilter}}),a("div",{staticClass:"actions"})],1)]),a("div",{},[a("base-table",{attrs:{data:t.data,isLoading:t.isLoading,table:t.query,showPagination:!0,paginationInfo:"bảng lương",emptyText:"Không có dữ liệu lương"},on:{rowClick:t.handleRowClick,sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange}},[a("el-table-column",{attrs:{index:t.getIndex,type:"index",align:"center",label:"#","min-width":"40"}}),a("el-table-column",{attrs:{label:"Tháng lương",prop:"payrollName","min-width":"190"}}),a("el-table-column",{attrs:{label:"Trạng thái",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.payrollStatus?a("span",{staticClass:"cell-status"},[t._v("Chờ xử lý")]):t._e(),"2"==e.row.payrollStatus?a("span",{staticClass:"cell-status"},[t._v("Đang tính")]):t._e(),"3"==e.row.payrollStatus?a("span",{staticClass:"not-approve cell-status"},[t._v("Đã tính xong")]):t._e(),"4"==e.row.payrollStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v(" Chờ duyệt ")]):t._e(),"5"==e.row.payrollStatus?a("span",{staticClass:"approve cell-status"},[t._v("CN đã duyệt")]):t._e(),"6"==e.row.payrollStatus?a("span",{staticClass:"decline cell-status"},[t._v("CN từ chối")]):t._e(),"7"==e.row.payrollStatus?a("span",{staticClass:"approve cell-status"},[t._v(" Duyệt chi ")]):t._e(),"8"==e.row.payrollStatus?a("span",{staticClass:"decline cell-status"},[t._v("Hội sở từ chối")]):t._e(),"9"==e.row.payrollStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),"10"==e.row.payrollStatus?a("span",{staticClass:"approve cell-status"},[t._v("Đồng ý hiệu chỉnh")]):t._e(),"11"==e.row.payrollStatus?a("span",{staticClass:"decline decline--1 cell-status"},[t._v("Từ chối hiệu chỉnh")]):t._e(),"12"==e.row.payrollStatus?a("span",{staticClass:"pending-approve decline--1 cell-status"},[t._v("Yêu cầu hiệu chỉnh CN")]):t._e(),"13"==e.row.payrollStatus?a("span",{staticClass:"decline decline--1 cell-status"},[t._v("CN từ chối hiệu chỉnh")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"Mã ĐVKD",prop:"branchCode","min-width":"100"}}),a("el-table-column",{attrs:{label:"đƠN VỊ KINH DOANH",prop:"branchName","min-width":"200"}}),a("el-table-column",{attrs:{label:"MÃ NVĐS LƯƠNG",prop:"approveRequestedMemberNo","min-width":"140"}}),a("el-table-column",{attrs:{width:"30"}}),a("el-table-column",{attrs:{label:"NV Đối soát lương",prop:"approveRequestedName","min-width":"200"}}),a("el-table-column",{attrs:{label:"Mã Người duyệt (CN)",prop:"approvedMemberNo","min-width":"180"}}),a("el-table-column",{attrs:{width:"30"}}),a("el-table-column",{attrs:{label:"Người duyệt (CN)",prop:"approvedName","min-width":"200"}}),a("el-table-column",{attrs:{label:"Mã NGƯỜI DUYỆT (HS)",prop:"payApprovedMemberNo","min-width":"180"}}),a("el-table-column",{attrs:{width:"30"}}),a("el-table-column",{attrs:{label:"nGƯỜI DUYỆT (hội sở)",prop:"payApprovedName","min-width":"200"}}),a("el-table-column",{attrs:{label:"thời gian duyệt",align:"left","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatDateHour")(e.row.approvedAt)))])]}}])})],1)],1),a("popup-filter",{on:{apply:t.handleFilter}}),a("popup-aprove-salary",{attrs:{"detail-file":t.rowData},on:{load:t.handleLoad}})],1)},l=[],n=a("f3f3"),s=a("c964"),r=a("276c"),o=a("e954"),c=a("920b"),u=a("92a6"),h=(a("96cf"),a("b0c0"),a("ac1f"),a("841c"),a("b64b"),a("9ab4")),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"import-filter"},[a("div",{staticClass:"be-flex jc-space-between"},[a("div",{staticClass:"action-left flex"},[a("div",{staticClass:"search"},[a("span",{staticClass:"flex"},[a("base-icon",{staticClass:"icon-search",attrs:{icon:"search"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"searchBar",attrs:{type:"text",placeholder:"Tìm kiếm..."},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}})],1)]),a("div",{staticClass:"filter-item"},[a("el-popover",{attrs:{placement:"bottom",trigger:"click",width:"378","popper-class":"cs-poper-salary fillter-salary-approve"},on:{show:t.handleShowFilter,hide:t.handleHideFilter},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[a("el-form",{ref:"filterForm",staticClass:"custom-salary-form",attrs:{model:t.formFilterData}},[a("div",{staticClass:"flex pay-roll-row"},[a("el-form-item",{attrs:{label:"Năm",size:"medium"}},[a("el-date-picker",{attrs:{format:"yyyy","value-format":"yyyy",type:"year",placeholder:"Năm"},model:{value:t.formFilterData.payrollYear,callback:function(e){t.$set(t.formFilterData,"payrollYear",e)},expression:"formFilterData.payrollYear"}})],1),a("el-form-item",{attrs:{label:"Tháng",size:"medium"}},[a("el-select",{attrs:{placeholder:"Tháng",clearable:""},model:{value:t.formFilterData.payrollMonth,callback:function(e){t.$set(t.formFilterData,"payrollMonth",e)},expression:"formFilterData.payrollMonth"}},t._l(12,(function(t){return a("el-option",{key:t,attrs:{label:"Tháng "+t,value:t}})})),1)],1)],1),a("el-form-item",{staticClass:"be-flex be-flex-column",attrs:{label:"Chi nhánh",size:"medium"}},[a("el-select",{staticClass:"select",attrs:{clearable:"",disabled:t.getDisableArea,remote:"","remote-method":t.remoteBranch,filterable:"",multiple:"",placeholder:"Chọn chi nhánh"},model:{value:t.formFilterData.branchIdArray,callback:function(e){t.$set(t.formFilterData,"branchIdArray",e)},expression:"formFilterData.branchIdArray"}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMoreBranch,expression:"loadMoreBranch"}],staticClass:"list-uploader",attrs:{"infinite-scroll-delay":"500"}},t._l(t.branchList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.locationCode+" - "+t.name,value:t.id}})})),1)])],1),a("el-form-item",{staticClass:"be-flex be-flex-column",attrs:{label:"Trạng thái",size:"medium"}},[a("el-select",{staticClass:"filter-select",attrs:{clearable:"",placeholder:"Chọn trạng thái ","popper-class":"select-item-border"},model:{value:t.formFilterData.payrollStatus,callback:function(e){t.$set(t.formFilterData,"payrollStatus",e)},expression:"formFilterData.payrollStatus"}},t._l(t.statusFilter,(function(t,e){return a("el-option",{key:e,class:t.value%2!==0?"cs-border":"",attrs:{label:t.label,value:t.value}})})),1)],1),a("div",{staticClass:"text-right footer"},[a("el-button",{staticClass:"group-filter-button",on:{click:function(e){return t.handleSubmit("reset")}}},[t._v("Mặc định")]),a("el-button",{staticClass:"be-button-danger group-filter-button",on:{click:t.handleSubmit}},[t._v("Áp dụng")])],1)],1),a("el-button",{staticClass:"be-button-unset cursor text-filter",attrs:{slot:"reference"},slot:"reference"},[a("span",{staticStyle:{"margin-right":"5px"}},[a("base-icon",{attrs:{icon:"filter"}})],1),t._v(" Bộ lọc ")])],1)],1),a("div",{staticClass:"sort"},[a("el-dropdown",{staticClass:"import-sort",attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("el-button",{staticClass:"be-button-unset custom-button"},[a("span",{staticStyle:{"margin-right":"5px"}},[a("base-icon",{staticClass:"icon",attrs:{icon:"sort"}})],1),t._v(" Sắp xếp ")]),a("el-dropdown-menu",{staticClass:"sort-menu-popper",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.sorts,(function(e,i){return a("el-dropdown-item",{key:i,class:e.active?"active":null,attrs:{command:e.command,divided:e.divided}},[a("span",{staticClass:"be-flex"},[a("span",{staticClass:"be-flex-item"},[t._v(" "+t._s(e.label)+" ")])])])})),1)],1)],1)])])])},p=[],m=a("d0ff"),b=(a("4de4"),a("b680"),a("99af"),a("d3b7"),a("3ca3"),a("ddb0"),a("a15b"),a("1b40")),f=a("6d3f"),y=a("2ef0"),v=a("08ba"),g=(a("caad"),a("2532"),a("4bb5")),_=Object(g["a"])("beUser"),C=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"branchId",get:function(){return this.user.branchId}},{key:"brandName",get:function(){return this.user.branchName}},{key:"roleHOLEADERAmin",get:function(){var t=!1;return this.user.role&&(this.roleMembers.userRole.includes("HO_LEADER")||this.roleMembers.userRole.includes("HO_MEMBER")||this.roleMembers.userRole.includes("ADMIN"))&&(t=!0),t}}]),a}(b["d"]);Object(h["a"])([_.State("user")],C.prototype,"user",void 0),Object(h["a"])([_.State("role")],C.prototype,"roleMembers",void 0),C=Object(h["a"])([b["a"]],C);var k=C,O=Object(g["a"])("beAudit"),j=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.members=[],t.filter={search:"",orderByClause:1},t.search="",t.sorts=[{command:"1",label:"Sắp xếp theo tháng",divided:!1,active:!0},{command:"2",label:"Sắp xếp theo trạng thái",divided:!0},{command:"3",label:"Sắp xếp theo chi nhánh",divided:!0}],t.statusFilter=[{value:"1",label:"Chờ xử lý"},{value:"2",label:"Đang tính"},{value:"3",label:"Đã tính xong"},{value:"4",label:"Chờ duyệt"},{value:"5",label:"CN đã duyệt"},{value:"6",label:"CN từ chối"},{value:"7",label:"Duyệt chi"},{value:"8",label:"Hội sở từ chối"},{value:"9",label:"Yêu cầu hiệu chỉnh"},{value:"10",label:"Đồng ý hiệu chỉnh"},{value:"11",label:"Từ chối hiệu chỉnh"},{value:"12",label:"Yêu cầu hiệu chỉnh CN"},{value:"13",label:"CN từ chối hiệu chỉnh"}],t.isShow=!1,t.formFilterData={payrollMonth:(new Date).getMonth(),payrollYear:(new Date).getFullYear().toFixed(),payrollStatus:"",branchIdArray:[]},t.branchList=[],t.query={search:"",type:2,i:0,districtId:0,ps:10},t.searchText=Object(y["debounce"])((function(e){t.$emit("search",e)}),500),t}return Object(o["a"])(a,[{key:"getDisableArea",get:function(){return!this.roleHOLEADERAmin}},{key:"created",value:function(){this.apiUser=Object(v["a"])("user",{districtId:this.districtId}),this.query={search:"",type:2,i:0,districtId:this.districtId,ps:10},this.getDisableArea&&(this.branchList.push({id:this.user.branchId,locationCode:this.user.branchCode,name:this.user.branchName}),this.formFilterData.branchIdArray=[this.branchId]);var t=this.getFilter(this.$route.name);t&&t.filters&&t.filters.search?this.search=t.filters.search:this.search=""}},{key:"handleSearch",value:function(t){var e,a,i=this.getFilter(this.$route.name);i&&(this.filter=Object(n["a"])(Object(n["a"])(Object(n["a"])({},i.filters),this.filter),{},{search:Object(y["trim"])(this.search)})),this.search!=(null===i||void 0===i||null===(e=i.filters)||void 0===e?void 0:e.search)&&this.searchText(this.filter),this.setReportFilter({contract:null===(a=this.$route)||void 0===a?void 0:a.name,filters:Object(n["a"])(Object(n["a"])({},this.filter),{},{search:Object(y["trim"])(this.search)})})}},{key:"loadMoreBranch",value:function(){var t,e=this;this.query.i+=this.query.ps,null===(t=this.apiUser)||void 0===t||t.getAreaList(this.query).then((function(t){e.branchList=[].concat(Object(m["a"])(e.branchList),Object(m["a"])(t.data))})).catch((function(t){return console.log(t)}))}},{key:"handleShowFilter",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,i,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=this.getFilter(null===(e=this.$route)||void 0===e?void 0:e.name),t.next=3,Promise.all([null===(a=this.apiUser)||void 0===a?void 0:a.getAreaList({search:"",type:2,i:0,districtId:this.districtId,ps:10}).then((function(t){l.branchList=t.data})).catch((function(t){return console.log(t)}))]).then((function(){i&&(l.formFilterData=Object(y["assign"])(l.formFilterData,i.filters))}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"remoteBranch",value:function(t){var e,a,i=this;""==t?null===(e=this.apiUser)||void 0===e||e.getAreaList({search:"",type:2,i:0,districtId:this.districtId,ps:10}).then((function(t){i.branchList=t.data})).catch((function(t){return console.log(t)})):null===(a=this.apiUser)||void 0===a||a.getAreaList({search:t,type:2,i:0,districtId:this.districtId,ps:10}).then((function(t){return i.branchList=t.data})).catch((function(t){return console.log(t)}))}},{key:"handleCommand",value:function(t){var e=this;Object(y["forEach"])(this.sorts,(function(a){a.command===t?(a.active=!0,e.$forceUpdate()):a.active=!1})),this.$emit("sort",+t)}},{key:"handleHideFilter",value:function(){console.log(this.formFilterData);var t=Object(n["a"])(Object(n["a"])({},this.formFilterData),{},{branchIdArray:this.formFilterData.branchIdArray.join(",")});this.$emit("close",t)}},{key:"resetData",value:function(){this.$refs.filterForm.clearValidate(),this.formFilterData={payrollMonth:(new Date).getMonth(),payrollYear:(new Date).getFullYear().toFixed(),payrollStatus:"",branchIdArray:this.getDisableArea?[this.branchId]:[]}}},{key:"handleSubmit",value:function(t){var e;if("reset"!==t){this.setReportFilter({contract:null===(e=this.$route)||void 0===e?void 0:e.name,filters:Object(n["a"])(Object(n["a"])({},this.formFilterData),{},{search:Object(y["trim"])(this.search)})});var a=Object(n["a"])(Object(n["a"])({},this.formFilterData),{},{branchIdArray:this.getDisableArea?this.branchId:this.formFilterData.branchIdArray.join(",")});this.isShow=!1,this.$emit("change",a)}else this.resetData()}},{key:"handleOpenPopupFilter",value:function(){this.$emit("open")}}]),a}(Object(b["b"])(k));Object(h["a"])([O.State("filters")],j.prototype,"filters",void 0),Object(h["a"])([O.Action("setReportFilter")],j.prototype,"setReportFilter",void 0),Object(h["a"])([O.Getter("getFilter")],j.prototype,"getFilter",void 0),Object(h["a"])([Object(b["e"])("search",{immediate:!1})],j.prototype,"handleSearch",null),j=Object(h["a"])([Object(b["a"])({components:{BaseIcon:f["a"]}})],j);var S=j,w=S,R=(a("9e48"),a("2877")),x=Object(R["a"])(w,d,p,!1,null,"70435000",null),q=x.exports,F=a("89256"),A=a("4a47e"),N=a("c56f"),P=a("9f48"),D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{attrs:{name:"pay-roll-month",hiddenFooter:!0,width:"386px"},on:{open:t.handleOpen,close:t.handleClose}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("Tính lương")]),a("el-form",{staticClass:"custom-salary-form",attrs:{model:t.dataForm}},[a("el-form-item",{staticClass:"be-flex be-flex-column",attrs:{label:"Đơn vị kinh doanh"}},[a("el-select",{staticClass:"salary-select",attrs:{placeholder:"Đơn vị kinh doanh"},model:{value:t.dataForm.value,callback:function(e){t.$set(t.dataForm,"value",e)},expression:"dataForm.value"}},t._l(t.dataForm.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("div",{staticClass:"flex pay-roll-row"},[a("el-form-item",{staticClass:"be-flex be-flex-column",attrs:{label:"Tháng"}},[a("el-date-picker",{staticClass:"salary-select",attrs:{format:"MM",type:"month",placeholder:"Tháng"},model:{value:t.dataForm.month,callback:function(e){t.$set(t.dataForm,"month",e)},expression:"dataForm.month"}})],1),a("el-form-item",{staticClass:"be-flex be-flex-column",attrs:{label:"Năm"}},[a("el-date-picker",{staticClass:"salary-select",attrs:{type:"year",placeholder:"Năm"},model:{value:t.dataForm.year,callback:function(e){t.$set(t.dataForm,"year",e)},expression:"dataForm.year"}})],1)],1)],1),a("div",{staticClass:"footer-popup",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"be-button-unset",on:{click:t.hanleCancel}},[t._v("Hủy")]),a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:t.handlePayRoll}},[t._v("Bắt đầu tính")])],1)],1)},L=[],T=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.dataForm={value:"",options:[],month:"",year:""},t}return Object(o["a"])(a,[{key:"hanleCancel",value:function(){this.setOpenPopup({popupName:"pay-roll-month",isOpen:!1})}},{key:"handlePayRoll",value:function(){this.setOpenPopup({popupName:"pay-roll-month",isOpen:!1})}},{key:"handleOpen",value:function(){console.log("1")}},{key:"handleClose",value:function(){console.log(2)}}]),a}(Object(b["b"])(P["a"]));T=Object(h["a"])([Object(b["a"])({})],T);var I=T,$=I,B=(a("b6d3"),Object(R["a"])($,D,L,!1,null,"0f1938da",null)),M=B.exports,z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"popup-file-detail popup-salary-detail",attrs:{name:"pay-roll",open:t.handleOpen,close:t.handleClose,width:"1240px",hiddenFooter:!0}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("Chi tiết bảng lương "+t._s(t.detailFile.branchName))]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoadingPopup,expression:"isLoadingPopup"}],staticClass:"body-content"},[a("div",{staticClass:"flex body-content__header"},[a("div",{staticClass:"be-flex-column header-file-name"},[a("div",{staticClass:"flex file-name"},[a("span",[t._v(t._s(t.detailFile.payrollName))]),"4"===t.detailFile.payrollStatus?a("span",{staticClass:"pending-approve cell-status"},[t._v("Chờ duyệt")]):t._e(),"5"==t.detailFile.payrollStatus?a("span",{staticClass:"approve cell-status"},[t._v("CN đã duyệt")]):t._e(),"6"==t.detailFile.payrollStatus?a("span",{staticClass:"decline cell-status"},[t._v("CN từ chối")]):t._e(),"7"==t.detailFile.payrollStatus?a("span",{staticClass:"approve cell-status"},[t._v(" Duyệt chi ")]):t._e(),"8"==t.detailFile.payrollStatus?a("span",{staticClass:"decline cell-status"},[t._v("Hội sở từ chối")]):t._e(),"9"==t.detailFile.payrollStatus?a("span",{staticClass:"pending-approve cell-status cell-width"},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),"10"==t.detailFile.payrollStatus?a("span",{staticClass:"approve cell-status cell-width"},[t._v("Đồng ý hiệu chỉnh")]):t._e(),"11"==t.detailFile.payrollStatus?a("span",{staticClass:"decline cell-status cell-width"},[t._v("Từ chối hiệu chỉnh")]):t._e(),"12"==t.detailFile.payrollStatus?a("span",{staticClass:"pending-approve cell-status cell-width"},[t._v("Yêu cầu hiệu chỉnh CN")]):t._e(),"13"==t.detailFile.payrollStatus?a("span",{staticClass:"decline cell-status cell-width"},[t._v("CN từ chối hiệu chỉnh")]):t._e()])]),a("div",{staticClass:"header-button-action"},[t.getRoleButton("3")&&t.checkPemission("salary",["request-hc","request-ho"])?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(4)}}},[t._v("Yêu cầu duyệt")]):t._e(),(t.getRoleButton("3")||t.getRoleButton("6")||t.getRoleButton("8")||t.getRoleButton("10"))&&t.checkPemission("salary",["request-hc","request-ho"])?a("el-button",{staticClass:"be-btn-danger",attrs:{loading:t.isLoadingBtn,size:"medium"},on:{click:function(e){return t.handleUpdateSalary(1)}}},[t._v("Tính lại lương")]):t._e(),t.getRoleButton("5")&&t.checkPemission("salary",["request-hc"])?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(12)}}},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),t.getRoleButton("4")&&t.checkPemission("salary",["request-dvkd","request-ho"])?a("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(6)}}},[t._v("Từ chối")]):t._e(),t.getRoleButton("4")&&t.checkPemission("salary",["request-dvkd","request-ho"])?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(5)}}},[t._v("Phê duyệt")]):t._e(),(t.getRoleButton("7")||t.getRoleButton("11"))&&t.checkPemission("salary",["request-dvkd","request-ho","request-hc"])?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(9)}}},[t._v("Yêu cầu hiệu chỉnh")]):t._e(),t.getRoleButton("12")&&t.checkPemission("salary",["request-dvkd"])&&t.getRequestAtDvkd?a("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(13)}}},[t._v("Từ chối hiệu chỉnh")]):t._e(),t.getRoleButton("12")&&t.checkPemission("salary",["request-dvkd"])&&t.getRequestAtDvkd?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(10)}}},[t._v("Duyệt hiệu chỉnh")]):t._e(),t.getRoleButton("12")&&t.checkPemission("salary",["request-ho"])&&t.getRequestAtHo?a("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(13)}}},[t._v("Từ chối hiệu chỉnh")]):t._e(),t.getRoleButton("12")&&t.checkPemission("salary",["request-ho"])&&t.getRequestAtHo?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(10)}}},[t._v("Duyệt hiệu chỉnh")]):t._e(),(t.getRoleButton("5")||t.getRoleButton("13"))&&t.checkPemission("salary",["request-ho"])?a("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(8)}}},[t._v("Từ chối")]):t._e(),(t.getRoleButton("5")||t.getRoleButton("13"))&&t.checkPemission("salary",["request-ho"])?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(7)}}},[t._v("Duyệt chi")]):t._e(),t.getRoleButton("9")&&t.checkPemission("salary",["request-ho"])&&t.getRequestAtHo?a("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(11)}}},[t._v("Từ chối hiệu chỉnh")]):t._e(),t.getRoleButton("9")&&t.checkPemission("salary",["request-ho"])&&t.getRequestAtHo?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(10)}}},[t._v("Duyệt hiệu chỉnh")]):t._e(),t.getRoleButton("9")&&t.checkPemission("salary",["request-dvkd"])&&t.getRequestAtDvkd?a("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(11)}}},[t._v("Từ chối hiệu chỉnh")]):t._e(),t.getRoleButton("9")&&t.checkPemission("salary",["request-dvkd"])&&t.getRequestAtDvkd?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:function(e){return t.handleUpdateSalary(10)}}},[t._v("Duyệt hiệu chỉnh")]):t._e()],1)]),"6"==t.detailFile.payrollStatus||"8"==t.detailFile.payrollStatus?a("div",{staticClass:"body-content__content body-content__content--error"},[a("div",{staticClass:"text-column"},[a("div",{staticClass:"be-flex text-item",staticStyle:{"align-items":"flex-start"}},[a("span",{staticClass:"text-item__title",staticStyle:{display:"block","line-height":"1.4"}},[t._v("Lý do từ chối:")]),"6"==t.detailFile.payrollStatus?a("span",{staticClass:"text-item__number",staticStyle:{"flex-basis":"70%","word-break":"break-word"}},[a("span",{staticStyle:{display:"block","line-height":"1.3"}},[t._v(t._s(t.getTitleCode))]),a("span",[t._v(t._s(t.detailFile.branchRejectReason))])]):t._e(),"8"==t.detailFile.payrollStatus?a("span",{staticClass:"text-item__number",staticStyle:{"flex-basis":"70%","word-break":"break-word"}},[a("span",{staticStyle:{display:"block","line-height":"1.3"}},[t._v(t._s(t.getTitleCode))]),a("span",[t._v(" "+t._s(t.detailFile.hoRejectReason))])]):t._e()])])]):t._e(),"9"==t.detailFile.payrollStatus||"12"==t.detailFile.payrollStatus?a("div",{staticClass:"body-content__content body-content__content--error"},[a("div",{staticClass:"text-column"},[a("div",{staticClass:"be-flex text-item",staticStyle:{"align-items":"flex-start"}},[a("span",{staticClass:"text-item__title",staticStyle:{display:"block","line-height":"1.4"}},[t._v("Lý do:")]),a("span",{staticClass:"text-item__number",staticStyle:{"flex-basis":"70%","word-break":"break-word"}},[a("span",{staticStyle:{display:"block","line-height":"1.4"}},[t._v(t._s(t.getTitleCode))]),a("span",[t._v(" "+t._s(t.detailFile.editRequestReason))])])])])]):t._e(),a("div",{staticClass:"body-content__tabs"},[a("div",{staticClass:"be-flex menu-tabs"},t._l(t.tabs,(function(e){return a("span",{key:e.id,staticClass:"cursor tab-item",class:e.active?"tab-active":null,on:{click:function(a){return t.handleChangeTab(e)}}},[t._v(t._s(e.name))])})),0)]),a("div",{staticClass:"body-content__table"},["CBNV"===t.sheetAactive?a("pay-roll-table",{attrs:{data:t.data,query:t.query,summary:t.summary,isLoading:t.isLoading},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange}}):a("table-other",{attrs:{data:t.data,query:t.query,summary:t.summary,isLoading:t.isLoading},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange}})],1)]),a("popup-reject-pay",{attrs:{id:t.detailFile.id,status:t.statusPayRoll},on:{load:t.handeLoad}})],1)},Y=[],E=a("ef28"),V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("base-tree-table",{attrs:{paginationInfo:"nhân viên",data:t.data,table:t.query,isLoading:t.isLoading,showSummary:!0,showPagination:!0,summaryMethod:t.summaryMethod,sumText:"Tổng"},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange}},[a("el-table-column",{attrs:{index:t.getIndex,type:"index",label:"#",width:"80",align:"center"}}),a("el-table-column",{attrs:{prop:"salesMemberNo",label:"mã nv",width:"150",align:"left"}}),a("el-table-column",{attrs:{prop:"salesFullName",label:"tên cbnv",width:"220"}}),a("el-table-column",{attrs:{prop:"transactionOfficeCode",label:"mã pgd",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"transactionOfficeName",label:"tên phòng giao dịch",width:"200"}}),a("el-table-column",{attrs:{label:"SL HĐ",prop:"numOfContract",width:"80",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.numOfContract))+" ")]}}])}),a("el-table-column",{attrs:{width:"30"}}),a("el-table-column",{attrs:{label:"SL hủy",prop:"numOfCancel",width:"80",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.numOfCancel))+" ")]}}])}),a("el-table-column",{attrs:{label:"FYP",prop:"revenueTotalAmountY1",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.revenueYear1Amount))+" ")]}}])}),a("el-table-column",{attrs:{label:"Lương KDTT",prop:"salarySalesAmountK1",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.salarySalesK1Amount))+" ")]}}])}),a("el-table-column",{attrs:{label:"RYP",prop:"revenueTotalAmountK2",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.revenueK2Amount))+" ")]}}])}),a("el-table-column",{attrs:{label:"Lương RYP",prop:"salarySalesAmountK2",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.salarySalesK2Amount))+" ")]}}])}),a("el-table-column",{attrs:{label:"CTTĐ",prop:"emulationAmount",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.emulationAmount))+" ")]}}])}),a("el-table-column",{attrs:{width:"40"}}),a("el-table-column",{attrs:{label:"Tlht kpi",prop:"resultMonthRevenueTotalPercent",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatPercent")(e.row.resultMonthRevenueYear1Percent))+" ")]}}])}),a("el-table-column",{attrs:{label:"truy thu",prop:"arrearsAmount",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.arrearsAmount))+" ")]}}])}),a("el-table-column",{attrs:{label:"tổng lương",prop:"salarySalesTotalAmount",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.salarySalesTotalAmount))+" ")]}}])})],1)],1)},U=[],H=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"getIndex",get:function(){return this.query.limit*(this.query.page-1)+1}},{key:"handleSizeChange",value:function(t){this.$emit("sizeChange",t)}},{key:"handleCurrentChange",value:function(t){this.$emit("currentChange",t)}},{key:"summaryMethod",value:function(t){var e=this,a=t.columns,i=[];return Object(y["forEach"])(a,(function(t,a){if(a<4)i[a]="";else if(4!==a){var l=e.summary[t.property];if(i[a]=l?e.$options.filters.formatNumber(l):0,14===a){var n=e.summary["resultMonthRevenueTotalPercent"];i[14]=e.$options.filters.formatPercentAdv(n)}6!==a&&13!==a||(i[a]="")}else i[a]="Tổng"})),i}}]),a}(b["d"]);Object(h["a"])([Object(b["c"])({required:!0,type:Array,default:[]})],H.prototype,"data",void 0),Object(h["a"])([Object(b["c"])({required:!1,type:Object,default:{}})],H.prototype,"query",void 0),Object(h["a"])([Object(b["c"])({required:!1,type:Object,default:{}})],H.prototype,"summary",void 0),Object(h["a"])([Object(b["c"])({required:!1,type:Boolean,default:!1})],H.prototype,"isLoading",void 0),H=Object(h["a"])([Object(b["a"])({components:{}})],H);var K=H,Q=K,G=Object(R["a"])(Q,V,U,!1,null,"e0b40c8c",null),W=G.exports,J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-popup",{staticClass:"popup-reject-pay",attrs:{name:"popup-reject-pay-roll",open:t.handleOpen,close:t.handleClose,top:"20vh",hiddenFooter:!0,width:"450px"}},[9==t.status||12===t.status?a("div",{attrs:{slot:"title"},slot:"title"},[t._v("Yêu cầu hiệu chỉnh")]):a("div",{attrs:{slot:"title"},slot:"title"},[t._v("Từ chối")]),a("el-form",{ref:"formData",staticClass:"form-reject",staticStyle:{"margin-top":"10px"}},[9==t.status||12===t.status?a("el-form-item",{staticClass:"be-flex be-flex-column",attrs:{label:"Lý do yêu cầu hiệu chỉnh"}},[a("el-select",{staticClass:"select",staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"Chọn lý do"},on:{change:t.handleChangeReason},model:{value:t.rejectCode,callback:function(e){t.rejectCode=e},expression:"rejectCode"}},t._l(t.payrollList,(function(e){return a("el-option",{key:e.id,attrs:{label:t.getPayroll(e.code),value:e.id}})})),1),t.isValid?a("small",{staticClass:"error"},[t._v("Vui lòng chọn lý do yêu cầu hiệu chỉnh")]):t._e()],1):a("el-form-item",{staticClass:"be-flex be-flex-column",attrs:{label:"Lý do từ chối"}},[a("el-select",{staticClass:"select",staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"Chọn lý do"},on:{change:t.handleChangeReason},model:{value:t.rejectCode,callback:function(e){t.rejectCode=e},expression:"rejectCode"}},t._l(t.paramsReject,(function(e){return a("el-option",{key:e.id,attrs:{label:""+t.$t(e.key),value:e.id}})})),1),t.isValid?a("small",{staticClass:"error"},[t._v("Vui lòng chọn lý do từ chối")]):t._e()],1),a("el-form-item",{staticClass:"be-flex be-flex-column",attrs:{label:"Mô tả"}},[a("el-input",{staticStyle:{"word-break":"break-word"},attrs:{type:"textarea",maxlength:250,"show-word-limit":"",wrap:"hard",rows:"6",placeholder:"Nhập nội dung"},model:{value:t.rejectValue,callback:function(e){t.rejectValue=e},expression:"rejectValue"}})],1)],1),a("div",{staticClass:"footer-popup",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"be-button-unset",on:{click:t.hanleCancel}},[t._v("Hủy")]),9==t.status||12===t.status?a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:t.handleConfirm}},[t._v("Yêu cầu")]):a("el-button",{staticClass:"be-btn-danger",attrs:{size:"medium"},on:{click:t.handlePayRoll}},[t._v("Từ chối")])],1)],1)},X=[],Z=(a("a9e3"),a("9f13")),tt=Object(v["a"])("auth"),et=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.rejectValue="",t.rejectCode="",t.paramsReject=[],t.payrollList=[],t.isValid=!1,t}return Object(o["a"])(a,[{key:"created",value:function(){this.contractReq=Object(v["a"])("contract",{districtId:this.districtId})}},{key:"hanleCancel",value:function(){this.setOpenPopup({popupName:"popup-reject-pay-roll",isOpen:!1}),this.rejectValue=""}},{key:"handleChangeReason",value:function(){this.isValid=!1}},{key:"handlePayRoll",value:function(){var t=this;if(this.rejectCode){var e=Object(y["filter"])(this.paramsReject,(function(e){return e.id===t.rejectCode})),a=null;e.length&&(a=e[0].value),this.contractReq.updatePayRoll(this.id,{payrollStatus:this.status,rejectReason:this.rejectValue,rejectCode:a}).then((function(){t.showNotification(t.status),t.setOpenPopup({popupName:"popup-reject-pay-roll",isOpen:!1}),t.setOpenPopup({popupName:"pay-roll",isOpen:!1}),t.$emit("load"),t.rejectValue="",t.rejectCode="",t.isValid=!1}))}else this.isValid=!0}},{key:"handleConfirm",value:function(){var t=this;if(this.rejectCode){var e=Object(y["filter"])(this.payrollList,(function(e){return e.id===t.rejectCode})),a=null;e.length&&(a=e[0].value),this.contractReq.updatePayRoll(this.id,{payrollStatus:this.status,rejectReason:this.rejectValue,rejectCode:a}).then((function(){t.showNotification(t.status),t.setOpenPopup({popupName:"popup-reject-pay-roll",isOpen:!1}),t.setOpenPopup({popupName:"pay-roll",isOpen:!1}),t.$emit("load"),t.rejectValue="",t.rejectCode="",t.isValid=!1}))}else this.isValid=!0}},{key:"showNotification",value:function(t){switch(t){case 6:this.$message.success("Từ chối thành công");break;case 8:this.$message.success("Từ chối thành công");break;case 11:this.$message.success("Từ chối hiệu chỉnh thành công");break;case 13:this.$message.success("Từ chối hiệu chỉnh thành công");break;case 9:this.$message.success("Yêu cầu hiệu chỉnh thành công");break;case 12:this.$message.success("Yêu cầu hiệu chỉnh thành công");break;default:break}}},{key:"handleOpen",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=["Số liệu không đúng","Thiếu thông tin","Sai thông tin","Khác"],9!=this.status&&12!==this.status){t.next=8;break}return t.next=4,tt.getParamsReject(this.districtId,this.status);case 4:this.payrollList=t.sent,Object(y["forEach"])(this.payrollList,(function(t,a){t.text=e[a]})),t.next=18;break;case 8:return t.prev=8,t.next=11,tt.getParamsReject(this.districtId,this.status);case 11:this.paramsReject=t.sent,Object(y["forEach"])(this.paramsReject,(function(t,a){t.text=e[a]})),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](8),console.log(t.t0);case 18:case"end":return t.stop()}}),t,this,[[8,15]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"getPayroll",value:function(t){return Z["PAYROLL_EDIT"][t]}},{key:"handleClose",value:function(){}}]),a}(Object(b["b"])(P["a"],N["a"]));Object(h["a"])([Object(b["c"])({required:!0,type:Number,default:0})],et.prototype,"id",void 0),Object(h["a"])([Object(b["c"])({required:!0,type:Number,default:0})],et.prototype,"status",void 0),et=Object(h["a"])([Object(b["a"])({})],et);var at=et,it=at,lt=(a("4778"),Object(R["a"])(it,J,X,!1,null,"314c376c",null)),nt=lt.exports,st=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("base-tree-table",{attrs:{paginationInfo:"đơn vị kinh doanh",data:t.data,showSummary:!0,summaryMethod:t.summaryMethod,sumText:"Tổng",table:t.query,showPagination:!0,isLoading:t.isLoading},on:{sizeChange:t.handleSizeChange,currentChange:t.handleCurrentChange}},[a("el-table-column",{attrs:{index:t.getIndex,type:"index",width:"70",align:"center",label:"#"}}),a("el-table-column",{attrs:{label:"mã đvkd",align:"center",prop:"transactionOfficeCode",width:"100"}}),a("el-table-column",{attrs:{label:"đơn vị kinh doanh",prop:"transactionOfficeName",width:"270"}}),a("el-table-column",{attrs:{label:"SL HĐ",prop:"numOfContract",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.numOfContract))+" ")]}}])}),a("el-table-column",{attrs:{label:"SL hủy",prop:"numOfCancel",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.numOfCancel))+" ")]}}])}),a("el-table-column",{attrs:{label:"FYP",prop:"revenueTotalAmountY1 ",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.revenueYear1Amount))+" ")]}}])}),a("el-table-column",{attrs:{label:"Lương KDTT",prop:"salarySalesAmountK1",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.salarySalesK1Amount))+" ")]}}])}),a("el-table-column",{attrs:{label:"RYP",prop:"revenueTotalAmountK2 ",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.revenueK2Amount))+" ")]}}])}),a("el-table-column",{attrs:{label:"Lương RYP",prop:"salarySalesAmountK1",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.salarySalesK2Amount))+" ")]}}])}),a("el-table-column",{attrs:{label:"CTTĐ",prop:"emulationAmount",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.emulationAmount))+" ")]}}])}),a("el-table-column",{attrs:{width:"40"}}),a("el-table-column",{attrs:{label:"Tlht kpi",prop:"resultMonthRevenueTotalPercent",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatPercent")(e.row.resultMonthRevenueYear1Percent))+" ")]}}])}),a("el-table-column",{attrs:{label:"truy thu",prop:"arrearsAmount",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.arrearsAmount))+" ")]}}])}),a("el-table-column",{attrs:{label:"Lương cbql",prop:"salaryManagerAmount",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.salaryManagerAmount))+" ")]}}])}),a("el-table-column",{attrs:{label:"tổng lương",prop:"salarySalesTotalAmount",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatNumber")(e.row.salarySalesTotalAmount))+" ")]}}])})],1)],1)},rt=[],ot=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"getIndex",get:function(){return this.query.limit*(this.query.page-1)+1}},{key:"handleSizeChange",value:function(t){this.$emit("sizeChange",t)}},{key:"handleCurrentChange",value:function(t){this.$emit("currentChange",t)}},{key:"summaryMethod",value:function(t){var e=this,a=t.columns,i=[];return Object(y["forEach"])(a,(function(t,a){if(a<2)i[a]="";else if(2!==a){var l=e.summary[t.property];if(i[a]=l?e.$options.filters.formatNumber(l):0,11===a){var n=e.summary["resultMonthRevenueTotalPercent"];i[11]=e.$options.filters.formatPercentAdv(n)}10===a&&(i[a]="")}else i[a]="Tổng"})),i}}]),a}(b["d"]);Object(h["a"])([Object(b["c"])({required:!0,type:Array,default:[]})],ot.prototype,"data",void 0),Object(h["a"])([Object(b["c"])({required:!1,type:Object,default:{}})],ot.prototype,"query",void 0),Object(h["a"])([Object(b["c"])({required:!1,type:Object,default:{}})],ot.prototype,"summary",void 0),Object(h["a"])([Object(b["c"])({required:!1,type:Boolean,default:!1})],ot.prototype,"isLoading",void 0),ot=Object(h["a"])([Object(b["a"])({components:{}})],ot);var ct=ot,ut=ct,ht=Object(R["a"])(ut,st,rt,!1,null,"8fdb910c",null),dt=ht.exports,pt=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.isShow=!1,t.detail={},t.avatar="",t.statusPayRoll=0,t.data=[],t.tabs=[{id:0,name:"Cá nhân",active:!0,label:"CBNV"},{id:1,name:"Đơn vị kinh doanh",label:"DVKD"}],t.sheetAactive="CBNV",t.summary={},t.isLoading=!1,t.isLoadingPopup=!1,t.isLoadingBtn=!1,t.query={page:1,limit:20,total:0},t.pageQuery={pageIndex:1,pageSize:20},t.fromDate=0,t.toDate=0,t}return Object(o["a"])(a,[{key:"getTitleCode",get:function(){if("6"===this.detailFile.payrollStatus)switch(this.detailFile.branchRejectCode){case"1":return"Sai nhân viên tư vấn";case"2":return"Sai thông tin lương";case"3":return"Sai mối quan hệ";case"4":return"Sai đơn vị kinh doanh";case"5":return"Sai chi nhánh";default:return"Khác"}else if("8"===this.detailFile.payrollStatus)switch(this.detailFile.hoRejectCode){case"1":return"Sai nhân viên tư vấn";case"2":return"Sai thông tin lương";case"3":return"Sai mối quan hệ";case"4":return"Sai đơn vị kinh doanh";case"5":return"Sai chi nhánh";default:return"Khác"}else if("12"===this.detailFile.payrollStatus)switch(this.detailFile.editRequestCode){case"1":return"Sai nhân viên tư vấn";case"2":return"Sai thông tin lương";case"3":return"Sai mối quan hệ";case"4":return"Sai đơn vị kinh doanh";case"5":return"Sai chi nhánh";default:return"Khác"}else switch(this.detailFile.editRequestCode){case"1":return"Sai nhân viên tư vấn";case"2":return"Sai thông tin lương";case"3":return"Sai mối quan hệ";case"4":return"Sai đơn vị kinh doanh";case"5":return"Sai chi nhánh";default:return"Khác"}}},{key:"getRequestAtNvds",get:function(){var t=new Date(this.detailFile.editRequestedAt).getDate();return t>this.toDate}},{key:"getRequestAtDvkd",get:function(){var t=new Date(this.detailFile.editRequestedAt).getDate();return t>this.toDate}},{key:"getRequestAtHo",get:function(){var t=new Date(this.detailFile.editRequestedAt).getDate();return t<=this.toDate}},{key:"getRoleButton",value:function(t){return this.detailFile.payrollStatus===t}},{key:"created",value:function(){this.salaryReq=Object(v["a"])("salary",{districtId:this.districtId}),this.contractReq=Object(v["a"])("contract",{districtId:this.districtId}),this.employee=Object(v["a"])("employee",{districtId:this.districtId}),this.paramsReq=Object(v["a"])("param",{districtId:this.districtId})}},{key:"checkTime",value:function(){this.pageQuery.year=this.detailFile.payrollYear,this.pageQuery.month=this.detailFile.payrollMonth}},{key:"handleOpen",value:function(){var t=new Date(this.detailFile.editRequestedAt).getDate();console.log("date",t),this.init(),"9"!==this.detailFile.payrollStatus&&"5"!==this.detailFile.payrollStatus&&"12"!==this.detailFile.payrollStatus||this.getRoleReqAt()}},{key:"getRoleReqAt",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e="HO_APPROVE_DATE",t.next=4,this.paramsReq.getParamTimeRequest(e);case 4:a=t.sent,this.fromDate=+Object(y["filter"])(a,(function(t){return"FROM_DATE"===t.code}))[0].value,this.toDate=+Object(y["filter"])(a,(function(t){return"TO_DATE"===t.code}))[0].value,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,this,[[0,9]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.checkTime(),e?this.isLoading=!0:this.isLoadingPopup=!0;var a=Object(n["a"])(Object(n["a"])({},this.pageQuery),{},{branchIds:this.detailFile.branchId});"CBNV"===this.sheetAactive?(this.salaryReq.getSalariesIndividual(a).then((function(a){t.data=a.data,e?t.isLoading=!1:t.isLoadingPopup=!1})).catch((function(){e?t.isLoading=!1:t.isLoadingPopup=!1})),this.salaryReq.getSummaryIndividual(a).then((function(e){t.query.total=e.data.total,t.summary=e.data}))):(this.salaryReq.getSalariesOffice(a).then((function(a){t.data=a.data,e?t.isLoading=!1:t.isLoadingPopup=!1})).catch((function(){e?t.isLoading=!1:t.isLoadingPopup=!1})),this.salaryReq.getSummaryOffice(a).then((function(e){t.query.total=e.data.total,t.summary=e.data})))}},{key:"resetQuery",value:function(){this.query={page:1,limit:20,total:0},this.pageQuery={pageIndex:1,pageSize:20}}},{key:"handleClose",value:function(){this.data=[],this.detail={},this.resetQuery(),this.sheetAactive="CBNV",Object(y["forEach"])(this.tabs,(function(t){0===t.id?t.active=!0:delete t.active}))}},{key:"handleChangeTab",value:function(t){this.data=[],this.summary={},this.isShow=!0,this.sheetAactive=t.label,Object(y["forEach"])(this.tabs,(function(e){e.active=e.id===t.id})),this.$forceUpdate(),this.resetQuery(),this.init(!0)}},{key:"handleSizeChange",value:function(t){this.query.limit=t,this.pageQuery.pageSize=t,this.init(!0)}},{key:"handleCurrentChange",value:function(t){this.query.page=t,this.pageQuery.pageIndex=t,this.init(!0)}},{key:"handleUpdateSalary",value:function(t){var e=this;6===t||8===t||9===t||12===t?(this.setOpenPopup({popupName:"popup-reject-pay-roll",isOpen:!0}),this.statusPayRoll=t):11===t||13===t?this.contractReq.updatePayRoll(this.detailFile.id,{payrollStatus:t,rejectReason:"",rejectCode:""}).then((function(){e.$message.success("Từ chối hiệu chỉnh thành công"),e.setOpenPopup({popupName:"pay-roll",isOpen:!1}),e.handleEmitLoad()})):(this.isLoadingBtn=!0,this.contractReq.updatePayRoll(this.detailFile.id,{payrollStatus:t,rejectReason:null}).then((function(){e.isLoadingBtn=!1,e.setOpenPopup({popupName:"pay-roll",isOpen:!1}),e.showNotification(t),e.handleEmitLoad()})).catch((function(){e.isLoadingBtn=!1})))}},{key:"showNotification",value:function(t){switch(t){case 4:this.$message.success("Yêu cầu duyệt thành công");break;case 5:this.$message.success("Phê duyệt thành công");break;case 7:this.$message.success("Duyệt chi thành công");break;case 9:this.$message.success("Yêu cầu hiệu chỉnh thành công");break;case 10:this.$message.success("Duyệt hiệu chỉnh thành công");break;default:break}}},{key:"handleEmitLoad",value:function(){this.$emit("load")}},{key:"handeLoad",value:function(){this.handleEmitLoad()}}]),a}(Object(b["b"])(P["a"],N["a"]));Object(h["a"])([Object(b["c"])({required:!1,type:Object,default:{}})],pt.prototype,"detailFile",void 0),Object(h["a"])([Object(b["c"])({required:!1,type:Boolean,default:!1})],pt.prototype,"isError",void 0),pt=Object(h["a"])([Object(b["a"])({components:{BaseTable:E["a"],BaseIcon:f["a"],PayRollTable:W,PopupRejectPay:nt,TableOther:dt}})],pt);var mt=pt,bt=mt,ft=(a("22e5"),Object(R["a"])(bt,z,Y,!1,null,"03fb44c0",null)),yt=ft.exports,vt=Object(g["a"])("beAudit"),gt=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.data=[],t.isLoading=!1,t.rowData={},t.query={total:100,page:1,limit:20,contractStatus:null,keywordString:"",orderByClause:1},t.isExcelLoading=!1,t.isPdfLoading=!1,t}return Object(o["a"])(a,[{key:"created",value:function(){this.contractReq=Object(v["a"])("contract",{districtId:this.districtId}),this.salaryReq=Object(v["a"])("salary",{districtId:this.districtId})}},{key:"mounted",value:function(){this.init()}},{key:"getIndex",get:function(){return this.query.limit&&this.query.page?this.query.limit*(this.query.page-1)+1:1}},{key:"getScreen",get:function(){return window.screen.availWidth>=1920?"full":window.screen.availWidth>1366&&window.screen.availWidth<1920?"hd":"low"}},{key:"init",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,i,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.isLoading=!0,e=this.getFilter(this.$route.name),e&&(this.query=Object(y["assign"])(this.query,e.filters)),a=Object(n["a"])(Object(n["a"])({},this.query),{},{total:null,branchId:this.roleHOLEADERAmin?"":this.branchId,pageNo:this.query.page,pageSize:this.query.limit,keywordString:this.query.search,search:null}),delete a["page"],delete a["limit"],t.next=9,this.contractReq.getPayRollSearch(a);case 9:return i=t.sent,this.data=i.data,t.next=13,this.contractReq.getPayRollCount(a);case 13:l=t.sent,this.query.total=l.data,this.isLoading=!1,t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](0),this.isLoading=!1;case 21:case"end":return t.stop()}}),t,this,[[0,18]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleOpenPayrollMonth",value:function(){this.setOpenPopup({popupName:"pay-roll",isOpen:!0})}},{key:"handleRowClick",value:function(t){this.rowData=t.row,"1"!==t.row.payrollStatus&&"2"!==t.row.payrollStatus?this.setOpenPopup({popupName:"pay-roll",isOpen:!0}):this.$message.error("Không xem được chi tiết khi chưa tính xong lương")}},{key:"handleSizeChange",value:function(t){this.query.limit=t,this.init()}},{key:"handleCurrentChange",value:function(t){this.query.page=t,this.init()}},{key:"handleOpenPopupFilter",value:function(){this.setOpenPopup({popupName:"filter-salary",isOpen:!0})}},{key:"handleSort",value:function(t){this.query.orderByClause=t,this.init()}},{key:"handleSearch",value:function(t){this.query=Object(n["a"])(Object(n["a"])({},this.query),t),this.query.page=1,this.init()}},{key:"handleFilter",value:function(t){var e=this,a=Object.keys(t);Object(y["forEach"])(a,(function(a){t[a]?e.query[a]=t[a]:e.query[a]&&delete e.query[a]})),this.query.page=1,this.init()}},{key:"handleLoad",value:function(){this.init()}}]),a}(Object(b["b"])(N["a"],P["a"],k));Object(h["a"])([vt.Getter("getFilter")],gt.prototype,"getFilter",void 0),gt=Object(h["a"])([Object(b["a"])({components:{FilterSalary:q,PopupFilter:F["a"],PopupFilterAudit:A["a"],PopupPayRollMonth:M,PopupAproveSalary:yt}})],gt);var _t=gt,Ct=_t,kt=(a("19fc"),Object(R["a"])(Ct,i,l,!1,null,"7fea295b",null));e["default"]=kt.exports},4778:function(t,e,a){"use strict";a("30c3")},"4d39":function(t,e,a){},"6b65":function(t,e,a){},"9e48":function(t,e,a){"use strict";a("4d39")},b6d3:function(t,e,a){"use strict";a("6b65")},e797:function(t,e,a){},eb10:function(t,e,a){}}]);
//# sourceMappingURL=chunk-74a9904c.cd627651.js.map